

==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FfPfEy3NZlelzhzjH9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 504e51418d856d664db23dd55a61352d                                                   |
| sha1                   | 522c0fb1ed2b9594e7a2aab9481883da57d8ca23                                           |
| sha256                 | f190e142f402de460455ff2d1835294a3e118ba74d76aa092af49372bb9b76f4                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FfPfEy3NZlelzhzjH9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FfPfEy3NZlelzhzjH9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.00 MB
Data read: 0.00 MB (ratio 1.00:1)
Time: 45.879 sec (0 m 45 s)
Start Date: 2022:02:11 10:12:32
End Date:   2022:02:11 10:13:18

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:12:33Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FfPfEy3NZlelzhzjH9.exe SCORE: 109 TYPE: EXE SIZE: 5120 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f95f8580400> 
MD5: 504e51418d856d664db23dd55a61352d 
SHA1: 522c0fb1ed2b9594e7a2aab9481883da57d8ca23 
SHA256: f190e142f402de460455ff2d1835294a3e118ba74d76aa092af49372bb9b76f4 CREATED: Fri Feb 11 10:12:32 2022 MODIFIED: Fri Feb 11 10:12:32 2022 ACCESSED: Fri Feb 11 10:13:30 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_3 SUBSCORE: 2 
DESCRIPTION: Low entropy - very sparse data or repeating plaintext REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 10 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T09:13:30Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_3
5		executable_pe
10		IsPE64
10		IsDLL
10		IsWindowsGUI
10		HasDebugData
10		ImportTableIsBad
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 109

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:12:32                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FfPfEy3NZlelzhzjH9.exe
Real Name:	/msidntld.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_3
5	executable_pe
10	IsPE64
10	IsDLL
10	IsWindowsGUI
10	HasDebugData
10	ImportTableIsBad
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	1.0
ClamAV:	0
Loki:	109
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
1747.4862029323024
==================================================================


==================================================================
Fichier HTTP-FfPfEy3NZlelzhzjH9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FpXghI3ZELze6AeFE8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FpXghI3ZELze6AeFE8.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 4.88 MB
Data read: 4.59 MB (ratio 1.06:1)
Time: 52.116 sec (0 m 52 s)
Start Date: 2022:02:11 10:13:32
End Date:   2022:02:11 10:14:24

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf2 in position 4: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:13:32Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FpXghI3ZELze6AeFE8.exe SCORE: 534 TYPE: EXE SIZE: 4809232 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fafd0630400> 
MD5: 2be5d5def542fd59a2278a656b074f65 
SHA1: 9bbc3f83076e41f3b69c11aa061adea74fca7e7c 
SHA256: 09d53831ce63aea279aaa08d670b6290312f63fedfe1981f819e58d774a68fa0 CREATED: Fri Feb 11 10:13:32 2022 MODIFIED: Fri Feb 11 10:13:32 2022 ACCESSED: Fri Feb 11 10:14:22 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier
REASON_17: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_18: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_19: Yara Rule MATCH: Debugger_Check__RemoteAPI SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: CheckRemoteDebuggerPresent
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Crypt32_CryptBinaryToString_API SUBSCORE: 25 
DESCRIPTION: Looks for crypt32 CryptBinaryToStringA function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: CRYPT32.dll Str2: CryptBinaryToStringA
REASON_23: Yara Rule MATCH: RIPEMD160_Constants SUBSCORE: 15 
DESCRIPTION: Look for RIPEMD-160 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3
REASON_24: Yara Rule MATCH: SHA1_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA1 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3 Str6: d6c162ca
REASON_25: Yara Rule MATCH: RijnDael_AES_CHAR SUBSCORE: 15 
DESCRIPTION: RijnDael AES (check2) [char] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T09:14:38Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
60		Debugger_Check__QueryInfo
60		Debugger_Check__RemoteAPI
20		isExecutable
10		Contains_PE_File
25		Crypt32_CryptBinaryToString_API
15		RIPEMD160_Constants
20		SHA1_Constants
15		RijnDael_AES_CHAR

Score total: 534

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2be5d5def542fd59a2278a656b074f65                                                   |
| sha1                   | 9bbc3f83076e41f3b69c11aa061adea74fca7e7c                                           |
| sha256                 | 09d53831ce63aea279aaa08d670b6290312f63fedfe1981f819e58d774a68fa0                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FpXghI3ZELze6AeFE8.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
|                             | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
| DATA                        | Decompress Data::QuickLZ [C0025.001]                                          |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints (2 matches)           | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-debugging instructions                  | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-VM instructions (15 matches)            | anti-analysis/anti-vm/vm-detection                   |
| check HTTP status code (3 matches)                   | communication/http/client                            |
| decompress data using QuickLZ                        | data-manipulation/compression                        |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| encode data using XOR (32 matches)                   | data-manipulation/encoding/xor                       |
| hash data via BCrypt (4 matches)                     | data-manipulation/hashing                            |
| hash data using murmur3                              | data-manipulation/hashing/murmur                     |
| hash data using SHA1 (3 matches)                     | data-manipulation/hashing/sha1                       |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes (3 matches)   | host-interaction/driver                              |
| get system information on Windows (21 matches)       | host-interaction/os/info                             |
| check OS version (2 matches)                         | host-interaction/os/version                          |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (48 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 23.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/62
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:13:32                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FpXghI3ZELze6AeFE8.exe
Real Name:	/mfcore.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1	- Discovery::System Information Discovery [T1082;1]
3	- Execution::System Services::Service Execution [T1569.002;3]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
60	Debugger_Check__QueryInfo
60	Debugger_Check__RemoteAPI
20	isExecutable
10	Contains_PE_File
25	Crypt32_CryptBinaryToString_API
15	RIPEMD160_Constants
20	SHA1_Constants
15	RijnDael_AES_CHAR

============================[ Scores ]============================
CAPA:	23.0
ClamAV:	0
Loki:	534
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
8922.239980185186
==================================================================


==================================================================
Fichier HTTP-FpXghI3ZELze6AeFE8.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fcbw11x8t1xDR7un1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f72d773f13ceb6b842a9d29c56f8880f                                                   |
| sha1                   | 967eea1c315970db632b9dabeaf10ee5b9d47696                                           |
| sha256                 | d66e15eea51ebd4bfd13f8c97646253740b1e6a99328d22232fd01ae13ef5d05                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fcbw11x8t1xDR7un1.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| EXECUTION              | System Services::Service Execution \[T1569.002]\                                   |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | HTTP Communication::IWebBrowser [C0002.010]                                   |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| initialize IWebBrowser2                              | communication/http                                   |
| interact with driver via control codes               | host-interaction/driver                              |
| write file on Windows                                | host-interaction/file-system/write                   |
| create service                                       | host-interaction/service/create                      |
| start service                                        | host-interaction/service/start                       |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
3		- Execution::System Services::Service Execution [T1569.002;3]

Score total: 13.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fcbw11x8t1xDR7un1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 35.617 sec (0 m 35 s)
Start Date: 2022:02:11 10:37:29
End Date:   2022:02:11 10:38:05

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xef in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x86 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 8: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdb in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbe in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 2-3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbf in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbb in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbb in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x94 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbb in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 3-4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xba in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 30: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 22: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8e in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfd in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbc in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdc in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe4 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfb in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb0 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe4 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 9: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf4 in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbb in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbf in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xba in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 4-5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdf in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 9: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe4 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 9: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8e in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfd in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xac in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe1 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:37:30Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fcbw11x8t1xDR7un1.exe SCORE: 729 TYPE: EXE SIZE: 24576 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fde04984400> 
MD5: f72d773f13ceb6b842a9d29c56f8880f 
SHA1: 967eea1c315970db632b9dabeaf10ee5b9d47696 
SHA256: d66e15eea51ebd4bfd13f8c97646253740b1e6a99328d22232fd01ae13ef5d05 CREATED: Fri Feb 11 10:37:29 2022 MODIFIED: Fri Feb 11 10:37:29 2022 ACCESSED: Fri Feb 11 10:38:24 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: CreateFileA
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff68f040400068741c400064a100000000506489250000000083ec585356578965e8ff154440400033d28ad48915545540008bc881e1ff0000008 ... (truncated)
REASON_6: Yara Rule MATCH: Installer_VISE_Custom_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68f040400068741c400064a100000000506489250000000083ec585356578965e8ff154440400033d28ad48915545540008bc881e1ff000000890d
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68f040400068741c400064a10000000050 Str2: 558bec6aff683044400068741c400064a10000000050 Str3: 558bec6aff684844400068741c40006 ... (truncated)
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68f040400068741c400064a10000000050 Str2: 558bec6aff683044400068741c400064a10000000050 Str3: 558bec6aff684844400068741c40006 ... (truncated)
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6a Str2: 558bec53 Str3: 558bec51 Str4: 558bec8b Str5: 558bec83 Str6: 558bec81 Str7: 558bec57 Str8: 558bec6aff68f040400068741c40 ... (truncated)
REASON_10: Yara Rule MATCH: Installer_VISE_Custom SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68f040400068741c400064a100000000506489250000000083ec585356578965e8ff154440400033d28ad48915545540008bc881e1ff000000890d
REASON_11: Yara Rule MATCH: Armadillo_v4x SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 40400085c00f84160100006a006a006a006a006a0068a85040006a016a036a0168ff010f006898504000689850400050ff15084040008b Str2: 6a006a006801efcd ... (truncated)
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68f040400068741c400064a1000000005064892500000000 Str2: 558bec6aff683044400068741c400064a1000000005064892500000000 Str3: 558 ... (truncated)
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_18: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T09:38:25Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		ft_exe
2		math_entropy_4
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Installer_VISE_Custom_additional
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Installer_VISE_Custom
70		Armadillo_v4x
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
40		SEH_Save
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 729

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 23/70
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:37:29                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fcbw11x8t1xDR7un1.exe
Real Name:	/Practical Malware Analysis Lab 10-03.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
4	- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
3	- Execution::System Services::Service Execution [T1569.002;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	ft_exe
2	math_entropy_4
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Installer_VISE_Custom_additional
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Installer_VISE_Custom
70	Armadillo_v4x
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
40	SEH_Save
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	13.5
ClamAV:	0
Loki:	729
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
13823.231785562315
==================================================================


==================================================================
Fichier HTTP-Fcbw11x8t1xDR7un1.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FnMYM5yYWQZf5BAD.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | d707382b7d60eb8830a2da9d6480062a                                                   |
| sha1                   | 4c721616200b2cd92d7716981999d94f549732a8                                           |
| sha256                 | bf331cdf306fe1d01a5b4b81b898a268d0d1c8461c4aeda19d5c67f5fad981b1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FnMYM5yYWQZf5BAD.exe                          |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 4.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:38:26Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FnMYM5yYWQZf5BAD.exe SCORE: 264 TYPE: EXE SIZE: 59904 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fc05d85c400> 
MD5: d707382b7d60eb8830a2da9d6480062a 
SHA1: 4c721616200b2cd92d7716981999d94f549732a8 
SHA256: bf331cdf306fe1d01a5b4b81b898a268d0d1c8461c4aeda19d5c67f5fad981b1 CREATED: Fri Feb 11 10:38:26 2022 MODIFIED: Fri Feb 11 10:38:26 2022 ACCESSED: Fri Feb 11 10:39:01 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e83b0500004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T09:39:01Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 264

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FnMYM5yYWQZf5BAD.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 44.622 sec (0 m 44 s)
Start Date: 2022:02:11 10:38:26
End Date:   2022:02:11 10:39:10

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/65
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:38:26                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FnMYM5yYWQZf5BAD.exe
Real Name:	/tzutil.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1	- Discovery::System Information Discovery [T1082;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	4.0
ClamAV:	0
Loki:	264
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4263.928520696095
==================================================================


==================================================================
Fichier HTTP-FnMYM5yYWQZf5BAD.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FHoNXK2ympNfTsL6Y9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5f69f4f8683151a59c5a11265b4a3c96                                                   |
| sha1                   | 95ae738ab6b2cc92d88e3debbaacdd924bc27f5e                                           |
| sha256                 | edc1b6a3e4fde216a323329e35f4192b0f49bc68285ee67036deff9e94c4e33a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FHoNXK2ympNfTsL6Y9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:39:11Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FHoNXK2ympNfTsL6Y9.exe SCORE: 229 TYPE: EXE SIZE: 30720 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9650b20400> 
MD5: 5f69f4f8683151a59c5a11265b4a3c96 
SHA1: 95ae738ab6b2cc92d88e3debbaacdd924bc27f5e 
SHA256: edc1b6a3e4fde216a323329e35f4192b0f49bc68285ee67036deff9e94c4e33a CREATED: Fri Feb 11 10:39:11 2022 MODIFIED: Fri Feb 11 10:39:11 2022 ACCESSED: Fri Feb 11 10:39:41 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e80b0300004883c428e95efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T09:39:42Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FHoNXK2ympNfTsL6Y9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 44.629 sec (0 m 44 s)
Start Date: 2022:02:11 10:39:11
End Date:   2022:02:11 10:39:56

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:39:11                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FHoNXK2ympNfTsL6Y9.exe
Real Name:	/VaultCmd.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	1.0
ClamAV:	0
Loki:	229
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3649.358033885638
==================================================================


==================================================================
Fichier HTTP-FHoNXK2ympNfTsL6Y9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FWjoX31tpod0bhWave.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ed888dc2f04f5eac83d6d14088d002de                                                   |
| sha1                   | b6ec6a00d53f4ee8ef51d7e533f63d4f9cd171f4                                           |
| sha256                 | c78dae3e6ef91539408d1def9724f89b1aae44e4003f464d21f20e28abc8310a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FWjoX31tpod0bhWave.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
|                        | System Information Discovery:: \[T1082]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Check String:: [C0019]                                                        |
|                             | Compression Library:: [C0060]                                                 |
|                             | Encode Data::Base64 [C0026.001]                                               |
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| compiled with py2exe (2 matches)                     | compiler/py2exe                                      |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (3 matches)  | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| read file via mapping                                | host-interaction/file-system/read                    |
| print debug messages (2 matches)                     | host-interaction/log/debug/write-event               |
| terminate process                                    | host-interaction/process/terminate                   |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| linked against ZLIB                                  | linking/static/zlib                                  |
| parse PE header                                      | load-code/pe                                         |
| reference startup folder                             | persistence/startup-folder                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 17.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FWjoX31tpod0bhWave.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 22.61 MB
Data read: 4.47 MB (ratio 5.06:1)
Time: 91.233 sec (1 m 31 s)
Start Date: 2022:02:11 10:39:56
End Date:   2022:02:11 10:41:28

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 37/64
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:39:56                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FWjoX31tpod0bhWave.exe
Real Name:	/ed888dc2f04f5eac83d6d14088d002de.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
1	- Discovery::System Information Discovery [T1082;1]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	win_files_operation
15	ldpreload
10	ft_exe
50	ConventionEngine_Anomaly_OutsideOfDebug
2	math_entropy_close_8
5	executable_pe
70	Visual_Cpp_2005_Release_Microsoft
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsWindowsGUI
10	IsPacked
10	HasOverlay
10	HasRichSignature
35	Embedded_PE
2	PE_File
70	stager_reverse_tcp_nx_ldone_x86
70	stager_bind_tcp_nx_ldone_x86
70	win32_stage_boot_winsock_conn_ldone_x86
70	win32_stage_boot_bind_read_ldone_x86
70	win32_stage_boot_reverse_read_ldone_x86
70	win32_stage_boot_winsock_conn_udp_ldone_x86
70	stager_reverse_ipv6_tcp_nx_ldone_x86
70	win32_stage_boot_bind_inlineegg_ldone_x86
70	win32_stage_boot_reverse_ldone_x86
70	win32_stage_boot_reverse_shell_revert_ldone_x86
70	win32_stage_winexec_ldone_x86
70	stager_bind_ipv6_tcp_nx_ldone_x86
70	win32_stage_boot_winsock_bind_ldone_x86
70	win32_stage_boot_reverse_shell_ldone_x86
70	win32_stage_api_ldone_x86
70	win32_stage_boot_bind_ldone_x86
70	win32_stage_boot_reverse_udp_ldone_x86
70	win32_stage_boot_reverse_inlineegg_ldone_x86
70	win32_stage_boot_bind_shell_ldone_x86
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
60	DebuggerException__ConsoleCtrl_v1
60	DebuggerException__SetConsoleCtrl_v1
30	Check_OutputDebugStringA_iat_v1
40	SEH_Save
40	SEH_Init
30	Check_OutputDebugStringA_iat
10	anti_dbg
60	Netwalker
20	isExecutable
5	py2exe
10	Contains_PE_File
70	blacklist
25	CRC32_poly_Constant
25	CRC32_table
15	CRC16_table
20	MD5_Constants
15	RIPEMD160_Constants
20	SHA1_Constants
20	SHA512_Constants
20	SHA2_BLAKE2_IVs
5	BASE64_table

============================[ Scores ]============================
CAPA:	17.0
ClamAV:	0
Loki:	2479
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
41628.696834655704
==================================================================


==================================================================
Fichier HTTP-FWjoX31tpod0bhWave.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FlnUKW1EBGHUpcKEA1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FlnUKW1EBGHUpcKEA1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 1.30 MB
Data read: 1.23 MB (ratio 1.06:1)
Time: 46.546 sec (0 m 46 s)
Start Date: 2022:02:11 10:41:29
End Date:   2022:02:11 10:42:15

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:41:29Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FlnUKW1EBGHUpcKEA1.exe SCORE: 324 TYPE: EXE SIZE: 1288704 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb37efe4400> 
MD5: 84aa261b1e0160be470ee27610bc65aa 
SHA1: cb517e3380f9b826bc4feccb23b0485951d86bc9 
SHA256: 352f2217ae1b5baabe77d8c9b74356cdbcd893799add6580b2960b19efb8800a CREATED: Fri Feb 11 10:41:29 2022 MODIFIED: Fri Feb 11 10:41:29 2022 ACCESSED: Fri Feb 11 10:42:23 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: possible_includes_base64_packed_functions SUBSCORE: 25 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: atob Str2: This Str3: prog Str4: rogr Str5: ogra Str6: gram Str7: cann Str8: anno Str9: nnot Str10: mode Str11: Rich Str12: ichq Str1 ... (truncated)
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8f30800004883c428e95efeffffcccccccccccccccccccccccccccc
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 75e40ac34da01d8b94fb6c09da8faff9 Str2: fd9a02c99d8294ea49df9fe274c83d4e Str3: f0b3cb648fe4baa9256ee1b64fd823bb Str4: 246bafd328781690 ... (truncated)
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T09:42:42Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
25		possible_includes_base64_packed_functions
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1

Score total: 324

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 84aa261b1e0160be470ee27610bc65aa                                                   |
| sha1                   | cb517e3380f9b826bc4feccb23b0485951d86bc9                                           |
| sha256                 | 352f2217ae1b5baabe77d8c9b74356cdbcd893799add6580b2960b19efb8800a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FlnUKW1EBGHUpcKEA1.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| encode data using XOR (3 matches)                    | data-manipulation/encoding/xor                       |
| hash data using fnv (3 matches)                      | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| access PEB ldr_data (41 matches)                     | linking/runtime-linking                              |
| parse PE header (125 matches)                        | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 6.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:41:28                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FlnUKW1EBGHUpcKEA1.exe
Real Name:	/mmgaserver.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_6
5	executable_pe
25	possible_includes_base64_packed_functions
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File
10	Big_Numbers1

============================[ Scores ]============================
CAPA:	6.0
ClamAV:	0
Loki:	324
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5254.769682472141
==================================================================


==================================================================
Fichier HTTP-FlnUKW1EBGHUpcKEA1.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FnnB364YyEiD5DNfTl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FnnB364YyEiD5DNfTl.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 43.410 sec (0 m 43 s)
Start Date: 2022:02:11 10:46:26
End Date:   2022:02:11 10:47:09

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 39/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:46:26                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FnnB364YyEiD5DNfTl.exe
Real Name:	/a45e377dbb98a6b44fd4034bc3fff9b0.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Installer_VISE_Custom_additional
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Installer_VISE_Custom
70	Armadillo_v4x
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
30	Check_OutputDebugStringA_iat_v1
40	SEH_Save
40	SEH_Init
30	Check_OutputDebugStringA_iat
10	anti_dbg
20	isExecutable
10	Contains_PE_File
15	VC6_Random

============================[ Scores ]============================
CAPA:	0
ClamAV:	0
Loki:	824
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
15059.519905879573
==================================================================


==================================================================
Fichier HTTP-FnnB364YyEiD5DNfTl.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FrCEtj46sdRLIupgG5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5108f54e67cc5d1a44db4fb64a6045c2                                                   |
| sha1                   | 5cb13a7e44537498c988358cd59a155d2d497c0d                                           |
| sha256                 | 8c43c3947c1d6599e9f115eb82c6e6829fa3affd993f0b4207a1e3bf023d1fe8                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FrCEtj46sdRLIupgG5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| check if file exists (6 matches)                     | host-interaction/file-system/exists                  |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value                    | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| delete registry key (2 matches)                      | host-interaction/registry/delete                     |
| delete registry value                                | host-interaction/registry/delete                     |
| create thread (2 matches)                            | host-interaction/thread/create                       |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::Query Registry [T1012;1]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 12.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FrCEtj46sdRLIupgG5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 41.885 sec (0 m 41 s)
Start Date: 2022:02:11 10:47:20
End Date:   2022:02:11 10:48:02

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:47:20Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FrCEtj46sdRLIupgG5.exe SCORE: 394 TYPE: EXE SIZE: 69120 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f0691e8e400> 
MD5: 5108f54e67cc5d1a44db4fb64a6045c2 
SHA1: 5cb13a7e44537498c988358cd59a155d2d497c0d 
SHA256: 8c43c3947c1d6599e9f115eb82c6e6829fa3affd993f0b4207a1e3bf023d1fe8 CREATED: Fri Feb 11 10:47:20 2022 MODIFIED: Fri Feb 11 10:47:20 2022 ACCESSED: Fri Feb 11 10:48:14 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T09:48:15Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
65		win_token
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 394

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:47:20                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FrCEtj46sdRLIupgG5.exe
Real Name:	/TSTheme.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::Query Registry [T1012;1]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
65	win_token
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	12.5
ClamAV:	0
Loki:	394
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
6493.886967667896
==================================================================


==================================================================
Fichier HTTP-FrCEtj46sdRLIupgG5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F2n8zH36XhJJSYXoXa.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F2n8zH36XhJJSYXoXa.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.24 MB
Data read: 0.23 MB (ratio 1.02:1)
Time: 40.083 sec (0 m 40 s)
Start Date: 2022:02:11 10:48:16
End Date:   2022:02:11 10:48:56

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 01e057351737ec63730e86352e4e7436                                                   |
| sha1                   | e59a43da67d67361a7db486148e1ba86008725f9                                           |
| sha256                 | a275b52cf71d8809455e69e46b073d9c802f5a045850c2598885d3d974ad07a5                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F2n8zH36XhJJSYXoXa.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
| DISCOVERY                   | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Get File Attributes:: [C0049]                                                 |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
|                             | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| hash data via BCrypt (2 matches)                     | data-manipulation/hashing                            |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| accept command line arguments (3 matches)            | host-interaction/cli                                 |
| query environment variable                           | host-interaction/environment-variable                |
| set environment variable                             | host-interaction/environment-variable                |
| get common file path (6 matches)                     | host-interaction/file-system                         |
| create directory                                     | host-interaction/file-system/create                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| get file size                                        | host-interaction/file-system/meta                    |
| get file version info                                | host-interaction/file-system/meta                    |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| get disk information (2 matches)                     | host-interaction/hardware/storage                    |
| print debug messages (7 matches)                     | host-interaction/log/debug/write-event               |
| access the Windows event log                         | host-interaction/log/winevt/access                   |
| check mutex                                          | host-interaction/mutex                               |
| check mutex and exit                                 | host-interaction/mutex                               |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| read process memory (21 matches)                     | host-interaction/process                             |
| enumerate process modules (6 matches)                | host-interaction/process/modules/list                |
| terminate process via fastfail (10 matches)          | host-interaction/process/terminate                   |
| query or enumerate registry value (14 matches)       | host-interaction/registry                            |
| set registry value (12 matches)                      | host-interaction/registry/create                     |
| delete registry key (4 matches)                      | host-interaction/registry/delete                     |
| delete registry value (2 matches)                    | host-interaction/registry/delete                     |
| start service                                        | host-interaction/service/start                       |
| get token membership (4 matches)                     | host-interaction/session                             |
| access PEB ldr_data                                  | linking/runtime-linking                              |
| access PE header                                     | load-code/pe                                         |
| parse PE header (11 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]

Score total: 27.5

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:48:16Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F2n8zH36XhJJSYXoXa.exe SCORE: 574 TYPE: EXE SIZE: 245760 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f5a2541c400> 
MD5: 01e057351737ec63730e86352e4e7436 
SHA1: e59a43da67d67361a7db486148e1ba86008725f9 
SHA256: a275b52cf71d8809455e69e46b073d9c802f5a045850c2598885d3d974ad07a5 CREATED: Fri Feb 11 10:48:16 2022 MODIFIED: Fri Feb 11 10:48:16 2022 ACCESSED: Fri Feb 11 10:49:09 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateThread
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e82b0200004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_10: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateThread
REASON_17: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T09:49:10Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
60		win_mutex
20		win_registry
65		win_token
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
45		Inject_Thread
60		Debugger_Check__QueryInfo
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 574

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/69
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:48:16                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F2n8zH36XhJJSYXoXa.exe
Real Name:	/DWWIN.EXE
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
3	- Discovery::System Owner/User Discovery [T1033;3]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
2	- Discovery::File and Directory Discovery [T1083;2]
4	- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4	- Discovery::Process Discovery [T1057;4]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	inject_thread
60	win_mutex
20	win_registry
65	win_token
10	ft_exe
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
45	Inject_Thread
60	Debugger_Check__QueryInfo
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	27.5
ClamAV:	0
Loki:	574
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
9645.984061343232
==================================================================


==================================================================
Fichier HTTP-F2n8zH36XhJJSYXoXa.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FTvaGbhedn0za7HLi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FTvaGbhedn0za7HLi.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.45 MB
Data read: 0.43 MB (ratio 1.05:1)
Time: 43.966 sec (0 m 43 s)
Start Date: 2022:02:11 10:49:11
End Date:   2022:02:11 10:49:55

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x82 in position 9: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:49:12Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FTvaGbhedn0za7HLi.exe SCORE: 239 TYPE: EXE SIZE: 453168 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f0ecf5da400> 
MD5: 811f0bf8bf1262b9fdc256b21599e800 
SHA1: 0f0b33ac2b42e951c556560a9a7e11dff8a691fa 
SHA256: d2f7a0266bcc4eb8521bcdbf98a37dccc27891b6cc96aaf7fc2c1ec77b4d81b7 CREATED: Fri Feb 11 10:49:11 2022 MODIFIED: Fri Feb 11 10:49:11 2022 ACCESSED: Fri Feb 11 10:50:00 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDigitalSignature SUBSCORE: 10 
DESCRIPTION: DigitalSignature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 30600000000202003082602206092a864886f70d010702a08260133082600f020101310b300906052b0e03021a05003068060a2b060104018237020104a05a3058303 ... (truncated)
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T09:50:01Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasOverlay
10		HasDigitalSignature
10		HasDebugData
10		HasRichSignature
2		PE_File
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 239

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 811f0bf8bf1262b9fdc256b21599e800                                                   |
| sha1                   | 0f0b33ac2b42e951c556560a9a7e11dff8a691fa                                           |
| sha256                 | d2f7a0266bcc4eb8521bcdbf98a37dccc27891b6cc96aaf7fc2c1ec77b4d81b7                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FTvaGbhedn0za7HLi.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| encode data using XOR (36 matches)                   | data-manipulation/encoding/xor                       |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| check OS version                                     | host-interaction/os/version                          |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE exports (5 matches)                         | load-code/pe                                         |
| parse PE header (29 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 10.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/62
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:49:11                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FTvaGbhedn0za7HLi.exe
Real Name:	/R4EED64A.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasOverlay
10	HasDigitalSignature
10	HasDebugData
10	HasRichSignature
2	PE_File
30	Check_OutputDebugStringA_iat_v1
30	Check_OutputDebugStringA_iat
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	10.5
ClamAV:	0
Loki:	239
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3997.397273053793
==================================================================


==================================================================
Fichier HTTP-FTvaGbhedn0za7HLi.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F3gSS24Q05IioMFfal.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c0781854a5cd83024f2f8683eb888a3c                                                   |
| sha1                   | 9fe6eb078a48b15a5c2be4ffbebf42f611bca0ff                                           |
| sha256                 | 17656523a20593ad128ec1bb0df99e025a3430e33b6a2cf4f613d14a00ae41d3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F3gSS24Q05IioMFfal.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:50:48Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F3gSS24Q05IioMFfal.exe SCORE: 194 TYPE: EXE SIZE: 63488 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f21c7d33400> 
MD5: c0781854a5cd83024f2f8683eb888a3c 
SHA1: 9fe6eb078a48b15a5c2be4ffbebf42f611bca0ff 
SHA256: 17656523a20593ad128ec1bb0df99e025a3430e33b6a2cf4f613d14a00ae41d3 CREATED: Fri Feb 11 10:50:48 2022 MODIFIED: Fri Feb 11 10:50:48 2022 ACCESSED: Fri Feb 11 10:51:27 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T09:51:27Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 194

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F3gSS24Q05IioMFfal.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 41.760 sec (0 m 41 s)
Start Date: 2022:02:11 10:50:48
End Date:   2022:02:11 10:51:29

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:50:48                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F3gSS24Q05IioMFfal.exe
Real Name:	/mdmlocalmanagement.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	194
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3134.550662823626
==================================================================


==================================================================
Fichier HTTP-F3gSS24Q05IioMFfal.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FKHPyjvnhFmYoU4Ld.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FKHPyjvnhFmYoU4Ld.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.95 MB
Data read: 0.89 MB (ratio 1.06:1)
Time: 35.828 sec (0 m 35 s)
Start Date: 2022:02:11 10:51:30
End Date:   2022:02:11 10:52:06

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:51:31Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FKHPyjvnhFmYoU4Ld.exe SCORE: 1089 TYPE: EXE SIZE: 937984 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb1a8de8400> 
MD5: ad4229879180e267f431ac6666b6a0a2 
SHA1: c191c35ac423b381efc84edce74d7a96dbd9ac7d 
SHA256: aa52dcaf6df43c6aa872fe0f73725f61e082d32c33fc976741d4eca17679533d CREATED: Fri Feb 11 10:51:30 2022 MODIFIED: Fri Feb 11 10:51:30 2022 ACCESSED: Fri Feb 11 10:52:25 2022 
REASON_1: Malware Hash TYPE: SHA1 HASH: c191c35ac423b381efc84edce74d7a96dbd9ac7d SUBSCORE: 100 DESC: Continued GreenBug/Shamoon attacks against Saudi Arabia https://twitter.com/eyalsela/status/885893685325574144
REASON_2: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: socket Str3: connect
REASON_3: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_5: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: win_ismdoor_auto SUBSCORE: 45 
DESCRIPTION: Detects win.ismdoor. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 32c0eb05c0e804240184c00f94c3 Str2: c1e00803c88bd98bc148c1e81283e03f Str3: 83e11f49c1e805428b04820fa3c873034533c9 Str4: 4883ec40488bda ... (truncated)
REASON_8: Yara Rule MATCH: ConventionEngine_Keyword_Bot SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453893a59277c0e5b419e162343a5ffcf3f01000000433a5c55736572735c6d655c446f63756d656e74735c56697375616c2053747564696f20323031335c507 ... (truncated)
REASON_9: Yara Rule MATCH: ConventionEngine_Term_Documents SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453893a59277c0e5b419e162343a5ffcf3f01000000433a5c55736572735c6d655c446f63756d656e74735c56697375616c2053747564696f20323031335c507 ... (truncated)
REASON_10: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453893a59277c0e5b419e162343a5ffcf3f01000000433a5c55736572735c6d655c446f63756d656e74735c56697375616c2053747564696f20323031335c507 ... (truncated)
REASON_11: Yara Rule MATCH: ConventionEngine_Term_VisualStudio SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453893a59277c0e5b419e162343a5ffcf3f01000000433a5c55736572735c6d655c446f63756d656e74735c56697375616c2053747564696f20323031335c507 ... (truncated)
REASON_12: Yara Rule MATCH: Greenbug_Malware_4 SUBSCORE: 70 
DESCRIPTION: Detects ISMDoor Backdoor REF: https://goo.gl/urp4CD AUTHOR: Florian Roth 
MATCHES: Str1: c:\windows	emp	mp8873
REASON_13: Yara Rule MATCH: Greenbug_Malware_5 SUBSCORE: 70 
DESCRIPTION: Auto-generated rule REF: https://goo.gl/urp4CD AUTHOR: Florian Roth 
MATCHES: Str1: cmd /u /c WMIC /Node:localhost /Namespace:oot\SecurityCenter Str2: cmd /a /c net user administrator /domain >> Str3: ============= ... (truncated)
REASON_14: Yara Rule MATCH: Recon_Commands_Windows_Gen1 SUBSCORE: 60 
DESCRIPTION: Detects a set of reconnaissance commands on Windows systems REF: https://goo.gl/MSJCxP AUTHOR: Florian Roth 
MATCHES: Str1: netstat -an Str2: net view Str3: net user Str4: systeminfo Str5: net user administrator
REASON_15: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_17: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_18: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_21: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_22: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_23: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_24: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_25: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_26: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_27: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_28: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_29: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_30: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: A67D0DB885A343257654
REASON_31: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: A67D0DB8A2A173347654432503702AA3 Str2: A67D0DB8A2A173347654432503701111 Str3: A67D0DB885A3432576548A2A03707334 Str4: A67D0DB885A34325 ... (truncated)
REASON_32: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_33: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
REASON_34: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T09:52:27Z

-------- Score ----------------
Scores		Rules
.......		...............
100		Malware Hash
50		network_tcp_socket
65		screenshot
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		ft_exe
45		win_ismdoor_auto
50		ConventionEngine_Keyword_Bot
50		ConventionEngine_Term_Documents
50		ConventionEngine_Term_Users
50		ConventionEngine_Term_VisualStudio
70		Greenbug_Malware_4
70		Greenbug_Malware_5
60		Recon_Commands_Windows_Gen1
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		DebuggerException__SetConsoleCtrl_v1
10		anti_dbg
20		isExecutable
10		Contains_PE_File
10		Big_Numbers0
10		Big_Numbers1
25		CRC32_poly_Constant
25		CRC32_table
5		BASE64_table

Score total: 1089

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ad4229879180e267f431ac6666b6a0a2                                                   |
| sha1                   | c191c35ac423b381efc84edce74d7a96dbd9ac7d                                           |
| sha256                 | aa52dcaf6df43c6aa872fe0f73725f61e082d32c33fc976741d4eca17679533d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FKHPyjvnhFmYoU4Ld.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Screen Capture:: \[T1113]\                                                          |
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005             |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
|                        | System Network Configuration Discovery:: \[T1016]\                                  |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COLLECTION                  | Screen Capture::WinAPI [E1113.m01]                                            |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | Socket Communication::Get Socket Status [C0001.012]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
| CRYPTOGRAPHY                | Generate Pseudo-random Sequence:: [C0021]                                     |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Checksum::Adler [C0032.005]                                                   |
|                             | Compression Library:: [C0060]                                                 |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+----------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                               | NAMESPACE                                            |
|----------------------------------------------------------+------------------------------------------------------|
| contain obfuscated stackstrings (2 matches)              | anti-analysis/obfuscation/string/stackstring         |
| capture screenshot                                       | collection/screenshot                                |
| receive data                                             | communication                                        |
| send data (2 matches)                                    | communication                                        |
| reference Google Public DNS server                       | communication/dns                                    |
| get socket status                                        | communication/socket                                 |
| initialize Winsock library (2 matches)                   | communication/socket                                 |
| compute adler32 checksum                                 | data-manipulation/checksum/adler32                   |
| encode data using Base64                                 | data-manipulation/encoding/base64                    |
| reference Base64 string                                  | data-manipulation/encoding/base64                    |
| encode data using XOR (10 matches)                       | data-manipulation/encoding/xor                       |
| hash data using fnv (6 matches)                          | data-manipulation/hashing/fnv                        |
| authenticate HMAC                                        | data-manipulation/hmac                               |
| generate random numbers using the Delphi LCG (5 matches) | data-manipulation/prng/lcg                           |
| contains PDB path                                        | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                       | executable/pe/section/rsrc                           |
| get common file path (4 matches)                         | host-interaction/file-system                         |
| copy file                                                | host-interaction/file-system/copy                    |
| create directory (2 matches)                             | host-interaction/file-system/create                  |
| delete file                                              | host-interaction/file-system/delete                  |
| check if file exists (3 matches)                         | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions                   | host-interaction/file-system/files/list              |
| get file attributes (4 matches)                          | host-interaction/file-system/meta                    |
| get file size                                            | host-interaction/file-system/meta                    |
| move file                                                | host-interaction/file-system/move                    |
| read file on Windows (5 matches)                         | host-interaction/file-system/read                    |
| write file on Windows (6 matches)                        | host-interaction/file-system/write                   |
| print debug messages                                     | host-interaction/log/debug/write-event               |
| allocate thread local storage                            | host-interaction/process                             |
| get thread local storage value (7 matches)               | host-interaction/process                             |
| set thread local storage value (4 matches)               | host-interaction/process                             |
| create process on Windows                                | host-interaction/process/create                      |
| terminate process (2 matches)                            | host-interaction/process/terminate                   |
| create thread (11 matches)                               | host-interaction/thread/create                       |
| linked against XZip                                      | linking/static/xzip                                  |
| enumerate PE sections (2 matches)                        | load-code/pe                                         |
| parse PE header (5 matches)                              | load-code/pe                                         |
| get startup folder                                       | persistence/startup-folder                           |
+----------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
3		- Discovery::System Network Configuration Discovery [T1016;3]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
6		- Collection::Screen Capture [T1113;6]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 34.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 47/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:51:30                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FKHPyjvnhFmYoU4Ld.exe
Real Name:	/ad4229879180e267f431ac6666b6a0a2.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
3	- Discovery::System Network Configuration Discovery [T1016;3]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
6	- Collection::Screen Capture [T1113;6]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
100	Malware Hash
50	network_tcp_socket
65	screenshot
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	ft_exe
45	win_ismdoor_auto
50	ConventionEngine_Keyword_Bot
50	ConventionEngine_Term_Documents
50	ConventionEngine_Term_Users
50	ConventionEngine_Term_VisualStudio
70	Greenbug_Malware_4
70	Greenbug_Malware_5
60	Recon_Commands_Windows_Gen1
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
60	DebuggerException__SetConsoleCtrl_v1
10	anti_dbg
20	isExecutable
10	Contains_PE_File
10	Big_Numbers0
10	Big_Numbers1
25	CRC32_poly_Constant
25	CRC32_table
5	BASE64_table

============================[ Scores ]============================
CAPA:	34.5
ClamAV:	0
Loki:	1089
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
19947.852364565788
==================================================================


==================================================================
Fichier HTTP-FKHPyjvnhFmYoU4Ld.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FFOXE44FAZJT8PukZb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 480f710806b68dfe478ca1ec7d7e79cc                                                   |
| sha1                   | b4fc97fed2dbff9c4874cb65ede7b50699db37cd                                           |
| sha256                 | 2416cd4aa577dbb2f8790a61e36fbab2b30bff81a4e1f67a5151c2fec29585bc                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FFOXE44FAZJT8PukZb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (3 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| print debug messages (5 matches)                     | host-interaction/log/debug/write-event               |
| query or enumerate registry key                      | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| create thread (2 matches)                            | host-interaction/thread/create                       |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::Query Registry [T1012;1]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 10.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FFOXE44FAZJT8PukZb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.08 MB
Data read: 0.08 MB (ratio 1.00:1)
Time: 41.574 sec (0 m 41 s)
Start Date: 2022:02:11 10:53:44
End Date:   2022:02:11 10:54:25

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:53:44Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FFOXE44FAZJT8PukZb.exe SCORE: 394 TYPE: EXE SIZE: 87312 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f093aed4400> 
MD5: 480f710806b68dfe478ca1ec7d7e79cc 
SHA1: b4fc97fed2dbff9c4874cb65ede7b50699db37cd 
SHA256: 2416cd4aa577dbb2f8790a61e36fbab2b30bff81a4e1f67a5151c2fec29585bc CREATED: Fri Feb 11 10:53:44 2022 MODIFIED: Fri Feb 11 10:53:44 2022 ACCESSED: Fri Feb 11 10:54:38 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_17: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T09:54:38Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 394

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/64
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:53:44                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FFOXE44FAZJT8PukZb.exe
Real Name:	/sessionmsg.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::Query Registry [T1012;1]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
30	Check_OutputDebugStringA_iat_v1
30	Check_OutputDebugStringA_iat
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	10.5
ClamAV:	0
Loki:	394
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
6453.981721368518
==================================================================


==================================================================
Fichier HTTP-FFOXE44FAZJT8PukZb.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FhnYwQ12COqMUw6YKe.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FhnYwQ12COqMUw6YKe.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 43.369 sec (0 m 43 s)
Start Date: 2022:02:11 10:54:39
End Date:   2022:02:11 10:55:23

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 138c71e94961fe9e31cec5dfba62a639                                                   |
| sha1                   | 7cc00da91f83d9e2f06172275f680501a09edd7c                                           |
| sha256                 | f81c70bc3d908f8152e3bfcdabf6538291d6a649fb6957d646fbde54d1ca1caf                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FhnYwQ12COqMUw6YKe.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings                             | anti-analysis/anti-vm/vm-detection                   |
| query remote server for available data                | communication                                        |
| receive data (2 matches)                              | communication                                        |
| parse URL (4 matches)                                 | communication/http                                   |
| check HTTP status code                                | communication/http/client                            |
| connect to HTTP server                                | communication/http/client                            |
| create HTTP request                                   | communication/http/client                            |
| obtain TransmitPackets callback function via WSAIoctl | communication/socket/tcp/send                        |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions               | executable/resource                                  |
| accept command line arguments                         | host-interaction/cli                                 |
| get local IPv4 addresses (2 matches)                  | host-interaction/network/address                     |
| get hostname                                          | host-interaction/os/hostname                         |
| get system information on Windows (2 matches)         | host-interaction/os/info                             |
| check OS version                                      | host-interaction/os/version                          |
| query or enumerate registry key (3 matches)           | host-interaction/registry                            |
| query or enumerate registry value (10 matches)        | host-interaction/registry                            |
| set registry value (8 matches)                        | host-interaction/registry/create                     |
| delete registry key                                   | host-interaction/registry/delete                     |
| delete registry value                                 | host-interaction/registry/delete                     |
| compare security identifiers                          | host-interaction/sid                                 |
| create thread (2 matches)                             | host-interaction/thread/create                       |
| link many functions at runtime                        | linking/runtime-linking                              |
| parse PE header                                       | load-code/pe                                         |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 33.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:54:40Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FhnYwQ12COqMUw6YKe.exe SCORE: 489 TYPE: EXE SIZE: 95232 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4f8ed9a400> 
MD5: 138c71e94961fe9e31cec5dfba62a639 
SHA1: 7cc00da91f83d9e2f06172275f680501a09edd7c 
SHA256: f81c70bc3d908f8152e3bfcdabf6538291d6a649fb6957d646fbde54d1ca1caf CREATED: Fri Feb 11 10:54:39 2022 MODIFIED: Fri Feb 11 10:54:39 2022 ACCESSED: Fri Feb 11 10:55:30 2022 
REASON_1: Yara Rule MATCH: network_udp_sock SUBSCORE: 45 
DESCRIPTION: Communications over UDP network REF: - AUTHOR: x0r 
MATCHES: Str1: ws2_32.DLL Str2: WSOCK32.dll Str3: WSASendTo Str4: WSARecvFrom
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: HttpOpenRequest Str6: HttpSendRequest
REASON_3: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: ws2_32.DLL Str2: WSOCK32.dll Str3: WSASocket Str4: WSASend Str5: WSAConnect
REASON_4: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: RegQueryValueExA Str4: RegOpenKeyExA Str5: RegCloseKey Str6: RegSetValueExA
REASON_5: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: OpenProcessToken
REASON_6: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: ws2_32.DLL Str2: WSOCK32.dll
REASON_7: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_8: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_9: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_10: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645e780c645e85fc645e948c645 Str2: c645e85fc645e948c645eaa1c645 Str3: c645f780c645f85fc645f948c645 Str4: c645f85fc645f948c645faa1c645
REASON_13: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_14: Yara Rule MATCH: winsocks SUBSCORE: 5 
DESCRIPTION: Imports Winsock Library REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_18: Yara Rule MATCH: IsBeyondImageSize SUBSCORE: 10 
DESCRIPTION: Data Beyond ImageSize Check REF: - AUTHOR: _pusher_
REASON_19: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_20: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_22: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_23: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000
REASON_24: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_25: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T09:55:30Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_udp_sock
45		network_http
50		network_tcp_socket
20		win_registry
65		win_token
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
5		winsocks
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		IsBeyondImageSize
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
40		SEH_Save
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 489

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 11/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:54:39                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FhnYwQ12COqMUw6YKe.exe
Real Name:	/138c71e94961fe9e31cec5dfba62a639.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3	- Discovery::System Network Configuration Discovery [T1016;3]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
45	network_udp_sock
45	network_http
50	network_tcp_socket
20	win_registry
65	win_token
10	Str_Win32_Winsock2_Library
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	Str_Win32_Http_API
10	ft_exe
2	math_entropy_6
5	obfuscation_singlebyte_mov
5	executable_pe
5	winsocks
10	IsPE32
10	IsWindowsGUI
10	HasDebugData
10	IsBeyondImageSize
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
40	SEH_Save
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	33.0
ClamAV:	0
Loki:	489
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
10408.564275074574
==================================================================


==================================================================
Fichier HTTP-FhnYwQ12COqMUw6YKe.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FmI3MCy8OJoeKEnli.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FmI3MCy8OJoeKEnli.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.71 MB
Data read: 0.67 MB (ratio 1.06:1)
Time: 49.445 sec (0 m 49 s)
Start Date: 2022:02:11 10:55:32
End Date:   2022:02:11 10:56:21

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfb in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfb in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 79: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 26: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 21: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 20: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 19: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 18: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 17: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 16: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 79: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 26: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 21: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 20: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 19: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 18: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 17: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 16: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 79: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 22: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:55:32Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FmI3MCy8OJoeKEnli.exe SCORE: 584 TYPE: EXE SIZE: 707072 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd4a85a0400> 
MD5: 477743976643213d96b66ed5041a3b12 
SHA1: c1cd5adff4e3e03bd736c1896019c33764b06ff6 
SHA256: da5acdec87c3b5e3dcdbde1d82650d5c1e1f1ce420bdbc99347b662c1a71dda3 CREATED: Fri Feb 11 10:55:32 2022 MODIFIED: Fri Feb 11 10:55:32 2022 ACCESSED: Fri Feb 11 10:56:24 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.DLL Str2: GDI32.dll Str3: user32.dll Str4: USER32.DLL Str5: USER32.dll Str6: BitBlt Str7: GetDC
REASON_2: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: USER32.DLL Str3: USER32.dll Str4: GetKeyState
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA Str6: RegCreateKeyA
REASON_4: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: GetPrivateProfileIntA Str4: GetPrivateProfileStringA Str5: WritePrivateProfileStringA
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: DeleteFileA Str7: CreateFileA Str8: FindFir ... (truncated)
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645d0ccc645d1ccc645d2ccc645 Str2: c645d1ccc645d2ccc645d3ccc645 Str3: c645d2ccc645d3ccc645d4ccc645 Str4: c645d3ccc645d4ccc645d5ccc645 ... (truncated)
REASON_9: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_10: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e819130000e910fdffff Str2: e8cddaffffe958ffffff Str3: e8802e0100e95dfdffff Str4: e8662e0100e96dfeffff Str5: e84fb5fdffe931ffffff Str6 ... (truncated)
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @@ Str2:  Str3:  Str4:  Str5:  Str6: 000000000000c0000000000000461801000000000000c0000000000000461201000000000000c0000000000000461501 ... (truncated)
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_18: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: USER32.DLL Str3: USER32.dll Str4: UnhookWindowsHookEx Str5: SetWindowsHookExA Str6: CallNextHookEx
REASON_19: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_20: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_21: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: IsDebuggerPresent
REASON_22: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_23: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T09:56:26Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
80		keylogger
20		win_registry
10		win_private_profile
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
15		dll_injection_hook
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
35		Win_Hook_v12
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 584

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 477743976643213d96b66ed5041a3b12                                                   |
| sha1                   | c1cd5adff4e3e03bd736c1896019c33764b06ff6                                           |
| sha256                 | da5acdec87c3b5e3dcdbde1d82650d5c1e1f1ce420bdbc99347b662c1a71dda3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FmI3MCy8OJoeKEnli.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | System Shutdown/Reboot:: \[T1529]\                                                 |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| log keystrokes via polling                           | collection/keylog                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (5 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| get common file path                                 | host-interaction/file-system                         |
| delete file (2 matches)                              | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| move file                                            | host-interaction/file-system/move                    |
| read .ini file                                       | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| enumerate gui resources                              | host-interaction/gui                                 |
| set application hook                                 | host-interaction/gui                                 |
| get graphical window text (3 matches)                | host-interaction/gui/window/get-text                 |
| hide graphical window                                | host-interaction/gui/window/hide                     |
| shutdown system                                      | host-interaction/os                                  |
| allocate thread local storage                        | host-interaction/process                             |
| enumerate process modules                            | host-interaction/process/modules/list                |
| terminate process                                    | host-interaction/process/terminate                   |
| create or open registry key (2 matches)              | host-interaction/registry                            |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| get session user name                                | host-interaction/session                             |
| create thread                                        | host-interaction/thread/create                       |
| link many functions at runtime                       | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
4		- Execution::Command and Scripting Interpreter [T1059;4]
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
9		- Impact::System Shutdown/Reboot [T1529;9]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
3		- Discovery::Account Discovery [T1087;3]

Score total: 55.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 44/65
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:55:32                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FmI3MCy8OJoeKEnli.exe
Real Name:	/477743976643213d96b66ed5041a3b12.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6	- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
4	- Execution::Command and Scripting Interpreter [T1059;4]
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
3	- Discovery::System Owner/User Discovery [T1033;3]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1	- Discovery::Query Registry [T1012;1]
9	- Impact::System Shutdown/Reboot [T1529;9]
6	- Collection::Input Capture::Keylogging [T1056.001;6]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4	- Discovery::Process Discovery [T1057;4]
3	- Discovery::Account Discovery [T1087;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
65	screenshot
80	keylogger
20	win_registry
10	win_private_profile
10	win_files_operation
10	ft_exe
2	math_entropy_6
5	obfuscation_singlebyte_mov
5	executable_pe
15	dll_injection_hook
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
35	Win_Hook_v12
40	SEH_Save
40	SEH_Init
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	55.5
ClamAV:	0
Loki:	584
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
12363.14682878063
==================================================================


==================================================================
Fichier HTTP-FmI3MCy8OJoeKEnli.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fmmqwc23HhsEo4XqE4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fmmqwc23HhsEo4XqE4.exe: Win.Exploit.CVE_2017_0213-6306933-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 41.291 sec (0 m 41 s)
Start Date: 2022:02:11 10:57:39
End Date:   2022:02:11 10:58:20

-------- Score ----------------
Scores		Rules
.......		...............
25		Win.Exploit.CVE_2017_0213-6306933-0

Score total: 25.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd1 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x99 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfa in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x91 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcf in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa5 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xae in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:57:39Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fmmqwc23HhsEo4XqE4.exe SCORE: 534 TYPE: EXE SIZE: 48640 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9690f8b400> 
MD5: 3ca359f5085bb96a7950d4735b089ffe 
SHA1: 60747604d54a18c4e4dc1a2c209e77a793e64dde 
SHA256: 7af61ce420051640c50b0e73e718dd8c55dddfcb58917a3bead9d3ece2f3e929 CREATED: Fri Feb 11 10:57:39 2022 MODIFIED: Fri Feb 11 10:57:39 2022 ACCESSED: Fri Feb 11 10:58:33 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: DuplicateTokenEx Str3: OpenProcessToken
REASON_3: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: win_ragnarlocker_auto SUBSCORE: 45 
DESCRIPTION: Detects win.ragnarlocker. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 8bec518b450c5356578d1c80 Str2: 8bfac1ef070fa4ca190bf2c1e11931750c0bf9 Str3: 8d4d10518d8d4cf5ffff51680401000050 Str4: 0f47d152ffd68d45 ... (truncated)
REASON_6: Yara Rule MATCH: MAL_RANSOM_Ragna_Locker_Apr20_1 SUBSCORE: 70 
DESCRIPTION: Detects Ragna Locker Ransomware REF: https://otx.alienvault.com/indicator/file/c2bd70495630ed8279de0713a010e5e55f3da29323b59ef71401b12942ba52f6 AUTHOR: Florian Roth 
MATCHES: Str1: ---RAGNAR SECRET--- Str2: 
%s

%s
%s
%s

%s
.ragnar_ Str3: -forceWinSta0\Default
otepad.exe Str4: bootfont.bin Str5: Windows ... (truncated)
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_15: Yara Rule MATCH: ragnarlocker_ransomware SUBSCORE: 60 
DESCRIPTION: Rule to detect RagnarLocker samples REF: https://www.bleepingcomputer.com/news/security/ragnar-locker-ransomware-targets-msp-enterprise-support-tools/ AUTHOR: McAfee ATR Team 
MATCHES: Str1: ---RAGNAR SECRET--- Str2: 668b858af7ffff663b45d2b8010000000f44 Str3: 558bec53578b7d088bd985ff0f84 Str4: ff15448140003dea0000000f85 St ... (truncated)
REASON_16: Yara Rule MATCH: Ran_Mem_RagnarLocker_Nov_2020_1 SUBSCORE: 75 
DESCRIPTION: Detect memory artefacts of the Ragnarlocker ransomware (Nov 2020) REF: Internal Research AUTHOR: Arkbird_SOLG 
MATCHES: Str1: \.\PHYSICALDRIVE%d Str2: bootfont.bin Str3: bootsect.bak Str4: bootmgr.efi Str5: ---RAGNAR SECRET--- Str6: Internet Explorer Str7:   ... (truncated)
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: Crypt32_CryptBinaryToString_API SUBSCORE: 25 
DESCRIPTION: Looks for crypt32 CryptBinaryToStringA function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: CRYPT32.dll Str2: CryptBinaryToStringA
REASON_20: Yara Rule MATCH: SHA512_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA384/SHA512 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: 982f8a42 Str2: 91443771 Str3: cffbc0b5 Str4: a5dbb5e9 Str5: 22ae28d7
REASON_21: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T09:58:33Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
65		win_token
10		win_files_operation
10		ft_exe
45		win_ragnarlocker_auto
70		MAL_RANSOM_Ragna_Locker_Apr20_1
2		math_entropy_6
5		executable_pe
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
60		ragnarlocker_ransomware
75		Ran_Mem_RagnarLocker_Nov_2020_1
20		isExecutable
10		Contains_PE_File
25		Crypt32_CryptBinaryToString_API
20		SHA512_Constants
20		SHA2_BLAKE2_IVs

Score total: 534

==================[ Vérification MalwareBazaar ]==================
Fichier trouvé !
Malware connu -> Score: 2000
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 61/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:57:39                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fmmqwc23HhsEo4XqE4.exe
Real Name:	/3ca359f5085bb96a7950d4735b089ffe.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
25	Win.Exploit.CVE_2017_0213-6306933-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
65	win_token
10	win_files_operation
10	ft_exe
45	win_ragnarlocker_auto
70	MAL_RANSOM_Ragna_Locker_Apr20_1
2	math_entropy_6
5	executable_pe
10	IsPE32
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
60	ragnarlocker_ransomware
75	Ran_Mem_RagnarLocker_Nov_2020_1
20	isExecutable
10	Contains_PE_File
25	Crypt32_CryptBinaryToString_API
20	SHA512_Constants
20	SHA2_BLAKE2_IVs

============================[ Scores ]============================
CAPA:	0
ClamAV:	25.0
Loki:	534
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	2000
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
12778.061000690886
==================================================================


==================================================================
Fichier HTTP-Fmmqwc23HhsEo4XqE4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FCEjwb4FeXicmx7enl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xce in position 78: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe7 in position 78: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe7 in position 62: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe7 in position 46: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe7 in position 30: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe7 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:58:35Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FCEjwb4FeXicmx7enl.exe SCORE: 559 TYPE: EXE SIZE: 72704 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f751da25400> 
MD5: e59ffeaf7acb0c326e452fa30bb71a36 
SHA1: c88fad293256bfead6962124394de4f8b97765aa 
SHA256: a91491f45b851a07f91ba5a200967921bf796d38677786de51a4a8fe5ddeafd2 CREATED: Fri Feb 11 10:58:34 2022 MODIFIED: Fri Feb 11 10:58:34 2022 ACCESSED: Fri Feb 11 10:59:09 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: DuplicateTokenEx Str4: OpenProcessToken
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_5: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8e8250000e989feffff Str2: e8d7fbffffe9b4feffff Str3: e8f1180000e919ffffff
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 0000000000000000000000000000400000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_11: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_17: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_22: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T09:59:09Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
20		win_registry
65		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
25		CRC32_poly_Constant
25		CRC32_table

Score total: 559

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FCEjwb4FeXicmx7enl.exe: Win.Malware.Phobos-6981135-1 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 40.008 sec (0 m 40 s)
Start Date: 2022:02:11 10:58:34
End Date:   2022:02:11 10:59:14

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Phobos-6981135-1

Score total: 50.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 58/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:58:34                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FCEjwb4FeXicmx7enl.exe
Real Name:	/e59ffeaf7acb0c326e452fa30bb71a36.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
50	Win.Malware.Phobos-6981135-1

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
20	win_registry
65	win_token
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	ft_exe
2	math_entropy_6
5	executable_pe
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
40	SEH_Save
40	SEH_Init
10	anti_dbg
20	isExecutable
10	Contains_PE_File
25	CRC32_poly_Constant
25	CRC32_table

============================[ Scores ]============================
CAPA:	0
ClamAV:	50.0
Loki:	559
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
11489.015651754708
==================================================================


==================================================================
Fichier HTTP-FCEjwb4FeXicmx7enl.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FmF2Q92G3TKUYlBEa.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b2ad4409323147b63e370745e5209996                                                   |
| sha1                   | 15e8fac9c9d5e541940a3c2782df6196ec1e9326                                           |
| sha256                 | 867991ade335186baa19a227e3a044c8321a6cef96c23c98eef21fe6b87edf6a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FmF2Q92G3TKUYlBEa.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Process Discovery:: \[T1057]\                                                      |
|                        | Software Discovery:: \[T1518]\                                                     |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| write file on Windows                                | host-interaction/file-system/write                   |
| check mutex                                          | host-interaction/mutex                               |
| create mutex                                         | host-interaction/mutex                               |
| inject thread                                        | host-interaction/process/inject                      |
| enumerate processes                                  | host-interaction/process/list                        |
| terminate process                                    | host-interaction/process/terminate                   |
| link many functions at runtime                       | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
| spawn thread to RWX shellcode                        | load-code/shellcode                                  |
| identify ATM dispenser service provider              | targeting/automated-teller-machine                   |
| reference Diebold ATM routines                       | targeting/automated-teller-machine/diebold-nixdorf   |
| load NCR ATM library                                 | targeting/automated-teller-machine/ncr               |
| reference NCR ATM library routines (2 matches)       | targeting/automated-teller-machine/ncr               |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
2		- Execution::Shared Modules [T1129;2]
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
4		- Discovery::Software Discovery [T1518;4]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]

Score total: 25.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FmF2Q92G3TKUYlBEa.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 35.172 sec (0 m 35 s)
Start Date: 2022:02:11 10:59:15
End Date:   2022:02:11 10:59:51

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T09:59:16Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FmF2Q92G3TKUYlBEa.exe SCORE: 679 TYPE: EXE SIZE: 26112 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f6edb4dc400> 
MD5: b2ad4409323147b63e370745e5209996 
SHA1: 15e8fac9c9d5e541940a3c2782df6196ec1e9326 
SHA256: 867991ade335186baa19a227e3a044c8321a6cef96c23c98eef21fe6b87edf6a CREATED: Fri Feb 11 10:59:15 2022 MODIFIED: Fri Feb 11 10:59:15 2022 ACCESSED: Fri Feb 11 11:00:06 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: win_dispenserxfs_auto SUBSCORE: 45 
DESCRIPTION: Detects win.dispenserxfs. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 6689854affffff33c066898574ffffff8d45cc6a06898578ffffff Str2: e9b20000006a0057893d508c4000b80000008033ff57 Str3: 0fb74106500fb74102500 ... (truncated)
REASON_5: Yara Rule MATCH: ATM_Malware_DispenserXFS SUBSCORE: 80 
DESCRIPTION: Detects ATM Malware DispenserXFS REF: https://twitter.com/r3c0nst/status/1100775857306652673 AUTHOR: @Xylit0l @r3c0nst / Modified by Florian Roth 
MATCHES: Str1: 68ffff00006860ea00006a10 Str2: \dispenserXFS.pdb Str3: C:\xfsasdf.txt Str4: Injected mxsfs killer into %d. Str5: Waiting for freeze m ... (truncated)
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c6459047c6459165c6459274c645 Str2: c6459165c6459274c6459350c645 Str3: c6459274c6459350c6459472c645 Str4: c6459350c6459472c645956fc645 ... (truncated)
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_10: Yara Rule MATCH: Visual_Cpp_2005_Release_Microsoft SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e836040000e957fdffff
REASON_11: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e85ffeffffe926ffffff Str2: e836040000e957fdffff
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2: @B Str3:  Str4:  Str5: e836040000e957fdffff
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_16: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_17: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_19: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_20: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_21: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_22: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:00:06Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
60		win_mutex
10		ft_exe
45		win_dispenserxfs_auto
80		ATM_Malware_DispenserXFS
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
15		dll_injection_thread
70		Visual_Cpp_2005_Release_Microsoft
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
45		Inject_Thread
40		SEH_Save
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 679

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 55/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 10:59:15                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FmF2Q92G3TKUYlBEa.exe
Real Name:	/b2ad4409323147b63e370745e5209996.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
8.5	- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
2	- Execution::Shared Modules [T1129;2]
6	- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
4	- Discovery::Software Discovery [T1518;4]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4	- Discovery::Process Discovery [T1057;4]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	inject_thread
60	win_mutex
10	ft_exe
45	win_dispenserxfs_auto
80	ATM_Malware_DispenserXFS
2	math_entropy_6
5	obfuscation_singlebyte_mov
5	executable_pe
15	dll_injection_thread
70	Visual_Cpp_2005_Release_Microsoft
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
45	Inject_Thread
40	SEH_Save
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	25.5
ClamAV:	0
Loki:	679
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
13270.216667128025
==================================================================


==================================================================
Fichier HTTP-FmF2Q92G3TKUYlBEa.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F8w0uG27dT5KHvNru9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c8403fb05244e23a7931c766409b5e22                                                   |
| sha1                   | c10a1d36b136c1df20c4135ea67bfb4c3934a4d8                                           |
| sha256                 | 42b610e7f4f0a0275ec3ede3895287e673c7cdad11fc352f86b1f2f7ed050fa0                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F8w0uG27dT5KHvNru9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| initialize Winsock library                           | communication/socket                                 |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| create process on Windows                            | host-interaction/process/create                      |
| terminate process                                    | host-interaction/process/terminate                   |
| link many functions at runtime                       | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 14.5

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:00:08Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F8w0uG27dT5KHvNru9.exe SCORE: 169 TYPE: EXE SIZE: 38400 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f294911e400> 
MD5: c8403fb05244e23a7931c766409b5e22 
SHA1: c10a1d36b136c1df20c4135ea67bfb4c3934a4d8 
SHA256: 42b610e7f4f0a0275ec3ede3895287e673c7cdad11fc352f86b1f2f7ed050fa0 CREATED: Fri Feb 11 11:00:07 2022 MODIFIED: Fri Feb 11 11:00:07 2022 ACCESSED: Fri Feb 11 11:00:44 2022 
REASON_1: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:00:44Z

-------- Score ----------------
Scores		Rules
.......		...............
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasRichSignature
2		PE_File
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 169

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F8w0uG27dT5KHvNru9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 44.809 sec (0 m 44 s)
Start Date: 2022:02:11 11:00:07
End Date:   2022:02:11 11:00:52

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:00:07                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F8w0uG27dT5KHvNru9.exe
Real Name:	/Practical Malware Analysis Lab 21-01.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
3	- Discovery::System Network Configuration Discovery [T1016;3]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	Str_Win32_Winsock2_Library
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasRichSignature
2	PE_File
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	14.5
ClamAV:	0
Loki:	169
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
2967.7825309297687
==================================================================


==================================================================
Fichier HTTP-F8w0uG27dT5KHvNru9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FWgYhV2kzXwR76OA1i.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 09cee5d093127aa9c9ff4b90f6a90581                                                   |
| sha1                   | b67e776551f3a451f0d5ffbcb6c3a9f096920386                                           |
| sha256                 | 4fa837762a3a76bcee46f7d34f8d2e3e4ea59a0d8f9094a8ca96144e137370f9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FWgYhV2kzXwR76OA1i.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FWgYhV2kzXwR76OA1i.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 44.641 sec (0 m 44 s)
Start Date: 2022:02:11 11:00:53
End Date:   2022:02:11 11:01:38

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:00:53Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FWgYhV2kzXwR76OA1i.exe SCORE: 229 TYPE: EXE SIZE: 24064 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f74db1d2400> 
MD5: 09cee5d093127aa9c9ff4b90f6a90581 
SHA1: b67e776551f3a451f0d5ffbcb6c3a9f096920386 
SHA256: 4fa837762a3a76bcee46f7d34f8d2e3e4ea59a0d8f9094a8ca96144e137370f9 CREATED: Fri Feb 11 11:00:53 2022 MODIFIED: Fri Feb 11 11:00:53 2022 ACCESSED: Fri Feb 11 11:01:47 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e81b0500004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:01:47Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/63
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:00:53                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FWgYhV2kzXwR76OA1i.exe
Real Name:	/tsdiscon.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
1	- Discovery::System Information Discovery [T1082;1]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	10.0
ClamAV:	0
Loki:	229
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3828.9316422328375
==================================================================


==================================================================
Fichier HTTP-FWgYhV2kzXwR76OA1i.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FmpkcI1lSqANGc1Ha3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 7faafc7e4a5c736ebfee6abbbc812d80                                                   |
| sha1                   | 625628d4c91d4193474735da011903642b2c916e                                           |
| sha256                 | 309217d8088871e09a7a03ee68ee46f60583a73945006f95021ec85fc1ec959e                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FmpkcI1lSqANGc1Ha3.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Indicator Removal on Host::File Deletion \[T1070.004]\                             |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
|                             | Debugger Detection::Process Environment Block NtGlobalFlag [B0001.036]        |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | Socket Communication::Connect Socket [C0001.004]                              |
|                             | Socket Communication::Create TCP Socket [C0001.011]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::TCP Client [C0001.008]                                  |
| DEFENSE EVASION             | Self Deletion::COMSPEC Environment Variable [F0007.001]                       |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag (24 matches)        | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB NtGlobalFlag flag (24 matches)         | anti-analysis/anti-debugging/debugger-detection      |
| self delete                                          | anti-analysis/anti-forensic/self-deletion            |
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| read and send data from client to server             | c2/file-transfer                                     |
| receive and write data from server to client         | c2/file-transfer                                     |
| creates tcp or udp socket                            | communication/socket                                 |
| initialize Winsock library                           | communication/socket                                 |
| act as TCP client                                    | communication/tcp/client                             |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| create process on Windows                            | host-interaction/process/create                      |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| modify service                                       | host-interaction/service/modify                      |
| persist via Windows service                          | persistence/service                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Discovery::System Network Configuration Discovery [T1016;3]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
1		- Discovery::System Information Discovery [T1082;1]
8.5		- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
1		- Discovery::Query Registry [T1012;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Discovery::File and Directory Discovery [T1083;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 60.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FmpkcI1lSqANGc1Ha3.exe: Win.Dropper.Ulise-9937584-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FmpkcI1lSqANGc1Ha3.exe: Win.Trojan.Downloader-15920 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 40.194 sec (0 m 40 s)
Start Date: 2022:02:11 11:01:48
End Date:   2022:02:11 11:02:28

-------- Score ----------------
Scores		Rules
.......		...............
30		Win.Dropper.Ulise-9937584-0
45		Win.Trojan.Downloader-15920

Score total: 75.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 35/61
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:01:48                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FmpkcI1lSqANGc1Ha3.exe
Real Name:	/Practical Malware Analysis Lab 16-01.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3	- Discovery::System Network Configuration Discovery [T1016;3]
4	- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
1	- Discovery::System Information Discovery [T1082;1]
8.5	- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
1	- Discovery::Query Registry [T1012;1]
3	- Execution::System Services::Service Execution [T1569.002;3]
8.5	- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2	- Discovery::File and Directory Discovery [T1083;2]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
30	Win.Dropper.Ulise-9937584-0
45	Win.Trojan.Downloader-15920

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Armadillo_v4x
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsConsole
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
40	SEH_Save
40	SEH_Init
20	isExecutable
10	Contains_PE_File
15	VC6_Random

============================[ Scores ]============================
CAPA:	60.0
ClamAV:	75.0
Loki:	669
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
14744.286905391802
==================================================================


==================================================================
Fichier HTTP-FmpkcI1lSqANGc1Ha3.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FN6WmZWmg6vp0zsEe.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ba4cfe6461afa1004c52f19c8f2169dc                                                   |
| sha1                   | ab8539ef6b2a93ff9589dec4b34a0257b6296c92                                           |
| sha256                 | e86870769ee6c797e09457bd99c58d9bf2303cf0193a24ef9b1222c2c3daf628                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FN6WmZWmg6vp0zsEe.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (3 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FN6WmZWmg6vp0zsEe.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.10 MB
Data read: 0.10 MB (ratio 1.00:1)
Time: 43.108 sec (0 m 43 s)
Start Date: 2022:02:11 11:02:43
End Date:   2022:02:11 11:03:26

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:02:44Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FN6WmZWmg6vp0zsEe.exe SCORE: 364 TYPE: EXE SIZE: 103288 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3bd014d400> 
MD5: ba4cfe6461afa1004c52f19c8f2169dc 
SHA1: ab8539ef6b2a93ff9589dec4b34a0257b6296c92 
SHA256: e86870769ee6c797e09457bd99c58d9bf2303cf0193a24ef9b1222c2c3daf628 CREATED: Fri Feb 11 11:02:43 2022 MODIFIED: Fri Feb 11 11:02:43 2022 ACCESSED: Fri Feb 11 11:03:32 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8f30400004883c428e96efeffffcccccccccccccccccccccccccccc
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:03:32Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 364

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/69
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:02:43                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FN6WmZWmg6vp0zsEe.exe
Real Name:	/RuntimeBroker.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	364
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5828.869090007519
==================================================================


==================================================================
Fichier HTTP-FN6WmZWmg6vp0zsEe.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fnozye4P2vE2NP0r6d.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fnozye4P2vE2NP0r6d.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.33 MB
Data read: 0.31 MB (ratio 1.05:1)
Time: 45.036 sec (0 m 45 s)
Start Date: 2022:02:11 11:03:33
End Date:   2022:02:11 11:04:18

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 19: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 18: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa8 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa8 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:03:33Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fnozye4P2vE2NP0r6d.exe SCORE: 594 TYPE: EXE SIZE: 328192 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f039a891400> 
MD5: 6be0ae5cb7c3155f70d608fc7670d2d9 
SHA1: a3d3d6c2adc7cb7d747c279810036bc104e80376 
SHA256: 223afed3106fb9cdde89eac273894e2fbe392f66b87ab8b9408cd6ef1bce8fa4 CREATED: Fri Feb 11 11:03:33 2022 MODIFIED: Fri Feb 11 11:03:33 2022 ACCESSED: Fri Feb 11 11:04:26 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CreateFileA Str7: FindFirstFileA Str8: MoveF ... (truncated)
REASON_2: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_3: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: Gamaredon_GetImportByHash SUBSCORE: 70 
DESCRIPTION: Detects Gamaredon APIHashing REF: - AUTHOR: Frank Boldewin (@r3c0nst) 
MATCHES: Str1: 8b503c03d08b527803d08b4a1c03c8 Str2: 8b7508ba051500008bc2c1e20503d033db8a1e03d34633db8a1e85db75
REASON_6: Yara Rule MATCH: MAL_SUSP_Gamaredon_GetImportByHash SUBSCORE: 70 
DESCRIPTION: Detects Gamaredon APIHashing REF: https://twitter.com/r3c0nst/status/1392405576131436546?s=20 AUTHOR: Frank Boldewin (@r3c0nst) 
MATCHES: Str1: 8b503c03d08b527803d08b4a1c03c8 Str2: 8b7508ba051500008bc2c1e20503d033db8a1e03d34633db8a1e85db75
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e871fdffffe96affffff Str2: e845e8ffffe99afbffff Str3: e866890c02e931ffffff Str4: e80e050000e974feffff Str5: e80efaffffe93dfaffff
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3: 00000000000000000000000000000000000064e0440000000000000000003ca143000000000000000000000000000001000000000000000000000 ... (truncated)
REASON_11: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_17: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_18: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_19: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_20: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_21: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_22: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_23: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:04:27Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
70		Gamaredon_GetImportByHash
70		MAL_SUSP_Gamaredon_GetImportByHash
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 594

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6be0ae5cb7c3155f70d608fc7670d2d9                                                   |
| sha1                   | a3d3d6c2adc7cb7d747c279810036bc104e80376                                           |
| sha256                 | 223afed3106fb9cdde89eac273894e2fbe392f66b87ab8b9408cd6ef1bce8fa4                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fnozye4P2vE2NP0r6d.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Non-Cryptographic Hash:: [C0030]                                              |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check HTTP status code                               | communication/http/client                            |
| encrypt data using RC4 PRGA (2 matches)              | data-manipulation/encryption/rc4                     |
| hash data using djb2                                 | data-manipulation/hashing/djb2                       |
| write file on Windows (3 matches)                    | host-interaction/file-system/write                   |
| get number of processors                             | host-interaction/hardware/cpu                        |
| access PEB ldr_data                                  | linking/runtime-linking                              |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Discovery::System Information Discovery [T1082;1]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2		- Execution::Shared Modules [T1129;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 12.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 44/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:03:33                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fnozye4P2vE2NP0r6d.exe
Real Name:	/6be0ae5cb7c3155f70d608fc7670d2d9.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Discovery::System Information Discovery [T1082;1]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2	- Execution::Shared Modules [T1129;2]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	Str_Win32_Internet_API
10	Str_Win32_Http_API
10	ft_exe
70	Gamaredon_GetImportByHash
70	MAL_SUSP_Gamaredon_GetImportByHash
2	math_entropy_6
5	executable_pe
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
40	SEH_Save
40	SEH_Init
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	12.5
ClamAV:	0
Loki:	594
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
11663.673352590122
==================================================================


==================================================================
Fichier HTTP-Fnozye4P2vE2NP0r6d.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F1iQtF3jB9i7cPJH38.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3d760b6fc84571c928bed835863fc302                                                   |
| sha1                   | adcf9ade7a4dc14b7bf656e86ea15766b843e3b6                                           |
| sha256                 | 8ac21275d0db7f3e990551f343e16ac105d6a513810ff71934de4855999cc9c5                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F1iQtF3jB9i7cPJH38.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+------------------------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                                   |
|-----------------------------+------------------------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                                            |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                                     |
|                             | Virtual Machine Detection::Unique Hardware/Firmware Check - I/O Communication Port [B0009.025] |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                                     |
|                             | C2 Communication::Send Data [B0030.001]                                                        |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                                         |
|                             | HTTP Communication::Connect to Server [C0002.009]                                              |
|                             | HTTP Communication::Create Request [C0002.012]                                                 |
|                             | HTTP Communication::Get Response [C0002.017]                                                   |
|                             | HTTP Communication::Read Header [C0002.014]                                                    |
|                             | HTTP Communication::Send Data [C0002.005]                                                      |
|                             | HTTP Communication::Send Request [C0002.003]                                                   |
| FILE SYSTEM                 | Read File:: [C0051]                                                                            |
|                             | Writes File:: [C0052]                                                                          |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                                      |
|                             | Registry::Open Registry Key [C0036.003]                                                        |
|                             | Registry::Query Registry Value [C0036.006]                                                     |
|                             | Registry::Set Registry Key [C0036.001]                                                         |
+-----------------------------+------------------------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-VM instructions                         | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VMWare           | anti-analysis/anti-vm/vm-detection                   |
| reference the VMWare IO port                         | anti-analysis/anti-vm/vm-detection                   |
| receive and write data from server to client         | c2/file-transfer                                     |
| get geographical location                            | collection                                           |
| send data (3 matches)                                | communication                                        |
| parse URL (2 matches)                                | communication/http                                   |
| check HTTP status code                               | communication/http/client                            |
| hash data with MD5                                   | data-manipulation/hashing/md5                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get file size                                        | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| get CPU information                                  | host-interaction/hardware/cpu                        |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| get hostname                                         | host-interaction/os/hostname                         |
| get system information on Windows                    | host-interaction/os/info                             |
| check OS version (2 matches)                         | host-interaction/os/version                          |
| set registry value                                   | host-interaction/registry/create                     |
| compare security identifiers                         | host-interaction/sid                                 |
| access PEB ldr_data (3 matches)                      | linking/runtime-linking                              |
| parse PE exports (2 matches)                         | load-code/pe                                         |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
1.5		- Discovery::System Location Discovery [T1614;1.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 32.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F1iQtF3jB9i7cPJH38.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 39.781 sec (0 m 39 s)
Start Date: 2022:02:11 11:04:47
End Date:   2022:02:11 11:05:27

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:04:48Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F1iQtF3jB9i7cPJH38.exe SCORE: 2284 TYPE: EXE SIZE: 57856 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f42fa211400> 
MD5: 3d760b6fc84571c928bed835863fc302 
SHA1: adcf9ade7a4dc14b7bf656e86ea15766b843e3b6 
SHA256: 8ac21275d0db7f3e990551f343e16ac105d6a513810ff71934de4855999cc9c5 CREATED: Fri Feb 11 11:04:48 2022 MODIFIED: Fri Feb 11 11:04:48 2022 ACCESSED: Fri Feb 11 11:05:40 2022 
REASON_1: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: InternetWriteFile Str6: HttpOpenRequest Str7: HttpS ... (truncated)
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: DeleteFileA Str5: CreateFileA Str6: FindFirstFileA
REASON_5: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_6: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_7: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_8: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_9: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff6820c5400068c0a6400064a100000000506489250000000083ec0c535657 Str3: 558bec6aff68e0c6400068c0a6400064a100000000506489 ... (truncated)
REASON_13: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6820c5400068c0a6400064a10000000050 Str2: 558bec6aff68e0c6400068c0a6400064a10000000050
REASON_14: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6820c5400068c0a6400064a10000000050 Str2: 558bec6aff68e0c6400068c0a6400064a10000000050
REASON_15: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6a Str2: 558bec6aff6820c5400068c0a6400064a10000000050 Str3: 558bec6aff68e0c6400068c0a6400064a10000000050
REASON_16: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6820c5400068c0a6400064a1000000005064892500000000 Str2: 558bec6aff68e0c6400068c0a6400064a1000000005064892500000000
REASON_17: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_20: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: stager_reverse_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_22: Yara Rule MATCH: stager_bind_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_23: Yara Rule MATCH: win32_stage_boot_winsock_conn_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_24: Yara Rule MATCH: win32_stage_boot_bind_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_25: Yara Rule MATCH: win32_stage_boot_reverse_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_26: Yara Rule MATCH: win32_stage_boot_winsock_conn_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_27: Yara Rule MATCH: stager_reverse_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_28: Yara Rule MATCH: win32_stage_boot_bind_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_29: Yara Rule MATCH: win32_stage_boot_reverse_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_30: Yara Rule MATCH: win32_stage_boot_reverse_shell_revert_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_31: Yara Rule MATCH: win32_stage_winexec_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_32: Yara Rule MATCH: stager_bind_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_33: Yara Rule MATCH: win32_stage_boot_winsock_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_34: Yara Rule MATCH: win32_stage_boot_reverse_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_35: Yara Rule MATCH: win32_stage_api_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_36: Yara Rule MATCH: win32_stage_boot_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_37: Yara Rule MATCH: win32_stage_boot_reverse_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_38: Yara Rule MATCH: win32_stage_boot_reverse_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_39: Yara Rule MATCH: win32_stage_boot_bind_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_40: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DESCRIPTION\System
REASON_41: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: vmware Str2: b868584d56bb00000000b90a000000ba58560000ed
REASON_42: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_43: Yara Rule MATCH: antivm_vmware SUBSCORE: 60 
DESCRIPTION: AntiVM checks for VMWare REF: - AUTHOR: x0r 
MATCHES: Str1: b868584d56bb00000000b90a000000ba58560000ed
REASON_44: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: vmware
REASON_45: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_46: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: vmware
REASON_47: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_48: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_49: Yara Rule MATCH: MD5_Constants SUBSCORE: 20 
DESCRIPTION: Look for MD5 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: 78a46ad7
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:05:40Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_http
20		win_registry
65		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
70		stager_reverse_tcp_nx_ldone_x86
70		stager_bind_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_conn_ldone_x86
70		win32_stage_boot_bind_read_ldone_x86
70		win32_stage_boot_reverse_read_ldone_x86
70		win32_stage_boot_winsock_conn_udp_ldone_x86
70		stager_reverse_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_bind_inlineegg_ldone_x86
70		win32_stage_boot_reverse_ldone_x86
70		win32_stage_boot_reverse_shell_revert_ldone_x86
70		win32_stage_winexec_ldone_x86
70		stager_bind_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_bind_ldone_x86
70		win32_stage_boot_reverse_shell_ldone_x86
70		win32_stage_api_ldone_x86
70		win32_stage_boot_bind_ldone_x86
70		win32_stage_boot_reverse_udp_ldone_x86
70		win32_stage_boot_reverse_inlineegg_ldone_x86
70		win32_stage_boot_bind_shell_ldone_x86
35		Qemu_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
60		antivm_vmware
60		vmdetect_2
40		SEH_Init
60		vmdetect
20		isExecutable
10		Contains_PE_File
20		MD5_Constants

Score total: 2284

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 55/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:04:47                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F1iQtF3jB9i7cPJH38.exe
Real Name:	/3d760b6fc84571c928bed835863fc302.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3	- Discovery::System Network Configuration Discovery [T1016;3]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
1.5	- Discovery::System Location Discovery [T1614;1.5]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
45	network_http
20	win_registry
65	win_token
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	Str_Win32_Http_API
10	ft_exe
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
70	stager_reverse_tcp_nx_ldone_x86
70	stager_bind_tcp_nx_ldone_x86
70	win32_stage_boot_winsock_conn_ldone_x86
70	win32_stage_boot_bind_read_ldone_x86
70	win32_stage_boot_reverse_read_ldone_x86
70	win32_stage_boot_winsock_conn_udp_ldone_x86
70	stager_reverse_ipv6_tcp_nx_ldone_x86
70	win32_stage_boot_bind_inlineegg_ldone_x86
70	win32_stage_boot_reverse_ldone_x86
70	win32_stage_boot_reverse_shell_revert_ldone_x86
70	win32_stage_winexec_ldone_x86
70	stager_bind_ipv6_tcp_nx_ldone_x86
70	win32_stage_boot_winsock_bind_ldone_x86
70	win32_stage_boot_reverse_shell_ldone_x86
70	win32_stage_api_ldone_x86
70	win32_stage_boot_bind_ldone_x86
70	win32_stage_boot_reverse_udp_ldone_x86
70	win32_stage_boot_reverse_inlineegg_ldone_x86
70	win32_stage_boot_bind_shell_ldone_x86
35	Qemu_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
60	antivm_vmware
60	vmdetect_2
40	SEH_Init
60	vmdetect
20	isExecutable
10	Contains_PE_File
20	MD5_Constants

============================[ Scores ]============================
CAPA:	32.5
ClamAV:	0
Loki:	2284
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
38847.420768176715
==================================================================


==================================================================
Fichier HTTP-F1iQtF3jB9i7cPJH38.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FfRYqe2YrwKfvYmXM.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a6933d1262da26403faf968672a1baf0                                                   |
| sha1                   | 3047bada98818c4b4699eb6bd5ffb19d9e9868a8                                           |
| sha256                 | ce8d7590182db2e51372a4a04d6a0927a65b2640739f9ec01cfd6c143b1110da                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FfRYqe2YrwKfvYmXM.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Portable Executable Injection \[T1055.002]\                     |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| set environment variable                             | host-interaction/environment-variable                |
| hide graphical window                                | host-interaction/gui/window/hide                     |
| inject pe                                            | host-interaction/process/inject                      |
| inject thread                                        | host-interaction/process/inject                      |
| access PE header                                     | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
| spawn thread to RWX shellcode                        | load-code/shellcode                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
2		- Execution::Shared Modules [T1129;2]
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
4		- Defense Evasion::Process Injection::Portable Executable Injection [T1055.002;4]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 19.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FfRYqe2YrwKfvYmXM.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.10 MB
Data read: 0.10 MB (ratio 1.00:1)
Time: 41.105 sec (0 m 41 s)
Start Date: 2022:02:11 11:05:41
End Date:   2022:02:11 11:06:23

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x92 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x92 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe2 in position 78: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:05:42Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FfRYqe2YrwKfvYmXM.exe SCORE: 539 TYPE: EXE SIZE: 104448 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fcc95891400> 
MD5: a6933d1262da26403faf968672a1baf0 
SHA1: 3047bada98818c4b4699eb6bd5ffb19d9e9868a8 
SHA256: ce8d7590182db2e51372a4a04d6a0927a65b2640739f9ec01cfd6c143b1110da CREATED: Fri Feb 11 11:05:41 2022 MODIFIED: Fri Feb 11 11:05:41 2022 ACCESSED: Fri Feb 11 11:06:33 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: FindClose
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: ConventionEngine_Term_Desktop SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445336f6360ba646a14aaeb3260c022cd49002000000433a5c55736572735c656e6467616d655c4465736b746f705c504557696e646f775c52656c656173655c5 ... (truncated)
REASON_5: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445336f6360ba646a14aaeb3260c022cd49002000000433a5c55736572735c656e6467616d655c4465736b746f705c504557696e646f775c52656c656173655c5 ... (truncated)
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e894030000e97afeffff Str2: e80f060000e977ffffff Str3: e821f1ffffe96cffffff
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_11: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread
REASON_17: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_18: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_19: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:06:34Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
10		win_files_operation
10		ft_exe
50		ConventionEngine_Term_Desktop
50		ConventionEngine_Term_Users
2		math_entropy_6
5		executable_pe
15		dll_injection_thread
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
45		Inject_Thread
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 539

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 3/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:05:41                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FfRYqe2YrwKfvYmXM.exe
Real Name:	/ce8d7590182db2e51372a4a04d6a0927a65b2640739f9ec01cfd6c143b1110da.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6	- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
2	- Execution::Shared Modules [T1129;2]
6	- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
4	- Defense Evasion::Process Injection::Portable Executable Injection [T1055.002;4]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	inject_thread
10	win_files_operation
10	ft_exe
50	ConventionEngine_Term_Desktop
50	ConventionEngine_Term_Users
2	math_entropy_6
5	executable_pe
15	dll_injection_thread
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
45	Inject_Thread
40	SEH_Save
40	SEH_Init
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	19.0
ClamAV:	0
Loki:	539
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
10921.67414720949
==================================================================


==================================================================
Fichier HTTP-FfRYqe2YrwKfvYmXM.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FmEfcF1DPTBH8wH875.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FmEfcF1DPTBH8wH875.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 42.535 sec (0 m 42 s)
Start Date: 2022:02:11 11:06:35
End Date:   2022:02:11 11:07:17

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:06:35Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:07:27Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 19/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:06:35                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FmEfcF1DPTBH8wH875.exe
Real Name:	/f9ac6b16273556b3a57bf2c6d7e7db97.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

============================[ Scores ]============================
CAPA:	0
ClamAV:	0
Loki:	0
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
2000.0
==================================================================


==================================================================
Fichier HTTP-FmEfcF1DPTBH8wH875.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FGFzwj2j7SDTirYTcc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FGFzwj2j7SDTirYTcc.exe: Win.Malware.Agent-6350563-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FGFzwj2j7SDTirYTcc.exe: Win.Trojan.Agent-709658 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.00 MB
Data read: 0.00 MB (ratio 0.00:1)
Time: 43.493 sec (0 m 43 s)
Start Date: 2022:02:11 11:07:29
End Date:   2022:02:11 11:08:12

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Agent-6350563-0
70		Win.Trojan.Agent-709658
75		Win.Trojan.Agent-709658
45		Win.Trojan.Agent-709658

Score total: 240.0
sh: 183: Syntax error: EOF in backquote substitution

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 54/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:07:29                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FGFzwj2j7SDTirYTcc.exe
Real Name:	/Practical Malware Analysis Lab 01-02.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
50	Win.Malware.Agent-6350563-0
70	Win.Trojan.Agent-709658
75	Win.Trojan.Agent-709658
45	Win.Trojan.Agent-709658

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	ft_exe
10	misc_upx_packed_binary
2	math_entropy_5
5	executable_pe
2	upx_sections
70	PackerUPX_CompresorGratuito_wwwupxsourceforgenet
70	UPX_wwwupxsourceforgenet_additional
70	yodas_Protector_v1033_dllocx_Ashkbiz_Danehkar_h
70	UPX_v0896_v102_v105_v124_Markus_Laszlo_overlay
70	UPX_v0896_v102_v105_v124_Markus_Laszlo_overlay_additional
70	UPX_wwwupxsourceforgenet
30	UPXv20MarkusLaszloReiser
70	UPXV200V290MarkusOberhumerLaszloMolnarJohnReiser
70	UPX20030XMarkusOberhumerLaszloMolnarJohnReiser
10	IsPE32
10	IsConsole
10	HasRichSignature
2	PE_File
15	upx
60	suspicious_packer_section
60	UPX
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	0
ClamAV:	240.0
Loki:	836
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
18271.128077280908
==================================================================


==================================================================
Fichier HTTP-FGFzwj2j7SDTirYTcc.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FOLRrqlyWVENRDVL6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FOLRrqlyWVENRDVL6.exe: Win.Dropper.Necurs-7617964-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FOLRrqlyWVENRDVL6.exe: Win.Malware.Necurs-7618009-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.18 MB
Data read: 0.18 MB (ratio 1.02:1)
Time: 45.997 sec (0 m 45 s)
Start Date: 2022:02:11 11:08:24
End Date:   2022:02:11 11:09:10

-------- Score ----------------
Scores		Rules
.......		...............
30		Win.Dropper.Necurs-7617964-0
50		Win.Malware.Necurs-7618009-0

Score total: 80.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf2 in position 8: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xda in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:08:24Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FOLRrqlyWVENRDVL6.exe SCORE: 1284 TYPE: EXE SIZE: 188418 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7effa35d5400> 
MD5: 0596c4ea5aa8def47f22c85d75aaca95 
SHA1: f63ad8e1c86666a0d3a51f039e44f7cb17232933 
SHA256: 377fdff7fd24bf9257447480a8061e0380902f795ac5f8aac3738663b6503a3d CREATED: Fri Feb 11 11:08:24 2022 MODIFIED: Fri Feb 11 11:08:24 2022 ACCESSED: Fri Feb 11 11:09:18 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: HttpOpenRequest Str6: HttpSendRequest
REASON_3: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: DNSAPI.dll Str3: getaddrinfo Str4: DnsQuery
REASON_4: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_5: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_6: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: DuplicateTokenEx Str3: AdjustTokenPrivileges Str4: OpenProcessToken
REASON_7: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: ReadFile Str5: CopyFile
REASON_8: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_9: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_10: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_11: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_12: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: win_necurs_auto SUBSCORE: 45 
DESCRIPTION: Detects win.necurs. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 13f2a314000801893510000801890d0c000801 Str2: 397508760433c0eb12 Str3: 33d246f7f68bc20345085e5d Str4: 0f318bc8a118000801568bf2 Str5: 0 ... (truncated)
REASON_14: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_16: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_17: Yara Rule MATCH: Microsoft_Visual_Basic_v50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: h
REASON_18: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_21: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_22: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_23: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_24: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_25: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_26: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: b868584d56bb00000000b90a000000ba58560000ed
REASON_27: Yara Rule MATCH: VM_Detect_VirtualPC_XEN_Wine_v1 SUBSCORE: 60 
DESCRIPTION: Xen detection, VirtualPC, Red Pill, Wine and other REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: ?
REASON_28: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_29: Yara Rule MATCH: antivm_vmware SUBSCORE: 60 
DESCRIPTION: AntiVM checks for VMWare REF: - AUTHOR: x0r 
MATCHES: Str1: b868584d56bb00000000b90a000000ba58560000ed
REASON_30: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: ?
REASON_31: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_32: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_33: Yara Rule MATCH: ThreadControl__Context_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetThreadContext
REASON_34: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_35: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: ?
REASON_36: Yara Rule MATCH: TrojanWin32NecursSample SUBSCORE: 50 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: some stupid error %u Str2: loading Str3: unloading Str4: exception %08x %swhen %s at %p Str5: microsoft.com Str6: facebook.com Str7:  ... (truncated)
REASON_37: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_38: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_39: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
REASON_40: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:09:19Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
45		network_http
50		network_dns
70		escalate_priv
20		win_registry
65		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
45		win_necurs_auto
2		math_entropy_5
5		executable_pe
15		dll_injection_thread
70		Microsoft_Visual_Basic_v50
10		IsPE32
10		IsWindowsGUI
10		HasOverlay
10		HasRichSignature
35		Embedded_PE
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		VM_Detect_VirtualPC_XEN_Wine_v1
35		Anti_Automated_Sandbox
60		antivm_vmware
60		vmdetect_2
45		Inject_Thread
60		Debugger_Check__QueryInfo
60		ThreadControl__Context_v1
40		SEH_Init
60		vmdetect
50		TrojanWin32NecursSample
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API
25		CRC32_poly_Constant

Score total: 1284

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 57/71
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:08:24                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FOLRrqlyWVENRDVL6.exe
Real Name:	/0596c4ea5aa8def47f22c85d75aaca95.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
30	Win.Dropper.Necurs-7617964-0
50	Win.Malware.Necurs-7618009-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	inject_thread
45	network_http
50	network_dns
70	escalate_priv
20	win_registry
65	win_token
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	Str_Win32_Http_API
10	ft_exe
45	win_necurs_auto
2	math_entropy_5
5	executable_pe
15	dll_injection_thread
70	Microsoft_Visual_Basic_v50
10	IsPE32
10	IsWindowsGUI
10	HasOverlay
10	HasRichSignature
35	Embedded_PE
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
60	VM_Detect_VirtualPC_XEN_Wine_v1
35	Anti_Automated_Sandbox
60	antivm_vmware
60	vmdetect_2
45	Inject_Thread
60	Debugger_Check__QueryInfo
60	ThreadControl__Context_v1
40	SEH_Init
60	vmdetect
50	TrojanWin32NecursSample
20	isExecutable
10	Contains_PE_File
20	Advapi_Hash_API
25	CRC32_poly_Constant

============================[ Scores ]============================
CAPA:	0
ClamAV:	80.0
Loki:	1284
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
23357.168920636028
==================================================================


==================================================================
Fichier HTTP-FOLRrqlyWVENRDVL6.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FDfcjB41unNmGACEvb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9dc209f66da77858e362e624d0be86b3                                                   |
| sha1                   | 60a542f76b1228b1725c51bd6e19d9763ce5cd03                                           |
| sha256                 | db36fbc490ffb8662d13388cf4a1d5daba1527ac0440fc2eff99ddedc51f4a82                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FDfcjB41unNmGACEvb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::3DES [C0027.004]                                                |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| encrypt data using DES                               | data-manipulation/encryption/des                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file size                                        | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| get hostname                                         | host-interaction/os/hostname                         |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| allocate thread local storage                        | host-interaction/process                             |
| terminate process                                    | host-interaction/process/terminate                   |
| set registry value (3 matches)                       | host-interaction/registry/create                     |
| delete registry key                                  | host-interaction/registry/delete                     |
| query service status                                 | host-interaction/service                             |
| create service                                       | host-interaction/service/create                      |
| modify service (2 matches)                           | host-interaction/service/modify                      |
| start service                                        | host-interaction/service/start                       |
| link many functions at runtime                       | linking/runtime-linking                              |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
| persist via Windows service                          | persistence/service                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 27.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FDfcjB41unNmGACEvb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.57 MB
Data read: 0.54 MB (ratio 1.06:1)
Time: 42.981 sec (0 m 42 s)
Start Date: 2022:02:11 11:09:20
End Date:   2022:02:11 11:10:03

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 20: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 19: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 18: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 61: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 45: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 29: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc4 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:09:20Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FDfcjB41unNmGACEvb.exe SCORE: 379 TYPE: EXE SIZE: 572244 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe2040fc400> 
MD5: 9dc209f66da77858e362e624d0be86b3 
SHA1: 60a542f76b1228b1725c51bd6e19d9763ce5cd03 
SHA256: db36fbc490ffb8662d13388cf4a1d5daba1527ac0440fc2eff99ddedc51f4a82 CREATED: Fri Feb 11 11:09:20 2022 MODIFIED: Fri Feb 11 11:09:20 2022 ACCESSED: Fri Feb 11 11:10:06 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 2 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8d54b0000e995feffff Str2: e8d7fbffffe9b4feffff Str3: e8810a0000e919ffffff Str4: e85fc9ffffe9fffeffff
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3:  Str4:  Str5:  Str6:  Str7:  Str8:  Str9:  Str10:  Str11:  Str12:  Str13:  Str14:  Str15:  Str16:  Str17: 00000000000 ... (truncated)
REASON_8: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_15: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: DES_sbox SUBSCORE: 15 
DESCRIPTION: DES [sbox] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 
REASON_20: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:10:07Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
10		ft_exe
2		math_entropy_close_8
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsConsole
10		IsPacked
10		HasOverlay
10		HasRichSignature
2		PE_File
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
15		DES_sbox
5		BASE64_table

Score total: 379

==================[ Vérification MalwareBazaar ]==================
Fichier trouvé !
Malware connu -> Score: 2000
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 59/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:09:20                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FDfcjB41unNmGACEvb.exe
Real Name:	/9dc209f66da77858e362e624d0be86b3.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::System Information Discovery [T1082;1]
3	- Execution::System Services::Service Execution [T1569.002;3]
8.5	- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
2	- Discovery::File and Directory Discovery [T1083;2]
4	- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	win_files_operation
10	ft_exe
2	math_entropy_close_8
5	executable_pe
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsConsole
10	IsPacked
10	HasOverlay
10	HasRichSignature
2	PE_File
40	SEH_Save
40	SEH_Init
10	anti_dbg
20	isExecutable
10	Contains_PE_File
15	DES_sbox
5	BASE64_table

============================[ Scores ]============================
CAPA:	27.0
ClamAV:	0
Loki:	379
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	2000
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
10545.466024469217
==================================================================


==================================================================
Fichier HTTP-FDfcjB41unNmGACEvb.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FIAkDP2ZP6VWg0nODf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 1f009de6a013a282d07436241512c056                                                   |
| sha1                   | f0d37e1e76a199135e00c0a36b154b191a0950a9                                           |
| sha256                 | c897c345c3bcf3e96589a0feeea8b6d26cf33c091ac3ee2162dd27f8a79c3ff5                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FIAkDP2ZP6VWg0nODf.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FIAkDP2ZP6VWg0nODf.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 39.898 sec (0 m 39 s)
Start Date: 2022:02:11 11:10:09
End Date:   2022:02:11 11:10:49

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:10:09Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FIAkDP2ZP6VWg0nODf.exe SCORE: 169 TYPE: EXE SIZE: 73728 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f5dd3532400> 
MD5: 1f009de6a013a282d07436241512c056 
SHA1: f0d37e1e76a199135e00c0a36b154b191a0950a9 
SHA256: c897c345c3bcf3e96589a0feeea8b6d26cf33c091ac3ee2162dd27f8a79c3ff5 CREATED: Fri Feb 11 11:10:09 2022 MODIFIED: Fri Feb 11 11:10:09 2022 ACCESSED: Fri Feb 11 11:11:02 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 5577fe6a71dbb9240a528a19d7a185c9
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:11:02Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1

Score total: 169

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/65
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:10:09                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FIAkDP2ZP6VWg0nODf.exe
Real Name:	/OnDemandConnRouteHelper.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File
10	Big_Numbers1

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	169
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
2738.327364708348
==================================================================


==================================================================
Fichier HTTP-FIAkDP2ZP6VWg0nODf.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F1d3Xc31mOiKloIR4g.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F1d3Xc31mOiKloIR4g.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.13 MB
Data read: 0.12 MB (ratio 1.03:1)
Time: 41.537 sec (0 m 41 s)
Start Date: 2022:02:11 11:11:03
End Date:   2022:02:11 11:11:45

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a7a7ef007355f853e8fc56a483c25a10                                                   |
| sha1                   | d7fcd0e6eadabd235fb969b6ee163c83fd07c991                                           |
| sha256                 | 1daad9a09bc5bc51f41a34cb604106eebe1559d35e8464785601e3e6d98c3f17                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F1d3Xc31mOiKloIR4g.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (7 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:11:03Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F1d3Xc31mOiKloIR4g.exe SCORE: 364 TYPE: EXE SIZE: 131152 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f26bdde6400> 
MD5: a7a7ef007355f853e8fc56a483c25a10 
SHA1: d7fcd0e6eadabd235fb969b6ee163c83fd07c991 
SHA256: 1daad9a09bc5bc51f41a34cb604106eebe1559d35e8464785601e3e6d98c3f17 CREATED: Fri Feb 11 11:11:03 2022 MODIFIED: Fri Feb 11 11:11:03 2022 ACCESSED: Fri Feb 11 11:11:48 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:11:48Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 364

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:11:03                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F1d3Xc31mOiKloIR4g.exe
Real Name:	/PickerHost.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	364
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5828.869090007519
==================================================================


==================================================================
Fichier HTTP-F1d3Xc31mOiKloIR4g.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F5QADZ2vO3bRpBWRR7.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 51cd52d8eaaeba1dbfedf2d2c4e3f796                                                   |
| sha1                   | 39eb573d623463e4e359f94b5bb605a7d89cabfe                                           |
| sha256                 | 5e3cacdc9963ee8189ee6619b205c235ec44c38faa430f176da7ed5cfb8a3343                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F5QADZ2vO3bRpBWRR7.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-VM instructions (28 matches)            | anti-analysis/anti-vm/vm-detection                   |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 10.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F5QADZ2vO3bRpBWRR7.exe: Win.Trojan.MSShellcode-6360728-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-F5QADZ2vO3bRpBWRR7.exe: Win.Trojan.MSShellcode-6360730-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-F5QADZ2vO3bRpBWRR7.exe: Win.Trojan.Swrort-5710536-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-F5QADZ2vO3bRpBWRR7.exe: Win.Trojan.MSShellcode-6360729-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-F5QADZ2vO3bRpBWRR7.exe: BC.Win.Trojan.Swrort-17210 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 42.089 sec (0 m 42 s)
Start Date: 2022:02:11 11:11:49
End Date:   2022:02:11 11:12:31

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.MSShellcode-6360728-0
45		Win.Trojan.MSShellcode-6360730-0
45		Win.Trojan.Swrort-5710536-0
45		Win.Trojan.MSShellcode-6360729-0
45		BC.Win.Trojan.Swrort-17210

Score total: 225.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xba in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xba in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:11:50Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F5QADZ2vO3bRpBWRR7.exe SCORE: 334 TYPE: EXE SIZE: 73802 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa7662d1400> 
MD5: 51cd52d8eaaeba1dbfedf2d2c4e3f796 
SHA1: 39eb573d623463e4e359f94b5bb605a7d89cabfe 
SHA256: 5e3cacdc9963ee8189ee6619b205c235ec44c38faa430f176da7ed5cfb8a3343 CREATED: Fri Feb 11 11:11:49 2022 MODIFIED: Fri Feb 11 11:11:49 2022 ACCESSED: Fri Feb 11 11:12:39 2022 
REASON_1: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: WSOCK32.dll Str3: socket Str4: send Str5: WSASend Str6: connect Str7: WSAStartup
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: CreateFileA
REASON_4: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll Str2: WSOCK32.dll
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: Hunting_Rule_ShikataGaNai SUBSCORE: 70 
DESCRIPTION: not set REF: https://www.fireeye.com/blog/threat-research/2019/10/shikata-ga-nai-encoder-still-going-strong.html AUTHOR: Steven Miller 
MATCHES: Str1: baba96367cdac9d97424f45e29c9b184315613 Str2: ba96367cdac9d97424f45e29c9b184315613
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: winsocks SUBSCORE: 5 
DESCRIPTION: Imports Winsock Library REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: metasploit_payload_msfpayload SUBSCORE: 25 
DESCRIPTION: This rule detects generic metasploit callback payloads generated with msfpayload REF: - AUTHOR: - 
MATCHES: Str1: asf Str2: release Str3: build Str4: support Str5: ab.pdb Str6: WS2_32.dll Str7: mswsock Str8: ntdll.dll Str9: KERNEL32.dll Str10: she ... (truncated)
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:12:39Z

-------- Score ----------------
Scores		Rules
.......		...............
50		network_tcp_socket
60		win_mutex
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		ft_exe
70		Hunting_Rule_ShikataGaNai
2		math_entropy_6
5		executable_pe
5		winsocks
10		IsPE32
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
25		metasploit_payload_msfpayload
20		isExecutable
10		Contains_PE_File
5		BASE64_table

Score total: 334

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 49/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:11:49                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F5QADZ2vO3bRpBWRR7.exe
Real Name:	/payload.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
45	Win.Trojan.MSShellcode-6360728-0
45	Win.Trojan.MSShellcode-6360730-0
45	Win.Trojan.Swrort-5710536-0
45	Win.Trojan.MSShellcode-6360729-0
45	BC.Win.Trojan.Swrort-17210

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	network_tcp_socket
60	win_mutex
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	ft_exe
70	Hunting_Rule_ShikataGaNai
2	math_entropy_6
5	executable_pe
5	winsocks
10	IsPE32
10	IsWindowsGUI
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
25	metasploit_payload_msfpayload
20	isExecutable
10	Contains_PE_File
5	BASE64_table

============================[ Scores ]============================
CAPA:	10.5
ClamAV:	225.0
Loki:	334
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
10335.627982428729
==================================================================


==================================================================
Fichier HTTP-F5QADZ2vO3bRpBWRR7.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FNDAdF11ebij4Bj5bc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FNDAdF11ebij4Bj5bc.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.45 MB
Data read: 0.42 MB (ratio 1.06:1)
Time: 34.510 sec (0 m 34 s)
Start Date: 2022:02:11 11:12:40
End Date:   2022:02:11 11:13:15

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:12:41Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FNDAdF11ebij4Bj5bc.exe SCORE: 194 TYPE: EXE SIZE: 443392 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe3595f4400> 
MD5: 761d7dcd4b60059b522fad83400d8418 
SHA1: 6954ba79dabf8aa903dd376cfc5f7d409dbe47d1 
SHA256: b0b994aeb9187bbf9d819bdef803bb3de63b73720de890d151ffa8ec346ee2bd CREATED: Fri Feb 11 11:12:40 2022 MODIFIED: Fri Feb 11 11:12:40 2022 ACCESSED: Fri Feb 11 11:13:34 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:13:35Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 194

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 761d7dcd4b60059b522fad83400d8418                                                   |
| sha1                   | 6954ba79dabf8aa903dd376cfc5f7d409dbe47d1                                           |
| sha256                 | b0b994aeb9187bbf9d819bdef803bb3de63b73720de890d151ffa8ec346ee2bd                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FNDAdF11ebij4Bj5bc.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location                            | collection                                           |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| hash data using fnv                                  | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (8 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1.5		- Discovery::System Location Discovery [T1614;1.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 7.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:12:40                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FNDAdF11ebij4Bj5bc.exe
Real Name:	/PhoneOm.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1.5	- Discovery::System Location Discovery [T1614;1.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	7.5
ClamAV:	0
Loki:	194
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3224.3374669972254
==================================================================


==================================================================
Fichier HTTP-FNDAdF11ebij4Bj5bc.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fr2iAo28dhLxSsHSol.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fr2iAo28dhLxSsHSol.exe: Win.Exploit.CVE_2019_1219-7151042-2 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.45 MB
Data read: 0.43 MB (ratio 1.06:1)
Time: 45.433 sec (0 m 45 s)
Start Date: 2022:02:11 11:15:01
End Date:   2022:02:11 11:15:46

-------- Score ----------------
Scores		Rules
.......		...............
25		Win.Exploit.CVE_2019_1219-7151042-2

Score total: 25.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | db648cd247281954344f1d810c6fd590                                                   |
| sha1                   | a457931874ba395917da2ab060c02159f2c418ec                                           |
| sha256                 | faf351db4072395ca1e2855a379b120cdbccdb09131c48463e30dccf4245f4bb                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fr2iAo28dhLxSsHSol.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Data from Information Repositories:: \[T1213]\                                     |
|                        | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Asynchronous Procedure Call \[T1055.004]\                       |
|                        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
|                        | Process Injection::Process Hollowing \[T1055.012]\                                 |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
|                        | Virtualization/Sandbox Evasion::User Activity Based Checks \[T1497.002]\           |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection:: [B0001]                                                  |
|                             | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
|                             | Debugger Detection::CheckRemoteDebuggerPresent [B0001.002]                    |
|                             | Debugger Detection::Hardware Breakpoints [B0001.005]                          |
|                             | Debugger Detection::Memory Write Watching [B0001.010]                         |
|                             | Debugger Detection::OutputDebugString [B0001.016]                             |
|                             | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
|                             | Debugger Detection::Process Environment Block NtGlobalFlag [B0001.036]        |
|                             | Debugger Detection::SetHandleInformation [B0001.024]                          |
|                             | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Debugger Detection::WudfIsAnyDebuggerPresent [B0001.031]                      |
|                             | Emulator Detection:: [B0004]                                                  |
|                             | Virtual Machine Detection:: [B0009]                                           |
|                             | Virtual Machine Detection::Human User Check [B0009.012]                       |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| COLLECTION                  | Keylogging::Application Hook [F0002.001]                                      |
| COMMUNICATION               | ICMP Communication::Echo Request [C0014.002]                                  |
| DISCOVERY                   | Analysis Tool Discovery::Process Detection [B0013.001]                        |
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+----------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                               | NAMESPACE                                            |
|----------------------------------------------------------+------------------------------------------------------|
| reference analysis tools strings                         | anti-analysis                                        |
| check for OutputDebugString error                        | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB BeingDebugged flag                         | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB NtGlobalFlag flag                          | anti-analysis/anti-debugging/debugger-detection      |
| check for debugger via API                               | anti-analysis/anti-debugging/debugger-detection      |
| check for hardware breakpoints                           | anti-analysis/anti-debugging/debugger-detection      |
| check for kernel debugger via shared user data structure | anti-analysis/anti-debugging/debugger-detection      |
| check for protected handle exception                     | anti-analysis/anti-debugging/debugger-detection      |
| check for software breakpoints (2 matches)               | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via GetTickCount                    | anti-analysis/anti-debugging/debugger-detection      |
| check for trap flag exception                            | anti-analysis/anti-debugging/debugger-detection      |
| check for unexpected memory writes (5 matches)           | anti-analysis/anti-debugging/debugger-detection      |
| check process job object                                 | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-debugging instructions (2 matches)          | anti-analysis/anti-debugging/debugger-detection      |
| check if process is running under wine (2 matches)       | anti-analysis/anti-emulation/wine                    |
| check for unmoving mouse cursor                          | anti-analysis/anti-vm/vm-detection                   |
| execute anti-VM instructions (7 matches)                 | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings                                | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Parallels            | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Qemu                 | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VMWare               | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VirtualBox           | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VirtualPC            | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Xen                  | anti-analysis/anti-vm/vm-detection                   |
| reference WMI statements (31 matches)                    | collection/database/wmi                              |
| log keystrokes via application hook                      | collection/keylog                                    |
| send ICMP echo request                                   | communication/icmp                                   |
| contains PDB path                                        | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                       | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section            | executable/pe/section/tls                            |
| interact with driver via control codes                   | host-interaction/driver                              |
| query environment variable (4 matches)                   | host-interaction/environment-variable                |
| get Program Files directory (2 matches)                  | host-interaction/file-system                         |
| get common file path (5 matches)                         | host-interaction/file-system                         |
| read raw disk data                                       | host-interaction/file-system                         |
| check if file exists (2 matches)                         | host-interaction/file-system/exists                  |
| get file attributes (2 matches)                          | host-interaction/file-system/meta                    |
| get file size                                            | host-interaction/file-system/meta                    |
| read file on Windows                                     | host-interaction/file-system/read                    |
| set console window title                                 | host-interaction/gui/console                         |
| find graphical window                                    | host-interaction/gui/window/find                     |
| get number of processor cores                            | host-interaction/hardware/cpu                        |
| get number of processors                                 | host-interaction/hardware/cpu                        |
| get memory capacity                                      | host-interaction/hardware/memory                     |
| enumerate disk properties                                | host-interaction/hardware/storage                    |
| get disk information (2 matches)                         | host-interaction/hardware/storage                    |
| get disk size (2 matches)                                | host-interaction/hardware/storage                    |
| print debug messages (6 matches)                         | host-interaction/log/debug/write-event               |
| create mutex                                             | host-interaction/mutex                               |
| get system information on Windows (5 matches)            | host-interaction/os/info                             |
| check OS version                                         | host-interaction/os/version                          |
| get process heap flags (2 matches)                       | host-interaction/process                             |
| get process heap force flags (2 matches)                 | host-interaction/process                             |
| read process memory (3 matches)                          | host-interaction/process                             |
| create process on Windows                                | host-interaction/process/create                      |
| allocate RWX memory (3 matches)                          | host-interaction/process/inject                      |
| inject APC                                               | host-interaction/process/inject                      |
| inject dll                                               | host-interaction/process/inject                      |
| inject thread                                            | host-interaction/process/inject                      |
| use process replacement                                  | host-interaction/process/inject                      |
| enumerate processes                                      | host-interaction/process/list                        |
| get Explorer PID                                         | host-interaction/process/list                        |
| acquire debug privileges                                 | host-interaction/process/modify                      |
| modify access privileges (2 matches)                     | host-interaction/process/modify                      |
| enumerate process modules (5 matches)                    | host-interaction/process/modules/list                |
| terminate process                                        | host-interaction/process/terminate                   |
| terminate process via fastfail (3 matches)               | host-interaction/process/terminate                   |
| query or enumerate registry value                        | host-interaction/registry                            |
| enumerate services                                       | host-interaction/service/list                        |
| enumerate threads (2 matches)                            | host-interaction/thread/list                         |
| get ntdll base address                                   | linking/runtime-linking                              |
| link function at runtime on Windows (8 matches)          | linking/runtime-linking                              |
| enumerate PE sections                                    | load-code/pe                                         |
| parse PE header (3 matches)                              | load-code/pe                                         |
+----------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
4		- Defense Evasion::Process Injection::Asynchronous Procedure Call [T1055.004;4]
3		- Execution::System Services::Service Execution [T1569.002;3]
5		- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]
5		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
4		- Discovery::Application Window Discovery [T1010;4]
4		- Discovery::Software Discovery [T1518;4]
2		- Discovery::File and Directory Discovery [T1083;2]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
5		- Collection::Data from Information Repositories [T1213;5]
7.5		- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]
4		- Discovery::Process Discovery [T1057;4]

Score total: 88.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 46/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:15:01                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fr2iAo28dhLxSsHSol.exe
Real Name:	/al-khaser_x86.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
8.5	- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
4	- Defense Evasion::Process Injection::Asynchronous Procedure Call [T1055.004;4]
3	- Execution::System Services::Service Execution [T1569.002;3]
5	- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]
5	- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
4	- Discovery::Application Window Discovery [T1010;4]
4	- Discovery::Software Discovery [T1518;4]
2	- Discovery::File and Directory Discovery [T1083;2]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
6	- Collection::Input Capture::Keylogging [T1056.001;6]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6	- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
5	- Privilege Escalation::Access Token Manipulation [T1134;5]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
5	- Collection::Data from Information Repositories [T1213;5]
7.5	- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]
4	- Discovery::Process Discovery [T1057;4]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
25	Win.Exploit.CVE_2019_1219-7151042-2

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	inject_thread
70	escalate_priv
65	screenshot
80	keylogger
45	migrate_apc
60	win_mutex
20	win_registry
65	win_token
10	win_private_profile
10	win_files_operation
10	ft_exe
50	ConventionEngine_Term_Desktop
50	ConventionEngine_Term_Users
2	math_entropy_5
5	obfuscation_singlebyte_mov
5	executable_pe
15	self_inject
15	dll_injection_thread
15	dll_injection_hook
25	possible_includes_base64_packed_functions
70	Microsoft_Visual_Cpp_V80_Debug
70	Microsoft_Visual_Cpp_80_Debug_
70	Microsoft_Visual_Cpp_80_Debug
10	IsPE32
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
10	virtualbox_detection
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
60	VM_Detect_VirtualPC_XEN_Wine_v1
35	Anti_Automated_Sandbox
30	Check_Dlls
60	Check_VBox_DeviceMap
60	Check_VBox_VideoDrivers
60	Check_VmTools
60	vmdetect_2
50	WMI_VM_Detect_v1
35	AtomTable_Inject
40	DLL_inject
45	Inject_Thread
35	Win_Hook_v12
35	Process_Doppelganging
40	Atom_Bombing
40	APC_Inject
60	Debugger_Check__GlobalFlags
60	Debugger_Check__QueryInfo
60	Debugger_Check__RemoteAPI
60	Debugger_Hiding__Thread
60	DebuggerHiding__Active_v1
60	DebuggerException__ConsoleCtrl_v1
60	DebuggerException__SetConsoleCtrl_v1
60	ThreadControl__Context_v1
60	SEH__vectored_v1
60	Check_Debugger_v1
40	SEH_Init
40	Check_Qemu_Description
40	Check_Qemu_DeviceMap
60	vmdetect
50	WMI_VM_Detect
10	anti_dbg
50	vmdetect_misc
70	INDICATOR_SUSPICIOUS_EXE_SandboxHookingDLL
70	INDICATOR_SUSPICIOUS_References_SecTools
70	INDICATOR_SUSPICIOUS_VM_Evasion_VirtDrvComb
70	INDICATOR_SUSPICIOUS_VM_Evasion_MACAddrComb
25	VMdetectMisc
70	SandboxDetectMisc
70	avdetect_procs
70	dbgdetect_procs
60	TrojanDownloaderCbeplaySample
20	isExecutable
10	Contains_PE_File
25	MD5_API

============================[ Scores ]============================
CAPA:	88.5
ClamAV:	25.0
Loki:	3239
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
55415.22900551146
==================================================================


==================================================================
Fichier HTTP-Fr2iAo28dhLxSsHSol.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F5suAp4fHQPb4REvXk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F5suAp4fHQPb4REvXk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.43 MB
Data read: 0.41 MB (ratio 1.06:1)
Time: 43.930 sec (0 m 43 s)
Start Date: 2022:02:11 11:16:40
End Date:   2022:02:11 11:17:24

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:16:40Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F5suAp4fHQPb4REvXk.exe SCORE: 334 TYPE: EXE SIZE: 429056 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f091410d400> 
MD5: b28148e4dc7bd3e63dc0162ebc33685c 
SHA1: fde2ab2cfba3d62c79b74d214c4ac9bb31bcd2b6 
SHA256: 2ece870892bb1c19ae933a5411560d1fe4eb51dd6b6b510f82b05f2b1ba49851 CREATED: Fri Feb 11 11:16:40 2022 MODIFIED: Fri Feb 11 11:16:40 2022 ACCESSED: Fri Feb 11 11:17:34 2022 
REASON_1: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e86b0200004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue Str2: dbghelp.dll
REASON_13: Yara Rule MATCH: antisb_threatExpert SUBSCORE: 60 
DESCRIPTION: Anti-Sandbox checks for ThreatExpert REF: - AUTHOR: x0r 
MATCHES: Str1: dbghelp.dll
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:17:35Z

-------- Score ----------------
Scores		Rules
.......		...............
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
60		antisb_threatExpert
20		isExecutable
10		Contains_PE_File

Score total: 334

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b28148e4dc7bd3e63dc0162ebc33685c                                                   |
| sha1                   | fde2ab2cfba3d62c79b74d214c4ac9bb31bcd2b6                                           |
| sha256                 | 2ece870892bb1c19ae933a5411560d1fe4eb51dd6b6b510f82b05f2b1ba49851                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F5suAp4fHQPb4REvXk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| DATA                        | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (3 matches)                | collection                                           |
| check HTTP status code                               | communication/http/client                            |
| initialize Winsock library                           | communication/socket                                 |
| hash data using murmur3 (3 matches)                  | data-manipulation/hashing/murmur                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| check OS version (2 matches)                         | host-interaction/os/version                          |
| terminate process via fastfail (74 matches)          | host-interaction/process/terminate                   |
| inspect section memory permissions                   | load-code/pe                                         |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (13 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
1.5		- Discovery::System Location Discovery [T1614;1.5]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 19.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:16:40                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F5suAp4fHQPb4REvXk.exe
Real Name:	/tracerpt.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1	- Discovery::System Information Discovery [T1082;1]
1.5	- Discovery::System Location Discovery [T1614;1.5]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	Str_Win32_Winsock2_Library
10	ft_exe
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
60	antisb_threatExpert
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	19.5
ClamAV:	0
Loki:	334
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5682.6194142390505
==================================================================


==================================================================
Fichier HTTP-F5suAp4fHQPb4REvXk.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FEZuYW3a5fDizgy7d.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f716498e51219f64bfb4afabab44a796                                                   |
| sha1                   | 5a9f9a54524497784c31064bdb14e25a9d7f185e                                           |
| sha256                 | 62054b4aebc9da850fe32c6a056ceaa2039c5bd3f51e3f1471116792e8778ed9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FEZuYW3a5fDizgy7d.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 7.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FEZuYW3a5fDizgy7d.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.08 MB
Data read: 0.08 MB (ratio 1.00:1)
Time: 45.296 sec (0 m 45 s)
Start Date: 2022:02:11 11:18:10
End Date:   2022:02:11 11:18:55

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:18:10Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FEZuYW3a5fDizgy7d.exe SCORE: 364 TYPE: EXE SIZE: 85840 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f1f55b13400> 
MD5: f716498e51219f64bfb4afabab44a796 
SHA1: 5a9f9a54524497784c31064bdb14e25a9d7f185e 
SHA256: 62054b4aebc9da850fe32c6a056ceaa2039c5bd3f51e3f1471116792e8778ed9 CREATED: Fri Feb 11 11:18:10 2022 MODIFIED: Fri Feb 11 11:18:10 2022 ACCESSED: Fri Feb 11 11:18:56 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8df0800004883c428e95efeffffcccccccccccccccccccccccccccc
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:18:57Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 364

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:18:10                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FEZuYW3a5fDizgy7d.exe
Real Name:	/tttracer.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	7.0
ClamAV:	0
Loki:	364
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5908.679582606274
==================================================================


==================================================================
Fichier HTTP-FEZuYW3a5fDizgy7d.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FLy8Cu34Cp0Y0nxJbh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FLy8Cu34Cp0Y0nxJbh.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.68 MB
Data read: 0.64 MB (ratio 1.06:1)
Time: 44.732 sec (0 m 44 s)
Start Date: 2022:02:11 11:18:58
End Date:   2022:02:11 11:19:42

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:18:58Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FLy8Cu34Cp0Y0nxJbh.exe SCORE: 174 TYPE: EXE SIZE: 673792 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f1671afb400> 
MD5: 91a4b42dbe45d072db748b2a121f4982 
SHA1: 0c04f8d26b21b592cade665c29bc271a6ea9a136 
SHA256: 1a22fead39232589cae5bd5d4dee39b557af707f2d9d441d54c630b004139027 CREATED: Fri Feb 11 11:18:58 2022 MODIFIED: Fri Feb 11 11:18:58 2022 ACCESSED: Fri Feb 11 11:19:52 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 8db0ce862824541f40dfb767113f1e28
REASON_14: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:19:53Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1
5		BASE64_table

Score total: 174

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 91a4b42dbe45d072db748b2a121f4982                                                   |
| sha1                   | 0c04f8d26b21b592cade665c29bc271a6ea9a136                                           |
| sha256                 | 1a22fead39232589cae5bd5d4dee39b557af707f2d9d441d54c630b004139027                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FLy8Cu34Cp0Y0nxJbh.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Delete Directory:: [C0048]                                                    |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| encode data using Base64 via WinAPI                  | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (12 matches)                   | data-manipulation/encoding/xor                       |
| encrypt data using DPAPI (2 matches)                 | data-manipulation/encryption/dpapi                   |
| hash data via BCrypt (3 matches)                     | data-manipulation/hashing                            |
| hash data using fnv (10 matches)                     | data-manipulation/hashing/fnv                        |
| generate random numbers via WinAPI (3 matches)       | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| delete directory                                     | host-interaction/file-system/delete                  |
| get system information on Windows                    | host-interaction/os/info                             |
| terminate process via fastfail (3 matches)           | host-interaction/process/terminate                   |
| enumerate PE sections                                | load-code/pe                                         |
| parse PE header (71 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 15.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:18:58                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FLy8Cu34Cp0Y0nxJbh.exe
Real Name:	/NgcIsoCtnr.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Discovery::System Information Discovery [T1082;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File
10	Big_Numbers1
5	BASE64_table

============================[ Scores ]============================
CAPA:	15.0
ClamAV:	0
Loki:	174
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3057.003502127669
==================================================================


==================================================================
Fichier HTTP-FLy8Cu34Cp0Y0nxJbh.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FqEk6Y12wXoCdomMUk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FqEk6Y12wXoCdomMUk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.98 MB
Data read: 0.93 MB (ratio 1.05:1)
Time: 46.148 sec (0 m 46 s)
Start Date: 2022:02:11 11:21:12
End Date:   2022:02:11 11:21:58

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 464ef2ca59782ce697bc329713698ccc                                                   |
| sha1                   | 91e3e135a587bcf6b782dce6c548ed08cd71a677                                           |
| sha256                 | 178c7da3356a689d104bcddde9d3fb74a715b18fe27c55f43b207e9829825313                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FqEk6Y12wXoCdomMUk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (2 matches)                | collection                                           |
| encrypt data using RC4 PRGA (2 matches)              | data-manipulation/encryption/rc4                     |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| set environment variable (3 matches)                 | host-interaction/environment-variable                |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| print debug messages (3 matches)                     | host-interaction/log/debug/write-event               |
| allocate thread local storage (2 matches)            | host-interaction/process                             |
| get thread local storage value (2 matches)           | host-interaction/process                             |
| set thread local storage value (2 matches)           | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| modify access privileges                             | host-interaction/process/modify                      |
| terminate process (2 matches)                        | host-interaction/process/terminate                   |
| terminate process via fastfail (7 matches)           | host-interaction/process/terminate                   |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
1		- Discovery::System Information Discovery [T1082;1]
1.5		- Discovery::System Location Discovery [T1614;1.5]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 19.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 41/70
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:21:12                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FqEk6Y12wXoCdomMUk.exe
Real Name:	/464ef2ca59782ce697bc329713698ccc.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
5	- Privilege Escalation::Access Token Manipulation [T1134;5]
1	- Discovery::System Information Discovery [T1082;1]
1.5	- Discovery::System Location Discovery [T1614;1.5]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
70	escalate_priv
20	win_registry
65	win_token
10	win_files_operation
10	ft_exe
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_V80_Debug
70	Microsoft_Visual_Cpp_80_Debug_
70	Microsoft_Visual_Cpp_80_Debug
10	IsPE32
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
60	DebuggerException__SetConsoleCtrl_v1
40	SEH_Save
40	SEH_Init
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	19.5
ClamAV:	0
Loki:	649
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
12675.032970491557
==================================================================


==================================================================
Fichier HTTP-FqEk6Y12wXoCdomMUk.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fjp39G3E9VWB3KgIfi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2393d4f762fb671d92a59388109c24d4                                                   |
| sha1                   | 2e27346b7cff97619923c3e3199e68e7b91d142b                                           |
| sha256                 | 8d9373ebd69f42153b0b47dbda2174811599db91630651ca01627ac1795f8d56                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fjp39G3E9VWB3KgIfi.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fjp39G3E9VWB3KgIfi.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 41.644 sec (0 m 41 s)
Start Date: 2022:02:11 11:23:55
End Date:   2022:02:11 11:24:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:23:55Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fjp39G3E9VWB3KgIfi.exe SCORE: 229 TYPE: EXE SIZE: 25088 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe8c1959400> 
MD5: 2393d4f762fb671d92a59388109c24d4 
SHA1: 2e27346b7cff97619923c3e3199e68e7b91d142b 
SHA256: 8d9373ebd69f42153b0b47dbda2174811599db91630651ca01627ac1795f8d56 CREATED: Fri Feb 11 11:23:55 2022 MODIFIED: Fri Feb 11 11:23:55 2022 ACCESSED: Fri Feb 11 11:24:49 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e81b0500004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:24:49Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:23:55                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fjp39G3E9VWB3KgIfi.exe
Real Name:	/tskill.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
1	- Discovery::System Information Discovery [T1082;1]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	10.0
ClamAV:	0
Loki:	229
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3828.9316422328375
==================================================================


==================================================================
Fichier HTTP-Fjp39G3E9VWB3KgIfi.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FjNjjO1xquqLx5Lmq9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FjNjjO1xquqLx5Lmq9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.01 MB (ratio 3.67:1)
Time: 46.029 sec (0 m 46 s)
Start Date: 2022:02:11 11:24:51
End Date:   2022:02:11 11:25:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0
sh: 167: Syntax error: EOF in backquote substitution

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 57/70
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:24:51                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FjNjjO1xquqLx5Lmq9.exe
Real Name:	/Practical Malware Analysis Lab 18-01.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
65	network_dropper
10	ft_exe
2	math_entropy_close_8
5	executable_pe
70	PackerUPX_CompresorGratuito_wwwupxsourceforgenet
70	UPX_wwwupxsourceforgenet_additional
70	yodas_Protector_v1033_dllocx_Ashkbiz_Danehkar_h
70	UPX_v0896_v102_v105_v124_Markus_Laszlo_overlay
70	UPX_v0896_v102_v105_v124_Markus_Laszlo_overlay_additional
70	UPX_wwwupxsourceforgenet
30	UPXv20MarkusLaszloReiser
70	UPXV200V290MarkusOberhumerLaszloMolnarJohnReiser
70	UPX20030XMarkusOberhumerLaszloMolnarJohnReiser
10	IsPE32
10	IsConsole
10	IsPacked
10	HasRichSignature
2	PE_File
60	suspicious_packer_section
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	0
ClamAV:	0
Loki:	804
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
14742.54126738735
==================================================================


==================================================================
Fichier HTTP-FjNjjO1xquqLx5Lmq9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FXY7k84FnbtQU4fEYd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FXY7k84FnbtQU4fEYd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 1.24 MB
Data read: 1.18 MB (ratio 1.06:1)
Time: 45.251 sec (0 m 45 s)
Start Date: 2022:02:11 11:25:43
End Date:   2022:02:11 11:26:28

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:25:43Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FXY7k84FnbtQU4fEYd.exe SCORE: 139 TYPE: EXE SIZE: 1233600 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f49d6884400> 
MD5: 8c0407e6173a8292b45d14d6ee1d9ecc 
SHA1: 8c4d5ef94403a5e95aca03b062f86d17fe554b93 
SHA256: ad7e97ad48a818bd078e4f691515e05a24d8a8d865d8b3f93e1febe32efad8c1 CREATED: Fri Feb 11 11:25:43 2022 MODIFIED: Fri Feb 11 11:25:43 2022 ACCESSED: Fri Feb 11 11:26:37 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:26:40Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 139

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 8c0407e6173a8292b45d14d6ee1d9ecc                                                   |
| sha1                   | 8c4d5ef94403a5e95aca03b062f86d17fe554b93                                           |
| sha256                 | ad7e97ad48a818bd078e4f691515e05a24d8a8d865d8b3f93e1febe32efad8c1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FXY7k84FnbtQU4fEYd.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key::RC4 KSA [C0028.002]                                           |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints (4 matches)           | anti-analysis/anti-debugging/debugger-detection      |
| encode data using XOR (152 matches)                  | data-manipulation/encoding/xor                       |
| encrypt data using RC4 KSA (5 matches)               | data-manipulation/encryption/rc4                     |
| encrypt data using RC4 PRGA (5 matches)              | data-manipulation/encryption/rc4                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| enumerate PE sections (7 matches)                    | load-code/pe                                         |
| parse PE exports (6 matches)                         | load-code/pe                                         |
| parse PE header (22 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 12.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/63
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:25:43                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FXY7k84FnbtQU4fEYd.exe
Real Name:	/mfperfhelper.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	12.5
ClamAV:	0
Loki:	139
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
2452.4093268920574
==================================================================


==================================================================
Fichier HTTP-FXY7k84FnbtQU4fEYd.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fnb6bf4EQ4oGqpail2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 81d41e225b8b55748ffb0d8747fe8bac                                                   |
| sha1                   | b8359399f1751ff1affc4a3a9f90f890cb17c9ed                                           |
| sha256                 | ac6e1f614cb902c0abe4297646e21c70590624b652a080bfbb8407b1ab52609d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fnb6bf4EQ4oGqpail2.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| terminate process (3 matches)                        | host-interaction/process/terminate                   |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 7.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fnb6bf4EQ4oGqpail2.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 41.547 sec (0 m 41 s)
Start Date: 2022:02:11 11:29:00
End Date:   2022:02:11 11:29:41

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:29:00Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fnb6bf4EQ4oGqpail2.exe SCORE: 159 TYPE: EXE SIZE: 13824 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f085cf9d400> 
MD5: 81d41e225b8b55748ffb0d8747fe8bac 
SHA1: b8359399f1751ff1affc4a3a9f90f890cb17c9ed 
SHA256: ac6e1f614cb902c0abe4297646e21c70590624b652a080bfbb8407b1ab52609d CREATED: Fri Feb 11 11:29:00 2022 MODIFIED: Fri Feb 11 11:29:00 2022 ACCESSED: Fri Feb 11 11:29:53 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:29:53Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_4
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 159

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:29:00                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fnb6bf4EQ4oGqpail2.exe
Real Name:	/verclsid.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_4
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	7.0
ClamAV:	0
Loki:	159
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
2659.6485380609915
==================================================================


==================================================================
Fichier HTTP-Fnb6bf4EQ4oGqpail2.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FOMS3i2Chh0Dv4cAge.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FOMS3i2Chh0Dv4cAge.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.76 MB
Data read: 0.72 MB (ratio 1.06:1)
Time: 38.322 sec (0 m 38 s)
Start Date: 2022:02:11 11:29:55
End Date:   2022:02:11 11:30:33

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:29:55Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FOMS3i2Chh0Dv4cAge.exe SCORE: 589 TYPE: EXE SIZE: 754688 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f5374828400> 
MD5: c7f3ef97d20486e2b80583909df8ee12 
SHA1: 322414f78b35fa2d285334de26a8236a6addba01 
SHA256: 64066d51263176642765cf54943c92a2a73fdc52e23418c4819750a7934db708 CREATED: Fri Feb 11 11:29:55 2022 MODIFIED: Fri Feb 11 11:29:55 2022 ACCESSED: Fri Feb 11 11:30:43 2022 
REASON_1: Yara Rule MATCH: create_com_service SUBSCORE: 45 
DESCRIPTION: Create a COM server REF: - AUTHOR: x0r 
MATCHES: Str1: DllCanUnloadNow Str2: DllGetClassObject Str3: DllInstall Str4: DllRegisterServer Str5: DllUnregisterServer
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: VM_Detect_VirtualPC_XEN_Wine_v1 SUBSCORE: 60 
DESCRIPTION: Xen detection, VirtualPC, Red Pill, Wine and other REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: 45c70001
REASON_17: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: 45c70001
REASON_18: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: 45c70001
REASON_20: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_21: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_22: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_23: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_24: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: f777dd4ec435cf534e5ac769899e2edc Str2: 160a746f73309ce8669c4d223c272932 Str3: 7909abc2ae44f82297bc7fd4cf7bf159 Str4: bef5238a41524bf5 ... (truncated)
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:30:44Z

-------- Score ----------------
Scores		Rules
.......		...............
45		create_com_service
60		win_mutex
20		win_registry
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		VM_Detect_VirtualPC_XEN_Wine_v1
60		vmdetect_2
30		Check_OutputDebugStringA_iat_v1
60		vmdetect
30		Check_OutputDebugStringA_iat
10		anti_dbg
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1

Score total: 589

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c7f3ef97d20486e2b80583909df8ee12                                                   |
| sha1                   | 322414f78b35fa2d285334de26a8236a6addba01                                           |
| sha256                 | 64066d51263176642765cf54943c92a2a73fdc52e23418c4819750a7934db708                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FOMS3i2Chh0Dv4cAge.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location                            | collection                                           |
| encode data using XOR (7 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA (2 matches)              | data-manipulation/encryption/rc4                     |
| hash data using fnv (7 matches)                      | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| interact with driver via control codes               | host-interaction/driver                              |
| query environment variable                           | host-interaction/environment-variable                |
| check if file exists (3 matches)                     | host-interaction/file-system/exists                  |
| get file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| print debug messages (3 matches)                     | host-interaction/log/debug/write-event               |
| create mutex                                         | host-interaction/mutex                               |
| get system information on Windows                    | host-interaction/os/info                             |
| allocate thread local storage                        | host-interaction/process                             |
| get thread local storage value (2 matches)           | host-interaction/process                             |
| set thread local storage value (2 matches)           | host-interaction/process                             |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry key (2 matches)          | host-interaction/registry                            |
| query or enumerate registry value (7 matches)        | host-interaction/registry                            |
| set registry value (7 matches)                       | host-interaction/registry/create                     |
| delete registry key                                  | host-interaction/registry/delete                     |
| delete registry value (3 matches)                    | host-interaction/registry/delete                     |
| link function at runtime on Windows (7 matches)      | linking/runtime-linking                              |
| parse PE header (12 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
1.5		- Discovery::System Location Discovery [T1614;1.5]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 17.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:29:55                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FOMS3i2Chh0Dv4cAge.exe
Real Name:	/Microsoft.Uev.Office2013CustomActions.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
3	- Execution::System Services::Service Execution [T1569.002;3]
1.5	- Discovery::System Location Discovery [T1614;1.5]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
45	create_com_service
60	win_mutex
20	win_registry
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
60	VM_Detect_VirtualPC_XEN_Wine_v1
60	vmdetect_2
30	Check_OutputDebugStringA_iat_v1
60	vmdetect
30	Check_OutputDebugStringA_iat
10	anti_dbg
20	isExecutable
10	Contains_PE_File
10	Big_Numbers1

============================[ Scores ]============================
CAPA:	17.0
ClamAV:	0
Loki:	589
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
9674.215497140667
==================================================================


==================================================================
Fichier HTTP-FOMS3i2Chh0Dv4cAge.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FTAGcs4DxV5zWArC2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2ea4a7b914044f15c56acf932a1569ba                                                   |
| sha1                   | 1b40046766db3713f434d61abff529f8293f8454                                           |
| sha256                 | 989f652848f7267aaf5b22f6d1ec1453377412f1fe21a78d05bf6617f6bb8872                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FTAGcs4DxV5zWArC2.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FTAGcs4DxV5zWArC2.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 42.998 sec (0 m 42 s)
Start Date: 2022:02:11 11:32:23
End Date:   2022:02:11 11:33:06

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:32:23Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FTAGcs4DxV5zWArC2.exe SCORE: 374 TYPE: EXE SIZE: 98120 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f8403616400> 
MD5: 2ea4a7b914044f15c56acf932a1569ba 
SHA1: 1b40046766db3713f434d61abff529f8293f8454 
SHA256: 989f652848f7267aaf5b22f6d1ec1453377412f1fe21a78d05bf6617f6bb8872 CREATED: Fri Feb 11 11:32:23 2022 MODIFIED: Fri Feb 11 11:32:23 2022 ACCESSED: Fri Feb 11 11:33:09 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8f70600004883c428e95efeffffcccccccccccccccccccccccccccc
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 8db0ce862824541f40dfb767113f1e28
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:33:09Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1

Score total: 374

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:32:23                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FTAGcs4DxV5zWArC2.exe
Real Name:	/SecurityHealthHost.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File
10	Big_Numbers1

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	374
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5987.35840925363
==================================================================


==================================================================
Fichier HTTP-FTAGcs4DxV5zWArC2.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FsabMG2NXXGH2trMFk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 53cba9af8d65fadbd0f7e5f9ff15cad3                                                   |
| sha1                   | c0c1b0c563bb9eeca89e2fd6b712aba6a119ae57                                           |
| sha256                 | 6767fd66f28a1d39cb84f59e8a86b3ea99e22d204d2aac821e0d01ac232fba56                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FsabMG2NXXGH2trMFk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
| COMMUNICATION               | HTTP Communication::Download URL [C0002.006]                                  |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| receive data                                         | communication                                        |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| create process on Windows                            | host-interaction/process/create                      |
| get session user name                                | host-interaction/session                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
3		- Discovery::Account Discovery [T1087;3]

Score total: 21.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FsabMG2NXXGH2trMFk.exe: Win.Trojan.Downloader-47085 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 42.403 sec (0 m 42 s)
Start Date: 2022:02:11 11:33:10
End Date:   2022:02:11 11:33:52

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Downloader-47085

Score total: 45.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 52/67
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:33:10                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FsabMG2NXXGH2trMFk.exe
Real Name:	/Practical Malware Analysis Lab 14-01.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3	- Discovery::System Owner/User Discovery [T1033;3]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
3	- Discovery::Account Discovery [T1087;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
45	Win.Trojan.Downloader-47085

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
65	network_dropper
10	win_files_operation
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Armadillo_v4x
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsConsole
10	HasRichSignature
2	PE_File
40	SEH_Save
40	SEH_Init
20	isExecutable
10	Contains_PE_File
1	db_connection
5	BASE64_table

============================[ Scores ]============================
CAPA:	21.0
ClamAV:	45.0
Loki:	660
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
13445.816591694189
==================================================================


==================================================================
Fichier HTTP-FsabMG2NXXGH2trMFk.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FDvvet4vfoM7vjr7nf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FDvvet4vfoM7vjr7nf.exe: Win.Trojan.Hupigon-10307 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.27 MB
Data read: 0.25 MB (ratio 1.06:1)
Time: 42.042 sec (0 m 42 s)
Start Date: 2022:02:11 11:34:04
End Date:   2022:02:11 11:34:46

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Hupigon-10307

Score total: 45.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:34:04Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:34:48Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 62/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:34:04                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FDvvet4vfoM7vjr7nf.exe
Real Name:	/02179f3ba93663074740b5c0d283bae2.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
45	Win.Trojan.Hupigon-10307

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

============================[ Scores ]============================
CAPA:	0
ClamAV:	45.0
Loki:	0
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
2566.516435307375
==================================================================


==================================================================
Fichier HTTP-FDvvet4vfoM7vjr7nf.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F8OqAC39XoTvtzPXA7.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F8OqAC39XoTvtzPXA7.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.74 MB
Data read: 0.70 MB (ratio 1.06:1)
Time: 45.862 sec (0 m 45 s)
Start Date: 2022:02:11 11:34:49
End Date:   2022:02:11 11:35:35

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x92 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:34:49Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F8OqAC39XoTvtzPXA7.exe SCORE: 409 TYPE: EXE SIZE: 739840 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fc95bfea400> 
MD5: c3db7abc637f7c820f605b91fa6e1717 
SHA1: 5a494165a180868545c68e3c78b5c85ba39adecf 
SHA256: d10944c16053504739af3f1f2620fa652b2191622e826199aa69f19467aa494d CREATED: Fri Feb 11 11:34:49 2022 MODIFIED: Fri Feb 11 11:34:49 2022 ACCESSED: Fri Feb 11 11:35:40 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: ConventionEngine_Anomaly_Short_TripleChar SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453924b942710d8af5fe50dd84f5cbd77dd010000007664732e70646200
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER Str4: Identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER Str4: Identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER Str4: Identifier
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:35:42Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
50		ConventionEngine_Anomaly_Short_TripleChar
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 409

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c3db7abc637f7c820f605b91fa6e1717                                                   |
| sha1                   | 5a494165a180868545c68e3c78b5c85ba39adecf                                           |
| sha256                 | d10944c16053504739af3f1f2620fa652b2191622e826199aa69f19467aa494d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F8OqAC39XoTvtzPXA7.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Execution Guardrails::Runs as Service [E1480.m07]                             |
| FILE SYSTEM                 | Delete Directory:: [C0048]                                                    |
| OPERATING SYSTEM            | Registry::Delete Registry Key [C0036.002]                                     |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints (4 matches)           | anti-analysis/anti-debugging/debugger-detection      |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| delete directory                                     | host-interaction/file-system/delete                  |
| get storage device properties                        | host-interaction/hardware/storage                    |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| delete registry key (2 matches)                      | host-interaction/registry/delete                     |
| run as service                                       | host-interaction/service                             |
| parse PE header (9 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Execution::System Services::Service Execution [T1569.002;3]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 27.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:34:49                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F8OqAC39XoTvtzPXA7.exe
Real Name:	/vds.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
3	- Execution::System Services::Service Execution [T1569.002;3]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
50	ConventionEngine_Anomaly_Short_TripleChar
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	27.0
ClamAV:	0
Loki:	409
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
7020.933982207551
==================================================================


==================================================================
Fichier HTTP-F8OqAC39XoTvtzPXA7.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F5OXDM1vjVhNYEAfhc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3e552dc653d5a927e4dd977e726340dd                                                   |
| sha1                   | 45fa65130321f800fd88fa9119245e5a5ef81183                                           |
| sha256                 | 5f24efa8e9df2a97a19f402f2461b2ad9bd12c1d92c4fbc6f4ccd163f689dea7                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F5OXDM1vjVhNYEAfhc.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F5OXDM1vjVhNYEAfhc.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 45.224 sec (0 m 45 s)
Start Date: 2022:02:11 11:36:42
End Date:   2022:02:11 11:37:27

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:36:42Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F5OXDM1vjVhNYEAfhc.exe SCORE: 324 TYPE: EXE SIZE: 52736 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f35fb404400> 
MD5: 3e552dc653d5a927e4dd977e726340dd 
SHA1: 45fa65130321f800fd88fa9119245e5a5ef81183 
SHA256: 5f24efa8e9df2a97a19f402f2461b2ad9bd12c1d92c4fbc6f4ccd163f689dea7 CREATED: Fri Feb 11 11:36:42 2022 MODIFIED: Fri Feb 11 11:36:42 2022 ACCESSED: Fri Feb 11 11:37:34 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:37:34Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 324

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:36:42                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F5OXDM1vjVhNYEAfhc.exe
Real Name:	/LanguageComponentsInstallerComHandler.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	324
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5194.911813023074
==================================================================


==================================================================
Fichier HTTP-F5OXDM1vjVhNYEAfhc.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F1rYPv4rz8arnC3Y8e.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be a .NET module.
WARNING:capa: 
WARNING:capa: .NET is a cross-platform framework for running managed applications.
WARNING:capa: capa cannot handle non-native files. This means that the results may be misleading or incomplete.
WARNING:capa: You may have to analyze the file manually, using a tool like the .NET decompiler dnSpy.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) dotnet file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F1rYPv4rz8arnC3Y8e.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 35.615 sec (0 m 35 s)
Start Date: 2022:02:11 11:37:36
End Date:   2022:02:11 11:38:11

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:37:36Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F1rYPv4rz8arnC3Y8e.exe SCORE: 174 TYPE: EXE SIZE: 19456 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f07ca543400> 
MD5: 2d76a5b22e9a23cd978f9e983e5b445e 
SHA1: 67d13b4441118c841b7fc663d2eb1daa84fa87a2 
SHA256: 1fc1c966618f3de21f51f5e4bc5c658cec61532af64379e6701fb5d73899e137 CREATED: Fri Feb 11 11:37:36 2022 MODIFIED: Fri Feb 11 11:37:36 2022 ACCESSED: Fri Feb 11 11:38:13 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: dotnet_libraries SUBSCORE: 5 
DESCRIPTION: .Net runtime mscoree.dll mscorwks.dll REF: - AUTHOR: - 
MATCHES: Str1: mscoree.dll Str2: _CorDllMain
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_C_Basic_NET SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: ff2500200010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
REASON_6: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsNET_DLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:38:13Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_4
5		dotnet_libraries
5		executable_pe
70		Microsoft_Visual_C_Basic_NET
10		IsPE32
10		IsNET_DLL
10		IsDLL
10		IsConsole
10		HasDebugData
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 174

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:37:36                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F1rYPv4rz8arnC3Y8e.exe
Real Name:	/Microsoft.Uev.SyncCommon.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_4
5	dotnet_libraries
5	executable_pe
70	Microsoft_Visual_C_Basic_NET
10	IsPE32
10	IsNET_DLL
10	IsDLL
10	IsConsole
10	HasDebugData
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	0
ClamAV:	0
Loki:	174
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
2757.714154882337
==================================================================


==================================================================
Fichier HTTP-F1rYPv4rz8arnC3Y8e.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FgstC13JOQDUzHV8db.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c277798eb447730580ad21ea647b9d36                                                   |
| sha1                   | a38373fde7a13bfa784003fa8efed0dc784debab                                           |
| sha256                 | 49d5cc85b8f66cdb238ed1d4bb46709b975f1627acfc934385271ed3be6f77d1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FgstC13JOQDUzHV8db.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::File Transfer Protocol \[T1071.002]\                   |
|                        | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | FTP Communication::Send File [C0004.001]                                      |
|                             | FTP Communication::WinINet [C0004.002]                                        |
|                             | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| send file using FTP via wininet (2 matches)          | communication/ftp/send                               |
| connect to HTTP server (2 matches)                   | communication/http/client                            |
| initialize Winsock library                           | communication/socket                                 |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| write file on Windows                                | host-interaction/file-system/write                   |
| get hostname                                         | host-interaction/os/hostname                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
2		- Discovery::File and Directory Discovery [T1083;2]
6		- Command and Control::Application Layer Protocol::File Transfer Protocol [T1071.002;6]

Score total: 21.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FgstC13JOQDUzHV8db.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 44.063 sec (0 m 44 s)
Start Date: 2022:02:11 11:38:14
End Date:   2022:02:11 11:38:59

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 42/70
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:38:14                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FgstC13JOQDUzHV8db.exe
Real Name:	/Practical Malware Analysis Lab 20-02.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1	- Discovery::System Information Discovery [T1082;1]
2	- Discovery::File and Directory Discovery [T1083;2]
6	- Command and Control::Application Layer Protocol::File Transfer Protocol [T1071.002;6]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	ft_exe
2	math_entropy_4
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Installer_VISE_Custom_additional
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Installer_VISE_Custom
70	Armadillo_v4x
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
40	SEH_Save
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	21.0
ClamAV:	0
Loki:	759
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
14448.344416923315
==================================================================


==================================================================
Fichier HTTP-FgstC13JOQDUzHV8db.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FtlUJo3GzWUeSAIHQ9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 58e8cbd053e64539fcd87bd08ab89d1b                                                   |
| sha1                   | 70fa7d97a39cc1610a2d66d8aa227e33f5dc1a36                                           |
| sha256                 | 6e71d0bb7fa0f02071460c55433209794f95f81058186142155de0330915b3c7                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FtlUJo3GzWUeSAIHQ9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:39:00Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FtlUJo3GzWUeSAIHQ9.exe SCORE: 109 TYPE: EXE SIZE: 6144 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f32a7c0c400> 
MD5: 58e8cbd053e64539fcd87bd08ab89d1b 
SHA1: 70fa7d97a39cc1610a2d66d8aa227e33f5dc1a36 
SHA256: 6e71d0bb7fa0f02071460c55433209794f95f81058186142155de0330915b3c7 CREATED: Fri Feb 11 11:39:00 2022 MODIFIED: Fri Feb 11 11:39:00 2022 ACCESSED: Fri Feb 11 11:39:28 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_3 SUBSCORE: 2 
DESCRIPTION: Low entropy - very sparse data or repeating plaintext REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 10 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:39:28Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_3
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		ImportTableIsBad
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 109

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FtlUJo3GzWUeSAIHQ9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.00 MB
Data read: 0.00 MB (ratio 1.00:1)
Time: 44.556 sec (0 m 44 s)
Start Date: 2022:02:11 11:39:00
End Date:   2022:02:11 11:39:44

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:39:00                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FtlUJo3GzWUeSAIHQ9.exe
Real Name:	/microsoft-windows-storage-tiering-events.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_3
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	ImportTableIsBad
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	1.0
ClamAV:	0
Loki:	109
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
1747.4862029323024
==================================================================


==================================================================
Fichier HTTP-FtlUJo3GzWUeSAIHQ9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FHsDgI3Led1YfZzuNb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 14d4bdcc5f0fe917abde4b01e39a350e                                                   |
| sha1                   | a2a7352960517502487fb46253a057f51872625e                                           |
| sha256                 | 435be1c6e904836ad65f97f3eac4cbe19ee7ba0da48178fc7f00206270469165                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FHsDgI3Led1YfZzuNb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Indicator Removal on Host::File Deletion \[T1070.004]\                             |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter::Windows Command Shell \[T1059.003]\             |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
|                             | Interprocess Communication::Create Pipe [C0003.001]                           |
|                             | Interprocess Communication::Read Pipe [C0003.003]                             |
| DATA                        | Encode Data::Base64 [C0026.001]                                               |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Self Deletion::COMSPEC Environment Variable [F0007.001]                       |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| self delete                                          | anti-analysis/anti-forensic/self-deletion            |
| execute shell command and capture output             | c2/shell                                             |
| receive data                                         | communication                                        |
| create two anonymous pipes                           | communication/named-pipe/create                      |
| read pipe                                            | communication/named-pipe/read                        |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| create process on Windows (2 matches)                | host-interaction/process/create                      |
| terminate process                                    | host-interaction/process/terminate                   |
| terminate thread (5 matches)                         | host-interaction/thread/terminate                    |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
5		- Execution::Command and Scripting Interpreter::Windows Command Shell [T1059.003;5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
8.5		- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 32.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FHsDgI3Led1YfZzuNb.exe: Win.Trojan.Agent-648031 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.00 MB
Data read: 0.00 MB (ratio 1.00:1)
Time: 42.624 sec (0 m 42 s)
Start Date: 2022:02:11 11:39:45
End Date:   2022:02:11 11:40:27

-------- Score ----------------
Scores		Rules
.......		...............
70		Win.Trojan.Agent-648031
75		Win.Trojan.Agent-648031
45		Win.Trojan.Agent-648031

Score total: 190.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:39:45Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FHsDgI3Led1YfZzuNb.exe SCORE: 499 TYPE: EXE SIZE: 6656 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb094ce5400> 
MD5: 14d4bdcc5f0fe917abde4b01e39a350e 
SHA1: a2a7352960517502487fb46253a057f51872625e 
SHA256: 435be1c6e904836ad65f97f3eac4cbe19ee7ba0da48178fc7f00206270469165 CREATED: Fri Feb 11 11:39:45 2022 MODIFIED: Fri Feb 11 11:39:45 2022 ACCESSED: Fri Feb 11 11:40:39 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile
REASON_2: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_3: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetOpen
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff68e820400068801b400064a100000000506489250000000083ec68535657
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68e820400068801b400064a10000000050
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68e820400068801b400064a10000000050
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6a Str2: 558bec6aff68e820400068801b400064a10000000050
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68e820400068801b400064a1000000005064892500000000
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:40:39Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 499

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 46/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:39:45                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FHsDgI3Led1YfZzuNb.exe
Real Name:	/Practical Malware Analysis Lab 14-02.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
5	- Execution::Command and Scripting Interpreter::Windows Command Shell [T1059.003;5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1	- Discovery::System Information Discovery [T1082;1]
8.5	- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
70	Win.Trojan.Agent-648031
75	Win.Trojan.Agent-648031
45	Win.Trojan.Agent-648031

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	32.5
ClamAV:	190.0
Loki:	499
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
12949.03556515476
==================================================================


==================================================================
Fichier HTTP-FHsDgI3Led1YfZzuNb.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FZEQwR3Ez4WZWrVUVk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9b0bf8d01b0fe7132f7bc6eb031eb46d                                                   |
| sha1                   | 200e768832b3d1bf345d930d1328f0528399c0c4                                           |
| sha256                 | 3ef4edafe8d587a91ef023b470e84b2b05c0327d4ca6701a34d5e0ab0ad0bbfc                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FZEQwR3Ez4WZWrVUVk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FZEQwR3Ez4WZWrVUVk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 45.267 sec (0 m 45 s)
Start Date: 2022:02:11 11:40:40
End Date:   2022:02:11 11:41:26

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:40:41Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FZEQwR3Ez4WZWrVUVk.exe SCORE: 109 TYPE: EXE SIZE: 35840 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f096d808400> 
MD5: 9b0bf8d01b0fe7132f7bc6eb031eb46d 
SHA1: 200e768832b3d1bf345d930d1328f0528399c0c4 
SHA256: 3ef4edafe8d587a91ef023b470e84b2b05c0327d4ca6701a34d5e0ab0ad0bbfc CREATED: Fri Feb 11 11:40:40 2022 MODIFIED: Fri Feb 11 11:40:40 2022 ACCESSED: Fri Feb 11 11:41:34 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_3 SUBSCORE: 2 
DESCRIPTION: Low entropy - very sparse data or repeating plaintext REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 10 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:41:34Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_3
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		ImportTableIsBad
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 109

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:40:40                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FZEQwR3Ez4WZWrVUVk.exe
Real Name:	/pifmgr.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_3
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	ImportTableIsBad
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	1.0
ClamAV:	0
Loki:	109
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
1747.4862029323024
==================================================================


==================================================================
Fichier HTTP-FZEQwR3Ez4WZWrVUVk.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FgYJ8i17tLW3v5YnI2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e5d1458bc7802b7647ee4bf7eafa0e20                                                   |
| sha1                   | e942f73990453954f8852a6d4128e929a7c236f0                                           |
| sha256                 | 21406ebfb9f68e56b75045a0b9c78a6b5c5a843f3ca22ee56cacd561f721913a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FgYJ8i17tLW3v5YnI2.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | System Services::Service Execution \[T1569.002]\                                   |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes               | host-interaction/driver                              |
| modify access privileges                             | host-interaction/process/modify                      |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Execution::System Services::Service Execution [T1569.002;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]

Score total: 9.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FgYJ8i17tLW3v5YnI2.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 45.130 sec (0 m 45 s)
Start Date: 2022:02:11 11:41:35
End Date:   2022:02:11 11:42:20

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:41:36Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FgYJ8i17tLW3v5YnI2.exe SCORE: 294 TYPE: EXE SIZE: 27448 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fccc0809400> 
MD5: e5d1458bc7802b7647ee4bf7eafa0e20 
SHA1: e942f73990453954f8852a6d4128e929a7c236f0 
SHA256: 21406ebfb9f68e56b75045a0b9c78a6b5c5a843f3ca22ee56cacd561f721913a CREATED: Fri Feb 11 11:41:35 2022 MODIFIED: Fri Feb 11 11:41:35 2022 ACCESSED: Fri Feb 11 11:42:29 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: DuplicateTokenEx Str3: AdjustTokenPrivileges Str4: OpenProcessToken
REASON_4: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:42:30Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
65		win_token
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 294

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:41:35                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FgYJ8i17tLW3v5YnI2.exe
Real Name:	/streamci.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
3	- Execution::System Services::Service Execution [T1569.002;3]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
5	- Privilege Escalation::Access Token Manipulation [T1134;5]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
70	escalate_priv
20	win_registry
65	win_token
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsWindowsGUI
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	9.0
ClamAV:	0
Loki:	294
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4839.159594182873
==================================================================


==================================================================
Fichier HTTP-FgYJ8i17tLW3v5YnI2.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FSSfnH1LLzH30gYKx6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | fedbac964787ad4898109a744fb6ec02                                                   |
| sha1                   | 1daea40e923ee1fd8c5832274cdd478a45685e46                                           |
| sha256                 | 743f8e8a91b2d1e0db9323109034de91a1e065242a33a90bb787a63edb860b35                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FSSfnH1LLzH30gYKx6.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | ICMP Communication::Echo Request [C0014.002]                                  |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| send ICMP echo request                               | communication/icmp                                   |
| initialize Winsock library                           | communication/socket                                 |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| resolve DNS (2 matches)                              | host-interaction/network/dns/resolve                 |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Network Configuration Discovery [T1016;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 11.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FSSfnH1LLzH30gYKx6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 31.617 sec (0 m 31 s)
Start Date: 2022:02:11 11:42:31
End Date:   2022:02:11 11:43:03

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:42:31Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FSSfnH1LLzH30gYKx6.exe SCORE: 239 TYPE: EXE SIZE: 18432 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f172a780400> 
MD5: fedbac964787ad4898109a744fb6ec02 
SHA1: 1daea40e923ee1fd8c5832274cdd478a45685e46 
SHA256: 743f8e8a91b2d1e0db9323109034de91a1e065242a33a90bb787a63edb860b35 CREATED: Fri Feb 11 11:42:31 2022 MODIFIED: Fri Feb 11 11:42:31 2022 ACCESSED: Fri Feb 11 11:43:12 2022 
REASON_1: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e86b0200004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:43:13Z

-------- Score ----------------
Scores		Rules
.......		...............
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 239

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/69
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:42:31                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FSSfnH1LLzH30gYKx6.exe
Real Name:	/TRACERT.EXE
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
3	- Discovery::System Network Configuration Discovery [T1016;3]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	Str_Win32_Winsock2_Library
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	11.5
ClamAV:	0
Loki:	239
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4017.349896203482
==================================================================


==================================================================
Fichier HTTP-FSSfnH1LLzH30gYKx6.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fj3OvcaTXskL6vVEl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | dc61643cd353aa826f2b8df06422b266                                                   |
| sha1                   | 7ec8f511717a71f692a79a27e348c6654d0d6f40                                           |
| sha256                 | 27858972c18afccd944453b72feeeba66b1587f2075087780aa4fc54202d8221                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fj3OvcaTXskL6vVEl.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-VM instructions (9 matches)             | anti-analysis/anti-vm/vm-detection                   |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail                       | host-interaction/process/terminate                   |
| query or enumerate registry value                    | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| enumerate PE sections (9 matches)                    | load-code/pe                                         |
| parse PE header (5 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::Query Registry [T1012;1]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 13.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fj3OvcaTXskL6vVEl.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 44.812 sec (0 m 44 s)
Start Date: 2022:02:11 11:43:14
End Date:   2022:02:11 11:43:59

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:43:14Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fj3OvcaTXskL6vVEl.exe SCORE: 234 TYPE: EXE SIZE: 76600 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f07b7ce3400> 
MD5: dc61643cd353aa826f2b8df06422b266 
SHA1: 7ec8f511717a71f692a79a27e348c6654d0d6f40 
SHA256: 27858972c18afccd944453b72feeeba66b1587f2075087780aa4fc54202d8221 CREATED: Fri Feb 11 11:43:14 2022 MODIFIED: Fri Feb 11 11:43:14 2022 ACCESSED: Fri Feb 11 11:44:07 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:44:07Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 234

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:43:14                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fj3OvcaTXskL6vVEl.exe
Real Name:	/PSHED.DLL
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::Query Registry [T1012;1]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsDLL
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	13.0
ClamAV:	0
Loki:	234
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3968.0341713049593
==================================================================


==================================================================
Fichier HTTP-Fj3OvcaTXskL6vVEl.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FZobOD3yXwHeqsNgFg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | dafbea2a91f86bf5e52efa3bac3f1b16                                                   |
| sha1                   | 6a41735369934a212fc90dbd8c847c26270b3fba                                           |
| sha256                 | 1fb3c4a9109ef171fa67bdf90e67f09ef25b5a1d401dc20dc45cfccf1e4fbd99                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FZobOD3yXwHeqsNgFg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get common file path                                 | host-interaction/file-system                         |
| inject dll                                           | host-interaction/process/inject                      |
| inject thread                                        | host-interaction/process/inject                      |
| link function at runtime on Windows                  | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::File and Directory Discovery [T1083;2]
5		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
2		- Execution::Shared Modules [T1129;2]
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]

Score total: 15.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FZobOD3yXwHeqsNgFg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 45.293 sec (0 m 45 s)
Start Date: 2022:02:11 11:44:08
End Date:   2022:02:11 11:44:54

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 52/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:44:08                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FZobOD3yXwHeqsNgFg.exe
Real Name:	/Practical Malware Analysis Lab 12-01.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Discovery::File and Directory Discovery [T1083;2]
5	- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
2	- Execution::Shared Modules [T1129;2]
6	- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	inject_thread
10	ft_exe
2	math_entropy_3
5	executable_pe
15	dll_injection_thread
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Armadillo_v4x
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsConsole
10	HasRichSignature
2	PE_File
45	Inject_Thread
40	SEH_Save
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	15.0
ClamAV:	0
Loki:	689
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
13219.203443302404
==================================================================


==================================================================
Fichier HTTP-FZobOD3yXwHeqsNgFg.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FhP9eu4FZirNVidpe5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c9d776b6a4bc22b5b9a0985ab9cd6101                                                   |
| sha1                   | fc72d96df9d0e61a0458280290b27165258d735c                                           |
| sha256                 | 81765113b2df32f13ef09fc96645c183f6064b27fcf4f3a3575088f016bbb5a5                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FhP9eu4FZirNVidpe5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| write file on Windows                                | host-interaction/file-system/write                   |
| get token membership                                 | host-interaction/session                             |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Owner/User Discovery [T1033;3]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 6.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FhP9eu4FZirNVidpe5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 45.013 sec (0 m 45 s)
Start Date: 2022:02:11 11:44:55
End Date:   2022:02:11 11:45:40

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:44:55Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FhP9eu4FZirNVidpe5.exe SCORE: 229 TYPE: EXE SIZE: 18944 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fcc3aa48400> 
MD5: c9d776b6a4bc22b5b9a0985ab9cd6101 
SHA1: fc72d96df9d0e61a0458280290b27165258d735c 
SHA256: 81765113b2df32f13ef09fc96645c183f6064b27fcf4f3a3575088f016bbb5a5 CREATED: Fri Feb 11 11:44:55 2022 MODIFIED: Fri Feb 11 11:44:55 2022 ACCESSED: Fri Feb 11 11:45:46 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e86b0200004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:45:46Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:44:55                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FhP9eu4FZirNVidpe5.exe
Real Name:	/ktmutil.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
3	- Discovery::System Owner/User Discovery [T1033;3]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	6.0
ClamAV:	0
Loki:	229
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3749.121149634082
==================================================================


==================================================================
Fichier HTTP-FhP9eu4FZirNVidpe5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FupAwj4q5xiDqdCWE.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9a77a7b2a0857916a97ffaac7695314b                                                   |
| sha1                   | 3d0de37b9c6b70a3c92dadcb4d4dcfda96da9527                                           |
| sha256                 | 2a9934712bcd65573605a90cd362c8c237f75d395b053df0c0d02d532b5bc405                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FupAwj4q5xiDqdCWE.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| encode data using XOR (7 matches)                    | data-manipulation/encoding/xor                       |
| hash data using fnv (7 matches)                      | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 6.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FupAwj4q5xiDqdCWE.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 39.166 sec (0 m 39 s)
Start Date: 2022:02:11 11:45:47
End Date:   2022:02:11 11:46:26

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:45:47Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FupAwj4q5xiDqdCWE.exe SCORE: 109 TYPE: EXE SIZE: 93696 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f363349d400> 
MD5: 9a77a7b2a0857916a97ffaac7695314b 
SHA1: 3d0de37b9c6b70a3c92dadcb4d4dcfda96da9527 
SHA256: 2a9934712bcd65573605a90cd362c8c237f75d395b053df0c0d02d532b5bc405 CREATED: Fri Feb 11 11:45:47 2022 MODIFIED: Fri Feb 11 11:45:47 2022 ACCESSED: Fri Feb 11 11:46:41 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: c3181255b064f97f09581282d90d484a Str2: 76c43bbe81a798c7cbe5d5cf5684e32d
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:46:41Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1

Score total: 109

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:45:47                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FupAwj4q5xiDqdCWE.exe
Real Name:	/MosHostClient.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File
10	Big_Numbers1

============================[ Scores ]============================
CAPA:	6.0
ClamAV:	0
Loki:	109
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
1847.2493186807462
==================================================================


==================================================================
Fichier HTTP-FupAwj4q5xiDqdCWE.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fwt5YC4HDTK2wywfBh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fwt5YC4HDTK2wywfBh.exe: Win.Dropper.ClipBanker-9778171-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-Fwt5YC4HDTK2wywfBh.exe: Win.Tool.Mimikatz-9862700-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-Fwt5YC4HDTK2wywfBh.exe: Win.Trojan.Mimikatz-6466236-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.82 MB
Data read: 0.77 MB (ratio 1.06:1)
Time: 45.347 sec (0 m 45 s)
Start Date: 2022:02:11 11:46:42
End Date:   2022:02:11 11:47:28

-------- Score ----------------
Scores		Rules
.......		...............
30		Win.Dropper.ClipBanker-9778171-0
10		Win.Tool.Mimikatz-9862700-0
45		Win.Trojan.Mimikatz-6466236-0

Score total: 85.0
sh: 1: gentilkiwi: not found

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 79: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 70: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 63: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x86 in position 58: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x86 in position 40: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:46:42Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fwt5YC4HDTK2wywfBh.exe SCORE: 2011 TYPE: EXE SIZE: 808600 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fac86613400> 
MD5: 5f66b82558ca92e54e77f216ef4c066c 
SHA1: e4f82e4d7f22938dc0a0ff8a4a7ad2a763643d38 
SHA256: 131314a6f6d1d263c75b9909586b3e1bd837036329ace5e69241749e861ac01d CREATED: Fri Feb 11 11:46:42 2022 MODIFIED: Fri Feb 11 11:46:42 2022 ACCESSED: Fri Feb 11 11:47:34 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_2: Yara Rule MATCH: create_service SUBSCORE: 45 
DESCRIPTION: Create a windows service REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: CreateService Str4: ControlService Str5: StartService Str6: QueryServiceStatus
REASON_3: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: DNSAPI.dll Str2: DnsQuery
REASON_4: Yara Rule MATCH: cred_local SUBSCORE: 80 
DESCRIPTION: Steal credential REF: - AUTHOR: x0r 
MATCHES: Str1: SamIConnect Str2: SamQueryInformationUse Str3: CredEnumerateW
REASON_5: Yara Rule MATCH: spreading_share SUBSCORE: 70 
DESCRIPTION: Malware can spread east-west using share drive REF: - AUTHOR: x0r 
MATCHES: Str1: NETAPI32.dll Str2: netapi32.dll Str3: NetShareEnum
REASON_6: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_7: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: RegCloseKey
REASON_8: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: DuplicateTokenEx Str4: OpenProcessToken
REASON_9: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CreateFileA Str7: FindClose
REASON_10: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_11: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: hacktool_windows_mimikatz_copywrite SUBSCORE: 50 
DESCRIPTION: Mimikatz credential dump tool: Author copywrite REF: https://github.com/gentilkiwi/mimikatz AUTHOR: @fusionrace 
MATCHES: Str1: Benjamin DELPY  Str2: http://blog.gentilkiwi.com/mimikatz Str3: http://blog.gentilkiwi.com/mimikatz Str4: Build with love ... (truncated)
REASON_13: Yara Rule MATCH: hacktool_windows_mimikatz_modules SUBSCORE: 50 
DESCRIPTION: Mimikatz credential dump tool: Modules REF: https://github.com/gentilkiwi/mimikatz AUTHOR: @fusionrace 
MATCHES: Str1: mimidrv
REASON_14: Yara Rule MATCH: Powerkatz_DLL_Generic SUBSCORE: 80 
DESCRIPTION: Detects Powerkatz - a Mimikatz version prepared to run in memory via Powershell (overlap with other Mimikatz versions is possible) REF: PowerKatz Analysis AUTHOR: Florian Roth 
MATCHES: Str1: kuhl_m_lsadump_getUsersAndSamKey ; kull_m_registry_RegOpenKeyEx SAM Accounts (0x%08x) Str2: kuhl_m_lsadump_getComputerAndSyskey ; kuh ... (truncated)
REASON_15: Yara Rule MATCH: HackTool_Producers SUBSCORE: 50 
DESCRIPTION: Hacktool Producers String REF: - AUTHOR: - 
MATCHES: Str1: gentilkiwi.com
REASON_16: Yara Rule MATCH: mimikatz SUBSCORE: 70 
DESCRIPTION: mimikatz REF: - AUTHOR: Benjamin DELPY (gentilkiwi) 
MATCHES: Str1: 89710489308d04bd Str2: 8b4de48b45f48975e8890185ff74 Str3: 8b4de88b45f48975ec890185ff74
REASON_17: Yara Rule MATCH: Mimikatz_Strings SUBSCORE: 65 
DESCRIPTION: Detects Mimikatz strings REF: not set AUTHOR: Florian Roth 
MATCHES: Str1: List tickets in MIT/Heimdall ccache Str2: kuhl_m_kerberos_ptt_file ; LsaCallKerberosPackage %08x Str3: * Injecting ticket : Str4: mim ... (truncated)
REASON_18: Yara Rule MATCH: Mimikatz_Gen_Strings SUBSCORE: 70 
DESCRIPTION: Detects Mimikatz by using some special strings REF: Internal Research AUTHOR: Florian Roth 
MATCHES: Str1: [*] '%s' service already started Str2: ** Security Callback! ** Str3: Try to export a software CA to a crypto (virtual)hardware Str4: ... (truncated)
REASON_19: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645ea00c645eb00c645ec00c645 Str2: c645eb00c645ec00c645ed00c645 Str3: c645f819c645f917c645fa16c645 Str4: c645a060c645a1bac645a24fc645 ... (truncated)
REASON_21: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_22: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_23: Yara Rule MATCH: Visual_Cpp_2005_Release_Microsoft SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8ce98ffffe9a1fdffff Str2: e84640ffffe92cfdffff Str3: e81f65feffe965fdffff Str4: e85dcafeffe958fdffff Str5: e8f3c8feffe956fdffff Str6 ... (truncated)
REASON_24: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e803e4ffffe9bffeffff Str2: e80a000000e971ffffff Str3: e804894508e954ffffff Str4: e872e1ffffe900ffffff Str5: e81b930200e90cffffff Str6 ... (truncated)
REASON_25: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_26: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_27: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_28: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_29: Yara Rule MATCH: HasDigitalSignature SUBSCORE: 10 
DESCRIPTION: DigitalSignature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 982c00000002020030822c8906092a864886f70d010702a0822c7a30822c76020101310b300906052b0e03021a0500304c060a2b060104018237020104a03e303c301 ... (truncated)
REASON_30: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_31: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_32: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: IDENTIFIER Str2: Identifier
REASON_33: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: IDENTIFIER Str2: Identifier
REASON_34: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: IDENTIFIER Str2: Identifier
REASON_35: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_36: Yara Rule MATCH: DLL_inject SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: LoadLibraryA Str4: CreateFileA Str5: WriteProcessMemory Str6: HeapAlloc Str7: GetProcAddress S ... (truncated)
REASON_37: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_38: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_39: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_40: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_41: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_42: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_43: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_44: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_45: Yara Rule MATCH: with_sqlite SUBSCORE: 60 
DESCRIPTION: Rule to detect the presence of SQLite data in raw image REF: http://www.st2labs.com AUTHOR: Julian J. Gonzalez <info@seguridadparatodos.es> 
MATCHES: Str1: SQLite format 3
REASON_46: Yara Rule MATCH: INDICATOR_TOOL_PWS_Mimikatz SUBSCORE: 70 
DESCRIPTION: Detects Mimikatz REF: - AUTHOR: ditekSHen 
MATCHES: Str1: mimikatz Str2: mimikatz Str3: \mimidrv Str4: mimidrv
REASON_47: Yara Rule MATCH: INDICATOR_SUSPICIOUS_EXE_SQLQuery_ConfidentialDataStore SUBSCORE: 70 
DESCRIPTION: Detects executables containing SQL queries to confidential data stores. Observed in infostealers REF: - AUTHOR: ditekSHen 
MATCHES: Str1: SELECT  Str2: select  Str3:  from logins Str4:  from cookies Str5: NAME Str6: Name Str7: NAME Str8: name Str9: name Str10: Name Str11 ... (truncated)
REASON_48: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_49: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_50: Yara Rule MATCH: db_structure SUBSCORE: 1 
DESCRIPTION: not set REF: https://github.com/kevthehermit/PasteHunter AUTHOR: @KevTheHermit 
MATCHES: Str1: CREATE TABLE Str2: INSERT INTO Str3: VALUES Str4: values Str5: Values Str6: NOT NULL Str7: PRIMARY KEY
REASON_51: Yara Rule MATCH: db_connection SUBSCORE: 1 
DESCRIPTION: not set REF: https://github.com/kevthehermit/PasteHunter AUTHOR: @KevTheHermit 
MATCHES: Str1: 687474703a2f2f63726c2e63657274756d2e706c2f63746e63612e63726c306b06082b06010505070101045f305d302806082b06010505073001861c687474703a2f2 ... (truncated)
REASON_52: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00112233445566778899
REASON_53: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 0123456789ABCDEF0123456789abcdef
REASON_54: Yara Rule MATCH: Big_Numbers3 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 64:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: bd49a8271d650fa89e446b42e513b595a717b9212c91dd384aab871fc1d0f6d7
REASON_55: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext Str6: CryptAcquireContext
REASON_56: Yara Rule MATCH: MD5_API SUBSCORE: 25 
DESCRIPTION: Looks for MD5 API REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: cryptdll.dll Str4: cryptdll.dll Str5: MD5Init Str6: MD5Update Str7: MD5Final
REASON_57: Yara Rule MATCH: DES_Long SUBSCORE: 15 
DESCRIPTION: DES [long] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 10801040000000000080100000001040100000401080000000800040008010000080000010001040100000000080004010001000008010400000104010000000
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:47:37Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
45		create_service
50		network_dns
80		cred_local
70		spreading_share
60		win_mutex
20		win_registry
65		win_token
10		win_files_operation
10		misc_pe_signature
10		ft_exe
50		hacktool_windows_mimikatz_copywrite
50		hacktool_windows_mimikatz_modules
80		Powerkatz_DLL_Generic
50		HackTool_Producers
70		mimikatz
65		Mimikatz_Strings
70		Mimikatz_Gen_Strings
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
15		dll_injection_thread
70		Visual_Cpp_2005_Release_Microsoft
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsConsole
10		HasOverlay
10		HasDigitalSignature
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
40		DLL_inject
45		Inject_Thread
60		Debugger_Check__QueryInfo
60		DebuggerException__SetConsoleCtrl_v1
30		Check_OutputDebugStringA_iat_v1
40		SEH_Save
40		SEH_Init
30		Check_OutputDebugStringA_iat
10		anti_dbg
60		with_sqlite
70		INDICATOR_TOOL_PWS_Mimikatz
70		INDICATOR_SUSPICIOUS_EXE_SQLQuery_ConfidentialDataStore
20		isExecutable
10		Contains_PE_File
1		db_structure
1		db_connection
10		Big_Numbers0
10		Big_Numbers1
10		Big_Numbers3
20		Advapi_Hash_API
25		MD5_API
15		DES_Long

Score total: 2011

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5f66b82558ca92e54e77f216ef4c066c                                                   |
| sha1                   | e4f82e4d7f22938dc0a0ff8a4a7ad2a763643d38                                           |
| sha256                 | 131314a6f6d1d263c75b9909586b3e1bd837036329ace5e69241749e861ac01d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fwt5YC4HDTK2wywfBh.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Archive Collected Data::Archive via Library \[T1560.002]\                          |
|                        | Clipboard Data:: \[T1115]\                                                         |
|                        | Data from Information Repositories:: \[T1213]\                                     |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| CREDENTIAL ACCESS      | Credentials from Password Stores::Windows Credential Manager \[T1555.004]\         |
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Indicator Removal on Host::Clear Windows Event Logs \[T1070.001]\                  |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Domain Trust Discovery:: \[T1482]\                                                 |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Network Share Discovery:: \[T1135]\                                                |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
|                        | System Network Configuration Discovery :: \[T1016]\                                |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Execution Guardrails::Runs as Service [E1480.m07]                             |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | Interprocess Communication::Create Pipe [C0003.001]                           |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::3DES [C0027.004]                                                |
|                             | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Compress Data:: [C0024]                                                       |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| DISCOVERY                   | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Console:: [C0033]                                                             |
|                             | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| clear the Windows event log                          | anti-analysis/anti-forensic/clear-logs               |
| contain obfuscated stackstrings (4 matches)          | anti-analysis/obfuscation/string/stackstring         |
| acquire credentials from Windows Credential Manager  | collection                                           |
| reference SQL statements (2 matches)                 | collection/database/sql                              |
| get domain trust relationships                       | collection/network                                   |
| check HTTP status code                               | communication/http/client                            |
| create pipe                                          | communication/named-pipe/create                      |
| listen for remote procedure calls (2 matches)        | communication/rpc/server                             |
| compress data via WinAPI                             | data-manipulation/compression                        |
| decode data using Base64 via WinAPI (2 matches)      | data-manipulation/encoding/base64                    |
| encode data using Base64 via WinAPI (2 matches)      | data-manipulation/encoding/base64                    |
| encode data using XOR (14 matches)                   | data-manipulation/encoding/xor                       |
| create new key via CryptAcquireContext (20 matches)  | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt (13 matches)         | data-manipulation/encryption                         |
| get outbound credentials handle via CredSSP          | data-manipulation/encryption                         |
| encrypt data using DES via WinAPI (2 matches)        | data-manipulation/encryption/des                     |
| encrypt data using DPAPI (2 matches)                 | data-manipulation/encryption/dpapi                   |
| encrypt data using RC4 PRGA (5 matches)              | data-manipulation/encryption/rc4                     |
| encrypt data using RC4 via WinAPI                    | data-manipulation/encryption/rc4                     |
| hash data via WinCrypt (4 matches)                   | data-manipulation/hashing                            |
| hash data using SHA1                                 | data-manipulation/hashing/sha1                       |
| hash data using SHA1 via WinCrypt                    | data-manipulation/hashing/sha1                       |
| authenticate HMAC (2 matches)                        | data-manipulation/hmac                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments (2 matches)            | host-interaction/cli                                 |
| read clipboard data                                  | host-interaction/clipboard                           |
| manipulate console                                   | host-interaction/console                             |
| interact with driver via control codes               | host-interaction/driver                              |
| query environment variable                           | host-interaction/environment-variable                |
| get common file path (4 matches)                     | host-interaction/file-system                         |
| delete file (2 matches)                              | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| get file size                                        | host-interaction/file-system/meta                    |
| get file version info                                | host-interaction/file-system/meta                    |
| read file on Windows (8 matches)                     | host-interaction/file-system/read                    |
| read file via mapping                                | host-interaction/file-system/read                    |
| write file on Windows (5 matches)                    | host-interaction/file-system/write                   |
| set console window title                             | host-interaction/gui/console                         |
| get keyboard layout                                  | host-interaction/hardware/keyboard/layout            |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| access the Windows event log                         | host-interaction/log/winevt/access                   |
| enumerate network shares                             | host-interaction/network                             |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| get domain controller name                           | host-interaction/network/domain                      |
| get hostname (2 matches)                             | host-interaction/os/hostname                         |
| get system information on Windows                    | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| read process memory                                  | host-interaction/process                             |
| create process on Windows (5 matches)                | host-interaction/process/create                      |
| terminate process (3 matches)                        | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (3 matches)        | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| query service status                                 | host-interaction/service                             |
| run as service                                       | host-interaction/service                             |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| start service (2 matches)                            | host-interaction/service/start                       |
| stop service                                         | host-interaction/service/stop                        |
| get token membership                                 | host-interaction/session                             |
| get user security identifier (2 matches)             | host-interaction/session                             |
| create thread (5 matches)                            | host-interaction/thread/create                       |
| terminate thread (3 matches)                         | host-interaction/thread/terminate                    |
| link many functions at runtime                       | linking/runtime-linking                              |
| enumerate PE sections (6 matches)                    | load-code/pe                                         |
| parse PE exports (10 matches)                        | load-code/pe                                         |
| parse PE header (48 matches)                         | load-code/pe                                         |
| persist via Windows service                          | persistence/service                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Discovery::Domain Trust Discovery [T1482;4]
9		- Impact::Service Stop [T1489;9]
3		- Execution::System Services::Service Execution [T1569.002;3]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
4		- Execution::Command and Scripting Interpreter [T1059;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
8.5		- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
3		- Discovery::Account Discovery [T1087;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
8		- Credential Access::Credentials from Password Stores::Windows Credential Manager [T1555.004;8]
3		- Discovery::System Network Configuration Discovery [T1016;3]
6		- Collection::Clipboard Data [T1115;6]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
5		- Collection::Data from Information Repositories [T1213;5]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 97.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 60/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:46:42                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fwt5YC4HDTK2wywfBh.exe
Real Name:	/mimikatz.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Discovery::Domain Trust Discovery [T1482;4]
9	- Impact::Service Stop [T1489;9]
3	- Execution::System Services::Service Execution [T1569.002;3]
4	- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
4	- Execution::Command and Scripting Interpreter [T1059;4]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3	- Discovery::System Owner/User Discovery [T1033;3]
8.5	- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]
2	- Discovery::File and Directory Discovery [T1083;2]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
3	- Discovery::Account Discovery [T1087;3]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
4	- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
8	- Credential Access::Credentials from Password Stores::Windows Credential Manager [T1555.004;8]
3	- Discovery::System Network Configuration Discovery [T1016;3]
6	- Collection::Clipboard Data [T1115;6]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
5	- Collection::Data from Information Repositories [T1213;5]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
30	Win.Dropper.ClipBanker-9778171-0
10	Win.Tool.Mimikatz-9862700-0
45	Win.Trojan.Mimikatz-6466236-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	inject_thread
45	create_service
50	network_dns
80	cred_local
70	spreading_share
60	win_mutex
20	win_registry
65	win_token
10	win_files_operation
10	misc_pe_signature
10	ft_exe
50	hacktool_windows_mimikatz_copywrite
50	hacktool_windows_mimikatz_modules
80	Powerkatz_DLL_Generic
50	HackTool_Producers
70	mimikatz
65	Mimikatz_Strings
70	Mimikatz_Gen_Strings
2	math_entropy_6
5	obfuscation_singlebyte_mov
5	executable_pe
15	dll_injection_thread
70	Visual_Cpp_2005_Release_Microsoft
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsConsole
10	HasOverlay
10	HasDigitalSignature
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
40	DLL_inject
45	Inject_Thread
60	Debugger_Check__QueryInfo
60	DebuggerException__SetConsoleCtrl_v1
30	Check_OutputDebugStringA_iat_v1
40	SEH_Save
40	SEH_Init
30	Check_OutputDebugStringA_iat
10	anti_dbg
60	with_sqlite
70	INDICATOR_TOOL_PWS_Mimikatz
70	INDICATOR_SUSPICIOUS_EXE_SQLQuery_ConfidentialDataStore
20	isExecutable
10	Contains_PE_File
1	db_structure
1	db_connection
10	Big_Numbers0
10	Big_Numbers1
10	Big_Numbers3
20	Advapi_Hash_API
25	MD5_API
15	DES_Long

============================[ Scores ]============================
CAPA:	100.0
ClamAV:	85.0
Loki:	2011
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
36937.55101538691
==================================================================


==================================================================
Fichier HTTP-Fwt5YC4HDTK2wywfBh.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fcl4el4EvlDeS7ous5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 912400a90ca88e80abc6cb8f30c1bb41                                                   |
| sha1                   | bf32f1dd03d9dfea828109824928c7f13b23ca99                                           |
| sha256                 | a174de17639a2c544d8124895f878abaaa634fdc63bf49979b407fd7a20c28bf                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fcl4el4EvlDeS7ous5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fcl4el4EvlDeS7ous5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 42.121 sec (0 m 42 s)
Start Date: 2022:02:11 11:50:25
End Date:   2022:02:11 11:51:07

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:50:25Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fcl4el4EvlDeS7ous5.exe SCORE: 269 TYPE: EXE SIZE: 21144 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f5a73132400> 
MD5: 912400a90ca88e80abc6cb8f30c1bb41 
SHA1: bf32f1dd03d9dfea828109824928c7f13b23ca99 
SHA256: a174de17639a2c544d8124895f878abaaa634fdc63bf49979b407fd7a20c28bf CREATED: Fri Feb 11 11:50:25 2022 MODIFIED: Fri Feb 11 11:50:25 2022 ACCESSED: Fri Feb 11 11:51:09 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e80b0300004883c428e96efeffffcccccccccccccccccccccccccccc
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:51:09Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 269

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/69
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:50:25                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fcl4el4EvlDeS7ous5.exe
Real Name:	/prproc.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	1.0
ClamAV:	0
Loki:	269
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4283.3153108700835
==================================================================


==================================================================
Fichier HTTP-Fcl4el4EvlDeS7ous5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FUdfoL3sGnBz0EcQY6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 57f0394e0c4082e04c9d635ea5e8fc98                                                   |
| sha1                   | df9779aaf47019ee0cb8b8fcbe6510a3d6b29bf5                                           |
| sha256                 | 8ef6e578c77caa6c47c512ba733b6532ac21d34f396632d8ff5ee7deca47846a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FUdfoL3sGnBz0EcQY6.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
| CRYPTOGRAPHY                | Encrypt Data:: [C0027]                                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| OPERATING SYSTEM            | Registry::Query Registry Key [C0036.005]                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints                       | anti-analysis/anti-debugging/debugger-detection      |
| encrypt data using DPAPI (4 matches)                 | data-manipulation/encryption/dpapi                   |
| generate random numbers via WinAPI (2 matches)       | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| query or enumerate registry key (4 matches)          | host-interaction/registry                            |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::Query Registry [T1012;1]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 11.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FUdfoL3sGnBz0EcQY6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778448
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 43.483 sec (0 m 43 s)
Start Date: 2022:02:11 11:51:10
End Date:   2022:02:11 11:51:53

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:51:10Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FUdfoL3sGnBz0EcQY6.exe SCORE: 134 TYPE: EXE SIZE: 76800 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3c3ea42400> 
MD5: 57f0394e0c4082e04c9d635ea5e8fc98 
SHA1: df9779aaf47019ee0cb8b8fcbe6510a3d6b29bf5 
SHA256: 8ef6e578c77caa6c47c512ba733b6532ac21d34f396632d8ff5ee7deca47846a CREATED: Fri Feb 11 11:51:10 2022 MODIFIED: Fri Feb 11 11:51:10 2022 ACCESSED: Fri Feb 11 11:52:04 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:52:04Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 134

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/64
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:51:10                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FUdfoL3sGnBz0EcQY6.exe
Real Name:	/tetheringclient.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Discovery::Query Registry [T1012;1]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	11.5
ClamAV:	0
Loki:	134
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
2353.212044119313
==================================================================


==================================================================
Fichier HTTP-FUdfoL3sGnBz0EcQY6.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fg0QMG1hdyGh3m7AF5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 61c85b1b2d5fe567546192ce83c0450b                                                   |
| sha1                   | 87e511c2ad9128e64e482b4a50473fcc1d464e4e                                           |
| sha256                 | e31535d614bcc97a14512386278f87c426ef4bf582abcf41ade75bf1acd0b437                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fg0QMG1hdyGh3m7AF5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fg0QMG1hdyGh3m7AF5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778461
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 44.819 sec (0 m 44 s)
Start Date: 2022:02:11 11:52:05
End Date:   2022:02:11 11:52:50

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:52:05Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fg0QMG1hdyGh3m7AF5.exe SCORE: 139 TYPE: EXE SIZE: 98640 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f366146d400> 
MD5: 61c85b1b2d5fe567546192ce83c0450b 
SHA1: 87e511c2ad9128e64e482b4a50473fcc1d464e4e 
SHA256: e31535d614bcc97a14512386278f87c426ef4bf582abcf41ade75bf1acd0b437 CREATED: Fri Feb 11 11:52:05 2022 MODIFIED: Fri Feb 11 11:52:05 2022 ACCESSED: Fri Feb 11 11:53:03 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:53:03Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 139

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:52:05                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fg0QMG1hdyGh3m7AF5.exe
Real Name:	/mfvdsp.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	1.0
ClamAV:	0
Loki:	139
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
2222.954160670636
==================================================================


==================================================================
Fichier HTTP-Fg0QMG1hdyGh3m7AF5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FPiJU24XW1cAEgn2o7.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FPiJU24XW1cAEgn2o7.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778461
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.22 MB
Data read: 0.21 MB (ratio 1.04:1)
Time: 43.363 sec (0 m 43 s)
Start Date: 2022:02:11 11:53:05
End Date:   2022:02:11 11:53:48

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:53:06Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FPiJU24XW1cAEgn2o7.exe SCORE: 764 TYPE: EXE SIZE: 226808 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3899c37400> 
MD5: a74ee8200aace7d19dee79871bbf2ed3 
SHA1: 7929ddb899baf5f1bfda9092c8edc0ef7cc4f647 
SHA256: 807424fa3c4e03471d4acc5d35fdd8923a3689f44599f23999879abf5a74dd85 CREATED: Fri Feb 11 11:53:05 2022 MODIFIED: Fri Feb 11 11:53:05 2022 ACCESSED: Fri Feb 11 11:54:02 2022 
REASON_1: Yara Rule MATCH: create_service SUBSCORE: 45 
DESCRIPTION: Create a windows service REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: CreateService Str3: ControlService Str4: StartService Str5: QueryServiceStatus
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_4: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 000000518b15b8c442008b45088b0d94c5420053565733f63bd08965f08975fc73473bc173458b0d00c542002bc23bc10f8fef0000003bc60f8ee70000008 ... (truncated)
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff685000420068b6bc410064a10000000050 Str2: 558bec6aff686000420068b6bc410064a10000000050 Str3: 558bec6aff684801420068b6bc41006 ... (truncated)
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff685000420068b6bc410064a10000000050 Str2: 558bec6aff686000420068b6bc410064a10000000050 Str3: 558bec6aff684801420068b6bc41006 ... (truncated)
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6a Str2: 558bec51 Str3: 558bec8d Str4: 558bec83 Str5: 558bec6aff685000420068b6bc410064a10000000050 Str6: 558bec6aff686000420068 ... (truncated)
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff685000420068b6bc410064a1000000005064892500000000 Str2: 558bec6aff686000420068b6bc410064a1000000005064892500000000 Str3: 558 ... (truncated)
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_16: Yara Rule MATCH: HasDigitalSignature SUBSCORE: 10 
DESCRIPTION: DigitalSignature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 88350000000202003082357806092a864886f70d010702a082356930823565020101310b300906052b0e03021a0500304c060a2b060104018237020104a03e303c301 ... (truncated)
REASON_17: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_18: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_19: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_21: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_22: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_23: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_24: Yara Rule MATCH: GenerateTLSClientHelloPacket_Test SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: Novetta Threat Research & Interdiction Group - trig@novetta.com 
MATCHES: Str1: 250700008079054883c8f840
REASON_25: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_26: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_27: Yara Rule MATCH: DES_sbox SUBSCORE: 15 
DESCRIPTION: DES [sbox] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:54:02Z

-------- Score ----------------
Scores		Rules
.......		...............
45		create_service
20		win_registry
10		Str_Win32_Winsock2_Library
10		misc_pe_signature
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasOverlay
10		HasDigitalSignature
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
60		DebuggerException__SetConsoleCtrl_v1
40		SEH_Init
10		anti_dbg
60		GenerateTLSClientHelloPacket_Test
20		isExecutable
10		Contains_PE_File
15		DES_sbox

Score total: 764

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a74ee8200aace7d19dee79871bbf2ed3                                                   |
| sha1                   | 7929ddb899baf5f1bfda9092c8edc0ef7cc4f647                                           |
| sha256                 | 807424fa3c4e03471d4acc5d35fdd8923a3689f44599f23999879abf5a74dd85                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FPiJU24XW1cAEgn2o7.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Automated Collection:: \[T1119]\                                                   |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Execution Guardrails::Runs as Service [E1480.m07]                             |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Read File:: [C0051]                                                           |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                 | anti-analysis/anti-debugging/debugger-detection      |
| contain obfuscated stackstrings (5 matches)           | anti-analysis/obfuscation/string/stackstring         |
| parse credit card information                         | collection/credit-card                               |
| check HTTP status code (4 matches)                    | communication/http/client                            |
| encode data using XOR                                 | data-manipulation/encoding/xor                       |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| accept command line arguments                         | host-interaction/cli                                 |
| get common file path (2 matches)                      | host-interaction/file-system                         |
| copy file                                             | host-interaction/file-system/copy                    |
| create directory                                      | host-interaction/file-system/create                  |
| get file size                                         | host-interaction/file-system/meta                    |
| read file on Windows                                  | host-interaction/file-system/read                    |
| enumerate gui resources (2 matches)                   | host-interaction/gui                                 |
| get number of processors                              | host-interaction/hardware/cpu                        |
| print debug messages                                  | host-interaction/log/debug/write-event               |
| get hostname                                          | host-interaction/os/hostname                         |
| create a process with modified I/O handles and window | host-interaction/process/create                      |
| create process on Windows                             | host-interaction/process/create                      |
| enumerate processes                                   | host-interaction/process/list                        |
| terminate process                                     | host-interaction/process/terminate                   |
| query or enumerate registry value (2 matches)         | host-interaction/registry                            |
| query service status (2 matches)                      | host-interaction/service                             |
| run as service                                        | host-interaction/service                             |
| create service                                        | host-interaction/service/create                      |
| delete service                                        | host-interaction/service/delete                      |
| stop service (2 matches)                              | host-interaction/service/stop                        |
| create thread (4 matches)                             | host-interaction/thread/create                       |
| resume thread (2 matches)                             | host-interaction/thread/resume                       |
| terminate thread (7 matches)                          | host-interaction/thread/terminate                    |
| access PEB ldr_data (3 matches)                       | linking/runtime-linking                              |
| link function at runtime on Windows (7 matches)       | linking/runtime-linking                              |
| parse PE exports (2 matches)                          | load-code/pe                                         |
| parse PE header (4 matches)                           | load-code/pe                                         |
| persist via Windows service                           | persistence/service                                  |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
6		- Collection::Automated Collection [T1119;6]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
4		- Discovery::Process Discovery [T1057;4]
9		- Impact::Service Stop [T1489;9]
3		- Execution::System Services::Service Execution [T1569.002;3]
4		- Discovery::Software Discovery [T1518;4]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 73.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 13/67
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:53:04                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FPiJU24XW1cAEgn2o7.exe
Real Name:	/a74ee8200aace7d19dee79871bbf2ed3.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
8.5	- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
6	- Collection::Automated Collection [T1119;6]
1	- Discovery::System Information Discovery [T1082;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1	- Discovery::Query Registry [T1012;1]
4	- Discovery::Process Discovery [T1057;4]
9	- Impact::Service Stop [T1489;9]
3	- Execution::System Services::Service Execution [T1569.002;3]
4	- Discovery::Software Discovery [T1518;4]
2	- Discovery::File and Directory Discovery [T1083;2]
4	- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
45	create_service
20	win_registry
10	Str_Win32_Winsock2_Library
10	misc_pe_signature
10	ft_exe
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsWindowsGUI
10	HasOverlay
10	HasDigitalSignature
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
60	DebuggerException__SetConsoleCtrl_v1
40	SEH_Init
10	anti_dbg
60	GenerateTLSClientHelloPacket_Test
20	isExecutable
10	Contains_PE_File
15	DES_sbox

============================[ Scores ]============================
CAPA:	73.5
ClamAV:	0
Loki:	764
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
15575.101791905032
==================================================================


==================================================================
Fichier HTTP-FPiJU24XW1cAEgn2o7.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FsJqKduzH47xiYpg5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 348059b0a770e1f95d3417107968a954                                                   |
| sha1                   | d6e48a1409e6d0b4d7fefe31028851a6e0e215ff                                           |
| sha256                 | 321a9e388a0e437325411998beaaecb9213823be935f1b37fab9d7cef8984c99                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FsJqKduzH47xiYpg5.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FsJqKduzH47xiYpg5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 35.156 sec (0 m 35 s)
Start Date: 2022:02:11 11:54:30
End Date:   2022:02:11 11:55:05

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:54:30Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FsJqKduzH47xiYpg5.exe SCORE: 109 TYPE: EXE SIZE: 8192 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3e362c6400> 
MD5: 348059b0a770e1f95d3417107968a954 
SHA1: d6e48a1409e6d0b4d7fefe31028851a6e0e215ff 
SHA256: 321a9e388a0e437325411998beaaecb9213823be935f1b37fab9d7cef8984c99 CREATED: Fri Feb 11 11:54:30 2022 MODIFIED: Fri Feb 11 11:54:30 2022 ACCESSED: Fri Feb 11 11:55:22 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_3 SUBSCORE: 2 
DESCRIPTION: Low entropy - very sparse data or repeating plaintext REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 10 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:55:22Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_3
5		executable_pe
10		IsPE32
10		IsDLL
10		IsConsole
10		HasDebugData
10		ImportTableIsBad
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 109

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:54:30                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FsJqKduzH47xiYpg5.exe
Real Name:	/Microsoft-Windows-MosHost.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_3
5	executable_pe
10	IsPE32
10	IsDLL
10	IsConsole
10	HasDebugData
10	ImportTableIsBad
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	1.0
ClamAV:	0
Loki:	109
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
1747.4862029323024
==================================================================


==================================================================
Fichier HTTP-FsJqKduzH47xiYpg5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Flim2H1uXjiUtUco39.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 73e4bcfce5e484f9e4ddb7f9c0e471f9                                                   |
| sha1                   | 4265c4744a852fc42fe4798d38e9dad9c239f383                                           |
| sha256                 | bb104769a2845ee2c5cac9cc89cdc0e853ee00dde202f14330954baef4cf5dee                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Flim2H1uXjiUtUco39.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| create thread                                        | host-interaction/thread/create                       |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 7.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Flim2H1uXjiUtUco39.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 44.127 sec (0 m 44 s)
Start Date: 2022:02:11 11:55:24
End Date:   2022:02:11 11:56:08

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:55:24Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Flim2H1uXjiUtUco39.exe SCORE: 229 TYPE: EXE SIZE: 27136 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f425956f400> 
MD5: 73e4bcfce5e484f9e4ddb7f9c0e471f9 
SHA1: 4265c4744a852fc42fe4798d38e9dad9c239f383 
SHA256: bb104769a2845ee2c5cac9cc89cdc0e853ee00dde202f14330954baef4cf5dee CREATED: Fri Feb 11 11:55:24 2022 MODIFIED: Fri Feb 11 11:55:24 2022 ACCESSED: Fri Feb 11 11:56:18 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e89b0200004883c428e97efdffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:56:18Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/64
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:55:24                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Flim2H1uXjiUtUco39.exe
Real Name:	/vdsldr.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	7.0
ClamAV:	0
Loki:	229
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3769.073772783771
==================================================================


==================================================================
Fichier HTTP-Flim2H1uXjiUtUco39.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fba5Cx4eNRc1qvYCUg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b766cc43d649d30e9f27aff8f7ee7de0                                                   |
| sha1                   | c1e170856c4887c056dee663bfda189fe7a094c9                                           |
| sha256                 | e15d509ae7b77989f885edb22b6c9cccec3f6a4c4805936756af7a01f2388b03                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fba5Cx4eNRc1qvYCUg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Indicator Removal on Host::Clear Windows Event Logs \[T1070.001]\                  |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | System Shutdown/Reboot:: \[T1529]\                                                 |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Virtual Machine Detection:: [B0009]                                           |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
|                             | Socket Communication::Connect Socket [C0001.004]                              |
|                             | Socket Communication::Create TCP Socket [C0001.011]                           |
|                             | Socket Communication::Get Socket Status [C0001.012]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::Set Socket Config [C0001.001]                           |
|                             | Socket Communication::TCP Client [C0001.008]                                  |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
|                             | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| HARDWARE                    | Simulate Hardware::Ctrl-Alt-Del [C0057.001]                                   |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| clear the Windows event log                          | anti-analysis/anti-forensic/clear-logs               |
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| contain obfuscated stackstrings (3 matches)          | anti-analysis/obfuscation/string/stackstring         |
| receive and write data from server to client         | c2/file-transfer                                     |
| send data (2 matches)                                | communication                                        |
| creates tcp or udp socket                            | communication/socket                                 |
| get socket information                               | communication/socket                                 |
| get socket status                                    | communication/socket                                 |
| initialize Winsock library                           | communication/socket                                 |
| set socket configuration (2 matches)                 | communication/socket                                 |
| act as TCP client                                    | communication/tcp/client                             |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| get common file path (5 matches)                     | host-interaction/file-system                         |
| delete file                                          | host-interaction/file-system/delete                  |
| get file size                                        | host-interaction/file-system/meta                    |
| move file (2 matches)                                | host-interaction/file-system/move                    |
| read .ini file                                       | host-interaction/file-system/read                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| enumerate gui resources                              | host-interaction/gui                                 |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| get CPU information                                  | host-interaction/hardware/cpu                        |
| simulate CTRL ALT DEL                                | host-interaction/hardware/keyboard                   |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| access the Windows event log                         | host-interaction/log/winevt/access                   |
| get local IPv4 addresses                             | host-interaction/network/address                     |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| shutdown system                                      | host-interaction/os                                  |
| get hostname                                         | host-interaction/os/hostname                         |
| get system information on Windows                    | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| create process on Windows (4 matches)                | host-interaction/process/create                      |
| enumerate processes (3 matches)                      | host-interaction/process/list                        |
| modify access privileges                             | host-interaction/process/modify                      |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry key (2 matches)                      | host-interaction/registry/delete                     |
| delete registry value                                | host-interaction/registry/delete                     |
| get session information                              | host-interaction/session                             |
| get session user name                                | host-interaction/session                             |
| create thread (2 matches)                            | host-interaction/thread/create                       |
| terminate thread                                     | host-interaction/thread/terminate                    |
| link function at runtime on Windows (6 matches)      | linking/runtime-linking                              |
| enumerate PE sections                                | load-code/pe                                         |
| inspect section memory permissions                   | load-code/pe                                         |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
9		- Impact::System Shutdown/Reboot [T1529;9]
4		- Discovery::Application Window Discovery [T1010;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
8.5		- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]
4		- Discovery::Process Discovery [T1057;4]
4		- Discovery::Software Discovery [T1518;4]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
3		- Discovery::Account Discovery [T1087;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 90.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:56:20Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fba5Cx4eNRc1qvYCUg.exe SCORE: 754 TYPE: EXE SIZE: 40960 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f8781b27400> 
MD5: b766cc43d649d30e9f27aff8f7ee7de0 
SHA1: c1e170856c4887c056dee663bfda189fe7a094c9 
SHA256: e15d509ae7b77989f885edb22b6c9cccec3f6a4c4805936756af7a01f2388b03 CREATED: Fri Feb 11 11:56:19 2022 MODIFIED: Fri Feb 11 11:56:19 2022 ACCESSED: Fri Feb 11 11:56:56 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_4: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: kernel32.dll Str3: GetPrivateProfileStringA
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: kernel32.dll Str3: WriteFile Str4: ReadFile Str5: CreateFileA Str6: MoveFileExA
REASON_6: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_7: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_8: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetOpen
REASON_9: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645e048c645e165c645e261c645 Str2: c645e165c645e261c645e370c645 Str3: c645e261c645e370c645e446c645 Str4: c645e370c645e446c645e572c645 ... (truncated)
REASON_12: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_13: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff68e0724000682064400064a100000000506489250000000083ec68535657
REASON_14: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68a8724000682064400064a10000000050 Str2: 558bec6aff68b8724000682064400064a10000000050 Str3: 558bec6aff68c872400068206440006 ... (truncated)
REASON_15: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68a8724000682064400064a10000000050 Str2: 558bec6aff68b8724000682064400064a10000000050 Str3: 558bec6aff68c872400068206440006 ... (truncated)
REASON_16: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83 Str2: 558bec51 Str3: 558bec81 Str4: 558bece8 Str5: 558bec68 Str6: 558bec6a Str7: 558becb8 Str8: 558bec6aff68a872400068206440 ... (truncated)
REASON_17: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68a8724000682064400064a1000000005064892500000000 Str2: 558bec6aff68b8724000682064400064a1000000005064892500000000 Str3: 558 ... (truncated)
REASON_18: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_21: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DESCRIPTION\System
REASON_23: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_24: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_25: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_26: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_27: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:56:56Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
65		win_token
10		win_private_profile
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		ft_exe
2		math_entropy_4
5		obfuscation_singlebyte_mov
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		Anti_Automated_Sandbox
40		SEH_Init
20		isExecutable
10		Contains_PE_File
5		BASE64_table

Score total: 754

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fba5Cx4eNRc1qvYCUg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 43.054 sec (0 m 43 s)
Start Date: 2022:02:11 11:56:19
End Date:   2022:02:11 11:57:02

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier trouvé !
Malware connu -> Score: 2000
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 55/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:56:19                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fba5Cx4eNRc1qvYCUg.exe
Real Name:	/b766cc43d649d30e9f27aff8f7ee7de0.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
8.5	- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
9	- Impact::System Shutdown/Reboot [T1529;9]
4	- Discovery::Application Window Discovery [T1010;4]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3	- Discovery::System Owner/User Discovery [T1033;3]
8.5	- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]
4	- Discovery::Process Discovery [T1057;4]
4	- Discovery::Software Discovery [T1518;4]
2	- Discovery::File and Directory Discovery [T1083;2]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
3	- Discovery::Account Discovery [T1087;3]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
5	- Privilege Escalation::Access Token Manipulation [T1134;5]
3	- Discovery::System Network Configuration Discovery [T1016;3]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
70	escalate_priv
20	win_registry
65	win_token
10	win_private_profile
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	ft_exe
2	math_entropy_4
5	obfuscation_singlebyte_mov
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	Anti_Automated_Sandbox
40	SEH_Init
20	isExecutable
10	Contains_PE_File
5	BASE64_table

============================[ Scores ]============================
CAPA:	90.0
ClamAV:	0
Loki:	754
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	2000
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
17745.830754628783
==================================================================


==================================================================
Fichier HTTP-Fba5Cx4eNRc1qvYCUg.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FgK2rF3ElICvRWIEY6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be an installer.
WARNING:capa: 
WARNING:capa: capa cannot handle installers well. This means the results may be misleading or incomplete.
WARNING:capa: You should try to understand the install mechanism and analyze created files with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) installer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:57:04Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FgK2rF3ElICvRWIEY6.exe SCORE: 1799 TYPE: EXE SIZE: 782044 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f73b2ee4400> 
MD5: 4f11bdb380dafa2518053c6d20147a05 
SHA1: 0de61c550a355e78874703f6f0aaf5d6f79f5eb6 
SHA256: 9a9012840295bc2c62fd9cbe3d3dda692f43536861a40464f4e073d22bff179f CREATED: Fri Feb 11 11:57:03 2022 MODIFIED: Fri Feb 11 11:57:03 2022 ACCESSED: Fri Feb 11 11:57:51 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_5: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: GetPrivateProfileStringA Str3: WritePrivateProfileStringA
REASON_6: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CreateFileA Str7: FindFirstFileA Str8: MoveF ... (truncated)
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 2 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_10: Yara Rule MATCH: Nullsoft_PiMP_Stub_SFX SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 81ec80010000535556
REASON_11: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: stager_reverse_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_18: Yara Rule MATCH: stager_bind_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_19: Yara Rule MATCH: win32_stage_boot_winsock_conn_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_20: Yara Rule MATCH: win32_stage_boot_bind_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_21: Yara Rule MATCH: win32_stage_boot_reverse_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_22: Yara Rule MATCH: win32_stage_boot_winsock_conn_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_23: Yara Rule MATCH: stager_reverse_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_24: Yara Rule MATCH: win32_stage_boot_bind_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_25: Yara Rule MATCH: win32_stage_boot_reverse_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_26: Yara Rule MATCH: win32_stage_boot_reverse_shell_revert_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_27: Yara Rule MATCH: win32_stage_winexec_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_28: Yara Rule MATCH: stager_bind_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_29: Yara Rule MATCH: win32_stage_boot_winsock_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_30: Yara Rule MATCH: win32_stage_boot_reverse_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_31: Yara Rule MATCH: win32_stage_api_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_32: Yara Rule MATCH: win32_stage_boot_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_33: Yara Rule MATCH: win32_stage_boot_reverse_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_34: Yara Rule MATCH: win32_stage_boot_reverse_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_35: Yara Rule MATCH: win32_stage_boot_bind_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_36: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_37: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_38: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_39: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:57:53Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
65		screenshot
20		win_registry
65		win_token
10		win_private_profile
10		win_files_operation
10		ft_exe
2		math_entropy_close_8
5		executable_pe
70		Nullsoft_PiMP_Stub_SFX
10		IsPE32
10		IsWindowsGUI
10		IsPacked
10		HasOverlay
10		HasRichSignature
2		PE_File
70		stager_reverse_tcp_nx_ldone_x86
70		stager_bind_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_conn_ldone_x86
70		win32_stage_boot_bind_read_ldone_x86
70		win32_stage_boot_reverse_read_ldone_x86
70		win32_stage_boot_winsock_conn_udp_ldone_x86
70		stager_reverse_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_bind_inlineegg_ldone_x86
70		win32_stage_boot_reverse_ldone_x86
70		win32_stage_boot_reverse_shell_revert_ldone_x86
70		win32_stage_winexec_ldone_x86
70		stager_bind_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_bind_ldone_x86
70		win32_stage_boot_reverse_shell_ldone_x86
70		win32_stage_api_ldone_x86
70		win32_stage_boot_bind_ldone_x86
70		win32_stage_boot_reverse_udp_ldone_x86
70		win32_stage_boot_reverse_inlineegg_ldone_x86
70		win32_stage_boot_bind_shell_ldone_x86
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File
25		CRC32_poly_Constant

Score total: 1799

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FgK2rF3ElICvRWIEY6.exe: Win.Trojan.Agent-1879100 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FgK2rF3ElICvRWIEY6.exe: Win.Trojan.Agent-1879100 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 5.69 MB
Data read: 0.74 MB (ratio 7.66:1)
Time: 80.729 sec (1 m 20 s)
Start Date: 2022:02:11 11:57:03
End Date:   2022:02:11 11:58:24

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 37/57
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:57:03                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FgK2rF3ElICvRWIEY6.exe
Real Name:	/4f11bdb380dafa2518053c6d20147a05.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
70	escalate_priv
65	screenshot
20	win_registry
65	win_token
10	win_private_profile
10	win_files_operation
10	ft_exe
2	math_entropy_close_8
5	executable_pe
70	Nullsoft_PiMP_Stub_SFX
10	IsPE32
10	IsWindowsGUI
10	IsPacked
10	HasOverlay
10	HasRichSignature
2	PE_File
70	stager_reverse_tcp_nx_ldone_x86
70	stager_bind_tcp_nx_ldone_x86
70	win32_stage_boot_winsock_conn_ldone_x86
70	win32_stage_boot_bind_read_ldone_x86
70	win32_stage_boot_reverse_read_ldone_x86
70	win32_stage_boot_winsock_conn_udp_ldone_x86
70	stager_reverse_ipv6_tcp_nx_ldone_x86
70	win32_stage_boot_bind_inlineegg_ldone_x86
70	win32_stage_boot_reverse_ldone_x86
70	win32_stage_boot_reverse_shell_revert_ldone_x86
70	win32_stage_winexec_ldone_x86
70	stager_bind_ipv6_tcp_nx_ldone_x86
70	win32_stage_boot_winsock_bind_ldone_x86
70	win32_stage_boot_reverse_shell_ldone_x86
70	win32_stage_api_ldone_x86
70	win32_stage_boot_bind_ldone_x86
70	win32_stage_boot_reverse_udp_ldone_x86
70	win32_stage_boot_reverse_inlineegg_ldone_x86
70	win32_stage_boot_bind_shell_ldone_x86
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File
25	CRC32_poly_Constant

============================[ Scores ]============================
CAPA:	0
ClamAV:	0
Loki:	1799
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
30512.22853237543
==================================================================


==================================================================
Fichier HTTP-FgK2rF3ElICvRWIEY6.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FaB8DP2YZgu4Nmdvde.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | d922a26d46a2e2194be6c3af1548d0e9                                                   |
| sha1                   | d0afd35a719dc0efc018f2609144297473d711d3                                           |
| sha256                 | 4363b665cb1b4b724716d7e287fe770d8c38c76aa78fa0d1cbcd1c9bc1c2b02c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FaB8DP2YZgu4Nmdvde.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| encrypt or decrypt data via BCrypt                   | data-manipulation/encryption                         |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| check if file exists                                 | host-interaction/file-system/exists                  |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| link function at runtime on Windows (4 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::File and Directory Discovery [T1083;2]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 8.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FaB8DP2YZgu4Nmdvde.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.10 MB
Data read: 0.10 MB (ratio 1.00:1)
Time: 42.125 sec (0 m 42 s)
Start Date: 2022:02:11 11:58:25
End Date:   2022:02:11 11:59:07

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:58:25Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FaB8DP2YZgu4Nmdvde.exe SCORE: 309 TYPE: EXE SIZE: 102400 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7faa7413e400> 
MD5: d922a26d46a2e2194be6c3af1548d0e9 
SHA1: d0afd35a719dc0efc018f2609144297473d711d3 
SHA256: 4363b665cb1b4b724716d7e287fe770d8c38c76aa78fa0d1cbcd1c9bc1c2b02c CREATED: Fri Feb 11 11:58:25 2022 MODIFIED: Fri Feb 11 11:58:25 2022 ACCESSED: Fri Feb 11 11:59:12 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8cf0800004883c428e95efeffffcccccccccccccccccccccccccccc
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Big_Numbers2 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 48:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 010203040506070801020304050607080102030405060708
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T10:59:12Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
10		anti_dbg
20		isExecutable
10		Contains_PE_File
10		Big_Numbers2

Score total: 309

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:58:25                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FaB8DP2YZgu4Nmdvde.exe
Real Name:	/tpmvscmgr.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Discovery::File and Directory Discovery [T1083;2]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
10	anti_dbg
20	isExecutable
10	Contains_PE_File
10	Big_Numbers2

============================[ Scores ]============================
CAPA:	8.0
ClamAV:	0
Loki:	309
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5056.94094990235
==================================================================


==================================================================
Fichier HTTP-FaB8DP2YZgu4Nmdvde.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fm3QvS2p4OXwDxG0Lh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fm3QvS2p4OXwDxG0Lh.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.47 MB
Data read: 0.45 MB (ratio 1.05:1)
Time: 43.832 sec (0 m 43 s)
Start Date: 2022:02:11 11:59:13
End Date:   2022:02:11 11:59:57

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T10:59:14Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fm3QvS2p4OXwDxG0Lh.exe SCORE: 434 TYPE: EXE SIZE: 468992 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb10f4cc400> 
MD5: 866989aa656cf67780143376c12df510 
SHA1: 3bacae009425ab65c13b236469caf11e8d30f2dd 
SHA256: 47a44a548c462510301785b3d849e7fa731b911fa0b174574876a1367c88cbd2 CREATED: Fri Feb 11 11:59:13 2022 MODIFIED: Fri Feb 11 11:59:13 2022 ACCESSED: Fri Feb 11 12:00:08 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_2: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_3: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_4: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetOpen
REASON_5: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_11: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_17: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: UnhookWindowsHookEx Str3: CallNextHookEx
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:00:09Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
80		keylogger
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
2		math_entropy_5
5		executable_pe
15		dll_injection_hook
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
35		Win_Hook_v12
10		anti_dbg
20		isExecutable
10		Contains_PE_File
5		BASE64_table

Score total: 434

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 866989aa656cf67780143376c12df510                                                   |
| sha1                   | 3bacae009425ab65c13b236469caf11e8d30f2dd                                           |
| sha256                 | 47a44a548c462510301785b3d849e7fa731b911fa0b174574876a1367c88cbd2                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fm3QvS2p4OXwDxG0Lh.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | HTTP Communication::Set Header [C0002.013]                                    |
|                             | HTTP Communication::WinHTTP [C0002.008]                                       |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
|                             | File and Directory Discovery::Log File [E1083.m01]                            |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| log keystrokes via polling                           | collection/keylog                                    |
| initialize WinHTTP library                           | communication/http                                   |
| read HTTP header                                     | communication/http                                   |
| set HTTP header                                      | communication/http                                   |
| create HTTP request                                  | communication/http/client                            |
| prepare HTTP request                                 | communication/http/client                            |
| receive HTTP response (2 matches)                    | communication/http/client                            |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (4 matches)                    | data-manipulation/encoding/xor                       |
| hash data via BCrypt                                 | data-manipulation/hashing                            |
| hash data using fnv (4 matches)                      | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| set application hook (4 matches)                     | host-interaction/gui                                 |
| get graphical window text (2 matches)                | host-interaction/gui/window/get-text                 |
| access the Windows event log                         | host-interaction/log/winevt/access                   |
| get session user name                                | host-interaction/session                             |
| create thread                                        | host-interaction/thread/create                       |
| parse PE header (7 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
3		- Discovery::Account Discovery [T1087;3]

Score total: 30.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 11:59:13                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fm3QvS2p4OXwDxG0Lh.exe
Real Name:	/dsregcmd.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3	- Discovery::System Owner/User Discovery [T1033;3]
6	- Collection::Input Capture::Keylogging [T1056.001;6]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
3	- Discovery::Account Discovery [T1087;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
65	screenshot
80	keylogger
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	Str_Win32_Http_API
10	ft_exe
2	math_entropy_5
5	executable_pe
15	dll_injection_hook
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
35	Win_Hook_v12
10	anti_dbg
20	isExecutable
10	Contains_PE_File
5	BASE64_table

============================[ Scores ]============================
CAPA:	30.5
ClamAV:	0
Loki:	434
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
7486.99146134674
==================================================================


==================================================================
Fichier HTTP-Fm3QvS2p4OXwDxG0Lh.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FX1SK632CMUhiKK5lf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 013710ab6de262c6e342571f1798d8c2                                                   |
| sha1                   | a798ad46810e0799d36e20a84ae2564200fcb32d                                           |
| sha256                 | ca68eff48f1e5b6158cd0f45571805717a8364a3d34ed469f4c9e76cfe88fada                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FX1SK632CMUhiKK5lf.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FX1SK632CMUhiKK5lf.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.00 MB
Data read: 0.00 MB (ratio 0.00:1)
Time: 42.557 sec (0 m 42 s)
Start Date: 2022:02:11 12:00:46
End Date:   2022:02:11 12:01:29

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:00:47Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FX1SK632CMUhiKK5lf.exe SCORE: 109 TYPE: EXE SIZE: 2560 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f70ab759400> 
MD5: 013710ab6de262c6e342571f1798d8c2 
SHA1: a798ad46810e0799d36e20a84ae2564200fcb32d 
SHA256: ca68eff48f1e5b6158cd0f45571805717a8364a3d34ed469f4c9e76cfe88fada CREATED: Fri Feb 11 12:00:46 2022 MODIFIED: Fri Feb 11 12:00:46 2022 ACCESSED: Fri Feb 11 12:01:39 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_2 SUBSCORE: 2 
DESCRIPTION: Very low entropy - repeating sequence of couple of bytes REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 10 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:01:39Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_2
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		ImportTableIsBad
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 109

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:00:46                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FX1SK632CMUhiKK5lf.exe
Real Name:	/Microsoft-WindowsPhone-SEManagementProvider.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_2
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	ImportTableIsBad
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	1.0
ClamAV:	0
Loki:	109
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
1747.4862029323024
==================================================================


==================================================================
Fichier HTTP-FX1SK632CMUhiKK5lf.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FgaWlsSRIm5NYDp5e.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FgaWlsSRIm5NYDp5e.exe: Win.Malware.Facido-9768987-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.81 MB
Data read: 0.77 MB (ratio 1.06:1)
Time: 44.643 sec (0 m 44 s)
Start Date: 2022:02:11 12:01:40
End Date:   2022:02:11 12:02:25

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Facido-9768987-0

Score total: 50.0

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 30: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 29: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 30: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 26: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 25: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 24: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 23: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 22: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 17: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 16: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 20: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 19: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 18: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 17: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 16: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 79: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 71: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 64: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 33: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 32: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 26: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 25: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 24: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 23: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 22: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x93 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x93 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x93 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x93 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x93 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdb in position 25: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfa in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfa in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfa in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 79: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 71: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 63: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 62: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 55: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 47: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 46: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 39: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 31: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 30: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 23: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:01:41Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FgaWlsSRIm5NYDp5e.exe SCORE: 894 TYPE: EXE SIZE: 805888 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4f70393400> 
MD5: c3d495bb065e8f3690efc50c70fc8c67 
SHA1: aebe79d986bedaa5ba4e2f5c7402fd759dff50cf 
SHA256: bc452cc1128ccf7fa9f76d83cda79132740414973600fed14509749fe946816e CREATED: Fri Feb 11 12:01:40 2022 MODIFIED: Fri Feb 11 12:01:40 2022 ACCESSED: Fri Feb 11 12:02:31 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: Typical_Malware_String_Transforms SUBSCORE: 60 
DESCRIPTION: Detects typical strings in a reversed or otherwise modified form REF: Internal Research AUTHOR: Florian Roth 
MATCHES: Str1: exe.23lldnur Str2: paeHssecorPteG Str3: sserddAcorPteG
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e817060000e976ffffff Str2: e814f1ffffe960ffffff Str3: e8c07d0000e97ffeffff Str4: e83267ffffe9f3feffff Str5: e80241ffffe971ffffff Str6 ... (truncated)
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @@ Str2:  Str3: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_9: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: b868584d56bb00000000b90a000000ba58560000ed
REASON_17: Yara Rule MATCH: VM_Detect_VirtualPC_XEN_Wine_v1 SUBSCORE: 60 
DESCRIPTION: Xen detection, VirtualPC, Red Pill, Wine and other REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: ? Str2: 45c70001
REASON_18: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_19: Yara Rule MATCH: antivm_vmware SUBSCORE: 60 
DESCRIPTION: AntiVM checks for VMWare REF: - AUTHOR: x0r 
MATCHES: Str1: b868584d56bb00000000b90a000000ba58560000ed
REASON_20: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: ? Str2: 45c70001
REASON_21: Yara Rule MATCH: Antivirus_strings SUBSCORE: 50 
DESCRIPTION: Contains references to security software REF: - AUTHOR: Jerome Athias 
MATCHES: Str1: avgui.exe Str2: AvastSvc.exe
REASON_22: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_23: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_24: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: ? Str2: 45c70001
REASON_25: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_26: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_27: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_28: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 5f96de8e69f003326a5e73ab7da5f5c1 Str2: F5AACA05FCFBBAFDAACDDBDABDBBFCCD
REASON_29: Yara Rule MATCH: MD5_Constants SUBSCORE: 20 
DESCRIPTION: Look for MD5 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: 78a46ad7
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:02:33Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
10		ft_exe
60		Typical_Malware_String_Transforms
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
35		Embedded_PE
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		VM_Detect_VirtualPC_XEN_Wine_v1
35		Anti_Automated_Sandbox
60		antivm_vmware
60		vmdetect_2
50		Antivirus_strings
40		SEH_Save
40		SEH_Init
60		vmdetect
10		anti_dbg
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1
20		MD5_Constants

Score total: 894

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 58/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:01:40                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FgaWlsSRIm5NYDp5e.exe
Real Name:	/bc452cc1128ccf7fa9f76d83cda79132740414973600fed14509749fe946816e.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
50	Win.Malware.Facido-9768987-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	win_files_operation
10	ft_exe
60	Typical_Malware_String_Transforms
2	math_entropy_6
5	executable_pe
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
35	Embedded_PE
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
60	VM_Detect_VirtualPC_XEN_Wine_v1
35	Anti_Automated_Sandbox
60	antivm_vmware
60	vmdetect_2
50	Antivirus_strings
40	SEH_Save
40	SEH_Init
60	vmdetect
10	anti_dbg
20	isExecutable
10	Contains_PE_File
10	Big_Numbers1
20	MD5_Constants

============================[ Scores ]============================
CAPA:	0
ClamAV:	50.0
Loki:	894
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
16798.407846499438
==================================================================


==================================================================
Fichier HTTP-FgaWlsSRIm5NYDp5e.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F16NI7yYre2JXlDbk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F16NI7yYre2JXlDbk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.19 MB
Data read: 0.18 MB (ratio 1.04:1)
Time: 43.582 sec (0 m 43 s)
Start Date: 2022:02:11 12:02:34
End Date:   2022:02:11 12:03:18

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:02:35Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F16NI7yYre2JXlDbk.exe SCORE: 159 TYPE: EXE SIZE: 189440 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb19fca9400> 
MD5: 2666097ee8cb3d4fd7b02eb8901246a5 
SHA1: bfdd9101a1941b7eee511681e1793541ef80008f 
SHA256: ddc1193d3545b1d93500c48b063dfd133273dea82a175207fb761360c1fe290f CREATED: Fri Feb 11 12:02:34 2022 MODIFIED: Fri Feb 11 12:02:34 2022 ACCESSED: Fri Feb 11 12:03:29 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:03:29Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 159

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2666097ee8cb3d4fd7b02eb8901246a5                                                   |
| sha1                   | bfdd9101a1941b7eee511681e1793541ef80008f                                           |
| sha256                 | ddc1193d3545b1d93500c48b063dfd133273dea82a175207fb761360c1fe290f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F16NI7yYre2JXlDbk.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| hash data using fnv                                  | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (9 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 6.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:02:34                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F16NI7yYre2JXlDbk.exe
Real Name:	/Microsoft-Windows-Internal-Shell-NearShareExperience.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	6.0
ClamAV:	0
Loki:	159
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
2639.6959149113027
==================================================================


==================================================================
Fichier HTTP-F16NI7yYre2JXlDbk.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FbZ4z32tv6MjvKmEp1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 4bdd67ff852c221112337fecd0681eac                                                   |
| sha1                   | 4610093687b0f2c42fe80adca217988c8947a546                                           |
| sha256                 | d33d69b454efba519bffd3ba63c99ffce058e3105745f8a7ae699f72db1e70eb                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FbZ4z32tv6MjvKmEp1.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Process Hollowing \[T1055.012]\                                 |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Resume Thread:: [C0054]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| compiled with Borland Delphi                         | compiler/delphi                                      |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| accept command line arguments                        | host-interaction/cli                                 |
| create process on Windows                            | host-interaction/process/create                      |
| allocate RWX memory (2 matches)                      | host-interaction/process/inject                      |
| use process replacement                              | host-interaction/process/inject                      |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
| load NCR ATM library                                 | targeting/automated-teller-machine/ncr               |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
5		- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 12.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FbZ4z32tv6MjvKmEp1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 41.654 sec (0 m 41 s)
Start Date: 2022:02:11 12:03:38
End Date:   2022:02:11 12:04:19

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:03:38Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FbZ4z32tv6MjvKmEp1.exe SCORE: 100 TYPE: EXE SIZE: 93184 
FIRST_BYTES: 4d5a50000200000004000f00ffff0000b8000000 / <filter object at 0x7fe1b64e7400> 
MD5: 4bdd67ff852c221112337fecd0681eac 
SHA1: 4610093687b0f2c42fe80adca217988c8947a546 
SHA256: d33d69b454efba519bffd3ba63c99ffce058e3105745f8a7ae699f72db1e70eb CREATED: Fri Feb 11 12:03:38 2022 MODIFIED: Fri Feb 11 12:03:38 2022 ACCESSED: Fri Feb 11 12:04:31 2022 
REASON_1: Malware Hash TYPE: MD5 HASH: 4bdd67ff852c221112337fecd0681eac SUBSCORE: 100 DESC: SUCEFUL: Next Generation ATM Malware https://www.fireeye.com/blog/threat-research/2015/09/suceful_next_genera.html
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:04:31Z

-------- Score ----------------
Scores		Rules
.......		...............
100		Malware Hash

Score total: 100

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 49/64
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:03:38                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FbZ4z32tv6MjvKmEp1.exe
Real Name:	/4bdd67ff852c221112337fecd0681eac.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
5	- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
100	Malware Hash

============================[ Scores ]============================
CAPA:	12.0
ClamAV:	0
Loki:	100
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
3824.324670257379
==================================================================


==================================================================
Fichier HTTP-FbZ4z32tv6MjvKmEp1.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FaU5xW23TfC4EWcKU5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 70f7d4806f949550ba5ac0afec9c042f                                                   |
| sha1                   | b7a53f5f90a5b78e8663e7372dfa61517d57d72d                                           |
| sha256                 | 6e118b779673183850a0acb474efa30bc4e91d47925aee5311364112d660e4ee                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FaU5xW23TfC4EWcKU5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| print debug messages (2 matches)                     | host-interaction/log/debug/write-event               |
| create process on Windows                            | host-interaction/process/create                      |
| query or enumerate registry key                      | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| create thread                                        | host-interaction/thread/create                       |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::Query Registry [T1012;1]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 10.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FaU5xW23TfC4EWcKU5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 35.949 sec (0 m 35 s)
Start Date: 2022:02:11 12:04:33
End Date:   2022:02:11 12:05:09

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:04:33Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FaU5xW23TfC4EWcKU5.exe SCORE: 354 TYPE: EXE SIZE: 78336 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7faafaf0f400> 
MD5: 70f7d4806f949550ba5ac0afec9c042f 
SHA1: b7a53f5f90a5b78e8663e7372dfa61517d57d72d 
SHA256: 6e118b779673183850a0acb474efa30bc4e91d47925aee5311364112d660e4ee CREATED: Fri Feb 11 12:04:33 2022 MODIFIED: Fri Feb 11 12:04:33 2022 ACCESSED: Fri Feb 11 12:05:27 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: Advapi32.dll Str2: ADVAPI32.dll Str3: RegCloseKey
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:05:27Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 354

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/64
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:04:33                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FaU5xW23TfC4EWcKU5.exe
Real Name:	/TSWbPrxy.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::Query Registry [T1012;1]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
30	Check_OutputDebugStringA_iat_v1
30	Check_OutputDebugStringA_iat
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	10.5
ClamAV:	0
Loki:	354
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5820.024444384074
==================================================================


==================================================================
Fichier HTTP-FaU5xW23TfC4EWcKU5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F4l6LB32oOuXzpVI0f.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a0dea5c1f4ad089439054c8c0ae8c8ea                                                   |
| sha1                   | 5f7f1fb7dc8822573ba9130fc5395ea8d94d0258                                           |
| sha256                 | 192e53a11e563333ea528dd2682bf97690f7d9b4b15dfb8fd111a39980a513ec                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F4l6LB32oOuXzpVI0f.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F4l6LB32oOuXzpVI0f.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 43.156 sec (0 m 43 s)
Start Date: 2022:02:11 12:05:28
End Date:   2022:02:11 12:06:11

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:05:28Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-F4l6LB32oOuXzpVI0f.exe SCORE: 99 TYPE: EXE SIZE: 67584 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f2266686400> 
MD5: a0dea5c1f4ad089439054c8c0ae8c8ea 
SHA1: 5f7f1fb7dc8822573ba9130fc5395ea8d94d0258 
SHA256: 192e53a11e563333ea528dd2682bf97690f7d9b4b15dfb8fd111a39980a513ec CREATED: Fri Feb 11 12:05:28 2022 MODIFIED: Fri Feb 11 12:05:28 2022 ACCESSED: Fri Feb 11 12:06:19 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:06:20Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 99

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/60
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:05:28                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F4l6LB32oOuXzpVI0f.exe
Real Name:	/threadpoolwinrt.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	99
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
1628.9021299855685
==================================================================


==================================================================
Fichier HTTP-F4l6LB32oOuXzpVI0f.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FBQ3QqcGeheh8857l.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FBQ3QqcGeheh8857l.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.33 MB
Data read: 0.31 MB (ratio 1.05:1)
Time: 38.625 sec (0 m 38 s)
Start Date: 2022:02:11 12:06:21
End Date:   2022:02:11 12:06:59

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:06:21Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FBQ3QqcGeheh8857l.exe SCORE: 379 TYPE: EXE SIZE: 329728 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd6d5314400> 
MD5: f2aa55885a2c014da99f1355f3f71e4a 
SHA1: f5671266fbf3ffbc32caa2c1effa1768893d0173 
SHA256: 508e5f70c29502d7ba66a35959a327e3d658514496ee7b9155d95e7409eb4fb8 CREATED: Fri Feb 11 12:06:21 2022 MODIFIED: Fri Feb 11 12:06:21 2022 ACCESSED: Fri Feb 11 12:07:05 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: Antivirus_strings SUBSCORE: 50 
DESCRIPTION: Contains references to security software REF: - AUTHOR: Jerome Athias 
MATCHES: Str1: rshell.exe
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:07:06Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
50		Antivirus_strings
20		isExecutable
10		Contains_PE_File

Score total: 379

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f2aa55885a2c014da99f1355f3f71e4a                                                   |
| sha1                   | f5671266fbf3ffbc32caa2c1effa1768893d0173                                           |
| sha256                 | 508e5f70c29502d7ba66a35959a327e3d658514496ee7b9155d95e7409eb4fb8                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FBQ3QqcGeheh8857l.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)  | executable/resource                                  |
| interact with driver via control codes (3 matches)   | host-interaction/driver                              |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path (4 matches)                     | host-interaction/file-system                         |
| create directory                                     | host-interaction/file-system/create                  |
| delete directory                                     | host-interaction/file-system/delete                  |
| delete file (2 matches)                              | host-interaction/file-system/delete                  |
| check if file exists (3 matches)                     | host-interaction/file-system/exists                  |
| get file attributes (5 matches)                      | host-interaction/file-system/meta                    |
| move file                                            | host-interaction/file-system/move                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| enumerate disk volumes                               | host-interaction/hardware/storage                    |
| get disk information (3 matches)                     | host-interaction/hardware/storage                    |
| get disk size (2 matches)                            | host-interaction/hardware/storage                    |
| get hostname                                         | host-interaction/os/hostname                         |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| create process on Windows                            | host-interaction/process/create                      |
| create or open registry key (5 matches)              | host-interaction/registry                            |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| query service status (2 matches)                     | host-interaction/service                             |
| start service                                        | host-interaction/service/start                       |
| get token membership                                 | host-interaction/session                             |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 30.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:06:21                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FBQ3QqcGeheh8857l.exe
Real Name:	/wbadmin.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
3	- Discovery::System Owner/User Discovery [T1033;3]
1	- Discovery::System Information Discovery [T1082;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1	- Discovery::Query Registry [T1012;1]
3	- Execution::System Services::Service Execution [T1569.002;3]
2	- Discovery::File and Directory Discovery [T1083;2]
4	- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	win_files_operation
10	ft_exe
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
50	Antivirus_strings
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	30.5
ClamAV:	0
Loki:	379
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
6615.3002054931285
==================================================================


==================================================================
Fichier HTTP-FBQ3QqcGeheh8857l.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FpL5wj3tQyZ7cQMfb4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FpL5wj3tQyZ7cQMfb4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.18 MB
Data read: 0.17 MB (ratio 1.05:1)
Time: 26.163 sec (0 m 26 s)
Start Date: 2022:02:11 12:07:47
End Date:   2022:02:11 12:08:13

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2116190ae866163ed485c4fd3e13d03b                                                   |
| sha1                   | 664654a40696f13dc8e23bd2df32ba55a6e0da20                                           |
| sha256                 | 608af8aef15ba4f75996d46249a428ebbff1551de06f6eb6a053c2c330da6965                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FpL5wj3tQyZ7cQMfb4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag                     | anti-analysis/anti-debugging/debugger-detection      |
| get geographical location                            | collection                                           |
| check HTTP status code                               | communication/http/client                            |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes (3 matches)   | host-interaction/driver                              |
| get system information on Windows (3 matches)        | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| terminate process via fastfail (3 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry key (2 matches)          | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| delete registry value (3 matches)                    | host-interaction/registry/delete                     |
| get kernel32 base address (6 matches)                | linking/runtime-linking                              |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
1.5		- Discovery::System Location Discovery [T1614;1.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 25.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:07:47Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FpL5wj3tQyZ7cQMfb4.exe SCORE: 304 TYPE: EXE SIZE: 177976 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f605fe09400> 
MD5: 2116190ae866163ed485c4fd3e13d03b 
SHA1: 664654a40696f13dc8e23bd2df32ba55a6e0da20 
SHA256: 608af8aef15ba4f75996d46249a428ebbff1551de06f6eb6a053c2c330da6965 CREATED: Fri Feb 11 12:07:47 2022 MODIFIED: Fri Feb 11 12:07:47 2022 ACCESSED: Fri Feb 11 12:08:28 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e83b0500004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:08:29Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 304

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:07:47                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FpL5wj3tQyZ7cQMfb4.exe
Real Name:	/verifier.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
3	- Execution::System Services::Service Execution [T1569.002;3]
1.5	- Discovery::System Location Discovery [T1614;1.5]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	25.0
ClamAV:	0
Loki:	304
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5316.890883824005
==================================================================


==================================================================
Fichier HTTP-FpL5wj3tQyZ7cQMfb4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FSxpiW2dGBcYt3UfB4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a7f21e412022554d187d6a876a3c08ac                                                   |
| sha1                   | 70e39bdfcaa4bcf0021311e8298266e527cf7c97                                           |
| sha256                 | 9b683d2fda7ca7adcc043e4412271009a0e115ca55f9a718c385a3f46b57ae6b                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FSxpiW2dGBcYt3UfB4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Application Hook [F0002.001]                                      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| log keystrokes via application hook                  | collection/keylog                                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| find graphical window                                | host-interaction/gui/window/find                     |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| hide graphical window                                | host-interaction/gui/window/hide                     |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
4		- Discovery::Application Window Discovery [T1010;4]
6		- Collection::Input Capture::Keylogging [T1056.001;6]

Score total: 16.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FSxpiW2dGBcYt3UfB4.exe: Win.Keylogger.Generic-9937589-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 39.603 sec (0 m 39 s)
Start Date: 2022:02:11 12:08:30
End Date:   2022:02:11 12:09:09

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Keylogger.Generic-9937589-0

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 54: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 12: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xaa in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x86 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc4 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 54: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 39: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe1 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 4-5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd9 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 4-5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x86 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 8: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdb in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbe in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbf in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbb in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbb in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x94 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbb in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 3-4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xba in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfd in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 26: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8e in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfd in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xac in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbc in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd7 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfb in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb0 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 9: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf4 in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbb in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbf in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xba in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdf in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 9: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe4 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 9: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdc in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbc in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8e in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfd in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 22: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x97 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:08:30Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FSxpiW2dGBcYt3UfB4.exe SCORE: 704 TYPE: EXE SIZE: 24576 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f06e6ead400> 
MD5: a7f21e412022554d187d6a876a3c08ac 
SHA1: 70e39bdfcaa4bcf0021311e8298266e527cf7c97 
SHA256: 9b683d2fda7ca7adcc043e4412271009a0e115ca55f9a718c385a3f46b57ae6b CREATED: Fri Feb 11 12:08:30 2022 MODIFIED: Fri Feb 11 12:08:30 2022 ACCESSED: Fri Feb 11 12:09:24 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: CreateFileA
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff68c8404000681c22400064a100000000506489250000000083ec105356578965e8ff153c40400033d28ad48915745b40008bc881e1ff0000008 ... (truncated)
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68c8404000681c22400064a10000000050 Str2: 558bec6aff6808444000681c22400064a10000000050 Str3: 558bec6aff6820444000681c2240006 ... (truncated)
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68c8404000681c22400064a10000000050 Str2: 558bec6aff6808444000681c22400064a10000000050 Str3: 558bec6aff6820444000681c2240006 ... (truncated)
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83 Str2: 558bec6a Str3: 558bec53 Str4: 558bec51 Str5: 558bec8b Str6: 558bec81 Str7: 558bec57 Str8: 558bec6aff68c8404000681c2240 ... (truncated)
REASON_10: Yara Rule MATCH: Armadillo_v4x SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000558b Str2: 0000000000000000 ... (truncated)
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68c8404000681c22400064a1000000005064892500000000 Str2: 558bec6aff6808444000681c22400064a1000000005064892500000000 Str3: 558 ... (truncated)
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: USER32.dll Str3: UnhookWindowsHookEx Str4: SetWindowsHookExA Str5: CallNextHookEx
REASON_17: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_18: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: DarkComet_Keylogs_Memory SUBSCORE: 65 
DESCRIPTION: not set REF: http://www.tekdefense.com/news/2013/12/23/analyzing-darkcomet-in-memory.html AUTHOR: - 
MATCHES: Str1: [DEL]
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:09:24Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		ft_exe
2		math_entropy_4
5		executable_pe
15		dll_injection_hook
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Armadillo_v4x
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsConsole
10		HasRichSignature
2		PE_File
35		Win_Hook_v12
40		SEH_Save
40		SEH_Init
20		isExecutable
65		DarkComet_Keylogs_Memory
10		Contains_PE_File

Score total: 704

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 43/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:08:30                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FSxpiW2dGBcYt3UfB4.exe
Real Name:	/Practical Malware Analysis Lab 12-03.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6	- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
4	- Discovery::Application Window Discovery [T1010;4]
6	- Collection::Input Capture::Keylogging [T1056.001;6]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
45	Win.Keylogger.Generic-9937589-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	ft_exe
2	math_entropy_4
5	executable_pe
15	dll_injection_hook
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Armadillo_v4x
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsConsole
10	HasRichSignature
2	PE_File
35	Win_Hook_v12
40	SEH_Save
40	SEH_Init
20	isExecutable
65	DarkComet_Keylogs_Memory
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	16.0
ClamAV:	45.0
Loki:	704
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
14043.406480628633
==================================================================


==================================================================
Fichier HTTP-FSxpiW2dGBcYt3UfB4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FCK2LeItEJDVIPVN.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FCK2LeItEJDVIPVN.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.66 MB
Data read: 0.62 MB (ratio 1.06:1)
Time: 42.237 sec (0 m 42 s)
Start Date: 2022:02:11 12:09:25
End Date:   2022:02:11 12:10:07

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 79: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 26: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 21: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 20: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 19: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 18: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 17: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 16: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 79: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 26: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 21: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 20: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 19: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 18: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 17: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 16: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 79: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 61: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 45: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 22: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:09:25Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FCK2LeItEJDVIPVN.exe SCORE: 644 TYPE: EXE SIZE: 650752 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd240c61400> 
MD5: a563c50c5fa0fd541248acaf72cc4e7d 
SHA1: 4b8c12b074e20a796071aa50dc82fe2ff755e8f6 
SHA256: 180f82bbedb03dc29328e32e054069870a1e65078b78b2120a84c96aaed7d843 CREATED: Fri Feb 11 12:09:25 2022 MODIFIED: Fri Feb 11 12:09:25 2022 ACCESSED: Fri Feb 11 12:10:13 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: user32.dll Str3: USER32.DLL Str4: USER32.dll Str5: GetDC
REASON_2: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: USER32.DLL Str3: USER32.dll Str4: GetKeyState
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_4: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WritePrivateProfileStringA
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: CreateFileA Str7: FindFirstFileA Str8: Find ... (truncated)
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645d0ccc645d1ccc645d2ccc645 Str2: c645d1ccc645d2ccc645d3ccc645 Str3: c645d2ccc645d3ccc645d4ccc645 Str4: c645d3ccc645d4ccc645d5ccc645 ... (truncated)
REASON_9: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_10: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8efdeffffe958ffffff Str2: e8c6600000e95dfdffff Str3: e8ac600000e96dfeffff Str4: e856740000e978feffff Str5: e881ecffffe9ddffffff Str6 ... (truncated)
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @@ Str2:  Str3: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_18: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: USER32.DLL Str3: USER32.dll Str4: UnhookWindowsHookEx Str5: SetWindowsHookExA Str6: CallNextHookEx
REASON_19: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_20: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_21: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: IsDebuggerPresent
REASON_22: Yara Rule MATCH: IceID_Bank_trojan SUBSCORE: 60 
DESCRIPTION: Detects IcedID..adjusted several times REF: - AUTHOR: unixfreaxjp 
MATCHES: Str1: MZ Str2: e856740000e978feffff6a0c68586b Str3: CCmdTarget Str4: CUserException Str5: FlsGetValue Str6: AVCShellWrapper@@ Str7: AVCCmdT ... (truncated)
REASON_23: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_24: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:10:14Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
80		keylogger
20		win_registry
10		win_private_profile
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
15		dll_injection_hook
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
35		Win_Hook_v12
40		SEH_Save
40		SEH_Init
10		anti_dbg
60		IceID_Bank_trojan
20		isExecutable
10		Contains_PE_File

Score total: 644

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================[ Vérification MalwareBazaar ]==================
Fichier trouvé !
Malware connu -> Score: 2000
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 48/67
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:09:25                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FCK2LeItEJDVIPVN.exe
Real Name:	/a563c50c5fa0fd541248acaf72cc4e7d.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
65	screenshot
80	keylogger
20	win_registry
10	win_private_profile
10	win_files_operation
10	ft_exe
2	math_entropy_6
5	obfuscation_singlebyte_mov
5	executable_pe
15	dll_injection_hook
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
35	Win_Hook_v12
40	SEH_Save
40	SEH_Init
10	anti_dbg
60	IceID_Bank_trojan
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	0
ClamAV:	0
Loki:	644
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	2000
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
14206.71215944957
==================================================================


==================================================================
Fichier HTTP-FCK2LeItEJDVIPVN.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FLJTWj46Un4nDHPKbb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FLJTWj46Un4nDHPKbb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.68 MB
Data read: 0.64 MB (ratio 1.06:1)
Time: 42.223 sec (0 m 42 s)
Start Date: 2022:02:11 12:10:33
End Date:   2022:02:11 12:11:15

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:10:33Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FLJTWj46Un4nDHPKbb.exe SCORE: 259 TYPE: EXE SIZE: 673184 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7197b73400> 
MD5: f64a684e29e8e117c8b3b1087594a673 
SHA1: b5fabc9d29c542da40b351347a3226cb1e65bb5d 
SHA256: 126ab3b346252be7227fbdc67f9fdc5f66d698df771deb1a1fda6f6b1afe810a CREATED: Fri Feb 11 12:10:33 2022 MODIFIED: Fri Feb 11 12:10:33 2022 ACCESSED: Fri Feb 11 12:11:15 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 2 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: Debugger_Hiding__Thread SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetInformationThread
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
REASON_18: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:11:16Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_close_8
5		executable_pe
10		IsPE64
10		IsWindowsGUI
10		IsPacked
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
60		Debugger_Hiding__Thread
20		isExecutable
10		Contains_PE_File
20		SHA2_BLAKE2_IVs
5		BASE64_table

Score total: 259

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f64a684e29e8e117c8b3b1087594a673                                                   |
| sha1                   | b5fabc9d29c542da40b351347a3226cb1e65bb5d                                           |
| sha256                 | 126ab3b346252be7227fbdc67f9fdc5f66d698df771deb1a1fda6f6b1afe810a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FLJTWj46Un4nDHPKbb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
|                             | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| CRYPTOGRAPHY                | Cryptographic Hash::SHA256 [C0029.003]                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag                     | anti-analysis/anti-debugging/debugger-detection      |
| check for software breakpoints                       | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-VM instructions (161 matches)           | anti-analysis/anti-vm/vm-detection                   |
| encode data using Base64 (2 matches)                 | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (21 matches)                   | data-manipulation/encoding/xor                       |
| hash data using murmur3 (2 matches)                  | data-manipulation/hashing/murmur                     |
| hash data using SHA256                               | data-manipulation/hashing/sha256                     |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes               | host-interaction/driver                              |
| get system information on Windows                    | host-interaction/os/info                             |
| create or open registry key                          | host-interaction/registry                            |
| query or enumerate registry value                    | host-interaction/registry                            |
| parse PE header (9 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 20.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/69
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:10:33                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FLJTWj46Un4nDHPKbb.exe
Real Name:	/GenValObj.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
3	- Execution::System Services::Service Execution [T1569.002;3]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_close_8
5	executable_pe
10	IsPE64
10	IsWindowsGUI
10	IsPacked
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
60	Debugger_Hiding__Thread
20	isExecutable
10	Contains_PE_File
20	SHA2_BLAKE2_IVs
5	BASE64_table

============================[ Scores ]============================
CAPA:	20.0
ClamAV:	0
Loki:	259
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4503.92583146806
==================================================================


==================================================================
Fichier HTTP-FLJTWj46Un4nDHPKbb.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FvA0oa4YISHHutHwna.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FvA0oa4YISHHutHwna.exe: Win.Trojan.Helminth-3 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.30 MB
Data read: 0.29 MB (ratio 1.05:1)
Time: 45.153 sec (0 m 45 s)
Start Date: 2022:02:11 12:11:59
End Date:   2022:02:11 12:12:44

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Helminth-3

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:11:59Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FvA0oa4YISHHutHwna.exe SCORE: 524 TYPE: EXE SIZE: 305664 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe07e464400> 
MD5: 2a584dfc657348d164274a12bff9bbd8 
SHA1: bfeeba69f3d0f182e877e8a0efa4587fec821176 
SHA256: ef5f06c2d0518c52be10f97bd567210568611f35a954ff32af04c5bf7180bee1 CREATED: Fri Feb 11 12:11:59 2022 MODIFIED: Fri Feb 11 12:11:59 2022 ACCESSED: Fri Feb 11 12:12:53 2022 
REASON_1: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: socket Str3: connect
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegCloseKey
REASON_3: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: Kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: DeleteFileA Str7: CreateFileA
REASON_4: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_5: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_6: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetReadFile
REASON_7: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpQueryInfo
REASON_8: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_11: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_17: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_18: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_19: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_20: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_21: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_22: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: Kernel32.dll Str2: KERNEL32.dll Str3: IsDebuggerPresent Str4: OutputDebugString
REASON_23: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_24: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_25: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 55554444444141411111 Str2: 55554444222222111111 Str3: 55555555555555554444
REASON_26: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Advapi32.dll Str2: ADVAPI32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext
REASON_27: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_28: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
REASON_29: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:12:54Z

-------- Score ----------------
Scores		Rules
.......		...............
50		network_tcp_socket
20		win_registry
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
10		Big_Numbers0
20		Advapi_Hash_API
25		CRC32_poly_Constant
25		CRC32_table
5		BASE64_table

Score total: 524

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2a584dfc657348d164274a12bff9bbd8                                                   |
| sha1                   | bfeeba69f3d0f182e877e8a0efa4587fec821176                                           |
| sha256                 | ef5f06c2d0518c52be10f97bd567210568611f35a954ff32af04c5bf7180bee1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FvA0oa4YISHHutHwna.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Send Data [C0002.005]                                     |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::Set Socket Config [C0001.001]                           |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| receive data (2 matches)                             | communication                                        |
| send data (2 matches)                                | communication                                        |
| reference Google Public DNS server                   | communication/dns                                    |
| initialize Winsock library                           | communication/socket                                 |
| set socket configuration                             | communication/socket                                 |
| encode data using Base64 (2 matches)                 | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| encrypt or decrypt via WinCrypt                      | data-manipulation/encryption                         |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| encrypt data using RC4 via WinAPI                    | data-manipulation/encryption/rc4                     |
| hash data via WinCrypt                               | data-manipulation/hashing                            |
| initialize hashing via WinCrypt                      | data-manipulation/hashing                            |
| hash data with MD5                                   | data-manipulation/hashing/md5                        |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments (2 matches)            | host-interaction/cli                                 |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| get thread local storage value                       | host-interaction/process                             |
| terminate process via fastfail                       | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value                    | host-interaction/registry                            |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 44.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 50/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:11:59                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FvA0oa4YISHHutHwna.exe
Real Name:	/2a584dfc657348d164274a12bff9bbd8.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
8.5	- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1	- Discovery::Query Registry [T1012;1]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
45	Win.Trojan.Helminth-3

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	network_tcp_socket
20	win_registry
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	Str_Win32_Http_API
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE32
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
40	SEH_Save
40	SEH_Init
10	anti_dbg
20	isExecutable
10	Contains_PE_File
10	Big_Numbers0
20	Advapi_Hash_API
25	CRC32_poly_Constant
25	CRC32_table
5	BASE64_table

============================[ Scores ]============================
CAPA:	44.0
ClamAV:	45.0
Loki:	524
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
11749.272182389916
==================================================================


==================================================================
Fichier HTTP-FvA0oa4YISHHutHwna.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FiC8NM1MZxBf4etf2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FiC8NM1MZxBf4etf2.exe: Win.Malware.Oski-9882838-1 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.18 MB
Data read: 0.17 MB (ratio 1.05:1)
Time: 42.217 sec (0 m 42 s)
Start Date: 2022:02:11 12:13:01
End Date:   2022:02:11 12:13:43

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Oski-9882838-1

Score total: 50.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 62: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 46: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 30: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:13:01Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FiC8NM1MZxBf4etf2.exe SCORE: 669 TYPE: EXE SIZE: 183296 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd7964e5400> 
MD5: fbbaaf569b63f6398503e4f1979cabef 
SHA1: ff86094702212d76922e2300c8868c9398729c33 
SHA256: 0a5de60f8d242caa0bd01cb811358ce2fc9f2f8530013ab650d8ac1950cff5e1 CREATED: Fri Feb 11 12:13:01 2022 MODIFIED: Fri Feb 11 12:13:01 2022 ACCESSED: Fri Feb 11 12:13:55 2022 
REASON_1: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetOpenUrl Str5: InternetReadFile Str6: HttpOpenRequest Str7: HttpSen ... (truncated)
REASON_2: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_3: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_4: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CreateFileA Str7: FindFirstFileA Str8: FindC ... (truncated)
REASON_6: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_7: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_8: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_9: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: win_oski_auto SUBSCORE: 45 
DESCRIPTION: Detects win.oski. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 33c0e92bfeffff8bff558bec8b4508668b08 Str2: 83c120516a006a00 Str3: 25ff7f0000c38bff558bec83ec14ff7510 Str4: 50a1f4c44200508d8df0feffff ... (truncated)
REASON_11: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_13: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8d26e0000e989feffff Str2: e8d7fbffffe9b4feffff Str3: e841010000e919ffffff Str4: e831b1ffffe9fffeffff
REASON_14: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3: H3B Str4: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_15: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_18: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_20: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_21: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_22: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_23: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_24: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_25: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_26: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:13:55Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_http
65		screenshot
60		win_mutex
20		win_registry
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
45		win_oski_auto
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
25		CRC32_poly_Constant
25		CRC32_table

Score total: 669

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | fbbaaf569b63f6398503e4f1979cabef                                                   |
| sha1                   | ff86094702212d76922e2300c8868c9398729c33                                           |
| sha256                 | 0a5de60f8d242caa0bd01cb811358ce2fc9f2f8530013ab650d8ac1950cff5e1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FiC8NM1MZxBf4etf2.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Screen Capture:: \[T1113]\                                                         |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Screen Capture::WinAPI [E1113.m01]                                            |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
| CRYPTOGRAPHY                | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence:: [C0021]                                     |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Compression Library:: [C0060]                                                 |
|                             | Decompress Data::IEncodingFilterFactory [C0025.002]                           |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+----------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                               | NAMESPACE                                            |
|----------------------------------------------------------+------------------------------------------------------|
| capture screenshot                                       | collection/screenshot                                |
| receive data                                             | communication                                        |
| send data (2 matches)                                    | communication                                        |
| connect to HTTP server (2 matches)                       | communication/http/client                            |
| connect to URL                                           | communication/http/client                            |
| decompress HTTP response via IEncodingFilterFactory      | communication/http/client                            |
| decode data using Base64 via WinAPI                      | data-manipulation/encoding/base64                    |
| encode data using XOR (241 matches)                      | data-manipulation/encoding/xor                       |
| encrypt data using DPAPI (3 matches)                     | data-manipulation/encryption/dpapi                   |
| encrypt data using RC4 PRGA                              | data-manipulation/encryption/rc4                     |
| generate random numbers using the Delphi LCG (3 matches) | data-manipulation/prng/lcg                           |
| get common file path (10 matches)                        | host-interaction/file-system                         |
| copy file (5 matches)                                    | host-interaction/file-system/copy                    |
| create directory (2 matches)                             | host-interaction/file-system/create                  |
| delete directory (2 matches)                             | host-interaction/file-system/delete                  |
| delete file (7 matches)                                  | host-interaction/file-system/delete                  |
| check if file exists                                     | host-interaction/file-system/exists                  |
| enumerate files recursively (3 matches)                  | host-interaction/file-system/files/list              |
| get file size (2 matches)                                | host-interaction/file-system/meta                    |
| read .ini file                                           | host-interaction/file-system/read                    |
| read file on Windows (4 matches)                         | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                        | host-interaction/file-system/write                   |
| get memory capacity                                      | host-interaction/hardware/memory                     |
| check mutex and exit                                     | host-interaction/mutex                               |
| get hostname                                             | host-interaction/os/hostname                         |
| get system information on Windows                        | host-interaction/os/info                             |
| check OS version                                         | host-interaction/os/version                          |
| allocate thread local storage                            | host-interaction/process                             |
| create process on Windows (2 matches)                    | host-interaction/process/create                      |
| terminate process (2 matches)                            | host-interaction/process/terminate                   |
| query or enumerate registry key                          | host-interaction/registry                            |
| query or enumerate registry value (4 matches)            | host-interaction/registry                            |
| get session user name                                    | host-interaction/session                             |
| link many functions at runtime (5 matches)               | linking/runtime-linking                              |
| linked against XZip                                      | linking/static/xzip                                  |
| enumerate PE sections (2 matches)                        | load-code/pe                                         |
| parse PE header                                          | load-code/pe                                         |
+----------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
6		- Collection::Screen Capture [T1113;6]
1		- Discovery::Query Registry [T1012;1]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
3		- Discovery::Account Discovery [T1087;3]

Score total: 47.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 57/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:13:01                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FiC8NM1MZxBf4etf2.exe
Real Name:	/fbbaaf569b63f6398503e4f1979cabef.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
4	- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
3	- Discovery::System Owner/User Discovery [T1033;3]
1	- Discovery::System Information Discovery [T1082;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
6	- Collection::Screen Capture [T1113;6]
1	- Discovery::Query Registry [T1012;1]
2	- Discovery::File and Directory Discovery [T1083;2]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
3	- Discovery::Account Discovery [T1087;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
50	Win.Malware.Oski-9882838-1

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
45	network_http
65	screenshot
60	win_mutex
20	win_registry
10	win_files_operation
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	Str_Win32_Http_API
10	ft_exe
45	win_oski_auto
2	math_entropy_6
5	executable_pe
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
40	SEH_Save
40	SEH_Init
10	anti_dbg
20	isExecutable
10	Contains_PE_File
25	CRC32_poly_Constant
25	CRC32_table

============================[ Scores ]============================
CAPA:	47.5
ClamAV:	50.0
Loki:	669
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
14180.14776307215
==================================================================


==================================================================
Fichier HTTP-FiC8NM1MZxBf4etf2.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F5tDqvd4sWS734Cxa.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F5tDqvd4sWS734Cxa.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.23 MB
Data read: 0.22 MB (ratio 1.04:1)
Time: 25.896 sec (0 m 25 s)
Start Date: 2022:02:11 12:13:59
End Date:   2022:02:11 12:14:25

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe1 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:13:59Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F5tDqvd4sWS734Cxa.exe SCORE: 1089 TYPE: EXE SIZE: 232677 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f943cb9c400> 
MD5: 2a7429d60040465f9bd27bbae2beef88 
SHA1: e51e65cf9377c74dec0c4fdb1acfb725855ec17d 
SHA256: 943998273af79de9689508f66166c6b33cc2af5c06d9e97fd8db15f0e9b5bdc0 CREATED: Fri Feb 11 12:13:59 2022 MODIFIED: Fri Feb 11 12:13:59 2022 ACCESSED: Fri Feb 11 12:14:50 2022 
REASON_1: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: DNSAPI.dll Str3: DnsQuery
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 2 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: PEtite_v22_wwwun4seencompetite SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_8: Yara Rule MATCH: PEtite_v22 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_9: Yara Rule MATCH: PEtite_v22_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_10: Yara Rule MATCH: Petite_v21_1 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_11: Yara Rule MATCH: Petite_22_c1998_99_Ian_Luck SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c605068000040008b3c248b306681c780078d74060889388b5e1050566a026880080000576a206a065 ... (truncated)
REASON_12: Yara Rule MATCH: PEtite_v22_Ian_Luck SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_13: Yara Rule MATCH: Petite_v21_1_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_14: Yara Rule MATCH: Petite_v21_1_Hint_WIN_EP SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_15: Yara Rule MATCH: Petite_13_c1998_Ian_Luck_h SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c605068000040008b3c248b306681c780078d74060889388b5e1050566a026880080000576a206a065 ... (truncated)
REASON_16: Yara Rule MATCH: Petitev211 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_17: Yara Rule MATCH: PEtitev22 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: b800f0480068e130470064ff350000000064892500000000669c6050
REASON_18: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_21: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_22: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_23: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_24: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_25: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_26: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: .petite
REASON_27: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_28: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:14:51Z

-------- Score ----------------
Scores		Rules
.......		...............
50		network_dns
20		win_registry
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_close_8
5		executable_pe
70		PEtite_v22_wwwun4seencompetite
70		PEtite_v22
70		PEtite_v22_additional
70		Petite_v21_1
70		Petite_22_c1998_99_Ian_Luck
70		PEtite_v22_Ian_Luck
70		Petite_v21_1_additional
70		Petite_v21_1_Hint_WIN_EP
70		Petite_13_c1998_Ian_Luck_h
70		Petitev211
70		PEtitev22
10		IsPE32
10		IsWindowsGUI
10		IsPacked
10		HasOverlay
10		HasRichSignature
2		PE_File
40		SEH_Save
40		SEH_Init
60		suspicious_packer_section
20		isExecutable
10		Contains_PE_File

Score total: 1089

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 58/67
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:13:59                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F5tDqvd4sWS734Cxa.exe
Real Name:	/2a7429d60040465f9bd27bbae2beef88.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	network_dns
20	win_registry
10	Str_Win32_Winsock2_Library
10	ft_exe
2	math_entropy_close_8
5	executable_pe
70	PEtite_v22_wwwun4seencompetite
70	PEtite_v22
70	PEtite_v22_additional
70	Petite_v21_1
70	Petite_22_c1998_99_Ian_Luck
70	PEtite_v22_Ian_Luck
70	Petite_v21_1_additional
70	Petite_v21_1_Hint_WIN_EP
70	Petite_13_c1998_Ian_Luck_h
70	Petitev211
70	PEtitev22
10	IsPE32
10	IsWindowsGUI
10	IsPacked
10	HasOverlay
10	HasRichSignature
2	PE_File
40	SEH_Save
40	SEH_Init
60	suspicious_packer_section
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	0
ClamAV:	0
Loki:	1089
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
19259.486865901523
==================================================================


==================================================================
Fichier HTTP-F5tDqvd4sWS734Cxa.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FBK0HL2ykF47LXTnD2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FBK0HL2ykF47LXTnD2.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.44 MB
Data read: 0.41 MB (ratio 1.06:1)
Time: 45.173 sec (0 m 45 s)
Start Date: 2022:02:11 12:14:52
End Date:   2022:02:11 12:15:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:14:53Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:15:46Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5dd0b130d5c3d40c69e3972f39fd7d62                                                   |
| sha1                   | 985c53d34bb0b7c8ddb615b5ec41168dfc96802c                                           |
| sha256                 | 708967cad421bb2396017bdd10a42e6799da27e29264f4b5fb095c0e3503e447                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FBK0HL2ykF47LXTnD2.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
|                        | Screen Capture:: \[T1113]\                                                         |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Indicator Removal on Host::File Deletion \[T1070.004]\                             |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Inhibit System Recovery:: \[T1490]\                                                |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
|                             | Screen Capture::WinAPI [E1113.m01]                                            |
| CRYPTOGRAPHY                | Generate Pseudo-random Sequence:: [C0021]                                     |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Disk Content Wipe::Delete Shadow Drive [F0014.001]                            |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Wallpaper:: [C0035]                                                           |
| PROCESS                     | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| inspect load icon resource                           | anti-analysis                                        |
| check for time delay via GetTickCount (2 matches)    | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-VM instructions (7 matches)             | anti-analysis/anti-vm/vm-detection                   |
| get geographical location (6 matches)                | collection                                           |
| log keystrokes                                       | collection/keylog                                    |
| log keystrokes via polling (7 matches)               | collection/keylog                                    |
| capture screenshot (2 matches)                       | collection/screenshot                                |
| compiled with Borland Delphi                         | compiler/delphi                                      |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| generate random numbers using the Delphi LCG         | data-manipulation/prng/lcg                           |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| manipulate boot configuration (2 matches)            | host-interaction/bootloader                          |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable                           | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| delete file                                          | host-interaction/file-system/delete                  |
| get file size (2 matches)                            | host-interaction/file-system/meta                    |
| get file version info                                | host-interaction/file-system/meta                    |
| read file on Windows (3 matches)                     | host-interaction/file-system/read                    |
| write file on Windows (4 matches)                    | host-interaction/file-system/write                   |
| enumerate gui resources (2 matches)                  | host-interaction/gui                                 |
| set application hook (2 matches)                     | host-interaction/gui                                 |
| set global application hook                          | host-interaction/gui                                 |
| change the wallpaper                                 | host-interaction/gui/session                         |
| find graphical window                                | host-interaction/gui/window/find                     |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| hide graphical window (7 matches)                    | host-interaction/gui/window/hide                     |
| get number of processors                             | host-interaction/hardware/cpu                        |
| get keyboard layout (2 matches)                      | host-interaction/hardware/keyboard/layout            |
| get disk information                                 | host-interaction/hardware/storage                    |
| get disk size                                        | host-interaction/hardware/storage                    |
| create mutex                                         | host-interaction/mutex                               |
| get system information on Windows                    | host-interaction/os/info                             |
| get thread local storage value                       | host-interaction/process                             |
| set thread local storage value                       | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry value (4 matches)        | host-interaction/registry                            |
| get session user name                                | host-interaction/session                             |
| create thread                                        | host-interaction/thread/create                       |
| delete volume shadow copies                          | impact/inhibit-system-recovery                       |
| link many functions at runtime (4 matches)           | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
4		- Execution::Command and Scripting Interpreter [T1059;4]
4		- Discovery::Application Window Discovery [T1010;4]
3		- Discovery::System Owner/User Discovery [T1033;3]
8.5		- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
6		- Collection::Screen Capture [T1113;6]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
3		- Discovery::Account Discovery [T1087;3]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1.5		- Discovery::System Location Discovery [T1614;1.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Inhibit System Recovery [T1490;8]
1		- Discovery::Query Registry [T1012;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 85.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 46/65
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:14:52                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FBK0HL2ykF47LXTnD2.exe
Real Name:	/5dd0b130d5c3d40c69e3972f39fd7d62.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6	- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
8.5	- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
4	- Execution::Command and Scripting Interpreter [T1059;4]
4	- Discovery::Application Window Discovery [T1010;4]
3	- Discovery::System Owner/User Discovery [T1033;3]
8.5	- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
6	- Collection::Screen Capture [T1113;6]
2	- Discovery::File and Directory Discovery [T1083;2]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
3	- Discovery::Account Discovery [T1087;3]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1.5	- Discovery::System Location Discovery [T1614;1.5]
6	- Collection::Input Capture::Keylogging [T1056.001;6]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1	- Discovery::System Information Discovery [T1082;1]
8	- Impact::Inhibit System Recovery [T1490;8]
1	- Discovery::Query Registry [T1012;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

============================[ Scores ]============================
CAPA:	85.5
ClamAV:	0
Loki:	0
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
3705.949279298392
==================================================================


==================================================================
Fichier HTTP-FBK0HL2ykF47LXTnD2.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FK4VQ91UvSkddHrIVa.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5e6764534b3a1e4d3abacc4810b6985d                                                   |
| sha1                   | f10ad287f126f577f197070453812a7e88c2cc52                                           |
| sha256                 | e7d3181ef643d77bb33fe328d1ea58f512b4f27c8e6ed71935a2e7548f2facc0                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FK4VQ91UvSkddHrIVa.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings targeting VMWare           | anti-analysis/anti-vm/vm-detection                   |
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| enumerate gui resources                              | host-interaction/gui                                 |
| link function at runtime on Windows                  | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 16.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FK4VQ91UvSkddHrIVa.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.77 MB
Data read: 0.72 MB (ratio 1.06:1)
Time: 40.301 sec (0 m 40 s)
Start Date: 2022:02:11 12:17:57
End Date:   2022:02:11 12:18:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:17:57Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FK4VQ91UvSkddHrIVa.exe SCORE: 474 TYPE: EXE SIZE: 757760 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7febe71b5400> 
MD5: 5e6764534b3a1e4d3abacc4810b6985d 
SHA1: f10ad287f126f577f197070453812a7e88c2cc52 
SHA256: e7d3181ef643d77bb33fe328d1ea58f512b4f27c8e6ed71935a2e7548f2facc0 CREATED: Fri Feb 11 12:17:57 2022 MODIFIED: Fri Feb 11 12:17:57 2022 ACCESSED: Fri Feb 11 12:18:51 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645c856c645c969c645ca72c645 Str2: c645c969c645ca72c645cb74c645 Str3: c645ca72c645cb74c645cc75c645 Str4: c645cb74c645cc75c645cd61c645 ... (truncated)
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff682896430068f42a400064a100000000506489250000000083ec68535657
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff682896430068f42a400064a10000000050
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff682896430068f42a400064a10000000050
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6a Str2: 558beca1 Str3: 558bec51 Str4: 558bece8 Str5: 558bec68 Str6: 558bec8b Str7: 558bec53 Str8: 558bec83 Str9: 558becb9 Str1 ... (truncated)
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff682896430068f42a400064a1000000005064892500000000
REASON_10: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:18:54Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 474

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 55/67
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:17:57                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FK4VQ91UvSkddHrIVa.exe
Real Name:	/5e6764534b3a1e4d3abacc4810b6985d.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_6
5	obfuscation_singlebyte_mov
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	16.5
ClamAV:	0
Loki:	474
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
9841.612014235543
==================================================================


==================================================================
Fichier HTTP-FK4VQ91UvSkddHrIVa.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F3mqrO2hU3Qrmtgdu2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be a .NET module.
WARNING:capa: 
WARNING:capa: .NET is a cross-platform framework for running managed applications.
WARNING:capa: capa cannot handle non-native files. This means that the results may be misleading or incomplete.
WARNING:capa: You may have to analyze the file manually, using a tool like the .NET decompiler dnSpy.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) dotnet file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F3mqrO2hU3Qrmtgdu2.exe: Win.Malware.Zusy-6866357-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-F3mqrO2hU3Qrmtgdu2.exe: Win.Packed.Bladabindi-6866359-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 42.745 sec (0 m 42 s)
Start Date: 2022:02:11 12:18:56
End Date:   2022:02:11 12:19:38

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Zusy-6866357-0
40		Win.Packed.Bladabindi-6866359-0

Score total: 90.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 36: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:18:56Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F3mqrO2hU3Qrmtgdu2.exe SCORE: 654 TYPE: EXE SIZE: 39424 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7efc15bc1400> 
MD5: b9f5bd514485fb06da39beff051b9fdc 
SHA1: c72a2e50410475a51d897d29ffbbaf2103754d53 
SHA256: 34acc4c0b61b5ce0b37c3589f97d1f23e6d84011a241e6f85683ee517ce786f1 CREATED: Fri Feb 11 12:18:56 2022 MODIFIED: Fri Feb 11 12:18:56 2022 ACCESSED: Fri Feb 11 12:19:45 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_7 SUBSCORE: 2 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: dotnet_libraries SUBSCORE: 5 
DESCRIPTION: .Net runtime mscoree.dll mscorwks.dll REF: - AUTHOR: - 
MATCHES: Str1: mscoree.dll Str2: _CorExeMain
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Studio_NET SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: ff250020400000000000000000000000000000000000000000000000000000000000000000000000
REASON_6: Yara Rule MATCH: Microsoft_Visual_C_v70_Basic_NET_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: ff2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
REASON_7: Yara Rule MATCH: Microsoft_Visual_C_Basic_NET SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: ff2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
REASON_8: Yara Rule MATCH: Microsoft_Visual_Studio_NET_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: ff250020400000000000000000000000000000000000000000000000000000000000000000000000
REASON_9: Yara Rule MATCH: Microsoft_Visual_C_v70_Basic_NET SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: ff2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
REASON_10: Yara Rule MATCH: NET_executable_ SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: ff2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
REASON_11: Yara Rule MATCH: NET_executable SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: ff2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
REASON_12: Yara Rule MATCH: NETexecutableMicrosoft SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: 00000000000000005f436f724578654d61696e006d73636f7265652e646c6c0000000000ff25
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsNET_EXE SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:19:45Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_7
5		dotnet_libraries
5		executable_pe
70		Microsoft_Visual_Studio_NET
70		Microsoft_Visual_C_v70_Basic_NET_additional
70		Microsoft_Visual_C_Basic_NET
70		Microsoft_Visual_Studio_NET_additional
70		Microsoft_Visual_C_v70_Basic_NET
70		NET_executable_
70		NET_executable
70		NETexecutableMicrosoft
10		IsPE32
10		IsNET_EXE
10		IsWindowsGUI
10		IsPacked
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 654

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 54/66
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:18:56                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F3mqrO2hU3Qrmtgdu2.exe
Real Name:	/b9f5bd514485fb06da39beff051b9fdc.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
50	Win.Malware.Zusy-6866357-0
40	Win.Packed.Bladabindi-6866359-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_7
5	dotnet_libraries
5	executable_pe
70	Microsoft_Visual_Studio_NET
70	Microsoft_Visual_C_v70_Basic_NET_additional
70	Microsoft_Visual_C_Basic_NET
70	Microsoft_Visual_Studio_NET_additional
70	Microsoft_Visual_C_v70_Basic_NET
70	NET_executable_
70	NET_executable
70	NETexecutableMicrosoft
10	IsPE32
10	IsNET_EXE
10	IsWindowsGUI
10	IsPacked
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	0
ClamAV:	90.0
Loki:	654
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
13498.23434931043
==================================================================


==================================================================
Fichier HTTP-F3mqrO2hU3Qrmtgdu2.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fd4shN16mw1rrG9PE5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3f8e2b945deba235fa4888682bd0d640                                                   |
| sha1                   | d4e234ec4baf7d12dd59c3a9238326819a509a31                                           |
| sha256                 | 75eb05679a0a988dddf8badfc6d5996cc7e372c73e1023dde59efbaab6ece655                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fd4shN16mw1rrG9PE5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                         |
| DISCOVERY              | System Network Configuration Discovery::Internet Connection Discovery \[T1016.001]\ |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Set Registry Key [C0036.001]                                        |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| receive data                                         | communication                                        |
| copy file                                            | host-interaction/file-system/copy                    |
| create directory                                     | host-interaction/file-system/create                  |
| delete file                                          | host-interaction/file-system/delete                  |
| check Internet connectivity via WinINet              | host-interaction/network/connectivity                |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2		- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 28.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fd4shN16mw1rrG9PE5.exe: Win.Trojan.Agent-6298583-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 43.215 sec (0 m 43 s)
Start Date: 2022:02:11 12:19:46
End Date:   2022:02:11 12:20:29

-------- Score ----------------
Scores		Rules
.......		...............
70		Win.Trojan.Agent-6298583-0
75		Win.Trojan.Agent-6298583-0
45		Win.Trojan.Agent-6298583-0

Score total: 190.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 42/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:19:45                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fd4shN16mw1rrG9PE5.exe
Real Name:	/Practical Malware Analysis Lab 06-03.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2	- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
70	Win.Trojan.Agent-6298583-0
75	Win.Trojan.Agent-6298583-0
45	Win.Trojan.Agent-6298583-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	win_files_operation
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	ft_exe
2	math_entropy_4
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Armadillo_v4x
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsConsole
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
40	SEH_Save
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	28.5
ClamAV:	190.0
Loki:	664
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
15484.29884011684
==================================================================


==================================================================
Fichier HTTP-Fd4shN16mw1rrG9PE5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F7z2D03xTmu340gVNa.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 89e7c865c8d862c55404b8b9a5f4b371                                                   |
| sha1                   | 54f5e4c43388c958a1ed947e2bb9e0e5d8a43277                                           |
| sha256                 | b48d5b58d9bbf92fbffba06d98e695218676d3ba1d4a060c08e3b9ef1650110c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F7z2D03xTmu340gVNa.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F7z2D03xTmu340gVNa.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.08 MB
Data read: 0.08 MB (ratio 1.00:1)
Time: 43.290 sec (0 m 43 s)
Start Date: 2022:02:11 12:20:38
End Date:   2022:02:11 12:21:21

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:20:38Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F7z2D03xTmu340gVNa.exe SCORE: 239 TYPE: EXE SIZE: 83968 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f41c3dde400> 
MD5: 89e7c865c8d862c55404b8b9a5f4b371 
SHA1: 54f5e4c43388c958a1ed947e2bb9e0e5d8a43277 
SHA256: b48d5b58d9bbf92fbffba06d98e695218676d3ba1d4a060c08e3b9ef1650110c CREATED: Fri Feb 11 12:20:38 2022 MODIFIED: Fri Feb 11 12:20:38 2022 ACCESSED: Fri Feb 11 12:21:31 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_7 SUBSCORE: 2 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e86b0200004883c428e97efdffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:21:31Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_7
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		IsPacked
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 239

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:20:38                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F7z2D03xTmu340gVNa.exe
Real Name:	/MSchedExe.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_7
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	IsPacked
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	239
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3847.7525994311272
==================================================================


==================================================================
Fichier HTTP-F7z2D03xTmu340gVNa.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FLiAEP1cPw80iQJFr4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FLiAEP1cPw80iQJFr4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.65 MB
Data read: 0.62 MB (ratio 1.06:1)
Time: 41.328 sec (0 m 41 s)
Start Date: 2022:02:11 12:21:33
End Date:   2022:02:11 12:22:14

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0
sh: 279: Syntax error: Unterminated quoted string

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c3341b7dfbb9d43bca8c812e07b4299f                                                   |
| sha1                   | 3a3e93cffca2a2cbaca24cb89cf8797c9aad7f97                                           |
| sha256                 | 17e53dc9559040773a1a3537f7d1c0ebe38929b905cb998f5c4cd9a2e435627f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FLiAEP1cPw80iQJFr4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-VM instructions (3 matches)             | anti-analysis/anti-vm/vm-detection                   |
| compiled with rust                                   | compiler/rust                                        |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA (3 matches)              | data-manipulation/encryption/rc4                     |
| hash data using murmur3                              | data-manipulation/hashing/murmur                     |
| contains PDB path                                    | executable/pe/pdb                                    |
| list groups for user account                         | host-interaction/accounts                            |
| list user accounts                                   | host-interaction/accounts                            |
| accept command line arguments                        | host-interaction/cli                                 |
| interact with driver via control codes               | host-interaction/driver                              |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| read file on Windows (3 matches)                     | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| references logon banner                              | host-interaction/gui/logon                           |
| get hostname                                         | host-interaction/os/hostname                         |
| allocate thread local storage                        | host-interaction/process                             |
| get thread local storage value (9 matches)           | host-interaction/process                             |
| set thread local storage value (10 matches)          | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| set registry value                                   | host-interaction/registry/create                     |
| get logon sessions                                   | host-interaction/session                             |
| get kernel32 base address                            | linking/runtime-linking                              |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| enumerate PE sections (23 matches)                   | load-code/pe                                         |
| parse PE exports (47 matches)                        | load-code/pe                                         |
| parse PE header (102 matches)                        | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
3		- Discovery::Account Discovery [T1087;3]

Score total: 28.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 34/71
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:21:33                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FLiAEP1cPw80iQJFr4.exe
Real Name:	/c3341b7dfbb9d43bca8c812e07b4299f.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::System Information Discovery [T1082;1]
3	- Execution::System Services::Service Execution [T1569.002;3]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
3	- Discovery::Account Discovery [T1087;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
80	cred_local
20	win_registry
10	win_files_operation
10	ft_exe
50	ConventionEngine_Term_Users
2	math_entropy_6
5	executable_pe
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
60	antisb_threatExpert
60	SEH__vectored_v1
40	SEH_Save
40	SEH_Init
10	anti_dbg
20	isExecutable
10	Contains_PE_File
10	Big_Numbers1
20	SHA2_BLAKE2_IVs
5	BASE64_table
15	SipHash_big_endian_constants

============================[ Scores ]============================
CAPA:	28.0
ClamAV:	0
Loki:	684
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
13399.342884625301
==================================================================


==================================================================
Fichier HTTP-FLiAEP1cPw80iQJFr4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FbJu6n9xzp1N1CkLh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9de952f476abab0cd62bfd81e20a3deb                                                   |
| sha1                   | 109cc4467b78dad4b12a3225020ea590bccee3e6                                           |
| sha256                 | e9cb6336359ac6f71ac75af2836efb28daa3bafd10a1f0b775dcdc2ec8850a6b                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FbJu6n9xzp1N1CkLh.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                            |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DEFENSE EVASION             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| create new key via CryptAcquireContext               | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt                      | data-manipulation/encryption                         |
| encrypt data using AES via WinAPI                    | data-manipulation/encryption/aes                     |
| hash data via WinCrypt                               | data-manipulation/hashing                            |
| initialize hashing via WinCrypt                      | data-manipulation/hashing                            |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path (11 matches)                    | host-interaction/file-system                         |
| create directory (3 matches)                         | host-interaction/file-system/create                  |
| delete file (3 matches)                              | host-interaction/file-system/delete                  |
| check if file exists (4 matches)                     | host-interaction/file-system/exists                  |
| enumerate files recursively (2 matches)              | host-interaction/file-system/files/list              |
| get file size (2 matches)                            | host-interaction/file-system/meta                    |
| get file version info                                | host-interaction/file-system/meta                    |
| set file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| create shortcut via IShellLink                       | host-interaction/file-system/write                   |
| write file on Windows                                | host-interaction/file-system/write                   |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| check mutex (3 matches)                              | host-interaction/mutex                               |
| create mutex (2 matches)                             | host-interaction/mutex                               |
| get system information on Windows                    | host-interaction/os/info                             |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (6 matches)        | host-interaction/registry                            |
| set registry value (6 matches)                       | host-interaction/registry/create                     |
| delete registry value (2 matches)                    | host-interaction/registry/delete                     |
| create thread                                        | host-interaction/thread/create                       |
| link function at runtime on Windows (6 matches)      | linking/runtime-linking                              |
| parse PE header (5 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
5		- Defense Evasion::File and Directory Permissions Modification [T1222;5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 44.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FbJu6n9xzp1N1CkLh.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 42.032 sec (0 m 42 s)
Start Date: 2022:02:11 12:24:15
End Date:   2022:02:11 12:24:57

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:24:15Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FbJu6n9xzp1N1CkLh.exe SCORE: 509 TYPE: EXE SIZE: 77824 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f6042f9d400> 
MD5: 9de952f476abab0cd62bfd81e20a3deb 
SHA1: 109cc4467b78dad4b12a3225020ea590bccee3e6 
SHA256: e9cb6336359ac6f71ac75af2836efb28daa3bafd10a1f0b775dcdc2ec8850a6b CREATED: Fri Feb 11 12:24:15 2022 MODIFIED: Fri Feb 11 12:24:15 2022 ACCESSED: Fri Feb 11 12:24:58 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8eb0500004883c428e97efdffffcccccccccccccccccccccccccccc
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_10: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_17: Yara Rule MATCH: skip20_sqllang_hook SUBSCORE: 60 
DESCRIPTION: YARA rule to detect if a sqllang.dll version is targeted by skip-2.0. Each byte pattern corresponds to a function hooked by skip-2.0. If _0 or _1 match, it is probably targeted as it corresponds to the hook responsible for bypassing the authentication. REF: https://www.welivesecurity.com/ AUTHOR: Mathieu Tartare <mathieu.tartare@eset.com> 
MATCHES: Str1: 8bc1488b8c24300200004833cc
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:24:58Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
20		win_registry
65		win_token
10		win_files_operation
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
10		anti_dbg
60		skip20_sqllang_hook
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API

Score total: 509

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/69
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:24:15                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FbJu6n9xzp1N1CkLh.exe
Real Name:	/ie4ushowIE.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
5	- Defense Evasion::File and Directory Permissions Modification [T1222;5]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::System Information Discovery [T1082;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1	- Discovery::Query Registry [T1012;1]
8.5	- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
20	win_registry
65	win_token
10	win_files_operation
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
10	anti_dbg
60	skip20_sqllang_hook
20	isExecutable
10	Contains_PE_File
20	Advapi_Hash_API

============================[ Scores ]============================
CAPA:	44.5
ClamAV:	0
Loki:	509
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
8954.998079788218
==================================================================


==================================================================
Fichier HTTP-FbJu6n9xzp1N1CkLh.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FIjacR3RtFLPr0I3hi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FIjacR3RtFLPr0I3hi.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 6.33 MB
Data read: 5.95 MB (ratio 1.06:1)
Time: 42.205 sec (0 m 42 s)
Start Date: 2022:02:11 12:24:59
End Date:   2022:02:11 12:25:41

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:24:59Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:25:53Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 22eb6c0cdc1c8b41e079c1d6ed625973                                                   |
| sha1                   | a014d18763e071d2b2bfc552e32598b138cfdf77                                           |
| sha256                 | 01179d6668a3aa00affc7481d53894233cc8f53eb2af23d4cc148e8bef904db2                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FIjacR3RtFLPr0I3hi.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings targeting Xen              | anti-analysis/anti-vm/vm-detection                   |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 7.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:24:59                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FIjacR3RtFLPr0I3hi.exe
Real Name:	/NlsLexicons000c.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

============================[ Scores ]============================
CAPA:	7.5
ClamAV:	0
Loki:	0
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
149.64467362266598
==================================================================


==================================================================
Fichier HTTP-FIjacR3RtFLPr0I3hi.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F1ulMb4GoBcXz5dh2e.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | bbdd0cfa22609724363ff4437bb47959                                                   |
| sha1                   | 68ecb50c8caa2a7205ccd50b194a43664bfde5ef                                           |
| sha256                 | b1f134a7183435671af8c9c1592d9662c1b4e1788577eb5bffa5b9e8caae148d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F1ulMb4GoBcXz5dh2e.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F1ulMb4GoBcXz5dh2e.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 42.013 sec (0 m 42 s)
Start Date: 2022:02:11 12:25:55
End Date:   2022:02:11 12:26:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:25:55Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-F1ulMb4GoBcXz5dh2e.exe SCORE: 99 TYPE: EXE SIZE: 14336 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f0ab5058400> 
MD5: bbdd0cfa22609724363ff4437bb47959 
SHA1: 68ecb50c8caa2a7205ccd50b194a43664bfde5ef 
SHA256: b1f134a7183435671af8c9c1592d9662c1b4e1788577eb5bffa5b9e8caae148d CREATED: Fri Feb 11 12:25:55 2022 MODIFIED: Fri Feb 11 12:25:55 2022 ACCESSED: Fri Feb 11 12:26:49 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:26:49Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_4
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 99

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/64
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:25:55                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F1ulMb4GoBcXz5dh2e.exe
Real Name:	/RemoteAppLifetimeManagerProxyStub.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_4
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	1.0
ClamAV:	0
Loki:	99
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
1588.996883686191
==================================================================


==================================================================
Fichier HTTP-F1ulMb4GoBcXz5dh2e.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FK5xDn1Dy07PG5qPQj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FK5xDn1Dy07PG5qPQj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.28 MB
Data read: 0.27 MB (ratio 1.06:1)
Time: 41.090 sec (0 m 41 s)
Start Date: 2022:02:11 12:26:50
End Date:   2022:02:11 12:27:31

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:26:50Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FK5xDn1Dy07PG5qPQj.exe SCORE: 349 TYPE: EXE SIZE: 280576 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f05c005c400> 
MD5: a5018ebb1a375f9bcf404b621c536426 
SHA1: 362280bcd1f26eca4943f2210160834fcc20da2e 
SHA256: b936f68a90d7a8e2a1e19826c6284abe2aa5cc4131bf231d1f1f08d664425d44 CREATED: Fri Feb 11 12:26:50 2022 MODIFIED: Fri Feb 11 12:26:50 2022 ACCESSED: Fri Feb 11 12:27:43 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
REASON_18: Yara Rule MATCH: Crypt32_CryptBinaryToString_API SUBSCORE: 25 
DESCRIPTION: Looks for crypt32 CryptBinaryToStringA function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: CRYPT32.dll Str2: CryptBinaryToStringA
REASON_19: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:27:43Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API
25		Crypt32_CryptBinaryToString_API
5		BASE64_table

Score total: 349

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a5018ebb1a375f9bcf404b621c536426                                                   |
| sha1                   | 362280bcd1f26eca4943f2210160834fcc20da2e                                           |
| sha256                 | b936f68a90d7a8e2a1e19826c6284abe2aa5cc4131bf231d1f1f08d664425d44                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FK5xDn1Dy07PG5qPQj.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-debugging instructions                  | anti-analysis/anti-debugging/debugger-detection      |
| decode data using Base64 via WinAPI                  | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (4 matches)                    | data-manipulation/encoding/xor                       |
| encrypt or decrypt data via BCrypt                   | data-manipulation/encryption                         |
| encrypt data using DPAPI (4 matches)                 | data-manipulation/encryption/dpapi                   |
| hash data via BCrypt (4 matches)                     | data-manipulation/hashing                            |
| hash data using murmur3                              | data-manipulation/hashing/murmur                     |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (5 matches)           | host-interaction/process/terminate                   |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (5 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 16.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/65
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:26:50                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FK5xDn1Dy07PG5qPQj.exe
Real Name:	/MicrosoftAccountCloudAP.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
4	- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File
20	Advapi_Hash_API
25	Crypt32_CryptBinaryToString_API
5	BASE64_table

============================[ Scores ]============================
CAPA:	16.5
ClamAV:	0
Loki:	349
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5860.495523659151
==================================================================


==================================================================
Fichier HTTP-FK5xDn1Dy07PG5qPQj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FGyDa13MAJzxKX0nDg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6fcc13563aad936c7d0f3165351cb453                                                   |
| sha1                   | 8b1757b95b7b7f9c4dfa09b52b0d3c6451b269fc                                           |
| sha256                 | 093c81f0b234c2aa0363129fdaaaf57551f161915da3d23f43a792b5f3024c1e                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FGyDa13MAJzxKX0nDg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Checksum::Luhn [C0032.002]                                                    |
|                             | Encode Data::Base64 [C0026.001]                                               |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| send data                                            | communication                                        |
| connect to HTTP server                               | communication/http/client                            |
| validate payment card number using luhn algorithm    | data-manipulation/checksum/luhn                      |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| allocate thread local storage                        | host-interaction/process                             |
| read process memory                                  | host-interaction/process                             |
| enumerate processes                                  | host-interaction/process/list                        |
| acquire debug privileges                             | host-interaction/process/modify                      |
| modify access privileges                             | host-interaction/process/modify                      |
| terminate process                                    | host-interaction/process/terminate                   |
| get session user name                                | host-interaction/session                             |
| access PEB ldr_data                                  | linking/runtime-linking                              |
| link many functions at runtime                       | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
4		- Discovery::Process Discovery [T1057;4]
4		- Discovery::Software Discovery [T1518;4]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
3		- Discovery::Account Discovery [T1087;3]

Score total: 37.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FGyDa13MAJzxKX0nDg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 43.421 sec (0 m 43 s)
Start Date: 2022:02:11 12:27:55
End Date:   2022:02:11 12:28:38

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe4 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9d in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9d in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:27:55Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FGyDa13MAJzxKX0nDg.exe SCORE: 779 TYPE: EXE SIZE: 95232 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4405e44400> 
MD5: 6fcc13563aad936c7d0f3165351cb453 
SHA1: 8b1757b95b7b7f9c4dfa09b52b0d3c6451b269fc 
SHA256: 093c81f0b234c2aa0363129fdaaaf57551f161915da3d23f43a792b5f3024c1e CREATED: Fri Feb 11 12:27:55 2022 MODIFIED: Fri Feb 11 12:27:55 2022 ACCESSED: Fri Feb 11 12:28:48 2022 
REASON_1: Malware Hash TYPE: SHA256 HASH: 093c81f0b234c2aa0363129fdaaaf57551f161915da3d23f43a792b5f3024c1e SUBSCORE: 100 DESC: Kronos Banking Trojan Used to Deliver New Point-of-Sale Malware https://www.proofpoint.com/us/threat-insight/post/kronos-banking-trojan-used-to-
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: HttpOpenRequest Str5: HttpSendRequest
REASON_3: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken
REASON_5: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_6: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetConnect Str2: InternetOpen
REASON_7: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_8: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: win_scanpos_auto SUBSCORE: 45 
DESCRIPTION: Detects win.scanpos. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 03c703cf83ff1f0f87a4030000ff24bd0ce640008bc6e998030000 Str2: c745fc00000000807dd800750aba04000000e9c2000000c645fc018b16 Str3: 5dc38d4 ... (truncated)
REASON_10: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344539d555c0350104c409f8f5859b0a35bf401000000433a5c55736572735c6578616d706c655c646f63756d656e74735c76697375616c2073747564696f20323 ... (truncated)
REASON_11: Yara Rule MATCH: ConventionEngine_Term_VisualStudio SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344539d555c0350104c409f8f5859b0a35bf401000000433a5c55736572735c6578616d706c655c646f63756d656e74735c76697375616c2073747564696f20323 ... (truncated)
REASON_12: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_14: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8cd530000e989feffff Str2: e8d7fbffffe9b4feffff Str3: e8c14c0000e919ffffff
REASON_15: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3: <gA Str4: <gA<gA Str5: <gA<gA<gA Str6: <gA<gA<gA<gA Str7: <gA<gA<gA<gA<gA Str8:  Str9:  Str10:  Str11:  Str12:  Str13 ... (truncated)
REASON_16: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_19: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_20: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_22: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_23: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_24: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_25: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_26: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:28:49Z

-------- Score ----------------
Scores		Rules
.......		...............
100		Malware Hash
45		network_http
70		escalate_priv
65		win_token
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
45		win_scanpos_auto
50		ConventionEngine_Term_Users
50		ConventionEngine_Term_VisualStudio
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
5		BASE64_table

Score total: 779

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 49/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:27:55                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FGyDa13MAJzxKX0nDg.exe
Real Name:	/6fcc13563aad936c7d0f3165351cb453.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
5	- Privilege Escalation::Access Token Manipulation [T1134;5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3	- Discovery::System Owner/User Discovery [T1033;3]
4	- Discovery::Process Discovery [T1057;4]
4	- Discovery::Software Discovery [T1518;4]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
3	- Discovery::Account Discovery [T1087;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
100	Malware Hash
45	network_http
70	escalate_priv
65	win_token
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	Str_Win32_Http_API
10	ft_exe
45	win_scanpos_auto
50	ConventionEngine_Term_Users
50	ConventionEngine_Term_VisualStudio
2	math_entropy_6
5	executable_pe
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
40	SEH_Save
40	SEH_Init
10	anti_dbg
20	isExecutable
10	Contains_PE_File
5	BASE64_table

============================[ Scores ]============================
CAPA:	37.0
ClamAV:	0
Loki:	779
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
15084.565025810558
==================================================================


==================================================================
Fichier HTTP-FGyDa13MAJzxKX0nDg.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fnq6lp4SlgJcYxCvci.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fnq6lp4SlgJcYxCvci.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.37 MB
Data read: 0.08 MB (ratio 4.70:1)
Time: 38.377 sec (0 m 38 s)
Start Date: 2022:02:11 12:28:50
End Date:   2022:02:11 12:29:28

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0
sh: 197: Syntax error: EOF in backquote substitution

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 16/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:28:50                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fnq6lp4SlgJcYxCvci.exe
Real Name:	/2055994ff75b4309eee3a49c5749d306.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_close_8
5	executable_pe
70	ASPack_v212_additional
70	ASPack_v21_additional
70	ASProtect_V2X_DLL_Alexey_Solodovnikov
70	ASPack_v212
70	yodas_Protector_v1033_dllocx_Ashkbiz_Danehkar_h
70	ASPack_v211d
70	ASProtect_V2X_DLL_Alexey_Solodovnikov_additional
70	ASPack_212withouth_Poly_Solodovnikov_Alexey
70	ASPack_v212_Alexey_Solodovnikov
70	ASPackv212AlexeySolodovnikov
70	ASProtectV2XDLLAlexeySolodovnikov
10	IsPE32
10	IsConsole
10	IsPacked
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
60	suspicious_packer_section
70	INDICATOR_EXE_Packed_ASPack
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	0
ClamAV:	0
Loki:	1034
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
18387.79561004791
==================================================================


==================================================================
Fichier HTTP-Fnq6lp4SlgJcYxCvci.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F2Oy5f4LlvBjPwzbXe.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | dfa95cf9ed03219827e5522d30d6c100                                                   |
| sha1                   | aaeafbabca133d19c49ecf1189dafb1c5ef45ef2                                           |
| sha256                 | 1a603726412f20385c8e488c9342c0da74210adf85395458b30b9ad59f78576f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F2Oy5f4LlvBjPwzbXe.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)  | executable/resource                                  |
| get file system object information                   | host-interaction/file-system                         |
| read .ini file (3 matches)                           | host-interaction/file-system/read                    |
| print debug messages (2 matches)                     | host-interaction/log/debug/write-event               |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value (4 matches)                       | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| link function at runtime on Windows                  | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::Query Registry [T1012;1]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 8.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F2Oy5f4LlvBjPwzbXe.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 36.306 sec (0 m 36 s)
Start Date: 2022:02:11 12:29:35
End Date:   2022:02:11 12:30:11

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:29:35Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F2Oy5f4LlvBjPwzbXe.exe SCORE: 329 TYPE: EXE SIZE: 66048 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9cdca18400> 
MD5: dfa95cf9ed03219827e5522d30d6c100 
SHA1: aaeafbabca133d19c49ecf1189dafb1c5ef45ef2 
SHA256: 1a603726412f20385c8e488c9342c0da74210adf85395458b30b9ad59f78576f CREATED: Fri Feb 11 12:29:35 2022 MODIFIED: Fri Feb 11 12:29:35 2022 ACCESSED: Fri Feb 11 12:30:28 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_15: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:30:29Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 329

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/62
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:29:35                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F2Oy5f4LlvBjPwzbXe.exe
Real Name:	/TapiMigPlugin.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::Query Registry [T1012;1]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
30	Check_OutputDebugStringA_iat_v1
30	Check_OutputDebugStringA_iat
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	8.5
ClamAV:	0
Loki:	329
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5383.895899969418
==================================================================


==================================================================
Fichier HTTP-F2Oy5f4LlvBjPwzbXe.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FEzzcn2Krfxd75FXRl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | d2cdbfcf382759848b76a2ac3422b491                                                   |
| sha1                   | edc3e444b5c046a47e58144977393a5b97b9158e                                           |
| sha256                 | be8040bd37a6868acb65672d94336ef62f831ca2100297744bcabadbc7f1d200                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FEzzcn2Krfxd75FXRl.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get thread local storage value                       | host-interaction/process                             |
| query or enumerate registry value                    | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| create thread                                        | host-interaction/thread/create                       |
| resume thread                                        | host-interaction/thread/resume                       |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::Query Registry [T1012;1]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 4.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FEzzcn2Krfxd75FXRl.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 40.600 sec (0 m 40 s)
Start Date: 2022:02:11 12:30:30
End Date:   2022:02:11 12:31:11

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:30:30Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FEzzcn2Krfxd75FXRl.exe SCORE: 289 TYPE: EXE SIZE: 16384 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4be4baf400> 
MD5: d2cdbfcf382759848b76a2ac3422b491 
SHA1: edc3e444b5c046a47e58144977393a5b97b9158e 
SHA256: be8040bd37a6868acb65672d94336ef62f831ca2100297744bcabadbc7f1d200 CREATED: Fri Feb 11 12:30:30 2022 MODIFIED: Fri Feb 11 12:30:30 2022 ACCESSED: Fri Feb 11 12:31:20 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:31:20Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
65		win_token
10		ft_exe
2		math_entropy_4
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 289

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:30:30                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FEzzcn2Krfxd75FXRl.exe
Real Name:	/pstask.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::Query Registry [T1012;1]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
70	escalate_priv
20	win_registry
65	win_token
10	ft_exe
2	math_entropy_4
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	4.5
ClamAV:	0
Loki:	289
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4670.128130386217
==================================================================


==================================================================
Fichier HTTP-FEzzcn2Krfxd75FXRl.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fgsvd44OrL0Lzd4Ggg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 80372de850597bd9e7e021a94f13f0a1                                                   |
| sha1                   | 037db820c8dee94ae25a439b758a2b89f527cbb4                                           |
| sha256                 | 2520b15068fa108c947db179377c6b462f2c4f47037168bf8c69fcb668cb11a8                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fgsvd44OrL0Lzd4Ggg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| CRYPTOGRAPHY                | Cryptographic Hash::SHA256 [C0029.003]                                        |
|                             | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key::RC4 KSA [C0028.002]                                           |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain obfuscated stackstrings (2 matches)          | anti-analysis/obfuscation/string/stackstring         |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (11 matches)                   | data-manipulation/encoding/xor                       |
| encrypt data using Curve25519 (2 matches)            | data-manipulation/encryption/elliptic-curve          |
| encrypt data using RC4 KSA                           | data-manipulation/encryption/rc4                     |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| hash data using murmur3 (2 matches)                  | data-manipulation/hashing/murmur                     |
| hash data using SHA256                               | data-manipulation/hashing/sha256                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| enumerate PE sections (4 matches)                    | load-code/pe                                         |
| parse PE exports (6 matches)                         | load-code/pe                                         |
| parse PE header (20 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 6.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fgsvd44OrL0Lzd4Ggg.exe: Win.Ransomware.Netwalker-7671868-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-Fgsvd44OrL0Lzd4Ggg.exe: Win.Ransomware.Razy-9848777-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 43.165 sec (0 m 43 s)
Start Date: 2022:02:11 12:31:21
End Date:   2022:02:11 12:32:04

-------- Score ----------------
Scores		Rules
.......		...............
80		Win.Ransomware.Netwalker-7671868-0
80		Win.Ransomware.Razy-9848777-0

Score total: 160.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 2-3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 5-6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:31:21Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fgsvd44OrL0Lzd4Ggg.exe SCORE: 384 TYPE: EXE SIZE: 70656 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f8384d26400> 
MD5: 80372de850597bd9e7e021a94f13f0a1 
SHA1: 037db820c8dee94ae25a439b758a2b89f527cbb4 
SHA256: 2520b15068fa108c947db179377c6b462f2c4f47037168bf8c69fcb668cb11a8 CREATED: Fri Feb 11 12:31:21 2022 MODIFIED: Fri Feb 11 12:31:21 2022 ACCESSED: Fri Feb 11 12:32:15 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: win_mailto_auto SUBSCORE: 45 
DESCRIPTION: Detects win.mailto. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 8b7c2410c1f81ac1f91f23c88bc1c1e01a2bf8 Str2: 03c0505655e8588e00008b742430 Str3: 85ed7ea4660f1f440000803c1e2e757656e844410000 Str4: 8b ... (truncated)
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: netwalker_ransomware_v1 SUBSCORE: 60 
DESCRIPTION: Rule to detect Netwalker ransomware REF: https://www.ccn-cert.cni.es/comunicacion-eventos/comunicados-ccn-cert/9802-publicado-un-informe-de-codigo-danino-sobre-netwalker.html AUTHOR: McAfee ATR Team 
MATCHES: Str1: cccccccccca170124100c3cccccccccccccccccccc538b5c24085533ed5785db747f8b7c241485ff74778b431085c07470c1e00250e8fb0e000083c404890785c0745 ... (truncated)
REASON_10: Yara Rule MATCH: Netwalker_v1 SUBSCORE: 60 
DESCRIPTION: Rule based on code overlap in RagnarLocker ransomware REF: - AUTHOR: McAfee ATR team 
MATCHES: Str1: c88bf28b4330f76f3803c88b434813f2f76f2003c88b433813f2f76f3003c88b434013f2f76f2803c88b432813f2f76f4003c8894d6813f289756c8b4338f76f388bc ... (truncated)
REASON_11: Yara Rule MATCH: Netwalker SUBSCORE: 60 
DESCRIPTION: Detects Netwalker Ransomware REF: https://github.com/f0wl/configwalker AUTHOR: Marius 'f0wL' Genheimer <hello@dissectingmalwa.re> 
MATCHES: Str1: svcwait Str2: mscfile Str3: pspath Str4: mode Str5: spsz Str6: idsz Str7: onion1 Str8: onion2 Str9: lfile Str10: lend Str11: white St ... (truncated)
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_15: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
REASON_16: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
REASON_17: Yara Rule MATCH: Chacha_128_constant SUBSCORE: 15 
DESCRIPTION: Look for 128-bit key Chacha stream cipher constant REF: https://www.ecrypt.eu.org/stream/salsa20pf.html AUTHOR: spelissier 
MATCHES: Str1: expand 16-byte k
REASON_18: Yara Rule MATCH: Chacha_256_constant SUBSCORE: 15 
DESCRIPTION: Look for 256-bit key Chacha stream cipher constant REF: https://tools.ietf.org/html/rfc8439#page-8 AUTHOR: spelissier 
MATCHES: Str1: expand 32-byte k Str2: expand 3 Str3: 2-byte k
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:32:16Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
45		win_mailto_auto
2		math_entropy_6
5		executable_pe
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
2		PE_File
60		netwalker_ransomware_v1
60		Netwalker_v1
60		Netwalker
20		isExecutable
10		Contains_PE_File
25		CRC32_poly_Constant
20		SHA2_BLAKE2_IVs
5		BASE64_table
15		Chacha_128_constant
15		Chacha_256_constant

Score total: 384

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Fichier non trouvé sur VirusTotal...
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:31:21                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fgsvd44OrL0Lzd4Ggg.exe
Real Name:	/80372de850597bd9e7e021a94f13f0a1.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
80	Win.Ransomware.Netwalker-7671868-0
80	Win.Ransomware.Razy-9848777-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
45	win_mailto_auto
2	math_entropy_6
5	executable_pe
10	IsPE32
10	IsWindowsGUI
10	HasDebugData
2	PE_File
60	netwalker_ransomware_v1
60	Netwalker_v1
60	Netwalker
20	isExecutable
10	Contains_PE_File
25	CRC32_poly_Constant
20	SHA2_BLAKE2_IVs
5	BASE64_table
15	Chacha_128_constant
15	Chacha_256_constant

============================[ Scores ]============================
CAPA:	6.0
ClamAV:	160.0
Loki:	384
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
8219.986256819475
==================================================================


==================================================================
Fichier HTTP-Fgsvd44OrL0Lzd4Ggg.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FHm7SIJUSjbNF2CRe.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6242e3d67787ccbf4e06ad2982853144                                                   |
| sha1                   | 6ac7947207d999a65890ab25fe344955da35028e                                           |
| sha256                 | 4ca10dba7ff487fdb3f1362a3681d7d929f5aa1262cdfd31b04c30826983fb1d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FHm7SIJUSjbNF2CRe.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | ICMP Communication::Echo Request [C0014.002]                                  |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| send ICMP echo request                               | communication/icmp                                   |
| initialize Winsock library                           | communication/socket                                 |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| resolve DNS (4 matches)                              | host-interaction/network/dns/resolve                 |
| get routing table                                    | host-interaction/network/routing-table               |
| query or enumerate registry value                    | host-interaction/registry                            |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Discovery::Query Registry [T1012;1]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 15.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FHm7SIJUSjbNF2CRe.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 43.295 sec (0 m 43 s)
Start Date: 2022:02:11 12:32:17
End Date:   2022:02:11 12:33:00

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf9 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:32:17Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FHm7SIJUSjbNF2CRe.exe SCORE: 554 TYPE: EXE SIZE: 15360 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7faf90be5400> 
MD5: 6242e3d67787ccbf4e06ad2982853144 
SHA1: 6ac7947207d999a65890ab25fe344955da35028e 
SHA256: 4ca10dba7ff487fdb3f1362a3681d7d929f5aa1262cdfd31b04c30826983fb1d CREATED: Fri Feb 11 12:32:17 2022 MODIFIED: Fri Feb 11 12:32:17 2022 ACCESSED: Fri Feb 11 12:33:11 2022 
REASON_1: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: getaddrinfo
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey
REASON_3: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Visual_Cpp_2005_Release_Microsoft SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e805030000e9c3fdffff
REASON_8: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e805030000e9c3fdffff
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1:  Str2: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_10: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_17: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_18: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:33:11Z

-------- Score ----------------
Scores		Rules
.......		...............
50		network_dns
20		win_registry
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Visual_Cpp_2005_Release_Microsoft
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
60		DebuggerException__SetConsoleCtrl_v1
40		SEH_Save
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 554

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:32:17                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FHm7SIJUSjbNF2CRe.exe
Real Name:	/ping_täst.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
3	- Discovery::System Network Configuration Discovery [T1016;3]
1	- Discovery::Query Registry [T1012;1]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	network_dns
20	win_registry
10	Str_Win32_Winsock2_Library
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Visual_Cpp_2005_Release_Microsoft
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
60	DebuggerException__SetConsoleCtrl_v1
40	SEH_Save
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	15.0
ClamAV:	0
Loki:	554
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
9079.5976334799
==================================================================


==================================================================
Fichier HTTP-FHm7SIJUSjbNF2CRe.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F6zS3F4tHYPe0ys9ab.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F6zS3F4tHYPe0ys9ab.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.58 MB
Data read: 0.55 MB (ratio 1.06:1)
Time: 26.899 sec (0 m 26 s)
Start Date: 2022:02:11 12:33:12
End Date:   2022:02:11 12:33:39

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 4e9c546a54e40d0da89bb4616dd7f8c4                                                   |
| sha1                   | bea77cbd4fb58a6e97a994310b63f7c3c2761cbe                                           |
| sha256                 | 66af4bca3df1ee98ec1fdb65b4e5fed4146bd0743ef8318c87368434d3ac50de                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F6zS3F4tHYPe0ys9ab.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
| DATA                        | Checksum::CRC32 [C0032.001]                                                   |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| hash data with CRC32                                 | data-manipulation/checksum/crc32                     |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| encrypt data using RC4 with custom key via WinAPI    | data-manipulation/encryption/rc4                     |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path (3 matches)                     | host-interaction/file-system                         |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file size                                        | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| check mutex and exit                                 | host-interaction/mutex                               |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (7 matches)                          | load-code/pe                                         |
| spawn thread to RWX shellcode                        | load-code/shellcode                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::File and Directory Discovery [T1083;2]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 8.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x86 in position 63: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x86 in position 45: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:33:12Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F6zS3F4tHYPe0ys9ab.exe SCORE: 460 TYPE: EXE SIZE: 580056 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f38c1e8d400> 
MD5: 4e9c546a54e40d0da89bb4616dd7f8c4 
SHA1: bea77cbd4fb58a6e97a994310b63f7c3c2761cbe 
SHA256: 66af4bca3df1ee98ec1fdb65b4e5fed4146bd0743ef8318c87368434d3ac50de CREATED: Fri Feb 11 12:33:12 2022 MODIFIED: Fri Feb 11 12:33:12 2022 ACCESSED: Fri Feb 11 12:34:05 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose
REASON_3: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_17: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_18: Yara Rule MATCH: INDICATOR_KB_CERT_3a236f003bdefc0c55aa42d9c6c0b08e SUBSCORE: 70 
DESCRIPTION: Detects executables signed with stolen, revoked or invalid certificates REF: - AUTHOR: ditekSHen
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: db_connection SUBSCORE: 1 
DESCRIPTION: not set REF: https://github.com/kevthehermit/PasteHunter AUTHOR: @KevTheHermit 
MATCHES: Str1: 687474703a2f2f63726c2e63657274756d2e706c2f657663736361736861322e63726c307506082b0601050507010104693067302d06082b060105050730018621687 ... (truncated)
REASON_22: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:34:07Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		win_files_operation
10		misc_pe_signature
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
10		anti_dbg
70		INDICATOR_KB_CERT_3a236f003bdefc0c55aa42d9c6c0b08e
20		isExecutable
10		Contains_PE_File
1		db_connection
25		CRC32_poly_Constant

Score total: 460

==================[ Vérification MalwareBazaar ]==================
Fichier trouvé !
Malware connu -> Score: 2000
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 45/70
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:33:12                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F6zS3F4tHYPe0ys9ab.exe
Real Name:	/4e9c546a54e40d0da89bb4616dd7f8c4.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Discovery::File and Directory Discovery [T1083;2]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	win_files_operation
10	misc_pe_signature
10	ft_exe
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
10	anti_dbg
70	INDICATOR_KB_CERT_3a236f003bdefc0c55aa42d9c6c0b08e
20	isExecutable
10	Contains_PE_File
1	db_connection
25	CRC32_poly_Constant

============================[ Scores ]============================
CAPA:	8.0
ClamAV:	0
Loki:	460
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	2000
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
11450.129670518632
==================================================================


==================================================================
Fichier HTTP-F6zS3F4tHYPe0ys9ab.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FqnDfG29GDtCS12nh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x94 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xea in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd1 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 61: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 30: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 22: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 78: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 78: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x86 in position 36: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 62: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:34:09Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FqnDfG29GDtCS12nh.exe SCORE: 525 TYPE: EXE SIZE: 137680 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4c7c932400> 
MD5: a5c70086b3bc4fe64f4e7a0aa452e620 
SHA1: 2ab44cf5338ef5ed118365b4e8452b906c0dab4b 
SHA256: 2ec5256a7edb90b1c05c92f79e8a48c205b29e1ac910a535aa83c30b8dbbeff8 CREATED: Fri Feb 11 12:34:08 2022 MODIFIED: Fri Feb 11 12:34:08 2022 ACCESSED: Fri Feb 11 12:34:45 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: FindClose
REASON_2: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_3: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: win_ryuk_auto SUBSCORE: 45 
DESCRIPTION: Detects win.ryuk. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 68940b02356a016a006814010000 Str2: 85c075086a01ff15200e023568940b02356a01 Str3: ff7508e8e40e00005e5dc36a086878b00135 Str4: 6a086a1868 ... (truncated)
REASON_6: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645bc48c645bd45c645be52c645 Str2: c645bd45c645be52c645bf4dc645 Str3: c645be52c645bf4dc645c045c645 Str4: c645bf4dc645c045c645c153c645
REASON_9: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_10: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e86d020000e98efeffff
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @@ Str2:  Str3: a Str4: a Str5: 00000000000000000000000000000081d3d8dee0f90000317e81fe00000000000000000000000000000000000000000000000 ... (truncated)
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_15: Yara Rule MATCH: HasDigitalSignature SUBSCORE: 10 
DESCRIPTION: DigitalSignature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: d021000000020200308221c006092a864886f70d010702a08221b1308221ad020101310b300906052b0e03021a0500304c060a2b060104018237020104a03e303c301 ... (truncated)
REASON_16: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_17: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_18: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_20: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_21: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_22: Yara Rule MATCH: cert_blocklist_07b74c70c4aa092648b7f0d1a8a3a28f SUBSCORE: 60 
DESCRIPTION: Certificate used for digitally signing malware. REF: - AUTHOR: ReversingLabs
REASON_23: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_24: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_25: Yara Rule MATCH: db_connection SUBSCORE: 1 
DESCRIPTION: not set REF: https://github.com/kevthehermit/PasteHunter AUTHOR: @KevTheHermit 
MATCHES: Str1: 687474703a2f2f6f6373702e64696769636572742e636f6d304906082b06010505073002863d687474703a2f2f636163657274732e64696769636572742e636f6d2f4 ... (truncated)
REASON_26: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:34:46Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		misc_pe_signature
10		ft_exe
45		win_ryuk_auto
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasOverlay
10		HasDigitalSignature
10		HasDebugData
10		HasRichSignature
2		PE_File
40		SEH_Save
40		SEH_Init
10		anti_dbg
60		cert_blocklist_07b74c70c4aa092648b7f0d1a8a3a28f
20		isExecutable
10		Contains_PE_File
1		db_connection
25		CRC32_poly_Constant

Score total: 525

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FqnDfG29GDtCS12nh.exe: Win.Ransomware.Ryuk-9779552-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.14 MB
Data read: 0.13 MB (ratio 1.06:1)
Time: 43.680 sec (0 m 43 s)
Start Date: 2022:02:11 12:34:08
End Date:   2022:02:11 12:34:52

-------- Score ----------------
Scores		Rules
.......		...............
80		Win.Ransomware.Ryuk-9779552-0

Score total: 80.0

==================[ Vérification MalwareBazaar ]==================
Fichier trouvé !
Malware connu -> Score: 2000
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 56/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:34:08                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FqnDfG29GDtCS12nh.exe
Real Name:	/a5c70086b3bc4fe64f4e7a0aa452e620.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
80	Win.Ransomware.Ryuk-9779552-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	misc_pe_signature
10	ft_exe
45	win_ryuk_auto
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	obfuscation_singlebyte_mov
5	executable_pe
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsWindowsGUI
10	HasOverlay
10	HasDigitalSignature
10	HasDebugData
10	HasRichSignature
2	PE_File
40	SEH_Save
40	SEH_Init
10	anti_dbg
60	cert_blocklist_07b74c70c4aa092648b7f0d1a8a3a28f
20	isExecutable
10	Contains_PE_File
1	db_connection
25	CRC32_poly_Constant

============================[ Scores ]============================
CAPA:	0
ClamAV:	80.0
Loki:	525
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	2000
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
13327.829589856177
==================================================================


==================================================================
Fichier HTTP-FqnDfG29GDtCS12nh.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F2VcXq1uEm2EqqClTi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 88abae59e3b1cf07bef2feb1efee0324                                                   |
| sha1                   | 4337778595c76e82ea011103f320d2af33dbe899                                           |
| sha256                 | 3ba837e827a5a20cf51ec82972b5e5fe028708932bfe1e58fd1224ef2fe5bb75                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F2VcXq1uEm2EqqClTi.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| create process on Windows                            | host-interaction/process/create                      |
| inject thread                                        | host-interaction/process/inject                      |
| acquire debug privileges                             | host-interaction/process/modify                      |
| modify access privileges                             | host-interaction/process/modify                      |
| query or enumerate registry value                    | host-interaction/registry                            |
| spawn thread to RWX shellcode                        | load-code/shellcode                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::Query Registry [T1012;1]
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]

Score total: 14.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F2VcXq1uEm2EqqClTi.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 30.035 sec (0 m 30 s)
Start Date: 2022:02:11 12:34:53
End Date:   2022:02:11 12:35:23

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 46/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:34:53                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F2VcXq1uEm2EqqClTi.exe
Real Name:	/Practical Malware Analysis Lab 19-02.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::Query Registry [T1012;1]
6	- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
5	- Privilege Escalation::Access Token Manipulation [T1134;5]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	inject_thread
70	escalate_priv
20	win_registry
65	win_token
10	win_files_operation
10	ft_exe
2	math_entropy_4
5	executable_pe
15	dll_injection_thread
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Armadillo_v4x
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsConsole
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
45	Inject_Thread
40	SEH_Save
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	14.5
ClamAV:	0
Loki:	889
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
16379.013516649786
==================================================================


==================================================================
Fichier HTTP-F2VcXq1uEm2EqqClTi.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fd1Fha38A2lz4HApni.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 05cff15ab2be64cdb74c1a542802f7bb                                                   |
| sha1                   | 365064133164b804317734f29e503749c5be0791                                           |
| sha256                 | 6f4a4f78ed11823f45fe9efeab507cbf8bbd90a415cd4151427b071ecc576dc0                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fd1Fha38A2lz4HApni.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag (2 matches)         | anti-analysis/anti-debugging/debugger-detection      |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| enumerate files via ntdll functions                  | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| get system information on Windows (5 matches)        | host-interaction/os/info                             |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| create or open registry key (7 matches)              | host-interaction/registry                            |
| query or enumerate registry key (3 matches)          | host-interaction/registry                            |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry key                                  | host-interaction/registry/delete                     |
| delete registry value                                | host-interaction/registry/delete                     |
| get kernel32 base address                            | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 16.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fd1Fha38A2lz4HApni.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 42.835 sec (0 m 42 s)
Start Date: 2022:02:11 12:35:48
End Date:   2022:02:11 12:36:31

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:35:48Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fd1Fha38A2lz4HApni.exe SCORE: 324 TYPE: EXE SIZE: 92160 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f2d95fa5400> 
MD5: 05cff15ab2be64cdb74c1a542802f7bb 
SHA1: 365064133164b804317734f29e503749c5be0791 
SHA256: 6f4a4f78ed11823f45fe9efeab507cbf8bbd90a415cd4151427b071ecc576dc0 CREATED: Fri Feb 11 12:35:48 2022 MODIFIED: Fri Feb 11 12:35:48 2022 ACCESSED: Fri Feb 11 12:36:36 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_13: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_14: Yara Rule MATCH: Debugger_Hiding__Thread SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetInformationThread
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:36:36Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		Debugger_Check__QueryInfo
60		Debugger_Hiding__Thread
20		isExecutable
10		Contains_PE_File

Score total: 324

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:35:48                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fd1Fha38A2lz4HApni.exe
Real Name:	/setbcdlocale.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
60	Debugger_Check__QueryInfo
60	Debugger_Hiding__Thread
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	16.0
ClamAV:	0
Loki:	324
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5454.295913969028
==================================================================


==================================================================
Fichier HTTP-Fd1Fha38A2lz4HApni.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FBabKv1fWbpnYi4yT3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FBabKv1fWbpnYi4yT3.exe: Win.Malware.Jaik-9870661-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FBabKv1fWbpnYi4yT3.exe: Win.Malware.Hacktoolx-9870688-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.22 MB
Data read: 0.21 MB (ratio 1.04:1)
Time: 43.172 sec (0 m 43 s)
Start Date: 2022:02:11 12:36:37
End Date:   2022:02:11 12:37:20

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Jaik-9870661-0
50		Win.Malware.Hacktoolx-9870688-0

Score total: 100.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:36:37Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FBabKv1fWbpnYi4yT3.exe SCORE: 69 TYPE: EXE SIZE: 222720 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f2bfc103400> 
MD5: bb7922d368a9a9c8d981837b5ad988f1 
SHA1: 340502b54df264b7bbe6574b0e5e5a5edb3dede6 
SHA256: 16b061de843d79b686a1b4e7d2bf601fb9fa7df12b843f83e2a01546df9558ec CREATED: Fri Feb 11 12:36:37 2022 MODIFIED: Fri Feb 11 12:36:37 2022 ACCESSED: Fri Feb 11 12:37:31 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_8: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:37:31Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE32
10		IsWindowsGUI
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 69

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 46/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:36:37                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FBabKv1fWbpnYi4yT3.exe
Real Name:	/bb7922d368a9a9c8d981837b5ad988f1.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
50	Win.Malware.Jaik-9870661-0
50	Win.Malware.Hacktoolx-9870688-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE32
10	IsWindowsGUI
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	0
ClamAV:	100.0
Loki:	69
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
4352.501714592336
==================================================================


==================================================================
Fichier HTTP-FBabKv1fWbpnYi4yT3.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fl3KZU3n1u68mUqBO1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 1d8fd13c890060464019c0f07b928b1a                                                   |
| sha1                   | 1bbcc9ba8d4ce5a1c6ca0c757d826e39619f94c0                                           |
| sha256                 | 6bffe5385dd1321fe5b99dec3f8858be9ff99c8629c1c8d6f414eebaa663a710                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fl3KZU3n1u68mUqBO1.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Automated Collection:: \[T1119]\                                                   |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Software Discovery:: \[T1518]\                                                     |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Checksum::Luhn [C0032.002]                                                    |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+---------------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                                    | NAMESPACE                                            |
|---------------------------------------------------------------+------------------------------------------------------|
| parse credit card information                                 | collection/credit-card                               |
| validate payment card number using luhn algorithm (2 matches) | data-manipulation/checksum/luhn                      |
| encrypt data using RC4 PRGA                                   | data-manipulation/encryption/rc4                     |
| get file size (2 matches)                                     | host-interaction/file-system/meta                    |
| move file                                                     | host-interaction/file-system/move                    |
| read .ini file                                                | host-interaction/file-system/read                    |
| read file on Windows                                          | host-interaction/file-system/read                    |
| write file on Windows                                         | host-interaction/file-system/write                   |
| print debug messages                                          | host-interaction/log/debug/write-event               |
| check mutex and exit                                          | host-interaction/mutex                               |
| read process memory                                           | host-interaction/process                             |
| allocate RWX memory                                           | host-interaction/process/inject                      |
| enumerate processes                                           | host-interaction/process/list                        |
| acquire debug privileges                                      | host-interaction/process/modify                      |
| modify access privileges                                      | host-interaction/process/modify                      |
| terminate process (2 matches)                                 | host-interaction/process/terminate                   |
+---------------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
6		- Collection::Automated Collection [T1119;6]
4		- Discovery::Software Discovery [T1518;4]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
4		- Discovery::Process Discovery [T1057;4]

Score total: 24.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fl3KZU3n1u68mUqBO1.exe: Win.Trojan.GetMyPass-1 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 40.980 sec (0 m 40 s)
Start Date: 2022:02:11 12:37:32
End Date:   2022:02:11 12:38:13

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.GetMyPass-1

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb9 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa0 in position 42: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:37:32Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fl3KZU3n1u68mUqBO1.exe SCORE: 950 TYPE: EXE SIZE: 17376 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f123eead400> 
MD5: 1d8fd13c890060464019c0f07b928b1a 
SHA1: 1bbcc9ba8d4ce5a1c6ca0c757d826e39619f94c0 
SHA256: 6bffe5385dd1321fe5b99dec3f8858be9ff99c8629c1c8d6f414eebaa663a710 CREATED: Fri Feb 11 12:37:32 2022 MODIFIED: Fri Feb 11 12:37:32 2022 ACCESSED: Fri Feb 11 12:38:26 2022 
REASON_1: Malware Hash TYPE: SHA1 HASH: 1bbcc9ba8d4ce5a1c6ca0c757d826e39619f94c0 SUBSCORE: 100 DESC: Signed POS malware - Carbanak http://blog.trendmicro.com/trendlabs-security-intelligence/signed-pos-malware-us
REASON_2: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_3: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile
REASON_6: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: win_getmypass_auto SUBSCORE: 45 
DESCRIPTION: Detects win.getmypass. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 52b928444000e83df1ffff6800800000 Str2: 8b45f88b4d088948048b55f8833a00 Str3: 894204eb1a8b4d0851 Str4: e817faffff83c40c8945a0837da0ff0f ... (truncated)
REASON_9: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec8b Str2: 558becff Str3: 558bec81 Str4: 558bec83 Str5: 558bec51 Str6: 558bec6a Str7: 558bec68 Str8: 558bec0f Str9: 558beca1 Str1 ... (truncated)
REASON_12: Yara Rule MATCH: Borland_Delphi_30_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_13: Yara Rule MATCH: Borland_Delphi_30_ SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_14: Yara Rule MATCH: Borland_Delphi_v40_v50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_15: Yara Rule MATCH: Borland_Delphi_v30 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_16: Yara Rule MATCH: Borland_Delphi_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_17: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_20: Yara Rule MATCH: HasDigitalSignature SUBSCORE: 10 
DESCRIPTION: DigitalSignature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: e013000000020200308213d206092a864886f70d010702a08213c3308213bf020101310b300906052b0e03021a05003068060a2b060104018237020104a05a3058303 ... (truncated)
REASON_21: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_22: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_23: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_24: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_25: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_26: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_27: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_28: Yara Rule MATCH: db_connection SUBSCORE: 1 
DESCRIPTION: not set REF: https://github.com/kevthehermit/PasteHunter AUTHOR: @KevTheHermit 
MATCHES: Str1: 68747470733a2f2f7365637572652e636f6d6f646f2e6e65742f43505330410603551d1f043a30383036a034a0328630687474703a2f2f63726c2e636f6d6f646f636 ... (truncated)
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:38:27Z

-------- Score ----------------
Scores		Rules
.......		...............
100		Malware Hash
70		escalate_priv
60		win_mutex
65		win_token
10		win_files_operation
10		misc_pe_signature
10		ft_exe
45		win_getmypass_auto
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Borland_Delphi_30_additional
70		Borland_Delphi_30_
70		Borland_Delphi_v40_v50
70		Borland_Delphi_v30
70		Borland_Delphi_DLL
10		IsPE32
10		IsWindowsGUI
10		HasOverlay
10		HasDigitalSignature
10		HasRichSignature
2		PE_File
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
20		isExecutable
10		Contains_PE_File
1		db_connection

Score total: 950

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 51/67
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:37:32                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fl3KZU3n1u68mUqBO1.exe
Real Name:	/1d8fd13c890060464019c0f07b928b1a.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5	- Privilege Escalation::Access Token Manipulation [T1134;5]
6	- Collection::Automated Collection [T1119;6]
4	- Discovery::Software Discovery [T1518;4]
2	- Discovery::File and Directory Discovery [T1083;2]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
4	- Discovery::Process Discovery [T1057;4]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
45	Win.Trojan.GetMyPass-1

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
100	Malware Hash
70	escalate_priv
60	win_mutex
65	win_token
10	win_files_operation
10	misc_pe_signature
10	ft_exe
45	win_getmypass_auto
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Borland_Delphi_30_additional
70	Borland_Delphi_30_
70	Borland_Delphi_v40_v50
70	Borland_Delphi_v30
70	Borland_Delphi_DLL
10	IsPE32
10	IsWindowsGUI
10	HasOverlay
10	HasDigitalSignature
10	HasRichSignature
2	PE_File
30	Check_OutputDebugStringA_iat_v1
30	Check_OutputDebugStringA_iat
10	anti_dbg
20	isExecutable
10	Contains_PE_File
1	db_connection

============================[ Scores ]============================
CAPA:	24.0
ClamAV:	45.0
Loki:	950
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
18101.864719280486
==================================================================


==================================================================
Fichier HTTP-Fl3KZU3n1u68mUqBO1.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FXUfqn1QvkEaW3kEK7.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FXUfqn1QvkEaW3kEK7.exe: Win.Worm.Hai-1 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 41.480 sec (0 m 41 s)
Start Date: 2022:02:11 12:38:28
End Date:   2022:02:11 12:39:09

-------- Score ----------------
Scores		Rules
.......		...............
35		Win.Worm.Hai-1

Score total: 35.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:38:28Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FXUfqn1QvkEaW3kEK7.exe SCORE: 649 TYPE: EXE SIZE: 65539 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4dfb2d5400> 
MD5: f0a6a1bd6d760497623611e8297a81df 
SHA1: 43a0c32e8c6c1c8d78c43550bcfa5740e27fdbb4 
SHA256: e50aaa300d13af1aeb4e5f06e89fe14d02300c6e27932f0c296e6706a4170963 CREATED: Fri Feb 11 12:38:28 2022 MODIFIED: Fri Feb 11 12:38:28 2022 ACCESSED: Fri Feb 11 12:39:18 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 2 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: PE_Lock_NT_v201_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: eb03cd20c71eeb03cd20ea9ceb02eb01eb01eb60
REASON_5: Yara Rule MATCH: PE_Lock_NT_v204_MARQUISDESOIRE SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: eb03cd20c71eeb03cd20ea9ceb02eb01eb01eb60eb03cd20ebeb01ebe803000000e9eb04584050c3
REASON_6: Yara Rule MATCH: PELOCKnt_204 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: eb03cd20c71eeb03cd20ea9ceb02eb01eb01eb60
REASON_7: Yara Rule MATCH: PELOCKnt_204_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: eb03cd20c71eeb03cd20ea9ceb02eb01eb01eb60
REASON_8: Yara Rule MATCH: PE_Lock_NT_v204 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: eb03cd20c71eeb03cd20ea9ceb02eb01eb01eb60eb03cd20ebeb01ebe803000000e9eb04584050c3
REASON_9: Yara Rule MATCH: PELockNTv204 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: eb03cd20c71eeb03cd20ea9ceb02eb01eb01eb60eb03cd20ebeb01ebe803000000e9eb04584050c3
REASON_10: Yara Rule MATCH: PELOCKnt204 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: eb03cd20c71eeb03cd20ea9ceb02eb01eb01eb60
REASON_11: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: PELOCKnt
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:39:19Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_close_8
5		executable_pe
70		PE_Lock_NT_v201_additional
70		PE_Lock_NT_v204_MARQUISDESOIRE
70		PELOCKnt_204
70		PELOCKnt_204_additional
70		PE_Lock_NT_v204
70		PELockNTv204
70		PELOCKnt204
10		IsPE32
10		IsWindowsGUI
10		IsPacked
10		HasOverlay
10		HasRichSignature
2		PE_File
60		suspicious_packer_section
20		isExecutable
10		Contains_PE_File

Score total: 649

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 62/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:38:28                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FXUfqn1QvkEaW3kEK7.exe
Real Name:	/f0a6a1bd6d760497623611e8297a81df.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
35	Win.Worm.Hai-1

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_close_8
5	executable_pe
70	PE_Lock_NT_v201_additional
70	PE_Lock_NT_v204_MARQUISDESOIRE
70	PELOCKnt_204
70	PELOCKnt_204_additional
70	PE_Lock_NT_v204
70	PELockNTv204
70	PELOCKnt204
10	IsPE32
10	IsWindowsGUI
10	IsPacked
10	HasOverlay
10	HasRichSignature
2	PE_File
60	suspicious_packer_section
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	0
ClamAV:	35.0
Loki:	649
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
12726.580713200585
==================================================================


==================================================================
Fichier HTTP-FXUfqn1QvkEaW3kEK7.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FICt036scInjfkiu2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 82ef69ecabf12160625a6ba15d2a2671                                                   |
| sha1                   | 5e590f68d63ba7ddf86c822498faa944a4e0990a                                           |
| sha256                 | 4ab78dc788cead8f20227c9e2abfbefd5e74c64c85677c505ae7e694b7d41565                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FICt036scInjfkiu2.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get system information on Windows                    | host-interaction/os/info                             |
| query or enumerate registry value (4 matches)        | host-interaction/registry                            |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Discovery::Query Registry [T1012;1]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 5.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FICt036scInjfkiu2.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 41.595 sec (0 m 41 s)
Start Date: 2022:02:11 12:39:20
End Date:   2022:02:11 12:40:01

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:39:20Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FICt036scInjfkiu2.exe SCORE: 434 TYPE: EXE SIZE: 79032 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fbe5d2f2400> 
MD5: 82ef69ecabf12160625a6ba15d2a2671 
SHA1: 5e590f68d63ba7ddf86c822498faa944a4e0990a 
SHA256: 4ab78dc788cead8f20227c9e2abfbefd5e74c64c85677c505ae7e694b7d41565 CREATED: Fri Feb 11 12:39:20 2022 MODIFIED: Fri Feb 11 12:39:20 2022 ACCESSED: Fri Feb 11 12:40:12 2022 
REASON_1: Yara Rule MATCH: cred_local SUBSCORE: 80 
DESCRIPTION: Steal credential REF: - AUTHOR: x0r 
MATCHES: Str1: SamQueryInformationUse
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_4: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e83b0300004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_11: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:40:12Z

-------- Score ----------------
Scores		Rules
.......		...............
80		cred_local
20		win_registry
65		win_token
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 434

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:39:20                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FICt036scInjfkiu2.exe
Real Name:	/easinvoker.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Discovery::Query Registry [T1012;1]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1	- Discovery::System Information Discovery [T1082;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
80	cred_local
20	win_registry
65	win_token
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	5.0
ClamAV:	0
Loki:	434
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
6978.199571029675
==================================================================


==================================================================
Fichier HTTP-FICt036scInjfkiu2.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FOJu6N3brXwQwha0Uf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FOJu6N3brXwQwha0Uf.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 42.741 sec (0 m 42 s)
Start Date: 2022:02:11 12:40:13
End Date:   2022:02:11 12:40:56

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:40:13Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FOJu6N3brXwQwha0Uf.exe SCORE: 439 TYPE: EXE SIZE: 12288 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7c880a5400> 
MD5: 68eaaa29813d706f4024af83cf3b88dc 
SHA1: db773a25602a3b3b678ce89e26ea85ab5b8ee59b 
SHA256: b756a02776b6b33394b255ba99f4cc0379cccbe080f36fd80034a5a6e2ffaa3e CREATED: Fri Feb 11 12:40:13 2022 MODIFIED: Fri Feb 11 12:40:13 2022 ACCESSED: Fri Feb 11 12:41:00 2022 
REASON_1: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_7 SUBSCORE: 2 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: PECompact_v110b2_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: eb066877150000c39c60e80200000033c08bc483c004938be38b5bfc81
REASON_6: Yara Rule MATCH: PECompact_v14xp_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: eb066877150000c39c60e80200000033c08bc483c004938be38b5bfc81
REASON_7: Yara Rule MATCH: PECompact_v14xp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: eb066877150000c39c60e80200000033c08bc483c004938be38b5bfc81
REASON_8: Yara Rule MATCH: PECompactv14x SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: eb066877150000c39c60e80200000033c08bc483c004938be38b5bfc81
REASON_9: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: pec1 Str2: pec2
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:41:00Z

-------- Score ----------------
Scores		Rules
.......		...............
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_7
5		executable_pe
70		PECompact_v110b2_additional
70		PECompact_v14xp_additional
70		PECompact_v14xp
70		PECompactv14x
10		IsPE32
10		IsWindowsGUI
10		IsPacked
10		HasRichSignature
2		PE_File
60		suspicious_packer_section
20		isExecutable
10		Contains_PE_File

Score total: 439

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 48/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:40:13                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FOJu6N3brXwQwha0Uf.exe
Real Name:	/Practical Malware Analysis Lab 18-03.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	Str_Win32_Winsock2_Library
10	ft_exe
2	math_entropy_7
5	executable_pe
70	PECompact_v110b2_additional
70	PECompact_v14xp_additional
70	PECompact_v14xp
70	PECompactv14x
10	IsPE32
10	IsWindowsGUI
10	IsPacked
10	HasRichSignature
2	PE_File
60	suspicious_packer_section
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	0
ClamAV:	0
Loki:	439
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
8957.681114904288
==================================================================


==================================================================
Fichier HTTP-FOJu6N3brXwQwha0Uf.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FwS9Bn1WjrPX47G121.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5247539e5510a12bb64bdef04027befb                                                   |
| sha1                   | c4ddbb32c13e207ce722774973d8763b47136155                                           |
| sha256                 | 2fb7c331a06b426c128ef653eb3496d0f8c8ef9a7d32195b9b660e559e6933c9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FwS9Bn1WjrPX47G121.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes (17 matches)  | host-interaction/driver                              |
| terminate process via fastfail (13 matches)          | host-interaction/process/terminate                   |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Execution::System Services::Service Execution [T1569.002;3]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 6.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:41:01Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FwS9Bn1WjrPX47G121.exe SCORE: 364 TYPE: EXE SIZE: 86864 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f881baed400> 
MD5: 5247539e5510a12bb64bdef04027befb 
SHA1: c4ddbb32c13e207ce722774973d8763b47136155 
SHA256: 2fb7c331a06b426c128ef653eb3496d0f8c8ef9a7d32195b9b660e559e6933c9 CREATED: Fri Feb 11 12:41:01 2022 MODIFIED: Fri Feb 11 12:41:01 2022 ACCESSED: Fri Feb 11 12:41:37 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8eb0400004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:41:38Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 364

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FwS9Bn1WjrPX47G121.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.08 MB
Data read: 0.08 MB (ratio 1.00:1)
Time: 41.097 sec (0 m 41 s)
Start Date: 2022:02:11 12:41:01
End Date:   2022:02:11 12:41:42

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/69
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:41:01                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FwS9Bn1WjrPX47G121.exe
Real Name:	/spaceman.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
3	- Execution::System Services::Service Execution [T1569.002;3]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	6.0
ClamAV:	0
Loki:	364
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5888.726959456586
==================================================================


==================================================================
Fichier HTTP-FwS9Bn1WjrPX47G121.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fj3gby4sK6j6zzBume.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | dc4dc746d8a14060fb5fc7edd4ef5282                                                   |
| sha1                   | b0f1a213545cd7bc06ce9ee42709a2b45af06b28                                           |
| sha256                 | 3cf53c1ad414913e4d57a4d6f319938cafa6edb62a5e3f7b797658f90c0ceea9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fj3gby4sK6j6zzBume.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| write file on Windows                                | host-interaction/file-system/write                   |
| terminate process (2 matches)                        | host-interaction/process/terminate                   |
| link many functions at runtime                       | linking/runtime-linking                              |
| load NCR ATM library                                 | targeting/automated-teller-machine/ncr               |
| reference NCR ATM library routines                   | targeting/automated-teller-machine/ncr               |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fj3gby4sK6j6zzBume.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 36.572 sec (0 m 36 s)
Start Date: 2022:02:11 12:41:43
End Date:   2022:02:11 12:42:19

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:41:43Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fj3gby4sK6j6zzBume.exe SCORE: 239 TYPE: EXE SIZE: 16384 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fcdadde9400> 
MD5: dc4dc746d8a14060fb5fc7edd4ef5282 
SHA1: b0f1a213545cd7bc06ce9ee42709a2b45af06b28 
SHA256: 3cf53c1ad414913e4d57a4d6f319938cafa6edb62a5e3f7b797658f90c0ceea9 CREATED: Fri Feb 11 12:41:43 2022 MODIFIED: Fri Feb 11 12:41:43 2022 ACCESSED: Fri Feb 11 12:42:37 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: CreateFileA
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Nullsoft_PiMP_Install_System_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 83ec14535556
REASON_6: Yara Rule MATCH: Nullsoft_PiMP_Install_System SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 83ec14535556
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:42:37Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Nullsoft_PiMP_Install_System_additional
70		Nullsoft_PiMP_Install_System
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 239

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 5/72
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:41:43                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fj3gby4sK6j6zzBume.exe
Real Name:	/dc4dc746d8a14060fb5fc7edd4ef5282.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Nullsoft_PiMP_Install_System_additional
70	Nullsoft_PiMP_Install_System
10	IsPE32
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	2.0
ClamAV:	0
Loki:	239
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
5827.799976281438
==================================================================


==================================================================
Fichier HTTP-Fj3gby4sK6j6zzBume.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FlNkPQ1FRLVPXp2Cla.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | cb612bd0353ba7151c1e6898b6e962c8                                                   |
| sha1                   | b4cbfac922bbc0b99f8e8ce30ee9c2db893be21c                                           |
| sha256                 | 6248846240929afd09bd74fb91d08617e5cf07314c219562f37dc28e30474684                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FlNkPQ1FRLVPXp2Cla.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FlNkPQ1FRLVPXp2Cla.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.18 MB
Data read: 0.17 MB (ratio 1.05:1)
Time: 43.372 sec (0 m 43 s)
Start Date: 2022:02:11 12:42:38
End Date:   2022:02:11 12:43:22

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:42:38Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FlNkPQ1FRLVPXp2Cla.exe SCORE: 109 TYPE: EXE SIZE: 183808 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f80411e8400> 
MD5: cb612bd0353ba7151c1e6898b6e962c8 
SHA1: b4cbfac922bbc0b99f8e8ce30ee9c2db893be21c 
SHA256: 6248846240929afd09bd74fb91d08617e5cf07314c219562f37dc28e30474684 CREATED: Fri Feb 11 12:42:38 2022 MODIFIED: Fri Feb 11 12:42:38 2022 ACCESSED: Fri Feb 11 12:43:32 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_7 SUBSCORE: 2 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:43:32Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_7
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		IsPacked
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 109

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/65
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:42:38                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FlNkPQ1FRLVPXp2Cla.exe
Real Name:	/miguiresource.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_7
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	IsPacked
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	1.0
ClamAV:	0
Loki:	109
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
1747.4862029323024
==================================================================


==================================================================
Fichier HTTP-FlNkPQ1FRLVPXp2Cla.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F0IKVe3Eof4tNp7w99.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F0IKVe3Eof4tNp7w99.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 1.66 MB
Data read: 0.84 MB (ratio 1.98:1)
Time: 41.757 sec (0 m 41 s)
Start Date: 2022:02:11 12:43:33
End Date:   2022:02:11 12:44:15

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf1 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:43:34Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F0IKVe3Eof4tNp7w99.exe SCORE: 2144 TYPE: EXE SIZE: 878592 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f658d3ee400> 
MD5: 5fbbfeed28b258c42e0cfeb16718b31c 
SHA1: 43e862583a091f3a88be2cee1b2c44892154dc32 
SHA256: 9b721175dcac05edf402c9b7eebe167270603c039310acdb5e609628fd591ad0 CREATED: Fri Feb 11 12:43:33 2022 MODIFIED: Fri Feb 11 12:43:33 2022 ACCESSED: Fri Feb 11 12:44:25 2022 
REASON_1: Yara Rule MATCH: create_service SUBSCORE: 45 
DESCRIPTION: Create a windows service REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: CreateService Str4: ControlService Str5: StartService Str6: QueryServiceStatus
REASON_2: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_3: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_4: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: RegCloseKey
REASON_5: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: OpenProcessToken
REASON_6: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: Kernel32.dll Str3: KERNEL32.dll Str4: WriteFile Str5: SetFilePointer Str6: ReadFile Str7: FindClose Str8: CopyFile
REASON_7: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_8: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: ConventionEngine_Anomaly_OutsideOfDebug SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453f14648d77cd4d94186c369b86649ad7601000000583a5c5057445352565c41524d36345c52656c656173655c5057445352562e70646200
REASON_10: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_12: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: Microsoft_Visual_Basic_v50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: h
REASON_14: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_17: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: stager_reverse_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_20: Yara Rule MATCH: stager_bind_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_21: Yara Rule MATCH: win32_stage_boot_winsock_conn_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_22: Yara Rule MATCH: win32_stage_boot_bind_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_23: Yara Rule MATCH: win32_stage_boot_reverse_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_24: Yara Rule MATCH: win32_stage_boot_winsock_conn_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_25: Yara Rule MATCH: stager_reverse_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_26: Yara Rule MATCH: win32_stage_boot_bind_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_27: Yara Rule MATCH: win32_stage_boot_reverse_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_28: Yara Rule MATCH: win32_stage_boot_reverse_shell_revert_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_29: Yara Rule MATCH: win32_stage_winexec_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_30: Yara Rule MATCH: stager_bind_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_31: Yara Rule MATCH: win32_stage_boot_winsock_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_32: Yara Rule MATCH: win32_stage_boot_reverse_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_33: Yara Rule MATCH: win32_stage_api_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_34: Yara Rule MATCH: win32_stage_boot_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_35: Yara Rule MATCH: win32_stage_boot_reverse_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_36: Yara Rule MATCH: win32_stage_boot_reverse_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_37: Yara Rule MATCH: win32_stage_boot_bind_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_38: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_39: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: UnhookWindowsHookEx Str3: CallNextHookEx
REASON_40: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_41: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_42: Yara Rule MATCH: Antivirus_strings SUBSCORE: 50 
DESCRIPTION: Contains references to security software REF: - AUTHOR: Jerome Athias 
MATCHES: Str1: nUI.exe
REASON_43: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_44: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_45: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: fdfb8cfc2e4d170431fb6b8c67210672 Str2: a7eb3390a15bcd2c80a978c75f2dcc4f Str3: 941dd5f1c32c7cec49703f0dfde8eba5 Str4: d2611745022d67cf ... (truncated)
REASON_46: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:44:27Z

-------- Score ----------------
Scores		Rules
.......		...............
45		create_service
65		screenshot
80		keylogger
20		win_registry
65		win_token
10		win_files_operation
10		Str_Win32_Http_API
10		ft_exe
50		ConventionEngine_Anomaly_OutsideOfDebug
2		math_entropy_6
5		executable_pe
15		dll_injection_hook
70		Microsoft_Visual_Basic_v50
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
35		Embedded_PE
2		PE_File
70		stager_reverse_tcp_nx_ldone_x86
70		stager_bind_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_conn_ldone_x86
70		win32_stage_boot_bind_read_ldone_x86
70		win32_stage_boot_reverse_read_ldone_x86
70		win32_stage_boot_winsock_conn_udp_ldone_x86
70		stager_reverse_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_bind_inlineegg_ldone_x86
70		win32_stage_boot_reverse_ldone_x86
70		win32_stage_boot_reverse_shell_revert_ldone_x86
70		win32_stage_winexec_ldone_x86
70		stager_bind_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_bind_ldone_x86
70		win32_stage_boot_reverse_shell_ldone_x86
70		win32_stage_api_ldone_x86
70		win32_stage_boot_bind_ldone_x86
70		win32_stage_boot_reverse_udp_ldone_x86
70		win32_stage_boot_reverse_inlineegg_ldone_x86
70		win32_stage_boot_bind_shell_ldone_x86
35		Anti_Automated_Sandbox
35		Win_Hook_v12
60		Debugger_Check__QueryInfo
60		DebuggerException__SetConsoleCtrl_v1
50		Antivirus_strings
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1
20		Advapi_Hash_API

Score total: 2144

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5fbbfeed28b258c42e0cfeb16718b31c                                                   |
| sha1                   | 43e862583a091f3a88be2cee1b2c44892154dc32                                           |
| sha256                 | 9b721175dcac05edf402c9b7eebe167270603c039310acdb5e609628fd591ad0                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F0IKVe3Eof4tNp7w99.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Automated Collection:: \[T1119]\                                                   |
|                        | Clipboard Data:: \[T1115]\                                                         |
|                        | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                            |
|                        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COLLECTION                  | Keylogging::Application Hook [F0002.001]                                      |
|                             | Keylogging::Polling [F0002.002]                                               |
| COMMUNICATION               | Interprocess Communication::Create Pipe [C0003.001]                           |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Encryption Key:: [C0028]                                                      |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Checksum::CRC32 [C0032.001]                                                   |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Console:: [C0033]                                                             |
|                             | Environment Variable::Set Variable [C0034.001]                                |
|                             | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                                  | NAMESPACE                                            |
|-------------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints                              | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via GetTickCount                       | anti-analysis/anti-debugging/debugger-detection      |
| timestomp file (2 matches)                                  | anti-analysis/anti-forensic/timestomp                |
| execute anti-VM instructions                                | anti-analysis/anti-vm/vm-detection                   |
| contain obfuscated stackstrings                             | anti-analysis/obfuscation/string/stackstring         |
| parse credit card information                               | collection/credit-card                               |
| log keystrokes via application hook                         | collection/keylog                                    |
| log keystrokes via polling                                  | collection/keylog                                    |
| create pipe                                                 | communication/named-pipe/create                      |
| hash data with CRC32 (2 matches)                            | data-manipulation/checksum/crc32                     |
| create new key via CryptAcquireContext                      | data-manipulation/encryption                         |
| hash data via WinCrypt                                      | data-manipulation/hashing                            |
| initialize hashing via WinCrypt                             | data-manipulation/hashing                            |
| hash data with MD5                                          | data-manipulation/hashing/md5                        |
| contains PDB path                                           | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                          | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (6 matches)         | executable/resource                                  |
| contain an embedded PE file                                 | executable/subfile/pe                                |
| manipulate boot configuration (3 matches)                   | host-interaction/bootloader                          |
| replace clipboard data                                      | host-interaction/clipboard                           |
| manipulate console (3 matches)                              | host-interaction/console                             |
| query environment variable (3 matches)                      | host-interaction/environment-variable                |
| set environment variable (2 matches)                        | host-interaction/environment-variable                |
| get common file path (3 matches)                            | host-interaction/file-system                         |
| read raw disk data                                          | host-interaction/file-system                         |
| copy file (2 matches)                                       | host-interaction/file-system/copy                    |
| create directory                                            | host-interaction/file-system/create                  |
| delete directory                                            | host-interaction/file-system/delete                  |
| delete file (6 matches)                                     | host-interaction/file-system/delete                  |
| check if file exists (11 matches)                           | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions (9 matches)          | host-interaction/file-system/files/list              |
| get file attributes (14 matches)                            | host-interaction/file-system/meta                    |
| get file size (3 matches)                                   | host-interaction/file-system/meta                    |
| get file version info                                       | host-interaction/file-system/meta                    |
| set file attributes (7 matches)                             | host-interaction/file-system/meta                    |
| move file                                                   | host-interaction/file-system/move                    |
| read .ini file (4 matches)                                  | host-interaction/file-system/read                    |
| read file on Windows (14 matches)                           | host-interaction/file-system/read                    |
| read file via mapping                                       | host-interaction/file-system/read                    |
| write file on Windows (11 matches)                          | host-interaction/file-system/write                   |
| enumerate gui resources                                     | host-interaction/gui                                 |
| get graphical window text (15 matches)                      | host-interaction/gui/window/get-text                 |
| hide graphical window (2 matches)                           | host-interaction/gui/window/hide                     |
| enumerate disk volumes                                      | host-interaction/hardware/storage                    |
| get disk information (17 matches)                           | host-interaction/hardware/storage                    |
| get disk size (3 matches)                                   | host-interaction/hardware/storage                    |
| get storage device properties (4 matches)                   | host-interaction/hardware/storage                    |
| get system information on Windows (3 matches)               | host-interaction/os/info                             |
| check OS version                                            | host-interaction/os/version                          |
| get thread local storage value (20 matches)                 | host-interaction/process                             |
| read process memory                                         | host-interaction/process                             |
| set thread local storage value (4 matches)                  | host-interaction/process                             |
| create a process with modified I/O handles and window       | host-interaction/process/create                      |
| create process on Windows (11 matches)                      | host-interaction/process/create                      |
| allocate RWX memory (2 matches)                             | host-interaction/process/inject                      |
| enumerate processes (2 matches)                             | host-interaction/process/list                        |
| create registry key via offline registry library            | host-interaction/registry                            |
| open registry key via offline registry library (3 matches)  | host-interaction/registry                            |
| query or enumerate registry value (8 matches)               | host-interaction/registry                            |
| query registry key via offline registry library (3 matches) | host-interaction/registry                            |
| set registry key via offline registry library (2 matches)   | host-interaction/registry                            |
| set registry value (7 matches)                              | host-interaction/registry/create                     |
| delete registry key                                         | host-interaction/registry/delete                     |
| query service status                                        | host-interaction/service                             |
| create service (2 matches)                                  | host-interaction/service/create                      |
| start service                                               | host-interaction/service/start                       |
| stop service                                                | host-interaction/service/stop                        |
| get token membership                                        | host-interaction/session                             |
| create thread (2 matches)                                   | host-interaction/thread/create                       |
| link many functions at runtime (6 matches)                  | linking/runtime-linking                              |
| parse PE exports                                            | load-code/pe                                         |
| parse PE header (41 matches)                                | load-code/pe                                         |
| persist via Windows service (2 matches)                     | persistence/service                                  |
+-------------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
6		- Collection::Automated Collection [T1119;6]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
9		- Impact::Service Stop [T1489;9]
3		- Execution::System Services::Service Execution [T1569.002;3]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
4		- Discovery::Application Window Discovery [T1010;4]
5		- Defense Evasion::File and Directory Permissions Modification [T1222;5]
3		- Discovery::System Owner/User Discovery [T1033;3]
4		- Discovery::Software Discovery [T1518;4]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6		- Collection::Clipboard Data [T1115;6]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
4		- Discovery::Process Discovery [T1057;4]

Score total: 109.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 3/65
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:43:33                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F0IKVe3Eof4tNp7w99.exe
Real Name:	/5fbbfeed28b258c42e0cfeb16718b31c.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6	- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
8.5	- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
6	- Collection::Automated Collection [T1119;6]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
9	- Impact::Service Stop [T1489;9]
3	- Execution::System Services::Service Execution [T1569.002;3]
4	- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
4	- Discovery::Application Window Discovery [T1010;4]
5	- Defense Evasion::File and Directory Permissions Modification [T1222;5]
3	- Discovery::System Owner/User Discovery [T1033;3]
4	- Discovery::Software Discovery [T1518;4]
8.5	- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
2	- Discovery::File and Directory Discovery [T1083;2]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
6	- Collection::Input Capture::Keylogging [T1056.001;6]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6	- Collection::Clipboard Data [T1115;6]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
4	- Discovery::Process Discovery [T1057;4]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
45	create_service
65	screenshot
80	keylogger
20	win_registry
65	win_token
10	win_files_operation
10	Str_Win32_Http_API
10	ft_exe
50	ConventionEngine_Anomaly_OutsideOfDebug
2	math_entropy_6
5	executable_pe
15	dll_injection_hook
70	Microsoft_Visual_Basic_v50
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
35	Embedded_PE
2	PE_File
70	stager_reverse_tcp_nx_ldone_x86
70	stager_bind_tcp_nx_ldone_x86
70	win32_stage_boot_winsock_conn_ldone_x86
70	win32_stage_boot_bind_read_ldone_x86
70	win32_stage_boot_reverse_read_ldone_x86
70	win32_stage_boot_winsock_conn_udp_ldone_x86
70	stager_reverse_ipv6_tcp_nx_ldone_x86
70	win32_stage_boot_bind_inlineegg_ldone_x86
70	win32_stage_boot_reverse_ldone_x86
70	win32_stage_boot_reverse_shell_revert_ldone_x86
70	win32_stage_winexec_ldone_x86
70	stager_bind_ipv6_tcp_nx_ldone_x86
70	win32_stage_boot_winsock_bind_ldone_x86
70	win32_stage_boot_reverse_shell_ldone_x86
70	win32_stage_api_ldone_x86
70	win32_stage_boot_bind_ldone_x86
70	win32_stage_boot_reverse_udp_ldone_x86
70	win32_stage_boot_reverse_inlineegg_ldone_x86
70	win32_stage_boot_bind_shell_ldone_x86
35	Anti_Automated_Sandbox
35	Win_Hook_v12
60	Debugger_Check__QueryInfo
60	DebuggerException__SetConsoleCtrl_v1
50	Antivirus_strings
20	isExecutable
10	Contains_PE_File
10	Big_Numbers1
20	Advapi_Hash_API

============================[ Scores ]============================
CAPA:	109.5
ClamAV:	0
Loki:	2144
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
38164.92228125719
==================================================================


==================================================================
Fichier HTTP-F0IKVe3Eof4tNp7w99.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FSxkHD11ShGcSykfye.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b792676216706673b65d67916460299f                                                   |
| sha1                   | 7e7351664daea80efcf57c7a55e413c59bf53ba2                                           |
| sha256                 | 15e3a70fd3f2972cd8d7826dfe4058255b0fbb974969828644d93256f7fb9c12                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FSxkHD11ShGcSykfye.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FSxkHD11ShGcSykfye.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 42.556 sec (0 m 42 s)
Start Date: 2022:02:11 12:45:57
End Date:   2022:02:11 12:46:40

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:45:57Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FSxkHD11ShGcSykfye.exe SCORE: 229 TYPE: EXE SIZE: 24576 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f07d6bf7400> 
MD5: b792676216706673b65d67916460299f 
SHA1: 7e7351664daea80efcf57c7a55e413c59bf53ba2 
SHA256: 15e3a70fd3f2972cd8d7826dfe4058255b0fbb974969828644d93256f7fb9c12 CREATED: Fri Feb 11 12:45:57 2022 MODIFIED: Fri Feb 11 12:45:57 2022 ACCESSED: Fri Feb 11 12:46:51 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e81b0500004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:46:51Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:45:57                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FSxkHD11ShGcSykfye.exe
Real Name:	/tscon.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
1	- Discovery::System Information Discovery [T1082;1]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	10.0
ClamAV:	0
Loki:	229
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3828.9316422328375
==================================================================


==================================================================
Fichier HTTP-FSxkHD11ShGcSykfye.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FosWSa2NkqhRaLIF6l.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 7a2e485d1bea00ee5907e4cc02cb2552                                                   |
| sha1                   | c5b482c79be28e1e8dcaf489a88a586b80e2482c                                           |
| sha256                 | b3b4c065849c81d856558e9cf91e8cef5d481648fd8aa88cdda534ab6b75e988                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FosWSa2NkqhRaLIF6l.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
|                        | Process Injection::Process Hollowing \[T1055.012]\                                 |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+------------------------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                                   |
|-----------------------------+------------------------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                                            |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                                     |
|                             | Virtual Machine Detection::Unique Hardware/Firmware Check - I/O Communication Port [B0009.025] |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                                         |
| EXECUTION                   | Install Additional Program:: [B0023]                                                           |
| MEMORY                      | Allocate Memory:: [C0007]                                                                      |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                                      |
|                             | Registry::Open Registry Key [C0036.003]                                                        |
|                             | Registry::Query Registry Key [C0036.005]                                                       |
| PROCESS                     | Create Process:: [C0017]                                                                       |
|                             | Create Process::Create Suspended Process [C0017.003]                                           |
|                             | Create Thread:: [C0038]                                                                        |
|                             | Resume Thread:: [C0054]                                                                        |
+-----------------------------+------------------------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-VM instructions                         | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VMWare           | anti-analysis/anti-vm/vm-detection                   |
| reference the VMWare IO port                         | anti-analysis/anti-vm/vm-detection                   |
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| get common file path                                 | host-interaction/file-system                         |
| read process memory                                  | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| inject dll                                           | host-interaction/process/inject                      |
| inject thread                                        | host-interaction/process/inject                      |
| use process replacement                              | host-interaction/process/inject                      |
| enumerate processes                                  | host-interaction/process/list                        |
| query or enumerate registry key                      | host-interaction/registry                            |
| link function at runtime on Windows (3 matches)      | linking/runtime-linking                              |
| enumerate PE sections                                | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
2		- Execution::Shared Modules [T1129;2]
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::Query Registry [T1012;1]
4		- Discovery::Software Discovery [T1518;4]
2		- Discovery::File and Directory Discovery [T1083;2]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
5		- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]

Score total: 39.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FosWSa2NkqhRaLIF6l.exe: Win.Malware.Explorerhijack-9937586-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FosWSa2NkqhRaLIF6l.exe: Win.Malware.Explorerhijack-9937587-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FosWSa2NkqhRaLIF6l.exe: Win.Trojan.Agent-663582 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 39.198 sec (0 m 39 s)
Start Date: 2022:02:11 12:46:52
End Date:   2022:02:11 12:47:31

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Explorerhijack-9937586-0
50		Win.Malware.Explorerhijack-9937587-0
70		Win.Trojan.Agent-663582
75		Win.Trojan.Agent-663582
45		Win.Trojan.Agent-663582

Score total: 290.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:46:52Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FosWSa2NkqhRaLIF6l.exe SCORE: 784 TYPE: EXE SIZE: 45056 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f2d0363b400> 
MD5: 7a2e485d1bea00ee5907e4cc02cb2552 
SHA1: c5b482c79be28e1e8dcaf489a88a586b80e2482c 
SHA256: b3b4c065849c81d856558e9cf91e8cef5d481648fd8aa88cdda534ab6b75e988 CREATED: Fri Feb 11 12:46:52 2022 MODIFIED: Fri Feb 11 12:46:52 2022 ACCESSED: Fri Feb 11 12:47:46 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegOpenKeyExA Str3: RegCloseKey
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645c800c645c950c645ca56c645 Str2: c645c950c645ca56c645cb00c645 Str3: c645ca56c645cb00c645cc0cc645 Str4: c645cb00c645cc0cc645cd29c645 ... (truncated)
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff68d020400068301b400064a100000000506489250000000083ec20535657
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68c020400068301b400064a10000000050 Str2: 558bec6aff68d020400068301b400064a10000000050
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68c020400068301b400064a10000000050 Str2: 558bec6aff68d020400068301b400064a10000000050
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83 Str2: 558bec51 Str3: 558bec81 Str4: 558bec57 Str5: 558bec6a Str6: 558bec6aff68c020400068301b400064a10000000050 Str7: 558bec6 ... (truncated)
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68c020400068301b400064a1000000005064892500000000 Str2: 558bec6aff68d020400068301b400064a1000000005064892500000000
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: vmware Str2: b868584d56bb00000000b90a000000ba58560000ed
REASON_17: Yara Rule MATCH: antivm_vmware SUBSCORE: 60 
DESCRIPTION: AntiVM checks for VMWare REF: - AUTHOR: x0r 
MATCHES: Str1: b868584d56bb00000000b90a000000ba58560000ed
REASON_18: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: vmware
REASON_19: Yara Rule MATCH: ThreadControl__Context_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetThreadContext
REASON_20: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_21: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: vmware
REASON_22: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_23: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:47:48Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		ft_exe
2		math_entropy_4
5		obfuscation_singlebyte_mov
5		executable_pe
15		dll_injection_thread
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsConsole
10		HasRichSignature
2		PE_File
35		VMWare_Detection
60		antivm_vmware
60		vmdetect_2
60		ThreadControl__Context_v1
40		SEH_Init
60		vmdetect
20		isExecutable
10		Contains_PE_File

Score total: 784

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 54/67
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:46:52                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FosWSa2NkqhRaLIF6l.exe
Real Name:	/Practical Malware Analysis Lab 17-03.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5	- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
2	- Execution::Shared Modules [T1129;2]
6	- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::Query Registry [T1012;1]
4	- Discovery::Software Discovery [T1518;4]
2	- Discovery::File and Directory Discovery [T1083;2]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
5	- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4	- Discovery::Process Discovery [T1057;4]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
50	Win.Malware.Explorerhijack-9937586-0
50	Win.Malware.Explorerhijack-9937587-0
70	Win.Trojan.Agent-663582
75	Win.Trojan.Agent-663582
45	Win.Trojan.Agent-663582

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	ft_exe
2	math_entropy_4
5	obfuscation_singlebyte_mov
5	executable_pe
15	dll_injection_thread
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsConsole
10	HasRichSignature
2	PE_File
35	VMWare_Detection
60	antivm_vmware
60	vmdetect_2
60	ThreadControl__Context_v1
40	SEH_Init
60	vmdetect
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	39.0
ClamAV:	290.0
Loki:	784
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
18854.598625936076
==================================================================


==================================================================
Fichier HTTP-FosWSa2NkqhRaLIF6l.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FGlSs81GkG0Nvnrxza.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e43555271a5a44c962d09844e7adc137                                                   |
| sha1                   | afbceceee83031342fd035141c44c0affeae274b                                           |
| sha256                 | 3d761e69cbbfe3055677c6b5ab296919c940ad0a55cc527fdab8cf52bacd487b                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FGlSs81GkG0Nvnrxza.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FGlSs81GkG0Nvnrxza.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 42.132 sec (0 m 42 s)
Start Date: 2022:02:11 12:47:49
End Date:   2022:02:11 12:48:31

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:47:49Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FGlSs81GkG0Nvnrxza.exe SCORE: 129 TYPE: EXE SIZE: 66448 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f417e324400> 
MD5: e43555271a5a44c962d09844e7adc137 
SHA1: afbceceee83031342fd035141c44c0affeae274b 
SHA256: 3d761e69cbbfe3055677c6b5ab296919c940ad0a55cc527fdab8cf52bacd487b CREATED: Fri Feb 11 12:47:49 2022 MODIFIED: Fri Feb 11 12:47:49 2022 ACCESSED: Fri Feb 11 12:48:42 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 10 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:48:42Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
2		math_entropy_4
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasOverlay
10		HasDebugData
10		ImportTableIsBad
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 129

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/57
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:47:49                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FGlSs81GkG0Nvnrxza.exe
Real Name:	/mfc140ita.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	misc_pe_signature
10	ft_exe
2	math_entropy_4
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasOverlay
10	HasDebugData
10	ImportTableIsBad
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	1.0
ClamAV:	0
Loki:	129
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
2064.464841424525
==================================================================


==================================================================
Fichier HTTP-FGlSs81GkG0Nvnrxza.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F4X1wa24KiAmy1HBmb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5d7c34b6854d48d3da4f96b71550a221                                                   |
| sha1                   | 1f0e20fbc74b4a7b1d73a0a6ac131f9543bd6cbb                                           |
| sha256                 | bec31fc132cff00910cb07cf9d66c9fcf5ff511f8182b61622a18843f0fd5841                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F4X1wa24KiAmy1HBmb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::Set Socket Config [C0001.001]                           |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| read and send data from client to server             | c2/file-transfer                                     |
| receive and write data from server to client         | c2/file-transfer                                     |
| initialize Winsock library                           | communication/socket                                 |
| set socket configuration                             | communication/socket                                 |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| get file size                                        | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::File and Directory Discovery [T1083;2]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]

Score total: 19.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F4X1wa24KiAmy1HBmb.exe: Win.Trojan.Generickd-7 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 42.705 sec (0 m 42 s)
Start Date: 2022:02:11 12:48:43
End Date:   2022:02:11 12:49:26

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Generickd-7

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:48:43Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F4X1wa24KiAmy1HBmb.exe SCORE: 634 TYPE: EXE SIZE: 28672 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4c386b0400> 
MD5: 5d7c34b6854d48d3da4f96b71550a221 
SHA1: 1f0e20fbc74b4a7b1d73a0a6ac131f9543bd6cbb 
SHA256: bec31fc132cff00910cb07cf9d66c9fcf5ff511f8182b61622a18843f0fd5841 CREATED: Fri Feb 11 12:48:43 2022 MODIFIED: Fri Feb 11 12:48:43 2022 ACCESSED: Fri Feb 11 12:49:37 2022 
REASON_1: Malware Hash TYPE: MD5 HASH: 5d7c34b6854d48d3da4f96b71550a221 SUBSCORE: 100 DESC: Analysis of DHS NCCIC Indicators (2014) https://www.secureworks.com/research/analysis-of-dhs-nccic-indicators
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile
REASON_3: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: win_simplefilemover_auto SUBSCORE: 45 
DESCRIPTION: Detects win.simplefilemover. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 8bfcf3a5e8def2ffff81c42002000085c0 Str2: 7d0733c0e9ee0100006820020000 Str3: 8b9540daffffd1e2528d855cfaffff50 Str4: 518d9524daffff52e8 ... (truncated)
REASON_6: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff68d0304000686022400064a100000000506489250000000083ec20535657
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68d0304000686022400064a10000000050
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68d0304000686022400064a10000000050
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83 Str2: 558bec56 Str3: 558bec68 Str4: 558becb8 Str5: 558bec81 Str6: 558bec6a Str7: 558bec6aff68d0304000686022400064a1000000005 ... (truncated)
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68d0304000686022400064a1000000005064892500000000
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:49:37Z

-------- Score ----------------
Scores		Rules
.......		...............
100		Malware Hash
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		ft_exe
45		win_simplefilemover_auto
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsConsole
10		HasRichSignature
2		PE_File
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 634

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 48/67
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:48:43                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F4X1wa24KiAmy1HBmb.exe
Real Name:	/5d7c34b6854d48d3da4f96b71550a221.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Discovery::File and Directory Discovery [T1083;2]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
8.5	- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
45	Win.Trojan.Generickd-7

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
100	Malware Hash
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	ft_exe
45	win_simplefilemover_auto
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsConsole
10	HasRichSignature
2	PE_File
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	19.0
ClamAV:	45.0
Loki:	634
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
12993.839115354922
==================================================================


==================================================================
Fichier HTTP-F4X1wa24KiAmy1HBmb.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FVcVnu11sHeiLUJNCc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ca042c9a80d01c409c740d0437942b4e                                                   |
| sha1                   | 715146caa48d94a6ae2f6f0b2d5268296d51773e                                           |
| sha256                 | cdaa7d2fd4328877fcab873cfa85b6b46b0a1afa6cc39017ced21dcfb139bba7                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FVcVnu11sHeiLUJNCc.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (3 matches)                | collection                                           |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| check OS version                                     | host-interaction/os/version                          |
| terminate process via fastfail (71 matches)          | host-interaction/process/terminate                   |
| access PEB ldr_data                                  | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
1.5		- Discovery::System Location Discovery [T1614;1.5]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 7.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FVcVnu11sHeiLUJNCc.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.11 MB
Data read: 0.11 MB (ratio 1.00:1)
Time: 41.824 sec (0 m 41 s)
Start Date: 2022:02:11 12:49:38
End Date:   2022:02:11 12:50:20

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:49:38Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FVcVnu11sHeiLUJNCc.exe SCORE: 264 TYPE: EXE SIZE: 120320 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7efcde4ce400> 
MD5: ca042c9a80d01c409c740d0437942b4e 
SHA1: 715146caa48d94a6ae2f6f0b2d5268296d51773e 
SHA256: cdaa7d2fd4328877fcab873cfa85b6b46b0a1afa6cc39017ced21dcfb139bba7 CREATED: Fri Feb 11 12:49:38 2022 MODIFIED: Fri Feb 11 12:49:38 2022 ACCESSED: Fri Feb 11 12:50:31 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e81b0600004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:50:32Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 264

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:49:38                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FVcVnu11sHeiLUJNCc.exe
Real Name:	/logman.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Discovery::System Information Discovery [T1082;1]
1.5	- Discovery::System Location Discovery [T1614;1.5]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	7.5
ClamAV:	0
Loki:	264
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4333.762701720006
==================================================================


==================================================================
Fichier HTTP-FVcVnu11sHeiLUJNCc.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FnOKNDf2vmOJaoqNc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FnOKNDf2vmOJaoqNc.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.51 MB
Data read: 0.48 MB (ratio 1.06:1)
Time: 45.423 sec (0 m 45 s)
Start Date: 2022:02:11 12:50:33
End Date:   2022:02:11 12:51:18

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0
sh: 212: Syntax error: "(" unexpected

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6f99a2c8944cb02ff28c6f9ced59b161                                                   |
| sha1                   | 2dcb89d0f72d854bef6fbca73fd7fbe503673bd0                                           |
| sha256                 | c4bb8f54e3b4577bb391c0f283d1161d5636764c40f97c799b017ce5db6dbcb3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FnOKNDf2vmOJaoqNc.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                          |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                             |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005             |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Process Injection::Process Hollowing \[T1055.012]\                                  |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                         |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                       |
|                        | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | Software Discovery:: \[T1518]\                                                      |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Location Discovery:: \[T1614]\                                               |
|                        | System Network Configuration Discovery:: \[T1016]\                                  |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
|                        | Resource Hijacking:: \[T1496]\                                                      |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
|                             | Debugger Detection::Software Breakpoints [B0001.025]                          |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | Socket Communication::Connect Socket [C0001.004]                              |
|                             | Socket Communication::Create TCP Socket [C0001.011]                           |
|                             | Socket Communication::Create UDP Socket [C0001.010]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::TCP Client [C0001.008]                                  |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
|                             | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag                     | anti-analysis/anti-debugging/debugger-detection      |
| check for software breakpoints                       | anti-analysis/anti-debugging/debugger-detection      |
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| get geographical location                            | collection                                           |
| receive data (3 matches)                             | communication                                        |
| send data (6 matches)                                | communication                                        |
| send HTTP request with Host header                   | communication/http                                   |
| get HTTP response content encoding                   | communication/http/client                            |
| creates tcp or udp socket                            | communication/socket                                 |
| initialize Winsock library                           | communication/socket                                 |
| create UDP socket                                    | communication/socket/udp/send                        |
| act as TCP client                                    | communication/tcp/client                             |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| hash data using fnv                                  | data-manipulation/hashing/fnv                        |
| hash data with MD5                                   | data-manipulation/hashing/md5                        |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| read clipboard data                                  | host-interaction/clipboard                           |
| replace clipboard data                               | host-interaction/clipboard                           |
| query environment variable                           | host-interaction/environment-variable                |
| set environment variable                             | host-interaction/environment-variable                |
| get common file path (6 matches)                     | host-interaction/file-system                         |
| get file system object information                   | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| create directory (3 matches)                         | host-interaction/file-system/create                  |
| delete file                                          | host-interaction/file-system/delete                  |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| set file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| move file                                            | host-interaction/file-system/move                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| create shortcut via IShellLink                       | host-interaction/file-system/write                   |
| write file on Windows                                | host-interaction/file-system/write                   |
| find graphical window                                | host-interaction/gui/window/find                     |
| get graphical window text (2 matches)                | host-interaction/gui/window/get-text                 |
| get keyboard layout                                  | host-interaction/hardware/keyboard/layout            |
| get disk information                                 | host-interaction/hardware/storage                    |
| check mutex and exit                                 | host-interaction/mutex                               |
| resolve DNS (2 matches)                              | host-interaction/network/dns/resolve                 |
| allocate thread local storage (3 matches)            | host-interaction/process                             |
| get thread local storage value (2 matches)           | host-interaction/process                             |
| set thread local storage value (2 matches)           | host-interaction/process                             |
| create process on Windows (11 matches)               | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| use process replacement                              | host-interaction/process/inject                      |
| enumerate processes on remote desktop session host   | host-interaction/process/list                        |
| enumerate process modules                            | host-interaction/process/modules/list                |
| terminate process by name                            | host-interaction/process/terminate                   |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| get session user name                                | host-interaction/session                             |
| create thread (5 matches)                            | host-interaction/thread/create                       |
| mine cryptocurrency                                  | impact/cryptocurrency                                |
| access PEB ldr_data (2 matches)                      | linking/runtime-linking                              |
| linked against CPP regex library                     | linking/static/cppregex                              |
| parse PE header (4 matches)                          | load-code/pe                                         |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
5		- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4		- Discovery::Application Window Discovery [T1010;4]
5		- Defense Evasion::File and Directory Permissions Modification [T1222;5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
4		- Discovery::Software Discovery [T1518;4]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
3		- Discovery::Account Discovery [T1087;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1.5		- Discovery::System Location Discovery [T1614;1.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Discovery::System Network Configuration Discovery [T1016;3]
6		- Collection::Clipboard Data [T1115;6]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
8		- Impact::Resource Hijacking [T1496;8]
4		- Discovery::Process Discovery [T1057;4]

Score total: 89.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 47/70
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:50:33                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FnOKNDf2vmOJaoqNc.exe
Real Name:	/6f99a2c8944cb02ff28c6f9ced59b161.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
5	- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]
4	- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4	- Discovery::Application Window Discovery [T1010;4]
5	- Defense Evasion::File and Directory Permissions Modification [T1222;5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3	- Discovery::System Owner/User Discovery [T1033;3]
4	- Discovery::Software Discovery [T1518;4]
2	- Discovery::File and Directory Discovery [T1083;2]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
3	- Discovery::Account Discovery [T1087;3]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1.5	- Discovery::System Location Discovery [T1614;1.5]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Discovery::System Network Configuration Discovery [T1016;3]
6	- Collection::Clipboard Data [T1115;6]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
8	- Impact::Resource Hijacking [T1496;8]
4	- Discovery::Process Discovery [T1057;4]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	inject_thread
45	network_http
50	network_tcp_socket
60	win_mutex
20	win_registry
65	win_token
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	Str_Win32_Http_API
10	ft_exe
45	win_megumin_auto
50	ConventionEngine_Term_Desktop
50	ConventionEngine_Term_Users
2	math_entropy_6
5	executable_pe
10	IsPE32
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
45	Inject_Thread
40	SEH_Save
40	SEH_Init
10	anti_dbg
70	INDICATOR_SUSPICIOUS_EXE_References_CryptoWallets
70	MALWARE_Win_Megumin
10	browser_pass
20	isExecutable
10	Contains_PE_File
10	Big_Numbers3
20	MD5_Constants
5	BASE64_table

============================[ Scores ]============================
CAPA:	89.5
ClamAV:	0
Loki:	1034
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
20173.555381945058
==================================================================


==================================================================
Fichier HTTP-FnOKNDf2vmOJaoqNc.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FO2ixUb8lfeZQLQkf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FO2ixUb8lfeZQLQkf.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 3.02 MB
Data read: 2.83 MB (ratio 1.06:1)
Time: 45.604 sec (0 m 45 s)
Start Date: 2022:02:11 12:52:08
End Date:   2022:02:11 12:52:54

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T11:52:09Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FO2ixUb8lfeZQLQkf.exe SCORE: 519 TYPE: EXE SIZE: 2970624 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f53f1c8a400> 
MD5: f4ff94ccd882cc33c6ba26e441cfcc78 
SHA1: 9450342e37a232c76c1573c0f00b83f82f034289 
SHA256: dbda182d31f85e507587ac6e37c56fe3380537d517573dd1f50050d1156b6f89 CREATED: Fri Feb 11 12:52:08 2022 MODIFIED: Fri Feb 11 12:52:08 2022 ACCESSED: Fri Feb 11 12:53:03 2022 
REASON_1: Yara Rule MATCH: network_udp_sock SUBSCORE: 45 
DESCRIPTION: Communications over UDP network REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: WSAStartup Str3: recvfrom
REASON_2: Yara Rule MATCH: network_tcp_listen SUBSCORE: 45 
DESCRIPTION: Listen for incoming communication REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: bind Str3: accept Str4: WSAStartup Str5: WSASocket Str6: listen
REASON_3: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: WSASocket Str3: socket Str4: send Str5: WSASend Str6: connect Str7: WSAStartup Str8: WSACleanup
REASON_4: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: getaddrinfo
REASON_5: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_16: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_17: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_18: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_19: Yara Rule MATCH: skip20_sqllang_hook SUBSCORE: 60 
DESCRIPTION: YARA rule to detect if a sqllang.dll version is targeted by skip-2.0. Each byte pattern corresponds to a function hooked by skip-2.0. If _0 or _1 match, it is probably targeted as it corresponds to the hook responsible for bypassing the authentication. REF: https://www.welivesecurity.com/ AUTHOR: Mathieu Tartare <mathieu.tartare@eset.com> 
MATCHES: Str1: 4c8d9c2420010000498b5b40498b7348498be3415f415e415c5f5dc3
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: certificates SUBSCORE: 5 
DESCRIPTION: not set REF: https://github.com/kevthehermit/PasteHunter AUTHOR: @KevTheHermit 
MATCHES: Str1: BEGIN EC PRIVATE KEY Str2: BEGIN CERTIFICATE
REASON_23: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2962ADEAE004074C8C0D598C5387FEB3 Str2: 5FFFB6E33C19F27A8A5535D45382B9E8 Str3: 4EDDBBCE46E0542C24BEC5BF9717C971 Str4: D946354436F2F3C7 ... (truncated)
REASON_24: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T11:53:11Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_udp_sock
45		network_tcp_listen
50		network_tcp_socket
50		network_dns
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
60		skip20_sqllang_hook
20		isExecutable
10		Contains_PE_File
5		certificates
10		Big_Numbers1
5		BASE64_table

Score total: 519

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f4ff94ccd882cc33c6ba26e441cfcc78                                                   |
| sha1                   | 9450342e37a232c76c1573c0f00b83f82f034289                                           |
| sha256                 | dbda182d31f85e507587ac6e37c56fe3380537d517573dd1f50050d1156b6f89                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FO2ixUb8lfeZQLQkf.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | Socket Communication::Get Socket Status [C0001.012]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::Set Socket Config [C0001.001]                           |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| receive data (3 matches)                             | communication                                        |
| send data (4 matches)                                | communication                                        |
| get socket information (2 matches)                   | communication/socket                                 |
| get socket status                                    | communication/socket                                 |
| initialize Winsock library                           | communication/socket                                 |
| set socket configuration (17 matches)                | communication/socket                                 |
| encode data using Base64 (3 matches)                 | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (50 matches)                   | data-manipulation/encoding/xor                       |
| encrypt or decrypt data via BCrypt (2 matches)       | data-manipulation/encryption                         |
| encrypt data using DPAPI                             | data-manipulation/encryption/dpapi                   |
| hash data via BCrypt                                 | data-manipulation/hashing                            |
| hash data using fnv (32 matches)                     | data-manipulation/hashing/fnv                        |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get local IPv4 addresses (3 matches)                 | host-interaction/network/address                     |
| resolve DNS (4 matches)                              | host-interaction/network/dns/resolve                 |
| enumerate PE sections                                | load-code/pe                                         |
| parse PE header (11 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 14.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 12:52:08                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FO2ixUb8lfeZQLQkf.exe
Real Name:	/MSAJApi.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
3	- Discovery::System Network Configuration Discovery [T1016;3]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
45	network_udp_sock
45	network_tcp_listen
50	network_tcp_socket
50	network_dns
10	Str_Win32_Winsock2_Library
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
60	skip20_sqllang_hook
20	isExecutable
10	Contains_PE_File
5	certificates
10	Big_Numbers1
5	BASE64_table

============================[ Scores ]============================
CAPA:	14.5
ClamAV:	0
Loki:	519
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
8514.908704543666
==================================================================


==================================================================
Fichier HTTP-FO2ixUb8lfeZQLQkf.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FxvvOQ1r7yJLccvGTl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be a .NET module.
WARNING:capa: 
WARNING:capa: .NET is a cross-platform framework for running managed applications.
WARNING:capa: capa cannot handle non-native files. This means that the results may be misleading or incomplete.
WARNING:capa: You may have to analyze the file manually, using a tool like the .NET decompiler dnSpy.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) dotnet file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FxvvOQ1r7yJLccvGTl.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 41.431 sec (0 m 41 s)
Start Date: 2022:02:11 13:02:30
End Date:   2022:02:11 13:03:11

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xed in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd9 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb9 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc4 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 10: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 11: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc4 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf1 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 2-3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x94 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xaa in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xae in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xaf in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb9 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xad in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xed in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc4 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc4 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 8: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xce in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb4 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbc in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb9 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc4 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc3 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xaa in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x95 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf2 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 15-16: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 34: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 38: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:02:30Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FxvvOQ1r7yJLccvGTl.exe SCORE: 289 TYPE: EXE SIZE: 50688 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa6dde01400> 
MD5: 9e600914f713d84ad23cc64d902a25ac 
SHA1: 262c2cfd9487e3762bbaa864d6a5f32681a70654 
SHA256: 2fb7d4574d11376d545b785b8751d79ef5405b79072a3e3d8106ff1a5349f777 CREATED: Fri Feb 11 13:02:30 2022 MODIFIED: Fri Feb 11 13:02:30 2022 ACCESSED: Fri Feb 11 13:03:19 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: dotnet_libraries SUBSCORE: 5 
DESCRIPTION: .Net runtime mscoree.dll mscorwks.dll REF: - AUTHOR: - 
MATCHES: Str1: mscoree.dll Str2: _CorDllMain
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Armadillo_v4x SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 0000001680100000042acccccccccccccccccccccccccc4c894424184c894c2420535556574883ec2833ed488d42ff483dfeffff7f488b Str2: 001680100000042a ... (truncated)
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsNET_DLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_15: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:03:19Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		dotnet_libraries
5		executable_pe
70		Armadillo_v4x
10		IsPE64
10		IsNET_DLL
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 289

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/65
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:02:30                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FxvvOQ1r7yJLccvGTl.exe
Real Name:	/NAPCRYPT.DLL
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	dotnet_libraries
5	executable_pe
70	Armadillo_v4x
10	IsPE64
10	IsNET_DLL
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	0
ClamAV:	0
Loki:	289
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4580.341326212618
==================================================================


==================================================================
Fichier HTTP-FxvvOQ1r7yJLccvGTl.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FUKhUo8j6ENHe39ai.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FUKhUo8j6ENHe39ai.exe: Win.Malware.Zusy-9938038-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FUKhUo8j6ENHe39ai.exe: Win.Trojan.Agent-1250609 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.47 MB
Data read: 0.45 MB (ratio 1.04:1)
Time: 38.427 sec (0 m 38 s)
Start Date: 2022:02:11 13:03:20
End Date:   2022:02:11 13:03:59

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Zusy-9938038-0
70		Win.Trojan.Agent-1250609
75		Win.Trojan.Agent-1250609
45		Win.Trojan.Agent-1250609

Score total: 240.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:03:21Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FUKhUo8j6ENHe39ai.exe SCORE: 1224 TYPE: EXE SIZE: 475138 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f5e48a87400> 
MD5: a70052c45e907820187c7e6bcdc7ecca 
SHA1: a8ae62aac336c119176f83e1b3d8c663e141709d 
SHA256: 8aec186d533ab9acf93965808e61ec9a8df4b7de250395f1c4bb9b7653ed6d1a CREATED: Fri Feb 11 13:03:21 2022 MODIFIED: Fri Feb 11 13:03:21 2022 ACCESSED: Fri Feb 11 13:04:14 2022 
REASON_1: Yara Rule MATCH: network_tcp_listen SUBSCORE: 45 
DESCRIPTION: Listen for incoming communication REF: - AUTHOR: x0r 
MATCHES: Str1: WSOCK32.DLL Str2: bind Str3: accept Str4: WSAStartup Str5: listen
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.DLL Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: HttpOpenRequest Str6: HttpSendRequest
REASON_3: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WSOCK32.DLL Str2: socket Str3: send Str4: connect Str5: WSAStartup Str6: closesocket Str7: WSACleanup
REASON_4: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WSOCK32.DLL Str2: gethostbyname
REASON_5: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_6: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_7: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.DLL Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_8: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: CreateFileA Str5: SetFileAttributesA
REASON_9: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WSOCK32.DLL
REASON_10: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.DLL
REASON_11: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_12: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_13: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: misc_no_dosmode_header SUBSCORE: 10 
DESCRIPTION: Detect on absence of 'DOS Mode' heaader between MZ and PE boundries REF: - AUTHOR: Jason Batchelor
REASON_15: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_17: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: winsocks SUBSCORE: 5 
DESCRIPTION: Imports Winsock Library REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: MingWin32_GCC_3x SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5589e583ec08c7042401000000ff15c8e44200e8c8feffff908db4260000000055 Str2: 5589e583ec08c7042402000000ff15c8e44200e8a8feffff908db4260000 ... (truncated)
REASON_20: Yara Rule MATCH: MingWin32_v_h_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5589e583ec08c7042401000000ff15c8e44200e8c8feffff908db4260000000055 Str2: 5589e583ec08c7042402000000ff15c8e44200e8a8feffff908db4260000 ... (truncated)
REASON_21: Yara Rule MATCH: MinGW_GCC_3x_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5589e583ec08c7042401000000ff15c8e44200e8c8feffff908db4260000000055 Str2: 5589e583ec08c7042402000000ff15c8e44200e8a8feffff908db4260000 ... (truncated)
REASON_22: Yara Rule MATCH: MinGW_GCC_3x SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5589e583ec08c7042401000000ff15c8e44200e8c8feffff908db4260000000055 Str2: 5589e583ec08c7042402000000ff15c8e44200e8a8feffff908db4260000 ... (truncated)
REASON_23: Yara Rule MATCH: MingWin32_GCC_3x_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5589e583ec08c7042401000000ff15c8e44200e8c8feffff908db4260000000055 Str2: 5589e583ec08c7042402000000ff15c8e44200e8a8feffff908db4260000 ... (truncated)
REASON_24: Yara Rule MATCH: MingWin32_v_h SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5589e583ec08c7042401000000ff15c8e44200e8c8feffff908db4260000000055 Str2: 5589e583ec08c7042402000000ff15c8e44200e8a8feffff908db4260000 ... (truncated)
REASON_25: Yara Rule MATCH: MingWin32_v SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5589e583ec08c7042401000000ff15c8e44200e8c8feffff908db4260000000055 Str2: 5589e583ec08c7042402000000ff15c8e44200e8a8feffff908db4260000 ... (truncated)
REASON_26: Yara Rule MATCH: MinGWGCC3x SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: 5589e583ec08c7042401000000ff15c8e44200e8c8feffff908db4260000000055 Str2: 5589e583ec08c7042402000000ff15c8e44200e8a8feffff908db4260000 ... (truncated)
REASON_27: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_28: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_29: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_30: Yara Rule MATCH: HasModified_DOS_Message SUBSCORE: 10 
DESCRIPTION: DOS Message Check REF: - AUTHOR: _pusher_
REASON_31: Yara Rule MATCH: MinGW_1 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: _pusher_ 
MATCHES: Str1: msvcrt.dll Str2: -LIBGCCW32-EH-2-SJLJ-GTHR-MINGW32
REASON_32: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_33: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_34: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: UnhookWindowsHookEx Str3: SetWindowsHookExA Str4: CallNextHookEx
REASON_35: Yara Rule MATCH: sitrof_fortis_scar SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: J from THL <j@techhelplist.com> 
MATCHES: Str1: ?get&version Str2: ?get&exe Str3: ?get&download Str4: ?get&module Str5: &ver= Str6: &comp= Str7: &addinfo=
REASON_36: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_37: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:04:16Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_tcp_listen
45		network_http
50		network_tcp_socket
50		network_dns
65		screenshot
80		keylogger
20		win_registry
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
10		misc_no_dosmode_header
2		math_entropy_6
5		executable_pe
15		dll_injection_hook
5		winsocks
70		MingWin32_GCC_3x
70		MingWin32_v_h_additional
70		MinGW_GCC_3x_additional
70		MinGW_GCC_3x
70		MingWin32_GCC_3x_additional
70		MingWin32_v_h
70		MingWin32_v
70		MinGWGCC3x
10		IsPE32
10		IsWindowsGUI
10		HasOverlay
10		HasModified_DOS_Message
10		MinGW_1
2		PE_File
35		Anti_Automated_Sandbox
35		Win_Hook_v12
60		sitrof_fortis_scar
20		isExecutable
10		Contains_PE_File

Score total: 1224

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a70052c45e907820187c7e6bcdc7ecca                                                   |
| sha1                   | a8ae62aac336c119176f83e1b3d8c663e141709d                                           |
| sha256                 | 8aec186d533ab9acf93965808e61ec9a8df4b7de250395f1c4bb9b7653ed6d1a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FUKhUo8j6ENHe39ai.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Audio Capture:: \[T1123]\                                                           |
|                        | Clipboard Data:: \[T1115]\                                                          |
|                        | Input Capture::Keylogging \[T1056.001]\                                             |
|                        | Screen Capture:: \[T1113]\                                                          |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                             |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                  |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005             |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | Software Discovery:: \[T1518]\                                                      |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Network Configuration Discovery:: \[T1016]\                                  |
|                        | System Network Configuration Discovery::Internet Connection Discovery \[T1016.001]\ |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COLLECTION                  | Keylogging::Application Hook [F0002.001]                                      |
|                             | Keylogging::Polling [F0002.002]                                               |
|                             | Screen Capture::WinAPI [E1113.m01]                                            |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | Socket Communication::Create UDP Socket [C0001.010]                           |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| receive and write data from server to client         | c2/file-transfer                                     |
| log keystrokes via application hook                  | collection/keylog                                    |
| log keystrokes via polling (2 matches)               | collection/keylog                                    |
| capture microphone audio                             | collection/microphone                                |
| capture screenshot                                   | collection/screenshot                                |
| send data (6 matches)                                | communication                                        |
| send HTTP request with Host header                   | communication/http                                   |
| create UDP socket                                    | communication/socket/udp/send                        |
| encode data using XOR (2 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| read clipboard data                                  | host-interaction/clipboard                           |
| query environment variable (12 matches)              | host-interaction/environment-variable                |
| create directory (3 matches)                         | host-interaction/file-system/create                  |
| delete file (10 matches)                             | host-interaction/file-system/delete                  |
| check if file exists (20 matches)                    | host-interaction/file-system/exists                  |
| set file attributes (14 matches)                     | host-interaction/file-system/meta                    |
| read file on Windows (3 matches)                     | host-interaction/file-system/read                    |
| write file on Windows (6 matches)                    | host-interaction/file-system/write                   |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| get disk information                                 | host-interaction/hardware/storage                    |
| check Internet connectivity via WinINet (3 matches)  | host-interaction/network/connectivity                |
| resolve DNS (2 matches)                              | host-interaction/network/dns/resolve                 |
| get hostname                                         | host-interaction/os/hostname                         |
| check OS version (2 matches)                         | host-interaction/os/version                          |
| allocate thread local storage (3 matches)            | host-interaction/process                             |
| get thread local storage value (10 matches)          | host-interaction/process                             |
| set thread local storage value (9 matches)           | host-interaction/process                             |
| create process on Windows (8 matches)                | host-interaction/process/create                      |
| create process suspended                             | host-interaction/process/create                      |
| enumerate processes                                  | host-interaction/process/list                        |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| create thread (7 matches)                            | host-interaction/thread/create                       |
| terminate thread                                     | host-interaction/thread/terminate                    |
| enumerate PE sections (20 matches)                   | load-code/pe                                         |
| parse PE exports (3 matches)                         | load-code/pe                                         |
| parse PE header (21 matches)                         | load-code/pe                                         |
| persist via Run registry key (2 matches)             | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4		- Execution::Command and Scripting Interpreter [T1059;4]
5		- Defense Evasion::File and Directory Permissions Modification [T1222;5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
6		- Collection::Screen Capture [T1113;6]
2		- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]
4		- Discovery::Software Discovery [T1518;4]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
5		- Collection::Audio Capture [T1123;5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Discovery::System Network Configuration Discovery [T1016;3]
6		- Collection::Clipboard Data [T1115;6]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
4		- Discovery::Process Discovery [T1057;4]

Score total: 90.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 54/66
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:03:20                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FUKhUo8j6ENHe39ai.exe
Real Name:	/a70052c45e907820187c7e6bcdc7ecca.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
4	- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4	- Execution::Command and Scripting Interpreter [T1059;4]
5	- Defense Evasion::File and Directory Permissions Modification [T1222;5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
6	- Collection::Screen Capture [T1113;6]
2	- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]
4	- Discovery::Software Discovery [T1518;4]
8.5	- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
2	- Discovery::File and Directory Discovery [T1083;2]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
5	- Collection::Audio Capture [T1123;5]
6	- Collection::Input Capture::Keylogging [T1056.001;6]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Discovery::System Network Configuration Discovery [T1016;3]
6	- Collection::Clipboard Data [T1115;6]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
4	- Discovery::Process Discovery [T1057;4]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
50	Win.Malware.Zusy-9938038-0
70	Win.Trojan.Agent-1250609
75	Win.Trojan.Agent-1250609
45	Win.Trojan.Agent-1250609

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
45	network_tcp_listen
45	network_http
50	network_tcp_socket
50	network_dns
65	screenshot
80	keylogger
20	win_registry
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	Str_Win32_Http_API
10	ft_exe
10	misc_no_dosmode_header
2	math_entropy_6
5	executable_pe
15	dll_injection_hook
5	winsocks
70	MingWin32_GCC_3x
70	MingWin32_v_h_additional
70	MinGW_GCC_3x_additional
70	MinGW_GCC_3x
70	MingWin32_GCC_3x_additional
70	MingWin32_v_h
70	MingWin32_v
70	MinGWGCC3x
10	IsPE32
10	IsWindowsGUI
10	HasOverlay
10	HasModified_DOS_Message
10	MinGW_1
2	PE_File
35	Anti_Automated_Sandbox
35	Win_Hook_v12
60	sitrof_fortis_scar
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	90.0
ClamAV:	240.0
Loki:	1224
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
26216.24974750202
==================================================================


==================================================================
Fichier HTTP-FUKhUo8j6ENHe39ai.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FmgEjt2X0kjL54Fmsj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FmgEjt2X0kjL54Fmsj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.16 MB
Data read: 0.16 MB (ratio 1.02:1)
Time: 31.407 sec (0 m 31 s)
Start Date: 2022:02:11 13:04:21
End Date:   2022:02:11 13:04:53

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:04:22Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FmgEjt2X0kjL54Fmsj.exe SCORE: 369 TYPE: EXE SIZE: 167936 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f63eb5ae400> 
MD5: db931bcbb03f78ecd39a793ba37201c4 
SHA1: 9f4cb9a7916366c71c07db6446c2fcbfdab4bf38 
SHA256: d19342e870809bcf20d3bac6bb7c92ca86253df615dbea835f2040e6e5a94391 CREATED: Fri Feb 11 13:04:21 2022 MODIFIED: Fri Feb 11 13:04:21 2022 ACCESSED: Fri Feb 11 13:05:15 2022 
REASON_1: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: MapVirtualKey
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: DuplicateTokenEx Str3: OpenProcessToken
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:05:16Z

-------- Score ----------------
Scores		Rules
.......		...............
80		keylogger
20		win_registry
65		win_token
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 369

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | db931bcbb03f78ecd39a793ba37201c4                                                   |
| sha1                   | 9f4cb9a7916366c71c07db6446c2fcbfdab4bf38                                           |
| sha256                 | d19342e870809bcf20d3bac6bb7c92ca86253df615dbea835f2040e6e5a94391                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FmgEjt2X0kjL54Fmsj.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| inspect load icon resource                           | anti-analysis                                        |
| execute anti-debugging instructions                  | anti-analysis/anti-debugging/debugger-detection      |
| log keystrokes                                       | collection/keylog                                    |
| check HTTP status code                               | communication/http/client                            |
| encode data using XOR (18 matches)                   | data-manipulation/encoding/xor                       |
| hash data using murmur3                              | data-manipulation/hashing/murmur                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)  | executable/resource                                  |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| find graphical window                                | host-interaction/gui/window/find                     |
| register raw input devices (2 matches)               | host-interaction/hardware                            |
| print debug messages (2 matches)                     | host-interaction/log/debug/write-event               |
| create process on Windows                            | host-interaction/process/create                      |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (6 matches)        | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| link many functions at runtime                       | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 33.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/64
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:04:21                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FmgEjt2X0kjL54Fmsj.exe
Real Name:	/Tabbtn.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
6	- Collection::Input Capture::Keylogging [T1056.001;6]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
80	keylogger
20	win_registry
65	win_token
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
30	Check_OutputDebugStringA_iat_v1
30	Check_OutputDebugStringA_iat
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	33.5
ClamAV:	0
Loki:	369
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
6516.668755696083
==================================================================


==================================================================
Fichier HTTP-FmgEjt2X0kjL54Fmsj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F6DfsfJflVgH9VAO7.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3fdfb2d522e7deecaaaf2f87420f7e75                                                   |
| sha1                   | a48505f1c45f50c4f028703bce826e38fc1f9b3c                                           |
| sha256                 | 70445e660358ef905cc01149dd3ffc604822a57a7dc32698f9f799d51ad57b62                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F6DfsfJflVgH9VAO7.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| decompress data using aPLib                          | data-manipulation/compression                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| access PEB ldr_data                                  | linking/runtime-linking                              |
| parse PE header (5 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F6DfsfJflVgH9VAO7.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 42.987 sec (0 m 42 s)
Start Date: 2022:02:11 13:05:19
End Date:   2022:02:11 13:06:02

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:05:19Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-F6DfsfJflVgH9VAO7.exe SCORE: 69 TYPE: EXE SIZE: 23040 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f8a7c939400> 
MD5: 3fdfb2d522e7deecaaaf2f87420f7e75 
SHA1: a48505f1c45f50c4f028703bce826e38fc1f9b3c 
SHA256: 70445e660358ef905cc01149dd3ffc604822a57a7dc32698f9f799d51ad57b62 CREATED: Fri Feb 11 13:05:19 2022 MODIFIED: Fri Feb 11 13:05:19 2022 ACCESSED: Fri Feb 11 13:06:12 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_8: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:06:12Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE32
10		IsWindowsGUI
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 69

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 51/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:05:19                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F6DfsfJflVgH9VAO7.exe
Real Name:	/3fdfb2d522e7deecaaaf2f87420f7e75.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE32
10	IsWindowsGUI
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	69
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
3153.4341722472345
==================================================================


==================================================================
Fichier HTTP-F6DfsfJflVgH9VAO7.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FoapW81P6SmaxTDyHb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6bad650a415802b2213368d9e32e46c5                                                   |
| sha1                   | 19085001edec67a61bda3d151ee4e09a3afcc825                                           |
| sha256                 | ff851f2724c4c35995c945f67e8c156ca34dc98f6f7381febb1c09aa0c624e46                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FoapW81P6SmaxTDyHb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FoapW81P6SmaxTDyHb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 42.816 sec (0 m 42 s)
Start Date: 2022:02:11 13:06:13
End Date:   2022:02:11 13:06:56

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:06:14Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FoapW81P6SmaxTDyHb.exe SCORE: 264 TYPE: EXE SIZE: 63488 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe732b61400> 
MD5: 6bad650a415802b2213368d9e32e46c5 
SHA1: 19085001edec67a61bda3d151ee4e09a3afcc825 
SHA256: ff851f2724c4c35995c945f67e8c156ca34dc98f6f7381febb1c09aa0c624e46 CREATED: Fri Feb 11 13:06:13 2022 MODIFIED: Fri Feb 11 13:06:13 2022 ACCESSED: Fri Feb 11 13:06:58 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:06:58Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 264

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:06:13                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FoapW81P6SmaxTDyHb.exe
Real Name:	/RemoteWipeCSP.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	264
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4243.975897546406
==================================================================


==================================================================
Fichier HTTP-FoapW81P6SmaxTDyHb.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F7ZPsM1mAC8Q8t2bB2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F7ZPsM1mAC8Q8t2bB2.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 3.16 MB
Data read: 2.97 MB (ratio 1.06:1)
Time: 34.010 sec (0 m 34 s)
Start Date: 2022:02:11 13:06:59
End Date:   2022:02:11 13:07:33

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa6 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xac in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x91 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcf in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa5 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xae in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdc in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:07:00Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F7ZPsM1mAC8Q8t2bB2.exe SCORE: 1185 TYPE: EXE SIZE: 3120640 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f444b36f400> 
MD5: 6cc148363200798a12091b97a17181a1 
SHA1: be0ad25b7b48347984908175404996531cfd74b7 
SHA256: dbaf4a8c8431fd80cc5160dfdaca7adb301adc26ab7e3a48be9543edf539ea8d CREATED: Fri Feb 11 13:06:59 2022 MODIFIED: Fri Feb 11 13:06:59 2022 ACCESSED: Fri Feb 11 13:07:41 2022 
REASON_1: Yara Rule MATCH: network_tcp_listen SUBSCORE: 45 
DESCRIPTION: Listen for incoming communication REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: bind Str3: accept Str4: WSAStartup Str5: WSASocket Str6: listen
REASON_2: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: WSASocket Str3: socket Str4: send Str5: WSASend Str6: connect Str7: WSAStartup
REASON_3: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: getaddrinfo Str3: gethostbyname
REASON_4: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose
REASON_6: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: ConventionEngine_Keyword_Reverse SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_9: Yara Rule MATCH: ConventionEngine_Keyword_Shell SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_10: Yara Rule MATCH: ConventionEngine_Keyword_Proxy SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_11: Yara Rule MATCH: ConventionEngine_Keyword_Client SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_12: Yara Rule MATCH: ConventionEngine_Term_Desktop SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_13: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_14: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_16: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_17: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_20: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_21: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER
REASON_23: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER
REASON_24: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER
REASON_25: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_26: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_27: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_28: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_29: Yara Rule MATCH: browser_pass SUBSCORE: 10 
DESCRIPTION: This module is intended for forensicators and pen-testers to find passwords in memory that can help their case/engagement. REF: https://github.com/swoodsec/YARA-RULES/blob/master/browserpass.yar AUTHOR: swood 
MATCHES: Str1: password=
REASON_30: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_31: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_32: Yara Rule MATCH: db_connection SUBSCORE: 1 
DESCRIPTION: not set REF: https://github.com/kevthehermit/PasteHunter AUTHOR: @KevTheHermit 
MATCHES: Str1: http://,/runCommand?h=wss://^@^%*&!wait
REASON_33: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 44f95cb9056da018991f9cc488ff7f38 Str2: e7b51236358cf576f2311ad760d4f7a8 Str3: d3284d61fdd76368e9f0ca0747334655 Str4: 0493be962c3f6830 ... (truncated)
REASON_34: Yara Rule MATCH: Big_Numbers2 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 48:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 666666666666666666666666666666666666666666666666
REASON_35: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_36: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
REASON_37: Yara Rule MATCH: BLOWFISH_Constants SUBSCORE: 25 
DESCRIPTION: Look for Blowfish constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: a60b31d1 Str2: acb5df98 Str3: db72fd2f Str4: b7df1ad0 Str5: e9707a4b Str6: 1c264cf6
REASON_38: Yara Rule MATCH: MD5_Constants SUBSCORE: 20 
DESCRIPTION: Look for MD5 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: 78a46ad7
REASON_39: Yara Rule MATCH: RIPEMD160_Constants SUBSCORE: 15 
DESCRIPTION: Look for RIPEMD-160 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3
REASON_40: Yara Rule MATCH: SHA1_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA1 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3 Str6: d6c162ca
REASON_41: Yara Rule MATCH: SHA512_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA384/SHA512 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: 982f8a42 Str2: 91443771 Str3: cffbc0b5 Str4: a5dbb5e9 Str5: 22ae28d7
REASON_42: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
REASON_43: Yara Rule MATCH: WHIRLPOOL_Constants SUBSCORE: 15 
DESCRIPTION: Look for WhirlPool constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: 18186018c07830d8 Str2: 23238c2305af4626
REASON_44: Yara Rule MATCH: DES_Long SUBSCORE: 15 
DESCRIPTION: DES [long] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 10801040000000000080100000001040100000401080000000800040008010000080000010001040100000000080004010001000008010400000104010000000
REASON_45: Yara Rule MATCH: RijnDael_AES_CHAR SUBSCORE: 15 
DESCRIPTION: RijnDael AES (check2) [char] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0
REASON_46: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
REASON_47: Yara Rule MATCH: ecc_order SUBSCORE: 15 
DESCRIPTION: Look for known Elliptic curve orders REF: - AUTHOR: spelissier 
MATCHES: Str1: fffffffffffffffffffffffe26f2fc170f69466a74defd8d Str2: ffffffffffffffffffffffff99def836146bc9b1b4d22831 Str3: 01000000000000000000000 ... (truncated)
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:07:45Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_tcp_listen
50		network_tcp_socket
50		network_dns
60		win_mutex
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		ft_exe
50		ConventionEngine_Keyword_Reverse
50		ConventionEngine_Keyword_Shell
50		ConventionEngine_Keyword_Proxy
50		ConventionEngine_Keyword_Client
50		ConventionEngine_Term_Desktop
50		ConventionEngine_Term_Users
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		DebuggerException__SetConsoleCtrl_v1
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
10		browser_pass
20		isExecutable
10		Contains_PE_File
1		db_connection
10		Big_Numbers1
10		Big_Numbers2
25		CRC32_poly_Constant
25		CRC32_table
25		BLOWFISH_Constants
20		MD5_Constants
15		RIPEMD160_Constants
20		SHA1_Constants
20		SHA512_Constants
20		SHA2_BLAKE2_IVs
15		WHIRLPOOL_Constants
15		DES_Long
15		RijnDael_AES_CHAR
5		BASE64_table
15		ecc_order

Score total: 1185

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6cc148363200798a12091b97a17181a1                                                   |
| sha1                   | be0ad25b7b48347984908175404996531cfd74b7                                           |
| sha256                 | dbaf4a8c8431fd80cc5160dfdaca7adb301adc26ab7e3a48be9543edf539ea8d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F7ZPsM1mAC8Q8t2bB2.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Execution Guardrails::Runs as Service [E1480.m07]                             |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | Socket Communication::Get Socket Status [C0001.012]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::Set Socket Config [C0001.001]                           |
| CRYPTOGRAPHY                | Crypto Library:: [C0059]                                                      |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
|                             | Cryptographic Hash::SHA224 [C0029.004]                                        |
|                             | Cryptographic Hash::SHA256 [C0029.003]                                        |
|                             | Decrypt Data::AES [C0031.001]                                                 |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encrypt Data::Blowfish [C0027.002]                                            |
|                             | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Checksum::Adler [C0032.005]                                                   |
|                             | Compression Library:: [C0060]                                                 |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| DISCOVERY                   | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+--------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                             | NAMESPACE                                            |
|--------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints                         | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via GetTickCount (2 matches)      | anti-analysis/anti-debugging/debugger-detection      |
| receive data (4 matches)                               | communication                                        |
| send data (4 matches)                                  | communication                                        |
| check HTTP status code (3 matches)                     | communication/http/client                            |
| get socket information (3 matches)                     | communication/socket                                 |
| get socket status (3 matches)                          | communication/socket                                 |
| initialize Winsock library (3 matches)                 | communication/socket                                 |
| set socket configuration (8 matches)                   | communication/socket                                 |
| compute adler32 checksum                               | data-manipulation/checksum/adler32                   |
| encode data using Base64 (3 matches)                   | data-manipulation/encoding/base64                    |
| reference Base64 string                                | data-manipulation/encoding/base64                    |
| encode data using XOR (130 matches)                    | data-manipulation/encoding/xor                       |
| decrypt data using AES via x86 extensions (10 matches) | data-manipulation/encryption/aes                     |
| encrypt data using AES via x86 extensions (18 matches) | data-manipulation/encryption/aes                     |
| reference AES constants (4 matches)                    | data-manipulation/encryption/aes                     |
| encrypt data using blowfish                            | data-manipulation/encryption/blowfish                |
| encrypt data using DPAPI (2 matches)                   | data-manipulation/encryption/dpapi                   |
| encrypt data using RC4 PRGA (5 matches)                | data-manipulation/encryption/rc4                     |
| hash data with MD5 (3 matches)                         | data-manipulation/hashing/md5                        |
| hash data using murmur3 (2 matches)                    | data-manipulation/hashing/murmur                     |
| hash data using SHA1 (3 matches)                       | data-manipulation/hashing/sha1                       |
| hash data using SHA224 (2 matches)                     | data-manipulation/hashing/sha224                     |
| hash data using SHA256 (2 matches)                     | data-manipulation/hashing/sha256                     |
| authenticate HMAC (2 matches)                          | data-manipulation/hmac                               |
| contains PDB path                                      | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                     | executable/pe/section/rsrc                           |
| accept command line arguments                          | host-interaction/cli                                 |
| check if file exists                                   | host-interaction/file-system/exists                  |
| read file on Windows                                   | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                      | host-interaction/file-system/write                   |
| get memory capacity                                    | host-interaction/hardware/memory                     |
| print debug messages (5 matches)                       | host-interaction/log/debug/write-event               |
| access the Windows event log                           | host-interaction/log/winevt/access                   |
| check mutex and exit                                   | host-interaction/mutex                               |
| get local IPv4 addresses (3 matches)                   | host-interaction/network/address                     |
| resolve DNS                                            | host-interaction/network/dns/resolve                 |
| allocate thread local storage (2 matches)              | host-interaction/process                             |
| get thread local storage value (29 matches)            | host-interaction/process                             |
| set thread local storage value (23 matches)            | host-interaction/process                             |
| terminate process                                      | host-interaction/process/terminate                   |
| run as service                                         | host-interaction/service                             |
| create thread (3 matches)                              | host-interaction/thread/create                       |
| terminate thread                                       | host-interaction/thread/terminate                    |
| link many functions at runtime                         | linking/runtime-linking                              |
| linked against OpenSSL                                 | linking/static/openssl                               |
| linked against ZLIB                                    | linking/static/zlib                                  |
| enumerate PE sections (20 matches)                     | load-code/pe                                         |
| parse PE exports (5 matches)                           | load-code/pe                                         |
| parse PE header (85 matches)                           | load-code/pe                                         |
+--------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Discovery::System Information Discovery [T1082;1]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 47.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 5/65
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:06:59                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F7ZPsM1mAC8Q8t2bB2.exe
Real Name:	/6cc148363200798a12091b97a17181a1.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
8.5	- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
4	- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3	- Discovery::System Network Configuration Discovery [T1016;3]
1	- Discovery::System Information Discovery [T1082;1]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
45	network_tcp_listen
50	network_tcp_socket
50	network_dns
60	win_mutex
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	ft_exe
50	ConventionEngine_Keyword_Reverse
50	ConventionEngine_Keyword_Shell
50	ConventionEngine_Keyword_Proxy
50	ConventionEngine_Keyword_Client
50	ConventionEngine_Term_Desktop
50	ConventionEngine_Term_Users
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
60	DebuggerException__SetConsoleCtrl_v1
30	Check_OutputDebugStringA_iat_v1
30	Check_OutputDebugStringA_iat
10	anti_dbg
10	browser_pass
20	isExecutable
10	Contains_PE_File
1	db_connection
10	Big_Numbers1
10	Big_Numbers2
25	CRC32_poly_Constant
25	CRC32_table
25	BLOWFISH_Constants
20	MD5_Constants
15	RIPEMD160_Constants
20	SHA1_Constants
20	SHA512_Constants
20	SHA2_BLAKE2_IVs
15	WHIRLPOOL_Constants
15	DES_Long
15	RijnDael_AES_CHAR
5	BASE64_table
15	ecc_order

============================[ Scores ]============================
CAPA:	47.0
ClamAV:	0
Loki:	1185
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
21718.757618699565
==================================================================


==================================================================
Fichier HTTP-F7ZPsM1mAC8Q8t2bB2.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FVlg3u2uuCJjIROr21.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a9c55bb87a7c5c3c923c4fa12940e719                                                   |
| sha1                   | d971656c6c605a6e2130ab83a38420e655428f94                                           |
| sha256                 | 57d8d248a8741176348b5d12dcf29f34c8f48ede0ca13c30d12e5ba0384056d7                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FVlg3u2uuCJjIROr21.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| PERSISTENCE            | Event Triggered Execution:: \[T1546]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Set Registry Key [C0036.001]                                        |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| persist via GinaDLL registry key                     | persistence/registry/ginadll                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
4		- Persistence::Event Triggered Execution [T1546;4]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 7.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FVlg3u2uuCJjIROr21.exe: Win.Trojan.Agent-595082 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.08:1)
Time: 42.768 sec (0 m 42 s)
Start Date: 2022:02:11 13:15:58
End Date:   2022:02:11 13:16:41

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 48/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:15:58                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FVlg3u2uuCJjIROr21.exe
Real Name:	/Practical Malware Analysis Lab 11-01.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
4	- Persistence::Event Triggered Execution [T1546;4]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	win_files_operation
10	ft_exe
2	math_entropy_4
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Armadillo_v4x
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsConsole
10	HasRichSignature
35	Embedded_PE
2	PE_File
40	SEH_Save
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	7.5
ClamAV:	0
Loki:	644
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
12356.356833072236
==================================================================


==================================================================
Fichier HTTP-FVlg3u2uuCJjIROr21.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FCrMg720YdIYdjJsSc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FCrMg720YdIYdjJsSc.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.24 MB
Data read: 0.23 MB (ratio 1.03:1)
Time: 36.463 sec (0 m 36 s)
Start Date: 2022:02:11 13:16:53
End Date:   2022:02:11 13:17:30

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 1e609dffd12a59ea5d5c9b3055939b1f                                                   |
| sha1                   | 0a6cd87f09ae5961fce6ca9c1c2aeda8a99447fb                                           |
| sha256                 | 57771f6312b091fb5450112864e56413ae2a2a2874289e8245eb3a0d286577e9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FCrMg720YdIYdjJsSc.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| CREDENTIAL ACCESS      | Credentials from Password Stores::Password Managers \[T1555.005]\                  |
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Software Discovery:: \[T1518]\                                                     |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| steal KeePass passwords using KeeFarce               | collection/password-manager                          |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| set environment variable                             | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| write file on Windows                                | host-interaction/file-system/write                   |
| inject thread (2 matches)                            | host-interaction/process/inject                      |
| enumerate processes                                  | host-interaction/process/list                        |
| enumerate process modules                            | host-interaction/process/modules/list                |
| terminate process via fastfail                       | host-interaction/process/terminate                   |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (9 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
2		- Execution::Shared Modules [T1129;2]
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
8		- Credential Access::Credentials from Password Stores::Password Managers [T1555.005;8]
4		- Discovery::Software Discovery [T1518;4]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]

Score total: 32.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 12: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 12: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 12: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:16:53Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FCrMg720YdIYdjJsSc.exe SCORE: 589 TYPE: EXE SIZE: 244224 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd39e84c400> 
MD5: 1e609dffd12a59ea5d5c9b3055939b1f 
SHA1: 0a6cd87f09ae5961fce6ca9c1c2aeda8a99447fb 
SHA256: 57771f6312b091fb5450112864e56413ae2a2a2874289e8245eb3a0d286577e9 CREATED: Fri Feb 11 13:16:53 2022 MODIFIED: Fri Feb 11 13:16:53 2022 ACCESSED: Fri Feb 11 13:17:45 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: win_rdat_auto SUBSCORE: 45 
DESCRIPTION: Detects win.rdat. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 48984885c0751e483bfb Str2: 4885c0751e483bfb731383c8ff Str3: 48ffc34038341a75f74883791810488b7910 Str4: 669048ffc34038341a75f748837918 ... (truncated)
REASON_5: Yara Rule MATCH: ConventionEngine_Term_Documents SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344532d3ad0ab66582a428f2eb2a659aaccc303000000433a5c55736572735c4361726c6f732044616e6765725c446f63756d656e74735c56697375616c2053747 ... (truncated)
REASON_6: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344532d3ad0ab66582a428f2eb2a659aaccc303000000433a5c55736572735c4361726c6f732044616e6765725c446f63756d656e74735c56697375616c2053747 ... (truncated)
REASON_7: Yara Rule MATCH: ConventionEngine_Term_VisualStudio SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344532d3ad0ab66582a428f2eb2a659aaccc303000000433a5c55736572735c4361726c6f732044616e6765725c446f63756d656e74735c56697375616c2053747 ... (truncated)
REASON_8: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_10: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_12: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_18: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_19: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_20: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_21: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_22: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_23: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:17:46Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
10		win_files_operation
10		ft_exe
45		win_rdat_auto
50		ConventionEngine_Term_Documents
50		ConventionEngine_Term_Users
50		ConventionEngine_Term_VisualStudio
2		math_entropy_6
5		executable_pe
15		dll_injection_thread
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
45		Inject_Thread
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 589

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 41/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:16:53                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FCrMg720YdIYdjJsSc.exe
Real Name:	/1e609dffd12a59ea5d5c9b3055939b1f.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5	- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
2	- Execution::Shared Modules [T1129;2]
6	- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
8	- Credential Access::Credentials from Password Stores::Password Managers [T1555.005;8]
4	- Discovery::Software Discovery [T1518;4]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4	- Discovery::Process Discovery [T1057;4]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	inject_thread
10	win_files_operation
10	ft_exe
45	win_rdat_auto
50	ConventionEngine_Term_Documents
50	ConventionEngine_Term_Users
50	ConventionEngine_Term_VisualStudio
2	math_entropy_6
5	executable_pe
15	dll_injection_thread
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
45	Inject_Thread
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	32.0
ClamAV:	0
Loki:	589
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
11973.504844386
==================================================================


==================================================================
Fichier HTTP-FCrMg720YdIYdjJsSc.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fe66X10y2Shke22hj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | bf3700789059bda100668d870aa7da4f                                                   |
| sha1                   | be3b9f386af5437f5a8948d6d11e9c21eb71b6b5                                           |
| sha256                 | 9f3db7047a20988b5790f6aafe0f06c3201ce8c7419915ff5c1c6647c27b64ad                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fe66X10y2Shke22hj.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| link function at runtime on Windows (3 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fe66X10y2Shke22hj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 42.334 sec (0 m 42 s)
Start Date: 2022:02:11 13:17:47
End Date:   2022:02:11 13:18:29

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:17:47Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fe66X10y2Shke22hj.exe SCORE: 159 TYPE: EXE SIZE: 21504 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f1f701ea400> 
MD5: bf3700789059bda100668d870aa7da4f 
SHA1: be3b9f386af5437f5a8948d6d11e9c21eb71b6b5 
SHA256: 9f3db7047a20988b5790f6aafe0f06c3201ce8c7419915ff5c1c6647c27b64ad CREATED: Fri Feb 11 13:17:47 2022 MODIFIED: Fri Feb 11 13:17:47 2022 ACCESSED: Fri Feb 11 13:18:38 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:18:38Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 159

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:17:47                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fe66X10y2Shke22hj.exe
Real Name:	/fixmapi.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	159
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
2579.8380454622366
==================================================================


==================================================================
Fichier HTTP-Fe66X10y2Shke22hj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FNR3lj8vnJUvRdJzb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b40fcca78adbc528f5ac0dac3df3a959                                                   |
| sha1                   | 1859e6b054d245f863973d0844a23348a2593a31                                           |
| sha256                 | 1953c9e88e24fd6594170a1f62da21b27847595e067ef9dba7e07543d0e3a510                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FNR3lj8vnJUvRdJzb.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FNR3lj8vnJUvRdJzb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.10 MB
Data read: 0.10 MB (ratio 1.00:1)
Time: 42.126 sec (0 m 42 s)
Start Date: 2022:02:11 13:18:39
End Date:   2022:02:11 13:19:21

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:18:39Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FNR3lj8vnJUvRdJzb.exe SCORE: 289 TYPE: EXE SIZE: 108544 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fc520d1f400> 
MD5: b40fcca78adbc528f5ac0dac3df3a959 
SHA1: 1859e6b054d245f863973d0844a23348a2593a31 
SHA256: 1953c9e88e24fd6594170a1f62da21b27847595e067ef9dba7e07543d0e3a510 CREATED: Fri Feb 11 13:18:39 2022 MODIFIED: Fri Feb 11 13:18:39 2022 ACCESSED: Fri Feb 11 13:19:30 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8ff0400004883c428e96efeffffcccccccccccccccccccccccccccc
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:19:30Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 289

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/69
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:18:39                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FNR3lj8vnJUvRdJzb.exe
Real Name:	/PinEnrollmentBroker.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	289
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4640.199195661684
==================================================================


==================================================================
Fichier HTTP-FNR3lj8vnJUvRdJzb.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FyTlR14tOejAcdi0ql.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 07f7846bbcda782e5639292ad93907eb                                                   |
| sha1                   | 19929c80e9191bf101da7f8f164984f49c6df8d4                                           |
| sha256                 | a52c3792d8cef6019ce67203220dc191e207c6ddbdfa51ac385d9493ffe2a83a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FyTlR14tOejAcdi0ql.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Automated Collection:: \[T1119]\                                                    |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005             |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
|                        | System Information Discovery:: \[T1082]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key::RC4 KSA [C0028.002]                                           |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| contain obfuscated stackstrings                       | anti-analysis/obfuscation/string/stackstring         |
| parse credit card information                         | collection/credit-card                               |
| check HTTP status code                                | communication/http/client                            |
| encode data using Base64 (2 matches)                  | data-manipulation/encoding/base64                    |
| reference Base64 string                               | data-manipulation/encoding/base64                    |
| encrypt data using RC4 KSA                            | data-manipulation/encryption/rc4                     |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| get common file path (2 matches)                      | host-interaction/file-system                         |
| read file on Windows                                  | host-interaction/file-system/read                    |
| write file on Windows                                 | host-interaction/file-system/write                   |
| get disk information                                  | host-interaction/hardware/storage                    |
| get hostname                                          | host-interaction/os/hostname                         |
| create a process with modified I/O handles and window | host-interaction/process/create                      |
| create process on Windows                             | host-interaction/process/create                      |
| parse PE exports                                      | load-code/pe                                         |
| parse PE header                                       | load-code/pe                                         |
| write file to startup folder                          | persistence/startup-folder                           |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
2		- Execution::Shared Modules [T1129;2]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
6		- Collection::Automated Collection [T1119;6]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 33.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FyTlR14tOejAcdi0ql.exe: Win.Trojan.Datper-6736003-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 42.889 sec (0 m 42 s)
Start Date: 2022:02:11 13:19:31
End Date:   2022:02:11 13:20:14

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Datper-6736003-0

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:19:32Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FyTlR14tOejAcdi0ql.exe SCORE: 475 TYPE: EXE SIZE: 24576 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7feab38d2400> 
MD5: 07f7846bbcda782e5639292ad93907eb 
SHA1: 19929c80e9191bf101da7f8f164984f49c6df8d4 
SHA256: a52c3792d8cef6019ce67203220dc191e207c6ddbdfa51ac385d9493ffe2a83a CREATED: Fri Feb 11 13:19:31 2022 MODIFIED: Fri Feb 11 13:19:31 2022 ACCESSED: Fri Feb 11 13:20:25 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_2 SUBSCORE: 2 
DESCRIPTION: Very low entropy - repeating sequence of couple of bytes REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff685031400068a421400064a100000000506489250000000083ec20535657
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff685031400068a421400064a10000000050
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff685031400068a421400064a10000000050
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6a Str2: 558bec6aff685031400068a421400064a10000000050
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff685031400068a421400064a1000000005064892500000000
REASON_9: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: db_connection SUBSCORE: 1 
DESCRIPTION: not set REF: https://github.com/kevthehermit/PasteHunter AUTHOR: @KevTheHermit 
MATCHES: Str1: http://www.oonumaboat.com/cx/index.php?id=%08xc:\H1@.PAVCException@@rwb+.exePerfTVqQAA200Mozilla/5.0
REASON_17: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:20:25Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_2
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
40		SEH_Init
20		isExecutable
10		Contains_PE_File
1		db_connection
5		BASE64_table

Score total: 475

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 55/67
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:19:31                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FyTlR14tOejAcdi0ql.exe
Real Name:	/07f7846bbcda782e5639292ad93907eb.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
2	- Execution::Shared Modules [T1129;2]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
6	- Collection::Automated Collection [T1119;6]
1	- Discovery::System Information Discovery [T1082;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
45	Win.Trojan.Datper-6736003-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_2
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
40	SEH_Init
20	isExecutable
10	Contains_PE_File
1	db_connection
5	BASE64_table

============================[ Scores ]============================
CAPA:	33.5
ClamAV:	45.0
Loki:	475
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
10763.171975012237
==================================================================


==================================================================
Fichier HTTP-FyTlR14tOejAcdi0ql.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F3wcEl4beqisUOTD7c.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F3wcEl4beqisUOTD7c.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.28 MB
Data read: 0.27 MB (ratio 1.06:1)
Time: 42.801 sec (0 m 42 s)
Start Date: 2022:02:11 13:20:26
End Date:   2022:02:11 13:21:09

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 605a2773eb23be4393f1a6938dfb34af                                                   |
| sha1                   | dd7b39389aec906d3355ccc2becb57f0fc876587                                           |
| sha256                 | f9057ba9c9f2e6cc22c0c25d3d834f8cd80ac9a749e0609c2b91f79d62d0ad51                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F3wcEl4beqisUOTD7c.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
|                             | HTTP Communication::Send Data [C0002.005]                                     |
| CRYPTOGRAPHY                | Encrypt Data:: [C0027]                                                        |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| OPERATING SYSTEM            | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location                            | collection                                           |
| log keystrokes via polling (3 matches)               | collection/keylog                                    |
| receive data                                         | communication                                        |
| send data                                            | communication                                        |
| parse URL                                            | communication/http                                   |
| connect to URL                                       | communication/http/client                            |
| create HTTP request                                  | communication/http/client                            |
| encrypt data using DPAPI (2 matches)                 | data-manipulation/encryption/dpapi                   |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| get file system object information (2 matches)       | host-interaction/file-system                         |
| check if file exists (2 matches)                     | host-interaction/file-system/exists                  |
| get graphical window text (3 matches)                | host-interaction/gui/window/get-text                 |
| create process on Windows                            | host-interaction/process/create                      |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (6 matches)        | host-interaction/registry                            |
| parse PE header (7 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::Query Registry [T1012;1]
1.5		- Discovery::System Location Discovery [T1614;1.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 32.5

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:20:27Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F3wcEl4beqisUOTD7c.exe SCORE: 449 TYPE: EXE SIZE: 280064 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7ff92bb16400> 
MD5: 605a2773eb23be4393f1a6938dfb34af 
SHA1: dd7b39389aec906d3355ccc2becb57f0fc876587 
SHA256: f9057ba9c9f2e6cc22c0c25d3d834f8cd80ac9a749e0609c2b91f79d62d0ad51 CREATED: Fri Feb 11 13:20:27 2022 MODIFIED: Fri Feb 11 13:20:27 2022 ACCESSED: Fri Feb 11 13:21:18 2022 
REASON_1: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetOpenUrl Str5: InternetReadFile Str6: InternetWriteFile
REASON_2: Yara Rule MATCH: network_ftp SUBSCORE: 60 
DESCRIPTION: Communications over FTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: FtpGetCurrentDirectory Str3: FtpGetFile Str4: FtpPutFile Str5: FtpSetCurrentDirectory Str6: FtpOpenFile Str7: FtpDe ... (truncated)
REASON_3: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetAsyncKeyState Str3: GetKeyState
REASON_4: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_5: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_6: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: DeleteFileA Str5: FindFirstFileA Str6: FindClose
REASON_7: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_8: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_9: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_12: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_16: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_17: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_19: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 33333333333333333333
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:21:19Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_http
60		network_ftp
80		keylogger
60		win_mutex
20		win_registry
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
10		anti_dbg
20		isExecutable
10		Contains_PE_File
10		Big_Numbers0

Score total: 449

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/60
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:20:26                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F3wcEl4beqisUOTD7c.exe
Real Name:	/msieftp.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1	- Discovery::Query Registry [T1012;1]
1.5	- Discovery::System Location Discovery [T1614;1.5]
6	- Collection::Input Capture::Keylogging [T1056.001;6]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
45	network_http
60	network_ftp
80	keylogger
60	win_mutex
20	win_registry
10	win_files_operation
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
10	anti_dbg
20	isExecutable
10	Contains_PE_File
10	Big_Numbers0

============================[ Scores ]============================
CAPA:	32.5
ClamAV:	0
Loki:	449
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
7764.630686515284
==================================================================


==================================================================
Fichier HTTP-F3wcEl4beqisUOTD7c.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fi3eIw85QpzkkZRf8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a5d66324daaee5672b913aa461d4bd3a                                                   |
| sha1                   | 856263bb665825de8c47ca649f33868df9eb79df                                           |
| sha256                 | 0e9d5b57db6d9d75bfa5837b62bd8402688433a998bf3d6ee9430898a7686025                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fi3eIw85QpzkkZRf8.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Process Doppelgänging \[T1055.013]\                             |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get file size                                        | host-interaction/file-system/meta                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| use process Doppelgänging                            | host-interaction/process/inject                      |
| terminate process                                    | host-interaction/process/terminate                   |
| link many functions at runtime                       | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::File and Directory Discovery [T1083;2]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Defense Evasion::Process Injection::Process Doppelgänging [T1055.013;4]

Score total: 9.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fi3eIw85QpzkkZRf8.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.18 MB
Data read: 0.17 MB (ratio 1.05:1)
Time: 39.785 sec (0 m 39 s)
Start Date: 2022:02:11 13:21:21
End Date:   2022:02:11 13:22:00

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:21:21Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fi3eIw85QpzkkZRf8.exe SCORE: 369 TYPE: EXE SIZE: 180736 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f0de819c400> 
MD5: a5d66324daaee5672b913aa461d4bd3a 
SHA1: 856263bb665825de8c47ca649f33868df9eb79df 
SHA256: 0e9d5b57db6d9d75bfa5837b62bd8402688433a998bf3d6ee9430898a7686025 CREATED: Fri Feb 11 13:21:21 2022 MODIFIED: Fri Feb 11 13:21:21 2022 ACCESSED: Fri Feb 11 13:22:14 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: Process_Doppelganging SUBSCORE: 35 
DESCRIPTION: Detect Process Doppelganging REF: https://www.blackhat.com/docs/eu-17/materials/eu-17-Liberman-Lost-In-Transaction-Process-Doppelganging.pdf AUTHOR: McAfee ATR - Thomas Roccia - @fr0gger_ 
MATCHES: Str1: CreateTransaction Str2: CreateFileTransacted Str3: WriteFile Str4: RollbackTransaction Str5: CreateProcess Str6: CreateProcessParamet ... (truncated)
REASON_14: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_15: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:22:15Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Process_Doppelganging
60		Debugger_Check__QueryInfo
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 369

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 4/67
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:21:21                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fi3eIw85QpzkkZRf8.exe
Real Name:	/a5d66324daaee5672b913aa461d4bd3a.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Discovery::File and Directory Discovery [T1083;2]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4	- Defense Evasion::Process Injection::Process Doppelgänging [T1055.013;4]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	ft_exe
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Process_Doppelganging
60	Debugger_Check__QueryInfo
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	9.0
ClamAV:	0
Loki:	369
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
8027.829488528708
==================================================================


==================================================================
Fichier HTTP-Fi3eIw85QpzkkZRf8.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FzyaDB4xZ08QJYf3E5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ba0422ccb92c557e2d54a826242cdd08                                                   |
| sha1                   | b77b2f349b076821b4f0daf5374fe5b2b8e40a91                                           |
| sha256                 | b31a65a8740c6ac91ccf81bc7e0e0f04e205ad453cfc35ceac60d1e6b51f9549                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FzyaDB4xZ08QJYf3E5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FzyaDB4xZ08QJYf3E5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.13 MB
Data read: 0.12 MB (ratio 1.06:1)
Time: 42.908 sec (0 m 42 s)
Start Date: 2022:02:11 13:22:16
End Date:   2022:02:11 13:22:59

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:22:16Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FzyaDB4xZ08QJYf3E5.exe SCORE: 404 TYPE: EXE SIZE: 132096 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f71c6d8a400> 
MD5: ba0422ccb92c557e2d54a826242cdd08 
SHA1: b77b2f349b076821b4f0daf5374fe5b2b8e40a91 
SHA256: b31a65a8740c6ac91ccf81bc7e0e0f04e205ad453cfc35ceac60d1e6b51f9549 CREATED: Fri Feb 11 13:22:16 2022 MODIFIED: Fri Feb 11 13:22:16 2022 ACCESSED: Fri Feb 11 13:23:08 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetConnect
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e8470500004883c428e95efeffffcccccccccccccccccccccccccccc
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_15: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:23:09Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		Str_Win32_Internet_API
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 404

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:22:16                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FzyaDB4xZ08QJYf3E5.exe
Real Name:	/UtcDecoderHost.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	Str_Win32_Internet_API
10	ft_exe
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	404
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
6462.826366991963
==================================================================


==================================================================
Fichier HTTP-FzyaDB4xZ08QJYf3E5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FFGuJD1rQ0Vw95U8Yc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3d547b8c756973b61a634db99aca74d8                                                   |
| sha1                   | b7d9c8fd14e8419c6f1b5d62d8dfafe8ed12be06                                           |
| sha256                 | f0aeee2d6851b6d1b616e85ccb24ea4045c1d00880c39be644b4899f9cac398c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FFGuJD1rQ0Vw95U8Yc.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery :: \[T1016]\                                |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| get domain controller name                           | host-interaction/network/domain                      |
| get hostname                                         | host-interaction/os/hostname                         |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (3 matches)        | host-interaction/registry                            |
| set registry value (3 matches)                       | host-interaction/registry/create                     |
| delete registry key (2 matches)                      | host-interaction/registry/delete                     |
| delete registry value                                | host-interaction/registry/delete                     |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 12.5

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:23:10Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FFGuJD1rQ0Vw95U8Yc.exe SCORE: 284 TYPE: EXE SIZE: 40448 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fc1dbd4f400> 
MD5: 3d547b8c756973b61a634db99aca74d8 
SHA1: b7d9c8fd14e8419c6f1b5d62d8dfafe8ed12be06 
SHA256: f0aeee2d6851b6d1b616e85ccb24ea4045c1d00880c39be644b4899f9cac398c CREATED: Fri Feb 11 13:23:10 2022 MODIFIED: Fri Feb 11 13:23:10 2022 ACCESSED: Fri Feb 11 13:23:39 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e81b0500004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:23:39Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 284

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FFGuJD1rQ0Vw95U8Yc.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 39.207 sec (0 m 39 s)
Start Date: 2022:02:11 13:23:10
End Date:   2022:02:11 13:23:49

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/65
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:23:10                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FFGuJD1rQ0Vw95U8Yc.exe
Real Name:	/ksetup.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
3	- Discovery::System Network Configuration Discovery [T1016;3]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	12.5
ClamAV:	0
Loki:	284
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4750.504455960672
==================================================================


==================================================================
Fichier HTTP-FFGuJD1rQ0Vw95U8Yc.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F7ejNRegDJYqS6xF.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9a86c3da2f39f3c6b1a4291f6940f6ea                                                   |
| sha1                   | 42e18468193e656b0e782be8023947a7e4c941d1                                           |
| sha256                 | 2235f03245ab289919a5c0b2272bf2f3a6a6a1e091944be1dfce79831678a71d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F7ejNRegDJYqS6xF.exe                          |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F7ejNRegDJYqS6xF.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 32.174 sec (0 m 32 s)
Start Date: 2022:02:11 13:23:50
End Date:   2022:02:11 13:24:22

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:23:50Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F7ejNRegDJYqS6xF.exe SCORE: 194 TYPE: EXE SIZE: 35840 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f40197d0400> 
MD5: 9a86c3da2f39f3c6b1a4291f6940f6ea 
SHA1: 42e18468193e656b0e782be8023947a7e4c941d1 
SHA256: 2235f03245ab289919a5c0b2272bf2f3a6a6a1e091944be1dfce79831678a71d CREATED: Fri Feb 11 13:23:50 2022 MODIFIED: Fri Feb 11 13:23:50 2022 ACCESSED: Fri Feb 11 13:24:42 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:24:43Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 194

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:23:50                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F7ejNRegDJYqS6xF.exe
Real Name:	/RacEngn.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsDLL
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	1.0
ClamAV:	0
Loki:	194
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3094.6454165242485
==================================================================


==================================================================
Fichier HTTP-F7ejNRegDJYqS6xF.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FWibQR3ckJ4pr8nP36.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 0a0882b8da225406cc838991b5f67d11                                                   |
| sha1                   | ef62537d97d436b6e7c03190ef35e9dbb4ef997d                                           |
| sha256                 | aa2316ff30647295efac2c884b30b6e83a8515c2d2ff1df3c5d6091b404c73a9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FWibQR3ckJ4pr8nP36.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Network Share Discovery:: \[T1135]\                                                |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | Windows Management Instrumentation:: \[T1047]\                                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings targeting VirtualBox       | anti-analysis/anti-vm/vm-detection                   |
| receive data                                         | communication                                        |
| send data (2 matches)                                | communication                                        |
| reference Google Public DNS server                   | communication/dns                                    |
| connect network resource                             | communication/http                                   |
| parse URL                                            | communication/http                                   |
| check HTTP status code (2 matches)                   | communication/http/client                            |
| encode data using XOR (18 matches)                   | data-manipulation/encoding/xor                       |
| encrypt data using Curve25519 (2 matches)            | data-manipulation/encryption/elliptic-curve          |
| encrypt data using Salsa20 or ChaCha                 | data-manipulation/encryption/salsa20                 |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| get file size                                        | host-interaction/file-system/meta                    |
| move file                                            | host-interaction/file-system/move                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| enumerate disk volumes (2 matches)                   | host-interaction/hardware/storage                    |
| get disk information (3 matches)                     | host-interaction/hardware/storage                    |
| enumerate network shares                             | host-interaction/network                             |
| get hostname (2 matches)                             | host-interaction/os/hostname                         |
| get system information on Windows                    | host-interaction/os/info                             |
| get session user name (2 matches)                    | host-interaction/session                             |
| create thread                                        | host-interaction/thread/create                       |
| connect to WMI namespace via WbemLocator             | host-interaction/wmi                                 |
| link function at runtime on Windows (5 matches)      | linking/runtime-linking                              |
| enumerate PE sections (2 matches)                    | load-code/pe                                         |
| parse PE exports (4 matches)                         | load-code/pe                                         |
| parse PE header (8 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::System Information Discovery [T1082;1]
4.5		- Execution::Windows Management Instrumentation [T1047;4.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
3		- Discovery::Account Discovery [T1087;3]

Score total: 37.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FWibQR3ckJ4pr8nP36.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.17 MB
Data read: 0.16 MB (ratio 1.05:1)
Time: 41.737 sec (0 m 41 s)
Start Date: 2022:02:11 13:24:44
End Date:   2022:02:11 13:25:26

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:24:44Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:25:30Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 53/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:24:44                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FWibQR3ckJ4pr8nP36.exe
Real Name:	/0a0882b8da225406cc838991b5f67d11.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3	- Discovery::System Owner/User Discovery [T1033;3]
1	- Discovery::System Information Discovery [T1082;1]
4.5	- Execution::Windows Management Instrumentation [T1047;4.5]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2	- Discovery::File and Directory Discovery [T1083;2]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
3	- Discovery::Account Discovery [T1087;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

============================[ Scores ]============================
CAPA:	37.0
ClamAV:	0
Loki:	0
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
2738.2470565384856
==================================================================


==================================================================
Fichier HTTP-FWibQR3ckJ4pr8nP36.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FpV9Ly2ugUL9kchhf3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FpV9Ly2ugUL9kchhf3.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 1.03 MB
Data read: 0.97 MB (ratio 1.06:1)
Time: 42.467 sec (0 m 42 s)
Start Date: 2022:02:11 13:25:31
End Date:   2022:02:11 13:26:14

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:25:31Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FpV9Ly2ugUL9kchhf3.exe SCORE: 409 TYPE: EXE SIZE: 1015944 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe67ef25400> 
MD5: 7a32d32f1e6d327f9adab871ba83aef3 
SHA1: 3f9a3bc046fad113fcc5a809ab98dce495cecaa5 
SHA256: 2bb06d7f050031f587eb3041952ba5312deeb234ecfe658136bf17a7450db2fc CREATED: Fri Feb 11 13:25:31 2022 MODIFIED: Fri Feb 11 13:25:31 2022 ACCESSED: Fri Feb 11 13:26:16 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_17: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_18: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 0ef37e9732bb247e3978f5e17dd65686 Str2: c7c7d9542f7252f4362267a060bbc20d Str3: d70dd71faf241293299ef257245aa4bc Str4: fdaeaf418c9d7e82 ... (truncated)
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:26:19Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
60		Debugger_Check__QueryInfo
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1

Score total: 409

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 7a32d32f1e6d327f9adab871ba83aef3                                                   |
| sha1                   | 3f9a3bc046fad113fcc5a809ab98dce495cecaa5                                           |
| sha256                 | 2bb06d7f050031f587eb3041952ba5312deeb234ecfe658136bf17a7450db2fc                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FpV9Ly2ugUL9kchhf3.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (3 matches)           | host-interaction/process/terminate                   |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (18 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:25:31                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FpV9Ly2ugUL9kchhf3.exe
Real Name:	/TextInputFramework.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
60	Debugger_Check__QueryInfo
20	isExecutable
10	Contains_PE_File
10	Big_Numbers1

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	409
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
6542.071026615019
==================================================================


==================================================================
Fichier HTTP-FpV9Ly2ugUL9kchhf3.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FqS67Vr8MInrRHyr6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FqS67Vr8MInrRHyr6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.30 MB
Data read: 0.29 MB (ratio 1.05:1)
Time: 41.457 sec (0 m 41 s)
Start Date: 2022:02:11 13:29:47
End Date:   2022:02:11 13:30:28

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3188cdc07256812f554e31432ef6b8c6                                                   |
| sha1                   | 13929ad3e0ab7c77cf9d7e6ef955df3a795d4c78                                           |
| sha256                 | 4d7b19afa6159fc77c593115143da7c47ee09e7f0fd4da58eb7b371c75be4748                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FqS67Vr8MInrRHyr6.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag (2 matches)         | anti-analysis/anti-debugging/debugger-detection      |
| listen for remote procedure calls                    | communication/rpc/server                             |
| encrypt or decrypt data via BCrypt (4 matches)       | data-manipulation/encryption                         |
| hash data via BCrypt (3 matches)                     | data-manipulation/hashing                            |
| generate random numbers via WinAPI (2 matches)       | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get system information on Windows                    | host-interaction/os/info                             |
| terminate process via fastfail (21 matches)          | host-interaction/process/terminate                   |
| get kernel32 base address (3 matches)                | linking/runtime-linking                              |
| access PE header                                     | load-code/pe                                         |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 13.5

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:29:47Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FqS67Vr8MInrRHyr6.exe SCORE: 434 TYPE: EXE SIZE: 304712 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3a11de6400> 
MD5: 3188cdc07256812f554e31432ef6b8c6 
SHA1: 13929ad3e0ab7c77cf9d7e6ef955df3a795d4c78 
SHA256: 4d7b19afa6159fc77c593115143da7c47ee09e7f0fd4da58eb7b371c75be4748 CREATED: Fri Feb 11 13:29:47 2022 MODIFIED: Fri Feb 11 13:29:47 2022 ACCESSED: Fri Feb 11 13:30:36 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e85b0200004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_16: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_17: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:30:37Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 434

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:29:47                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FqS67Vr8MInrRHyr6.exe
Real Name:	/LsaIso.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Discovery::System Information Discovery [T1082;1]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	13.5
ClamAV:	0
Loki:	434
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
7147.79686780203
==================================================================


==================================================================
Fichier HTTP-FqS67Vr8MInrRHyr6.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FyZRGI2bRZFSvWbdh5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2b8bec5bcb1777eaa155d832f7afc797                                                   |
| sha1                   | 356d60df7a64367ca059d8e1fae02a9d4160e9da                                           |
| sha256                 | 782a48821d88060adf0f7ef3e8759fee3ddad49e942daad18c5af8ae0e9eb51e                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FyZRGI2bRZFSvWbdh5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
| PERSISTENCE            | Scheduled Task/Job::Scheduled Task \[T1053.005]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | Socket Communication::Connect Socket [C0001.004]                              |
|                             | Socket Communication::Create TCP Socket [C0001.011]                           |
|                             | Socket Communication::Create UDP Socket [C0001.010]                           |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::TCP Client [C0001.008]                                  |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Encryption Key::RC4 KSA [C0028.002]                                           |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| receive data (2 matches)                             | communication                                        |
| send data                                            | communication                                        |
| creates tcp or udp socket (4 matches)                | communication/socket                                 |
| create UDP socket                                    | communication/socket/udp/send                        |
| act as TCP client (3 matches)                        | communication/tcp/client                             |
| decode data using Base64 via WinAPI (7 matches)      | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| create new key via CryptAcquireContext               | data-manipulation/encryption                         |
| decrypt data via SSPI                                | data-manipulation/encryption                         |
| encrypt data via SSPI                                | data-manipulation/encryption                         |
| get client handle via SChannel                       | data-manipulation/encryption                         |
| encrypt data using RC4 KSA (2 matches)               | data-manipulation/encryption/rc4                     |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable                           | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| create directory                                     | host-interaction/file-system/create                  |
| delete directory                                     | host-interaction/file-system/delete                  |
| delete file                                          | host-interaction/file-system/delete                  |
| write file on Windows                                | host-interaction/file-system/write                   |
| enumerate gui resources                              | host-interaction/gui                                 |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| hide graphical window                                | host-interaction/gui/window/hide                     |
| get disk information                                 | host-interaction/hardware/storage                    |
| check mutex                                          | host-interaction/mutex                               |
| create mutex                                         | host-interaction/mutex                               |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| get session user name (2 matches)                    | host-interaction/session                             |
| create thread (2 matches)                            | host-interaction/thread/create                       |
| access PEB ldr_data (2 matches)                      | linking/runtime-linking                              |
| parse PE exports                                     | load-code/pe                                         |
| schedule task via ITaskScheduler                     | persistence/scheduled-tasks                          |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
4		- Execution::Command and Scripting Interpreter [T1059;4]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
3		- Discovery::System Network Configuration Discovery [T1016;3]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
2		- Discovery::File and Directory Discovery [T1083;2]
5		- Persistence/Scheduled Task/Job/Scheduled Task [T1053.005;5]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
3		- Discovery::Account Discovery [T1087;3]

Score total: 53.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FyZRGI2bRZFSvWbdh5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 36.911 sec (0 m 36 s)
Start Date: 2022:02:11 13:30:38
End Date:   2022:02:11 13:31:15

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf4 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:30:39Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FyZRGI2bRZFSvWbdh5.exe SCORE: 569 TYPE: EXE SIZE: 31232 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7fff0d4400> 
MD5: 2b8bec5bcb1777eaa155d832f7afc797 
SHA1: 356d60df7a64367ca059d8e1fae02a9d4160e9da 
SHA256: 782a48821d88060adf0f7ef3e8759fee3ddad49e942daad18c5af8ae0e9eb51e CREATED: Fri Feb 11 13:30:39 2022 MODIFIED: Fri Feb 11 13:30:39 2022 ACCESSED: Fri Feb 11 13:31:32 2022 
REASON_1: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: ws2_32.dll Str2: wsock32.dll Str3: socket Str4: send Str5: connect Str6: WSAStartup Str7: closesocket Str8: WSACleanup
REASON_2: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: ws2_32.dll Str2: dnsapi.dll Str3: wsock32.dll Str4: getaddrinfo Str5: DnsQuery
REASON_3: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: OpenProcessToken
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: WriteFile Str3: SetFilePointer Str4: DeleteFileA Str5: CreateFileA Str6: CopyFile
REASON_6: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: ws2_32.dll Str2: wsock32.dll
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: win_systembc_auto SUBSCORE: 45 
DESCRIPTION: Detects win.systembc. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: ff75fce830030000ff75fce8620200005e5f Str2: 4f8bc75e5f Str3: 8b85f4feffffeb038b46185e5f5bc9 Str4: 8b450cab8b4514ab Str5: 74f4368a94290 ... (truncated)
REASON_9: Yara Rule MATCH: MiniTor SUBSCORE: 50 
DESCRIPTION: Identifies MiniTor implementation as seen in SystemBC and Parallax RAT. REF: https://news.sophos.com/en-us/2020/12/16/systembc/ AUTHOR: @bartblaze 
MATCHES: Str1: 558bec81c4f0fdffff5157568d4df42bcc518d44241050e8472500006a0f8d8500feffff50680c834000e8ad2400008d850ffeffff506a14ff7510e8b42800008d85f ... (truncated)
REASON_10: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645d305c645d401c645d500c645 Str2: c645d401c645d500c645d601c645 Str3: c645d500c645d601c645d700c645 Str4: c645d601c645d700c645d800c645 ... (truncated)
REASON_12: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_13: Yara Rule MATCH: winsocks SUBSCORE: 5 
DESCRIPTION: Imports Winsock Library REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec81 Str2: 558bec83 Str3: 558bec53 Str4: 558bec51 Str5: 558bec60
REASON_15: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_18: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: Antivirus_strings SUBSCORE: 50 
DESCRIPTION: Contains references to security software REF: - AUTHOR: Jerome Athias 
MATCHES: Str1: guard.exe
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:31:33Z

-------- Score ----------------
Scores		Rules
.......		...............
50		network_tcp_socket
50		network_dns
60		win_mutex
65		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		ft_exe
45		win_systembc_auto
50		MiniTor
2		math_entropy_5
5		obfuscation_singlebyte_mov
5		executable_pe
5		winsocks
70		Microsoft_Visual_Cpp_v50v60_MFC
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
50		Antivirus_strings
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API

Score total: 569

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 56/70
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:30:38                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FyZRGI2bRZFSvWbdh5.exe
Real Name:	/2b8bec5bcb1777eaa155d832f7afc797.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6	- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
4	- Execution::Command and Scripting Interpreter [T1059;4]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
4	- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
3	- Discovery::System Network Configuration Discovery [T1016;3]
3	- Discovery::System Owner/User Discovery [T1033;3]
1	- Discovery::System Information Discovery [T1082;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
2	- Discovery::File and Directory Discovery [T1083;2]
5	- Persistence/Scheduled Task/Job/Scheduled Task [T1053.005;5]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
3	- Discovery::Account Discovery [T1087;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	network_tcp_socket
50	network_dns
60	win_mutex
65	win_token
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	ft_exe
45	win_systembc_auto
50	MiniTor
2	math_entropy_5
5	obfuscation_singlebyte_mov
5	executable_pe
5	winsocks
70	Microsoft_Visual_Cpp_v50v60_MFC
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
50	Antivirus_strings
20	isExecutable
10	Contains_PE_File
20	Advapi_Hash_API

============================[ Scores ]============================
CAPA:	53.5
ClamAV:	0
Loki:	569
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
12085.507603612086
==================================================================


==================================================================
Fichier HTTP-FyZRGI2bRZFSvWbdh5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FNMYoL3eQGNpgFQKk4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b94af4a4d4af6eac81fc135abda1c40c                                                   |
| sha1                   | d6356b2c6f8d29f8626062b5aefb13b7fc744d54                                           |
| sha256                 | 6ac06dfa543dca43327d55a61d0aaed25f3c90cce791e0555e3e306d47107859                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FNMYoL3eQGNpgFQKk4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Indicator Removal on Host::File Deletion \[T1070.004]\                             |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Modify Registry:: \[T1112]\                                                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | Socket Communication::Connect Socket [C0001.004]                              |
|                             | Socket Communication::Create TCP Socket [C0001.011]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::TCP Client [C0001.008]                                  |
| DEFENSE EVASION             | Self Deletion::COMSPEC Environment Variable [F0007.001]                       |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| self delete                                          | anti-analysis/anti-forensic/self-deletion            |
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| read and send data from client to server             | c2/file-transfer                                     |
| receive and write data from server to client         | c2/file-transfer                                     |
| creates tcp or udp socket                            | communication/socket                                 |
| initialize Winsock library                           | communication/socket                                 |
| act as TCP client                                    | communication/tcp/client                             |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| create process on Windows                            | host-interaction/process/create                      |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| modify service                                       | host-interaction/service/modify                      |
| persist via Windows service                          | persistence/service                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Discovery::System Information Discovery [T1082;1]
8.5		- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
1		- Discovery::Query Registry [T1012;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 53.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FNMYoL3eQGNpgFQKk4.exe: Win.Dropper.Ulise-9937584-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 32.689 sec (0 m 32 s)
Start Date: 2022:02:11 13:31:34
End Date:   2022:02:11 13:32:06

-------- Score ----------------
Scores		Rules
.......		...............
30		Win.Dropper.Ulise-9937584-0

Score total: 30.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 52/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:31:34                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FNMYoL3eQGNpgFQKk4.exe
Real Name:	/Practical Malware Analysis Lab 03-04.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3	- Discovery::System Network Configuration Discovery [T1016;3]
1	- Discovery::System Information Discovery [T1082;1]
8.5	- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
1	- Discovery::Query Registry [T1012;1]
3	- Execution::System Services::Service Execution [T1569.002;3]
8.5	- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
2	- Discovery::File and Directory Discovery [T1083;2]
4	- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
30	Win.Dropper.Ulise-9937584-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Armadillo_v4x
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsConsole
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
40	SEH_Save
40	SEH_Init
20	isExecutable
10	Contains_PE_File
15	VC6_Random

============================[ Scores ]============================
CAPA:	53.5
ClamAV:	30.0
Loki:	669
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
14048.07841961145
==================================================================


==================================================================
Fichier HTTP-FNMYoL3eQGNpgFQKk4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FtSogU1BTlnLECpFfb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FtSogU1BTlnLECpFfb.exe: Win.Malware.Beaugrit-9835568-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 43.203 sec (0 m 43 s)
Start Date: 2022:02:11 13:32:29
End Date:   2022:02:11 13:33:12

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Beaugrit-9835568-0

Score total: 50.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:32:29Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FtSogU1BTlnLECpFfb.exe SCORE: 784 TYPE: EXE SIZE: 53346 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f953f302400> 
MD5: 9324d1a8ae37a36ae560c37448c9705a 
SHA1: 042eb46fbd8480f85a860266907cab24954d57e1 
SHA256: a3d7bfbdd9e9f72fb9201a8e7f05f524007ed3ac2172c51a49bd361cb39aaf0f CREATED: Fri Feb 11 13:32:29 2022 MODIFIED: Fri Feb 11 13:32:29 2022 ACCESSED: Fri Feb 11 13:33:16 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CreateFileA Str7: CopyFile
REASON_5: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_6: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_7: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetOpen
REASON_8: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645f072c645f175c645f26ec645 Str2: c645f633c645f732c645f82ec645 Str3: c645f732c645f82ec645f965c645 Str4: c645f82ec645f965c645fa78c645 ... (truncated)
REASON_11: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff68a892400068907e400064a100000000506489250000000083ec14535657 Str3: 558bec6aff68c892400068907e400064a100000000506489 ... (truncated)
REASON_13: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff689892400068907e400064a10000000050 Str2: 558bec6aff68a892400068907e400064a10000000050 Str3: 558bec6aff68b892400068907e40006 ... (truncated)
REASON_14: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff689892400068907e400064a10000000050 Str2: 558bec6aff68a892400068907e400064a10000000050 Str3: 558bec6aff68b892400068907e40006 ... (truncated)
REASON_15: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6a Str2: 558bec83 Str3: 558bec81 Str4: 558bec53 Str5: 558bec6aff689892400068907e400064a10000000050 Str6: 558bec6aff68a892400068 ... (truncated)
REASON_16: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff689892400068907e400064a1000000005064892500000000 Str2: 558bec6aff68a892400068907e400064a1000000005064892500000000 Str3: 558 ... (truncated)
REASON_17: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_20: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_21: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_22: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_23: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_24: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_25: Yara Rule MATCH: LimaAlfa SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: Novetta Threat Research & Interdiction Group - trig@novetta.com 
MATCHES: Str1: 33c0668b028be881e500f0ffff81fd00300000750d8b6c241825ff0f000003c701
REASON_26: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_27: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:33:16Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
65		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		ft_exe
2		math_entropy_5
5		obfuscation_singlebyte_mov
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
40		SEH_Init
60		LimaAlfa
20		isExecutable
10		Contains_PE_File

Score total: 784

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 61/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:32:29                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FtSogU1BTlnLECpFfb.exe
Real Name:	/9324d1a8ae37a36ae560c37448c9705a.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
50	Win.Malware.Beaugrit-9835568-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
70	escalate_priv
20	win_registry
65	win_token
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	ft_exe
2	math_entropy_5
5	obfuscation_singlebyte_mov
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsWindowsGUI
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
40	SEH_Init
60	LimaAlfa
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	0
ClamAV:	50.0
Loki:	784
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
15055.025334792212
==================================================================


==================================================================
Fichier HTTP-FtSogU1BTlnLECpFfb.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FBfD9U24Br2WUlIKyc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:33:18Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FBfD9U24Br2WUlIKyc.exe SCORE: 149 TYPE: EXE SIZE: 250696 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f973245c400> 
MD5: dafbfa941f1d5af65c296a2b22d0ec7a 
SHA1: eaad1642d87dc72247930f93d7800f5e4c12e82c 
SHA256: 5319c6b57e4dbf9cf23362bce0835a5deae25ff1036ea2766033333db6295f97 CREATED: Fri Feb 11 13:33:17 2022 MODIFIED: Fri Feb 11 13:33:17 2022 ACCESSED: Fri Feb 11 13:33:55 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_7 SUBSCORE: 2 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:33:55Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_7
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		IsPacked
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 149

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | dafbfa941f1d5af65c296a2b22d0ec7a                                                   |
| sha1                   | eaad1642d87dc72247930f93d7800f5e4c12e82c                                           |
| sha256                 | 5319c6b57e4dbf9cf23362bce0835a5deae25ff1036ea2766033333db6295f97                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FBfD9U24Br2WUlIKyc.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FBfD9U24Br2WUlIKyc.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.25 MB
Data read: 0.24 MB (ratio 1.03:1)
Time: 40.818 sec (0 m 40 s)
Start Date: 2022:02:11 13:33:17
End Date:   2022:02:11 13:33:58

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:33:17                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FBfD9U24Br2WUlIKyc.exe
Real Name:	/RESAMPLEDMO.DLL
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_7
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	IsPacked
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	149
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
2421.348726216125
==================================================================


==================================================================
Fichier HTTP-FBfD9U24Br2WUlIKyc.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FC8hebu9LwlCIZsql.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FC8hebu9LwlCIZsql.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.30 MB
Data read: 0.28 MB (ratio 1.06:1)
Time: 38.200 sec (0 m 38 s)
Start Date: 2022:02:11 13:33:59
End Date:   2022:02:11 13:34:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:33:59Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FC8hebu9LwlCIZsql.exe SCORE: 299 TYPE: EXE SIZE: 297472 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7760522400> 
MD5: fd5ea005e9ac54c8692ef8d8dbcc8a0c 
SHA1: 084e7e6db9b1047ff1171bc29696ae4a00459197 
SHA256: d40375ca08c682192bd6f57dcc43f056eb75ce61afb9172776253589be21194c CREATED: Fri Feb 11 13:33:59 2022 MODIFIED: Fri Feb 11 13:33:59 2022 ACCESSED: Fri Feb 11 13:34:49 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_2: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:34:49Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
80		keylogger
20		win_registry
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 299

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | fd5ea005e9ac54c8692ef8d8dbcc8a0c                                                   |
| sha1                   | 084e7e6db9b1047ff1171bc29696ae4a00459197                                           |
| sha256                 | d40375ca08c682192bd6f57dcc43f056eb75ce61afb9172776253589be21194c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FC8hebu9LwlCIZsql.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location                            | collection                                           |
| log keystrokes via polling                           | collection/keylog                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (5 matches)  | executable/resource                                  |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| get file system object information (2 matches)       | host-interaction/file-system                         |
| delete file (5 matches)                              | host-interaction/file-system/delete                  |
| get file size (4 matches)                            | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| query or enumerate registry value                    | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| create thread                                        | host-interaction/thread/create                       |
| resume thread                                        | host-interaction/thread/resume                       |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::Query Registry [T1012;1]
1.5		- Discovery::System Location Discovery [T1614;1.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 28.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:33:59                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FC8hebu9LwlCIZsql.exe
Real Name:	/scansetting.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::Query Registry [T1012;1]
1.5	- Discovery::System Location Discovery [T1614;1.5]
6	- Collection::Input Capture::Keylogging [T1056.001;6]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
65	screenshot
80	keylogger
20	win_registry
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	28.0
ClamAV:	0
Loki:	299
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5297.504093650015
==================================================================


==================================================================
Fichier HTTP-FC8hebu9LwlCIZsql.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F2RrRt4IF5gjffBhn8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 8b21545a9a6b5fa8894bb8ec4d06de5b                                                   |
| sha1                   | 3feb6f204ad4a1a8653f66e73dc35c9555f49b88                                           |
| sha256                 | 6e9d3fc3e4c502592e48a42aaa498180eaa11a2b3dbb2e5aede88a2e74ad8f43                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F2RrRt4IF5gjffBhn8.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F2RrRt4IF5gjffBhn8.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 42.348 sec (0 m 42 s)
Start Date: 2022:02:11 13:34:59
End Date:   2022:02:11 13:35:42

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa5 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:35:00Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F2RrRt4IF5gjffBhn8.exe SCORE: 264 TYPE: EXE SIZE: 64248 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7d6b872400> 
MD5: 8b21545a9a6b5fa8894bb8ec4d06de5b 
SHA1: 3feb6f204ad4a1a8653f66e73dc35c9555f49b88 
SHA256: 6e9d3fc3e4c502592e48a42aaa498180eaa11a2b3dbb2e5aede88a2e74ad8f43 CREATED: Fri Feb 11 13:34:59 2022 MODIFIED: Fri Feb 11 13:34:59 2022 ACCESSED: Fri Feb 11 13:35:54 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: ConventionEngine_Keyword_Install SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453a5fa96a1a66ab8489e4408a7632f3eda01000000453a5c5744462d494d4339302d4a4f42315c77696e31305f6275696c647465616d5f4d6f6465726e2e536 ... (truncated)
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 10 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:35:54Z

-------- Score ----------------
Scores		Rules
.......		...............
10		misc_pe_signature
10		ft_exe
50		ConventionEngine_Keyword_Install
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		ImportTableIsBad
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 264

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:34:59                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F2RrRt4IF5gjffBhn8.exe
Real Name:	/ImController.InfInstaller.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	misc_pe_signature
10	ft_exe
50	ConventionEngine_Keyword_Install
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsWindowsGUI
10	HasOverlay
10	HasDebugData
10	ImportTableIsBad
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	1.0
ClamAV:	0
Loki:	264
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4204.070651247028
==================================================================


==================================================================
Fichier HTTP-F2RrRt4IF5gjffBhn8.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Freo6g4PwEa6VMeFO2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 61908f4d70ce6f16173e76aa42a8c25a                                                   |
| sha1                   | fd47522692c262de30da8d1f682dd014281d9317                                           |
| sha256                 | d7ff81ff775d4ab50d31ac1e962c8c4dea7ff9f280aa2b42ddd06760a5665002                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Freo6g4PwEa6VMeFO2.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::User Activity Based Checks \[T1497.002]\           |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection::Human User Check [B0009.012]                       |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for unmoving mouse cursor                      | anti-analysis/anti-vm/vm-detection                   |
| get geographical location                            | collection                                           |
| decompress data using aPLib                          | data-manipulation/compression                        |
| encode data using XOR (3 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| read file on Windows                                 | host-interaction/file-system/read                    |
| read file via mapping                                | host-interaction/file-system/read                    |
| check OS version                                     | host-interaction/os/version                          |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| terminate process                                    | host-interaction/process/terminate                   |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
1.5		- Discovery::System Location Discovery [T1614;1.5]
7.5		- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 20.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Freo6g4PwEa6VMeFO2.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 41.398 sec (0 m 41 s)
Start Date: 2022:02:11 13:35:55
End Date:   2022:02:11 13:36:36

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 52/71
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:35:55                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Freo6g4PwEa6VMeFO2.exe
Real Name:	/d7ff81ff775d4ab50d31ac1e962c8c4dea7ff9f280aa2b42ddd06760a5665002.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
1	- Discovery::System Information Discovery [T1082;1]
1.5	- Discovery::System Location Discovery [T1614;1.5]
7.5	- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	ft_exe
2	math_entropy_7
5	executable_pe
70	Armadillo_v4x
10	IsPE32
10	IsWindowsGUI
10	IsPacked
10	HasOverlay
10	HasRichSignature
2	PE_File
40	SEH_Save
40	SEH_Init
20	isExecutable
10	Contains_PE_File
25	CRC32_poly_Constant

============================[ Scores ]============================
CAPA:	20.0
ClamAV:	0
Loki:	284
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
6900.149129583338
==================================================================


==================================================================
Fichier HTTP-Freo6g4PwEa6VMeFO2.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FVMdaO3sQ9uNdgYC67.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FVMdaO3sQ9uNdgYC67.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 41.347 sec (0 m 41 s)
Start Date: 2022:02:11 13:36:42
End Date:   2022:02:11 13:37:23

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c56af5561e3f20bed435fb4355cffc29                                                   |
| sha1                   | 7e0e6900f4528e7dacb65ab1b1c107425d2a321b                                           |
| sha256                 | 70aaf2b367b97fa35d599a6db4d08875206ef18c99d8c8c5b5f25e4f5509931a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FVMdaO3sQ9uNdgYC67.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                          |
| CREDENTIAL ACCESS      | Credentials from Password Stores::Windows Credential Manager \[T1555.004]\          |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                         |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                         |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | Software Discovery:: \[T1518]\                                                      |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                               |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| acquire credentials from Windows Credential Manager  | collection                                           |
| encode data using XOR (9 matches)                    | data-manipulation/encoding/xor                       |
| authenticate HMAC (2 matches)                        | data-manipulation/hmac                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| open clipboard                                       | host-interaction/clipboard                           |
| replace clipboard data                               | host-interaction/clipboard                           |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| delete file (3 matches)                              | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| read .ini file (7 matches)                           | host-interaction/file-system/read                    |
| read file on Windows (2 matches)                     | host-interaction/file-system/read                    |
| read file via mapping                                | host-interaction/file-system/read                    |
| write file on Windows (4 matches)                    | host-interaction/file-system/write                   |
| enumerate gui resources                              | host-interaction/gui                                 |
| get graphical window text (2 matches)                | host-interaction/gui/window/get-text                 |
| hide graphical window                                | host-interaction/gui/window/hide                     |
| enumerate internet cache                             | host-interaction/internet/cache                      |
| read process memory                                  | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| enumerate processes                                  | host-interaction/process/list                        |
| acquire debug privileges                             | host-interaction/process/modify                      |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| delete registry value                                | host-interaction/registry/delete                     |
| link many functions at runtime (7 matches)           | linking/runtime-linking                              |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (4 matches)                          | load-code/pe                                         |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
8		- Credential Access::Credentials from Password Stores::Windows Credential Manager [T1555.004;8]
6		- Collection::Clipboard Data [T1115;6]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
4		- Discovery::Process Discovery [T1057;4]
4		- Discovery::Software Discovery [T1518;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 67.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:36:42Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FVMdaO3sQ9uNdgYC67.exe SCORE: 444 TYPE: EXE SIZE: 101376 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f5ad74ca400> 
MD5: c56af5561e3f20bed435fb4355cffc29 
SHA1: 7e0e6900f4528e7dacb65ab1b1c107425d2a321b 
SHA256: 70aaf2b367b97fa35d599a6db4d08875206ef18c99d8c8c5b5f25e4f5509931a CREATED: Fri Feb 11 13:36:42 2022 MODIFIED: Fri Feb 11 13:36:42 2022 ACCESSED: Fri Feb 11 13:37:36 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: SeDebugPrivilege Str4: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: RegQueryValueExA Str4: RegOpenKeyExA Str5: RegCloseKey
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: AdjustTokenPrivileges Str4: OpenProcessToken Str5: LookupPrivilegeValueA
REASON_5: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: GetPrivateProfileIntA Str4: GetPrivateProfileStringA Str5: WritePrivateProfileStringA
REASON_6: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: DeleteFileA Str7: CreateFileA Str8: FindFir ... (truncated)
REASON_7: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_8: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645f401c645f500c645f600c645 Str2: c645f500c645f600c645f700c645 Str3: c645ec01c645f0d0c645f18cc645 Str4: c645f0d0c645f18cc645f29dc645 ... (truncated)
REASON_11: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_17: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext
REASON_21: Yara Rule MATCH: DES_sbox SUBSCORE: 15 
DESCRIPTION: DES [sbox] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:37:36Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
65		screenshot
20		win_registry
65		win_token
10		win_private_profile
10		win_files_operation
10		Str_Win32_Wininet_Library
10		ft_exe
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
40		SEH_Init
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API
15		DES_sbox

Score total: 444

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 45/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:36:41                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FVMdaO3sQ9uNdgYC67.exe
Real Name:	/c56af5561e3f20bed435fb4355cffc29.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6	- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
4	- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
5	- Privilege Escalation::Access Token Manipulation [T1134;5]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
8	- Credential Access::Credentials from Password Stores::Windows Credential Manager [T1555.004;8]
6	- Collection::Clipboard Data [T1115;6]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1	- Discovery::Query Registry [T1012;1]
4	- Discovery::Process Discovery [T1057;4]
4	- Discovery::Software Discovery [T1518;4]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
70	escalate_priv
65	screenshot
20	win_registry
65	win_token
10	win_private_profile
10	win_files_operation
10	Str_Win32_Wininet_Library
10	ft_exe
2	math_entropy_6
5	obfuscation_singlebyte_mov
5	executable_pe
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
40	SEH_Init
20	isExecutable
10	Contains_PE_File
20	Advapi_Hash_API
15	DES_sbox

============================[ Scores ]============================
CAPA:	67.0
ClamAV:	0
Loki:	444
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
10373.751525556492
==================================================================


==================================================================
Fichier HTTP-FVMdaO3sQ9uNdgYC67.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FUKuPkOBaHqOZmPt5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e2bf42217a67e46433da8b6f4507219e                                                   |
| sha1                   | daf263702f11dc0430d30f9bf443e7885cf91fcb                                           |
| sha256                 | ae8a1c7eb64c42ea2a04f97523ebf0844c27029eb040d910048b680f884b9dce                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FUKuPkOBaHqOZmPt5.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Process Hollowing \[T1055.012]\                                 |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Resume Thread:: [C0054]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| get common file path                                 | host-interaction/file-system                         |
| get file size                                        | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| read process memory                                  | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| use process replacement                              | host-interaction/process/inject                      |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| enumerate PE sections                                | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::File and Directory Discovery [T1083;2]
5		- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FUKuPkOBaHqOZmPt5.exe: Win.Malware.Explorerhijack-9937586-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FUKuPkOBaHqOZmPt5.exe: Win.Malware.Explorerhijack-9937587-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 40.413 sec (0 m 40 s)
Start Date: 2022:02:11 13:37:37
End Date:   2022:02:11 13:38:18

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Explorerhijack-9937586-0
50		Win.Malware.Explorerhijack-9937587-0

Score total: 100.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 56/63
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:37:37                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FUKuPkOBaHqOZmPt5.exe
Real Name:	/Practical Malware Analysis Lab 03-03.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Discovery::File and Directory Discovery [T1083;2]
5	- Defense Evasion::Process Injection::Process Hollowing [T1055.012;5]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
50	Win.Malware.Explorerhijack-9937586-0
50	Win.Malware.Explorerhijack-9937587-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	ft_exe
2	math_entropy_4
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Armadillo_v4x
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsConsole
10	HasRichSignature
2	PE_File
60	ThreadControl__Context_v1
40	SEH_Save
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	10.0
ClamAV:	100.0
Loki:	649
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
13744.40846236368
==================================================================


==================================================================
Fichier HTTP-FUKuPkOBaHqOZmPt5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FfBqmZ1b3sGGMVgrp6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FfBqmZ1b3sGGMVgrp6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.36 MB
Data read: 0.34 MB (ratio 1.05:1)
Time: 40.306 sec (0 m 40 s)
Start Date: 2022:02:11 13:38:34
End Date:   2022:02:11 13:39:14

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa2 in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa2 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 0: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:38:34Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FfBqmZ1b3sGGMVgrp6.exe SCORE: 574 TYPE: EXE SIZE: 363008 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f6cf59b1400> 
MD5: 0c605276ff21b5150365b7d1991f5904 
SHA1: 2d336978af261e07b1ecfaf65dc903b239e287a4 
SHA256: 720610b9067c8afe857819a098a44cab24e9da5cf6a086351d01b73714afd397 CREATED: Fri Feb 11 13:38:34 2022 MODIFIED: Fri Feb 11 13:38:34 2022 ACCESSED: Fri Feb 11 13:39:19 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: CreateFileA Str6: FindClose
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8418945ece90fffffff Str2: e829050000e974feffff Str3: e83e080000e977ffffff Str4: e80f060000e977ffffff Str5: e861b4ffffe96cffffff
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1:  Str2: PE Str3: @B Str4: 00000000000000000000000000000000000070a24400401343001c0000002cb242000000000000000000000000000001000000000000 ... (truncated)
REASON_8: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: Process_Doppelganging SUBSCORE: 35 
DESCRIPTION: Detect Process Doppelganging REF: https://www.blackhat.com/docs/eu-17/materials/eu-17-Liberman-Lost-In-Transaction-Process-Doppelganging.pdf AUTHOR: McAfee ATR - Thomas Roccia - @fr0gger_ 
MATCHES: Str1: CreateTransaction Str2: CreateFileTransacted Str3: WriteFile Str4: RollbackTransaction
REASON_14: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_16: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_17: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_19: Yara Rule MATCH: MAL_Stashlog_Sep_2021_1 SUBSCORE: 70 
DESCRIPTION: Detect Stashlog malware REF: https://www.fireeye.com/blog/threat-research/2021/09/unknown-actor-using-clfs-log-files-for-stealth.html AUTHOR: Arkbird_SOLG 
MATCHES: Str1: 497E724A7BA2764BB4570B225601FB693A796873E7847DB943F7FE9E7281C91A443DF1F8519CBB25FC736CC65BF3DE67A82E704BEB698E17 Str2: 5083ec0c89e031 ... (truncated)
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: RIPEMD160_Constants SUBSCORE: 15 
DESCRIPTION: Look for RIPEMD-160 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3
REASON_23: Yara Rule MATCH: SHA1_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA1 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3 Str6: d6c162ca
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:39:20Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsConsole
10		HasDebugData
2		PE_File
35		Anti_Automated_Sandbox
35		Process_Doppelganging
30		Check_OutputDebugStringA_iat_v1
40		SEH_Save
40		SEH_Init
30		Check_OutputDebugStringA_iat
10		anti_dbg
70		MAL_Stashlog_Sep_2021_1
20		isExecutable
10		Contains_PE_File
15		RIPEMD160_Constants
20		SHA1_Constants

Score total: 574

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 0c605276ff21b5150365b7d1991f5904                                                   |
| sha1                   | 2d336978af261e07b1ecfaf65dc903b239e287a4                                           |
| sha256                 | 720610b9067c8afe857819a098a44cab24e9da5cf6a086351d01b73714afd397                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FfBqmZ1b3sGGMVgrp6.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Cryptographic Hash::SHA1 [C0029.002]                                          |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
|                             | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| hash data using SHA1                                 | data-manipulation/hashing/sha1                       |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| set environment variable                             | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| read file via mapping (2 matches)                    | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| get disk size                                        | host-interaction/hardware/storage                    |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 7.0

==================[ Vérification MalwareBazaar ]==================
Fichier trouvé !
Malware connu -> Score: 2000
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 50/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:38:34                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FfBqmZ1b3sGGMVgrp6.exe
Real Name:	/0c605276ff21b5150365b7d1991f5904.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	win_files_operation
10	ft_exe
2	math_entropy_6
5	executable_pe
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsConsole
10	HasDebugData
2	PE_File
35	Anti_Automated_Sandbox
35	Process_Doppelganging
30	Check_OutputDebugStringA_iat_v1
40	SEH_Save
40	SEH_Init
30	Check_OutputDebugStringA_iat
10	anti_dbg
70	MAL_Stashlog_Sep_2021_1
20	isExecutable
10	Contains_PE_File
15	RIPEMD160_Constants
20	SHA1_Constants

============================[ Scores ]============================
CAPA:	7.0
ClamAV:	0
Loki:	574
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	2000
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
13236.955286774612
==================================================================


==================================================================
Fichier HTTP-FfBqmZ1b3sGGMVgrp6.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FW2DF4y0MVEpj6ue9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FW2DF4y0MVEpj6ue9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.24 MB
Data read: 0.23 MB (ratio 1.03:1)
Time: 41.095 sec (0 m 41 s)
Start Date: 2022:02:11 13:41:40
End Date:   2022:02:11 13:42:21

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:41:41Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FW2DF4y0MVEpj6ue9.exe SCORE: 304 TYPE: EXE SIZE: 249054 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7bcabb6400> 
MD5: 068a76d4823419b376d418cf03215d5c 
SHA1: 4096855ff2c286c737ccf298ea048219cbe8e537 
SHA256: 39655d8f0d03173bd98de4d6f0c9bde51bc7ea0deed3a644ccd5d7732052e9c6 CREATED: Fri Feb 11 13:41:40 2022 MODIFIED: Fri Feb 11 13:41:40 2022 ACCESSED: Fri Feb 11 13:42:33 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 2 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Basic_v50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: h
REASON_5: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: rlpack SUBSCORE: 15 
DESCRIPTION: RLPack packed file REF: - AUTHOR: - 
MATCHES: Str1: MZ Str2: .packed Str3: .RLPack
REASON_11: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: .packed Str2: .RLPack
REASON_12: Yara Rule MATCH: INDICATOR_EXE_Packed_RLPack SUBSCORE: 70 
DESCRIPTION: Detects executables packed with RLPACK REF: - AUTHOR: ditekSHen 
MATCHES: Str1: .packed Str2: .RLPack
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:42:34Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_close_8
5		executable_pe
70		Microsoft_Visual_Basic_v50
10		IsPE32
10		IsWindowsGUI
10		IsPacked
10		HasRichSignature
2		PE_File
15		rlpack
60		suspicious_packer_section
70		INDICATOR_EXE_Packed_RLPack
20		isExecutable
10		Contains_PE_File

Score total: 304

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 59/70
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:41:40                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FW2DF4y0MVEpj6ue9.exe
Real Name:	/068a76d4823419b376d418cf03215d5c.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_close_8
5	executable_pe
70	Microsoft_Visual_Basic_v50
10	IsPE32
10	IsWindowsGUI
10	IsPacked
10	HasRichSignature
2	PE_File
15	rlpack
60	suspicious_packer_section
70	INDICATOR_EXE_Packed_RLPack
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	0
ClamAV:	0
Loki:	304
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
6818.075305081785
==================================================================


==================================================================
Fichier HTTP-FW2DF4y0MVEpj6ue9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F3slPKcuhETEYOXe.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F3slPKcuhETEYOXe.exe: Win.Trojan.Agent-375080 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.04 MB (ratio 1.44:1)
Time: 41.500 sec (0 m 41 s)
Start Date: 2022:02:11 13:42:35
End Date:   2022:02:11 13:43:17

-------- Score ----------------
Scores		Rules
.......		...............
70		Win.Trojan.Agent-375080
75		Win.Trojan.Agent-375080
45		Win.Trojan.Agent-375080

Score total: 190.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:42:35Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F3slPKcuhETEYOXe.exe SCORE: 714 TYPE: EXE SIZE: 36864 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fca4f63c400> 
MD5: 625ac05fd47adc3c63700c3b30de79ab 
SHA1: 9369d80106dd245938996e245340a3c6f17587fe 
SHA256: 0fa1498340fca6c562cfa389ad3e93395f44c72fd128d7ba08579a69aaf3b126 CREATED: Fri Feb 11 13:42:35 2022 MODIFIED: Fri Feb 11 13:42:35 2022 ACCESSED: Fri Feb 11 13:43:29 2022 
REASON_1: Yara Rule MATCH: network_dropper SUBSCORE: 65 
DESCRIPTION: File downloader/dropper REF: - AUTHOR: x0r 
MATCHES: Str1: urlmon.dll Str2: URLDownloadToFile
REASON_2: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: SeDebugPrivilege Str3: AdjustTokenPrivileges
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: CreateFileA
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_1 SUBSCORE: 2 
DESCRIPTION: Very low entropy - repeating 2 bytes REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff6898204000681017400064a100000000506489250000000083ec20535657 Str3: 558bec6aff6858204000687012400064a100000000506489 ... (truncated)
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6898204000681017400064a10000000050 Str2: 558bec6aff6858204000687012400064a10000000050
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6898204000681017400064a10000000050 Str2: 558bec6aff6858204000687012400064a10000000050
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec81 Str2: 558bec83 Str3: 558becb8 Str4: 558bec6a Str5: 558bec6aff6898204000681017400064a10000000050 Str6: 558bec6aff685820400068 ... (truncated)
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6898204000681017400064a1000000005064892500000000 Str2: 558bec6aff6858204000687012400064a1000000005064892500000000
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:43:29Z

-------- Score ----------------
Scores		Rules
.......		...............
65		network_dropper
70		escalate_priv
65		win_token
10		win_files_operation
10		ft_exe
2		math_entropy_1
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
35		Embedded_PE
2		PE_File
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 714

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 60/70
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:42:35                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F3slPKcuhETEYOXe.exe
Real Name:	/Practical Malware Analysis Lab 01-04.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
70	Win.Trojan.Agent-375080
75	Win.Trojan.Agent-375080
45	Win.Trojan.Agent-375080

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
65	network_dropper
70	escalate_priv
65	win_token
10	win_files_operation
10	ft_exe
2	math_entropy_1
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
35	Embedded_PE
2	PE_File
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	0
ClamAV:	190.0
Loki:	714
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
15708.095676581266
==================================================================


==================================================================
Fichier HTTP-F3slPKcuhETEYOXe.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FKCxTG1mDLFjtRp244.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 61: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 79: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 71: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 70: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 64: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 63: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 62: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 61: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 55: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 54: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 53: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 47: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 46: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 45: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 39: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 38: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 33: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 32: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 31: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 30: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 26: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 25: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 24: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 23: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 22: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf2 in position 4: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:43:31Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FKCxTG1mDLFjtRp244.exe SCORE: 1689 TYPE: EXE SIZE: 665088 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9d1fbc6400> 
MD5: 66602b5fab602cb4e6f754748d249542 
SHA1: 105232653edcf20ce539973401aa8015232c5cdf 
SHA256: c5144dd0a675e0c9d7f7a9cab034a680d99a8e8ae56e3588a1f3e0b2e8d917f3 CREATED: Fri Feb 11 13:43:31 2022 MODIFIED: Fri Feb 11 13:43:31 2022 ACCESSED: Fri Feb 11 13:43:59 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: FindClose
REASON_2: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645fc08c645fc09c645fc0ac645 Str2: c645fc09c645fc0ac645fc0bc645 Str3: c645fc0ac645fc0bc645fc0cc645
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e81a050000e987feffff Str2: e8ddceffffe992feffff Str3: e893cdffffe98cfdffff Str4: e8e0ccffffe9fbfcffff Str5: e8e1f2ffffe9fbfeffff Str6 ... (truncated)
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_9: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: stager_reverse_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_15: Yara Rule MATCH: stager_bind_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_16: Yara Rule MATCH: win32_stage_boot_winsock_conn_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_17: Yara Rule MATCH: win32_stage_boot_bind_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_18: Yara Rule MATCH: win32_stage_boot_reverse_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_19: Yara Rule MATCH: win32_stage_boot_winsock_conn_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_20: Yara Rule MATCH: stager_reverse_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_21: Yara Rule MATCH: win32_stage_boot_bind_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_22: Yara Rule MATCH: win32_stage_boot_reverse_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_23: Yara Rule MATCH: win32_stage_boot_reverse_shell_revert_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_24: Yara Rule MATCH: win32_stage_winexec_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_25: Yara Rule MATCH: stager_bind_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_26: Yara Rule MATCH: win32_stage_boot_winsock_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_27: Yara Rule MATCH: win32_stage_boot_reverse_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_28: Yara Rule MATCH: win32_stage_api_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_29: Yara Rule MATCH: win32_stage_boot_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_30: Yara Rule MATCH: win32_stage_boot_reverse_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_31: Yara Rule MATCH: win32_stage_boot_reverse_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_32: Yara Rule MATCH: win32_stage_boot_bind_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_33: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_34: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_35: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_36: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_37: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_38: Yara Rule MATCH: RijnDael_AES_CHAR SUBSCORE: 15 
DESCRIPTION: RijnDael AES (check2) [char] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:44:00Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
70		stager_reverse_tcp_nx_ldone_x86
70		stager_bind_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_conn_ldone_x86
70		win32_stage_boot_bind_read_ldone_x86
70		win32_stage_boot_reverse_read_ldone_x86
70		win32_stage_boot_winsock_conn_udp_ldone_x86
70		stager_reverse_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_bind_inlineegg_ldone_x86
70		win32_stage_boot_reverse_ldone_x86
70		win32_stage_boot_reverse_shell_revert_ldone_x86
70		win32_stage_winexec_ldone_x86
70		stager_bind_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_bind_ldone_x86
70		win32_stage_boot_reverse_shell_ldone_x86
70		win32_stage_api_ldone_x86
70		win32_stage_boot_bind_ldone_x86
70		win32_stage_boot_reverse_udp_ldone_x86
70		win32_stage_boot_reverse_inlineegg_ldone_x86
70		win32_stage_boot_bind_shell_ldone_x86
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
15		RijnDael_AES_CHAR

Score total: 1689

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FKCxTG1mDLFjtRp244.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.67 MB
Data read: 0.63 MB (ratio 1.06:1)
Time: 39.190 sec (0 m 39 s)
Start Date: 2022:02:11 13:43:31
End Date:   2022:02:11 13:44:10

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 66602b5fab602cb4e6f754748d249542                                                   |
| sha1                   | 105232653edcf20ce539973401aa8015232c5cdf                                           |
| sha256                 | c5144dd0a675e0c9d7f7a9cab034a680d99a8e8ae56e3588a1f3e0b2e8d917f3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FKCxTG1mDLFjtRp244.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| CRYPTOGRAPHY                | Crypto Library:: [C0059]                                                      |
|                             | Decrypt Data::AES [C0031.001]                                                 |
|                             | Encrypt Data::AES [C0027.001]                                                 |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| initialize Winsock library                            | communication/socket                                 |
| encode data using XOR (4 matches)                     | data-manipulation/encoding/xor                       |
| decrypt data using AES via x86 extensions (2 matches) | data-manipulation/encryption/aes                     |
| encrypt data using AES via x86 extensions             | data-manipulation/encryption/aes                     |
| contains PDB path                                     | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section         | executable/pe/section/tls                            |
| set environment variable                              | host-interaction/environment-variable                |
| allocate thread local storage                         | host-interaction/process                             |
| allocate RWX memory                                   | host-interaction/process/inject                      |
| linked against Crypto++                               | linking/static/cryptopp                              |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 13.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 58/71
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:43:30                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FKCxTG1mDLFjtRp244.exe
Real Name:	/66602b5fab602cb4e6f754748d249542.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	ft_exe
2	math_entropy_6
5	obfuscation_singlebyte_mov
5	executable_pe
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
70	stager_reverse_tcp_nx_ldone_x86
70	stager_bind_tcp_nx_ldone_x86
70	win32_stage_boot_winsock_conn_ldone_x86
70	win32_stage_boot_bind_read_ldone_x86
70	win32_stage_boot_reverse_read_ldone_x86
70	win32_stage_boot_winsock_conn_udp_ldone_x86
70	stager_reverse_ipv6_tcp_nx_ldone_x86
70	win32_stage_boot_bind_inlineegg_ldone_x86
70	win32_stage_boot_reverse_ldone_x86
70	win32_stage_boot_reverse_shell_revert_ldone_x86
70	win32_stage_winexec_ldone_x86
70	stager_bind_ipv6_tcp_nx_ldone_x86
70	win32_stage_boot_winsock_bind_ldone_x86
70	win32_stage_boot_reverse_shell_ldone_x86
70	win32_stage_api_ldone_x86
70	win32_stage_boot_bind_ldone_x86
70	win32_stage_boot_reverse_udp_ldone_x86
70	win32_stage_boot_reverse_inlineegg_ldone_x86
70	win32_stage_boot_bind_shell_ldone_x86
40	SEH_Save
40	SEH_Init
10	anti_dbg
20	isExecutable
10	Contains_PE_File
15	RijnDael_AES_CHAR

============================[ Scores ]============================
CAPA:	13.5
ClamAV:	0
Loki:	1689
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
29038.206433189003
==================================================================


==================================================================
Fichier HTTP-FKCxTG1mDLFjtRp244.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fcj5PP37HYFftCJrcg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 766597058149125847962eecf0c6dac0                                                   |
| sha1                   | 3c75ac9f8ff661f133acb9dd1a8e210a9a0a3d0c                                           |
| sha256                 | 6b877d6bb0fb40835fd4494003b14377feeb8a304fa1a850f0067b4c8cadeefc                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fcj5PP37HYFftCJrcg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| CREDENTIAL ACCESS      | Input Capture::GUI Input Capture \[T1056.002]\                                     |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| prompt user for credentials                          | collection/credentials                               |
| log keystrokes via polling (3 matches)               | collection/keylog                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (5 matches)  | executable/resource                                  |
| hide graphical window                                | host-interaction/gui/window/hide                     |
| create thread                                        | host-interaction/thread/create                       |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6		- Collection::Input Capture::Keylogging [T1056.001;6]

Score total: 21.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fcj5PP37HYFftCJrcg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.11 MB
Data read: 0.11 MB (ratio 1.00:1)
Time: 35.812 sec (0 m 35 s)
Start Date: 2022:02:11 13:44:59
End Date:   2022:02:11 13:45:35

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:44:59Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fcj5PP37HYFftCJrcg.exe SCORE: 179 TYPE: EXE SIZE: 113152 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f876a0f3400> 
MD5: 766597058149125847962eecf0c6dac0 
SHA1: 3c75ac9f8ff661f133acb9dd1a8e210a9a0a3d0c 
SHA256: 6b877d6bb0fb40835fd4494003b14377feeb8a304fa1a850f0067b4c8cadeefc CREATED: Fri Feb 11 13:44:59 2022 MODIFIED: Fri Feb 11 13:44:59 2022 ACCESSED: Fri Feb 11 13:45:53 2022 
REASON_1: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:45:53Z

-------- Score ----------------
Scores		Rules
.......		...............
80		keylogger
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 179

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:44:59                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fcj5PP37HYFftCJrcg.exe
Real Name:	/onexui.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6	- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
8.5	- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6	- Collection::Input Capture::Keylogging [T1056.001;6]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
80	keylogger
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	21.5
ClamAV:	0
Loki:	179
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3265.9402122237016
==================================================================


==================================================================
Fichier HTTP-Fcj5PP37HYFftCJrcg.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FIxbR62SewEvdBclmc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 004091b8024936ff322c11cf370f2184                                                   |
| sha1                   | 8208fee26d92e661a8f65a721b272ae931bc7692                                           |
| sha256                 | 6210fa6ade115dd07409cfae21683b1772d6d3fdb6b438814cacbd3588dad9e3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FIxbR62SewEvdBclmc.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| query or enumerate registry value                    | host-interaction/registry                            |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 7.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FIxbR62SewEvdBclmc.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 43.251 sec (0 m 43 s)
Start Date: 2022:02:11 13:45:54
End Date:   2022:02:11 13:46:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:45:54Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FIxbR62SewEvdBclmc.exe SCORE: 294 TYPE: EXE SIZE: 22016 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fdde98e5400> 
MD5: 004091b8024936ff322c11cf370f2184 
SHA1: 8208fee26d92e661a8f65a721b272ae931bc7692 
SHA256: 6210fa6ade115dd07409cfae21683b1772d6d3fdb6b438814cacbd3588dad9e3 CREATED: Fri Feb 11 13:45:54 2022 MODIFIED: Fri Feb 11 13:45:54 2022 ACCESSED: Fri Feb 11 13:46:48 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e81b0400004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:46:48Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		Str_Win32_Winsock2_Library
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 294

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:45:54                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FIxbR62SewEvdBclmc.exe
Real Name:	/nbtstat.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	Str_Win32_Winsock2_Library
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	7.5
ClamAV:	0
Loki:	294
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4809.23065945834
==================================================================


==================================================================
Fichier HTTP-FIxbR62SewEvdBclmc.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FwnC76xBfVp6CILN9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a198216798ca38f280dc413f8c57f2c2                                                   |
| sha1                   | bd2dfda3d3abd9684f8608c4eb1007c26cb0e200                                           |
| sha256                 | 16a7d90a578215fb1796caf1c2ad99126bfd7022f49bd6b8051e925384910712                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FwnC76xBfVp6CILN9.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (3 matches)                | collection                                           |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| write file on Windows                                | host-interaction/file-system/write                   |
| get ntdll base address                               | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1.5		- Discovery::System Location Discovery [T1614;1.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 4.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FwnC76xBfVp6CILN9.exe: Win.Countermeasure.LoaderWinGeneric-9804845-2 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FwnC76xBfVp6CILN9.exe: Win.Malware.Agent-9870952-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.29 MB
Data read: 0.28 MB (ratio 1.06:1)
Time: 43.035 sec (0 m 43 s)
Start Date: 2022:02:11 13:46:49
End Date:   2022:02:11 13:47:32

-------- Score ----------------
Scores		Rules
.......		...............
60		Win.Countermeasure.LoaderWinGeneric-9804845-2
50		Win.Malware.Agent-9870952-0

Score total: 110.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:46:50Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FwnC76xBfVp6CILN9.exe SCORE: 209 TYPE: EXE SIZE: 292864 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f53d32be400> 
MD5: a198216798ca38f280dc413f8c57f2c2 
SHA1: bd2dfda3d3abd9684f8608c4eb1007c26cb0e200 
SHA256: 16a7d90a578215fb1796caf1c2ad99126bfd7022f49bd6b8051e925384910712 CREATED: Fri Feb 11 13:46:49 2022 MODIFIED: Fri Feb 11 13:46:49 2022 ACCESSED: Fri Feb 11 13:47:38 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: Trojan_Win_Generic_v101 SUBSCORE: 50 
DESCRIPTION: not set REF: - AUTHOR: FireEye 
MATCHES: Str1: 2a00000041b817000000ba0204000089c1ff15 Str2: 817c243802040000757a48837c244017757248837c24482a75 Str3: ff15328c0400ffd32d5802000029f03 ... (truncated)
REASON_3: Yara Rule MATCH: Trojan_Win_Generic_101 SUBSCORE: 70 
DESCRIPTION: Detects FireEye Windows trojan REF: https://www.fireeye.com/blog/products-and-services/2020/12/fireeye-shares-details-of-recent-cyber-attack-actions-to-protect-community.html AUTHOR: FireEye 
MATCHES: Str1: 2a00000041b817000000ba0204000089c1ff15 Str2: 817c243802040000757a48837c244017757248837c24482a75 Str3: ff15328c0400ffd32d5802000029f03 ... (truncated)
REASON_4: Yara Rule MATCH: math_entropy_7 SUBSCORE: 2 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:47:39Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
50		Trojan_Win_Generic_v101
70		Trojan_Win_Generic_101
2		math_entropy_7
5		executable_pe
10		IsPE64
10		IsWindowsGUI
10		IsPacked
10		HasOverlay
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 209

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 41/70
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:46:49                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FwnC76xBfVp6CILN9.exe
Real Name:	/a198216798ca38f280dc413f8c57f2c2.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1.5	- Discovery::System Location Discovery [T1614;1.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
60	Win.Countermeasure.LoaderWinGeneric-9804845-2
50	Win.Malware.Agent-9870952-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
50	Trojan_Win_Generic_v101
70	Trojan_Win_Generic_101
2	math_entropy_7
5	executable_pe
10	IsPE64
10	IsWindowsGUI
10	IsPacked
10	HasOverlay
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	4.5
ClamAV:	110.0
Loki:	209
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
6787.03152939091
==================================================================


==================================================================
Fichier HTTP-FwnC76xBfVp6CILN9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FgrhS91nWEJAkPMEXa.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3808f21e56dede99bc914d90aeabe47a                                                   |
| sha1                   | 93cc73149d4bb34830a2cb2a3047e9267b9e3080                                           |
| sha256                 | 4a5ac3c6f8383cc33c795804ba5f7f5553c029bbb4a6d28f1e4d8fb5107902c1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FgrhS91nWEJAkPMEXa.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                            |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Network Share Discovery:: \[T1135]\                                                |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery :: \[T1016]\                                |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
|                        | Windows Management Instrumentation:: \[T1047]\                                     |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Debugger Detection::Timing/Delay Check QueryPerformanceCounter [B0001.033]    |
| CRYPTOGRAPHY                | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encryption Key:: [C0028]                                                      |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Analysis Tool Discovery::Process Detection [B0013.001]                        |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Console:: [C0033]                                                             |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference analysis tools strings                     | anti-analysis                                        |
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via QueryPerformanceCounter     | anti-analysis/anti-debugging/debugger-detection      |
| connect network resource                             | communication/http                                   |
| encode data using XOR (9 matches)                    | data-manipulation/encoding/xor                       |
| encrypt or decrypt via WinCrypt                      | data-manipulation/encryption                         |
| reference public RSA key                             | data-manipulation/encryption/rsa                     |
| encrypt data using Salsa20 or ChaCha (2 matches)     | data-manipulation/encryption/salsa20                 |
| accept command line arguments (3 matches)            | host-interaction/cli                                 |
| manipulate console (2 matches)                       | host-interaction/console                             |
| interact with driver via control codes               | host-interaction/driver                              |
| get common file path                                 | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| delete file                                          | host-interaction/file-system/delete                  |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| get file size                                        | host-interaction/file-system/meta                    |
| set file attributes                                  | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (5 matches)                    | host-interaction/file-system/write                   |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| get disk information (3 matches)                     | host-interaction/hardware/storage                    |
| enumerate network shares (2 matches)                 | host-interaction/network                             |
| enumerate domain computers via LDAP                  | host-interaction/network/domain                      |
| get domain controller name                           | host-interaction/network/domain                      |
| get hostname (2 matches)                             | host-interaction/os/hostname                         |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| allocate thread local storage                        | host-interaction/process                             |
| get thread local storage value                       | host-interaction/process                             |
| set thread local storage value                       | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| acquire debug privileges                             | host-interaction/process/modify                      |
| modify access privileges                             | host-interaction/process/modify                      |
| terminate process (3 matches)                        | host-interaction/process/terminate                   |
| set registry value                                   | host-interaction/registry/create                     |
| query service status                                 | host-interaction/service                             |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| enumerate services                                   | host-interaction/service/list                        |
| start service                                        | host-interaction/service/start                       |
| stop service                                         | host-interaction/service/stop                        |
| get session user name                                | host-interaction/session                             |
| create thread (3 matches)                            | host-interaction/thread/create                       |
| terminate thread                                     | host-interaction/thread/terminate                    |
| connect to WMI namespace via WbemLocator             | host-interaction/wmi                                 |
| parse PE exports (2 matches)                         | load-code/pe                                         |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
2		- Execution::Shared Modules [T1129;2]
5		- Defense Evasion::File and Directory Permissions Modification [T1222;5]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Network Configuration Discovery [T1016;3]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
4		- Discovery::Process Discovery [T1057;4]
9		- Impact::Service Stop [T1489;9]
3		- Execution::System Services::Service Execution [T1569.002;3]
4.5		- Execution::Windows Management Instrumentation [T1047;4.5]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
3		- Discovery::Account Discovery [T1087;3]

Score total: 74.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FgrhS91nWEJAkPMEXa.exe: Win.Ransomware.MountLocker-9802291-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 43.151 sec (0 m 43 s)
Start Date: 2022:02:11 13:47:40
End Date:   2022:02:11 13:48:23

-------- Score ----------------
Scores		Rules
.......		...............
80		Win.Ransomware.MountLocker-9802291-0

Score total: 80.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:47:40Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FgrhS91nWEJAkPMEXa.exe SCORE: 1054 TYPE: EXE SIZE: 68096 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f23b2d7e400> 
MD5: 3808f21e56dede99bc914d90aeabe47a 
SHA1: 93cc73149d4bb34830a2cb2a3047e9267b9e3080 
SHA256: 4a5ac3c6f8383cc33c795804ba5f7f5553c029bbb4a6d28f1e4d8fb5107902c1 CREATED: Fri Feb 11 13:47:40 2022 MODIFIED: Fri Feb 11 13:47:40 2022 ACCESSED: Fri Feb 11 13:48:32 2022 
REASON_1: Yara Rule MATCH: create_service SUBSCORE: 45 
DESCRIPTION: Create a windows service REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: CreateService Str3: ControlService Str4: StartService Str5: QueryServiceStatus
REASON_2: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: SeDebugPrivilege Str3: AdjustTokenPrivileges
REASON_3: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetDC
REASON_4: Yara Rule MATCH: spreading_share SUBSCORE: 70 
DESCRIPTION: Malware can spread east-west using share drive REF: - AUTHOR: x0r 
MATCHES: Str1: NETAPI32.dll Str2: NetShareEnum
REASON_5: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_6: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: win_mount_locker_auto SUBSCORE: 45 
DESCRIPTION: Detects win.mount_locker. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 4883f8ff74364883642420004c8d4c2468448bc7488bd3 Str2: ff156e3b00008bd885c0743b488b4d6f488d4567c744243000010000 Str3: ff15f95f00004c8d4 ... (truncated)
REASON_9: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_12: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Detect_Monitoring SUBSCORE: 50 
DESCRIPTION: Check for monitoring tools REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: procexp.exe Str2: procmon.exe
REASON_17: Yara Rule MATCH: anti_dbgtools_v1 SUBSCORE: 60 
DESCRIPTION: Checks for the presence of known debug tools REF: - AUTHOR: x0r 
MATCHES: Str1: procexp.exe Str2: procmon.exe
REASON_18: Yara Rule MATCH: anti_dbgtools SUBSCORE: 55 
DESCRIPTION: Checks for the presence of known debug tools REF: - AUTHOR: x0r 
MATCHES: Str1: procexp.exe Str2: procmon.exe
REASON_19: Yara Rule MATCH: RANSOM_mountlocker SUBSCORE: 60 
DESCRIPTION: Rule to detect Mount Locker ransomware REF: - AUTHOR: McAfee ATR Team 
MATCHES: Str1: cid=%CLIENT_ID
REASON_20: Yara Rule MATCH: MALWARE_Win_MountLocker SUBSCORE: 70 
DESCRIPTION: Detects MountLocker ransomware REF: - AUTHOR: ditekSHen 
MATCHES: Str1: ] locker.dir.check >  Str2: ] locekr.kill. Str3: ] locker.worm Str4: %CLIENT_ID% Str5: RecoveryManual.html Str6: RECOVERY MANUAL Str7 ... (truncated)
REASON_21: Yara Rule MATCH: MALWARE_Win_Quantum SUBSCORE: 70 
DESCRIPTION: Detects Quantum locker / ransomware REF: - AUTHOR: ditekSHen 
MATCHES: Str1: ERROR Str2: .log Str3: SLOW Str4: Create Str5: Integrity Str6: Disabled Str7: Deny Str8: FAST Str9: Mandatory Str10: NetGetDCName Str ... (truncated)
REASON_22: Yara Rule MATCH: RAN_MountLocker_May_2021_1 SUBSCORE: 75 
DESCRIPTION: Detect the Mountlocker ransomware REF: Internal Research AUTHOR: Arkbird_SOLG 
MATCHES: Str1: 48214d774c8d055040000048214d6f458bce488d4d7744897d6733d2c7442420000000f0ff15913b000085c00f840b020000488b4d77488d456f4889442428488d3de ... (truncated)
REASON_23: Yara Rule MATCH: dbgdetect_procs SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: procexp Str2: procmon
REASON_24: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_25: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_26: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 879538e20b82e80052dd5f7ef9ad5077
REASON_27: Yara Rule MATCH: Chacha_256_constant SUBSCORE: 15 
DESCRIPTION: Look for 256-bit key Chacha stream cipher constant REF: https://tools.ietf.org/html/rfc8439#page-8 AUTHOR: spelissier 
MATCHES: Str1: expand 32-byte k Str2: expand 3 Str3: 2-byte k
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:48:32Z

-------- Score ----------------
Scores		Rules
.......		...............
45		create_service
70		escalate_priv
65		screenshot
70		spreading_share
65		win_token
10		win_files_operation
10		ft_exe
45		win_mount_locker_auto
2		math_entropy_4
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
50		Detect_Monitoring
60		anti_dbgtools_v1
55		anti_dbgtools
60		RANSOM_mountlocker
70		MALWARE_Win_MountLocker
70		MALWARE_Win_Quantum
75		RAN_MountLocker_May_2021_1
70		dbgdetect_procs
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1
15		Chacha_256_constant

Score total: 1054

==================[ Vérification MalwareBazaar ]==================
Fichier trouvé !
Malware connu -> Score: 2000
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 54/67
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:47:40                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FgrhS91nWEJAkPMEXa.exe
Real Name:	/3808f21e56dede99bc914d90aeabe47a.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
8.5	- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
2	- Execution::Shared Modules [T1129;2]
5	- Defense Evasion::File and Directory Permissions Modification [T1222;5]
5	- Privilege Escalation::Access Token Manipulation [T1134;5]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
3	- Discovery::System Network Configuration Discovery [T1016;3]
3	- Discovery::System Owner/User Discovery [T1033;3]
1	- Discovery::System Information Discovery [T1082;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
4	- Discovery::Process Discovery [T1057;4]
9	- Impact::Service Stop [T1489;9]
3	- Execution::System Services::Service Execution [T1569.002;3]
4.5	- Execution::Windows Management Instrumentation [T1047;4.5]
2	- Discovery::File and Directory Discovery [T1083;2]
4	- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
3	- Discovery::Account Discovery [T1087;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
80	Win.Ransomware.MountLocker-9802291-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
45	create_service
70	escalate_priv
65	screenshot
70	spreading_share
65	win_token
10	win_files_operation
10	ft_exe
45	win_mount_locker_auto
2	math_entropy_4
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
50	Detect_Monitoring
60	anti_dbgtools_v1
55	anti_dbgtools
60	RANSOM_mountlocker
70	MALWARE_Win_MountLocker
70	MALWARE_Win_Quantum
75	RAN_MountLocker_May_2021_1
70	dbgdetect_procs
20	isExecutable
10	Contains_PE_File
10	Big_Numbers1
15	Chacha_256_constant

============================[ Scores ]============================
CAPA:	74.5
ClamAV:	80.0
Loki:	1054
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	2000
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
23198.38500262728
==================================================================


==================================================================
Fichier HTTP-FgrhS91nWEJAkPMEXa.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FOdcfk2jz1RkJ6LN99.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FOdcfk2jz1RkJ6LN99.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.78 MB
Data read: 0.73 MB (ratio 1.06:1)
Time: 43.412 sec (0 m 43 s)
Start Date: 2022:02:11 13:48:34
End Date:   2022:02:11 13:49:17

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:48:34Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FOdcfk2jz1RkJ6LN99.exe SCORE: 409 TYPE: EXE SIZE: 772608 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f5fec98f400> 
MD5: e24b2506af9f97069b171dc87240b2f7 
SHA1: 5718a9bcae2706e6e5e5b9d322a0d3be0e1a3558 
SHA256: 18d51bd52b4fa76870407f7ee4a0b0bd0b86c0fbdd7f00322edc50d3d4ff15d2 CREATED: Fri Feb 11 13:48:34 2022 MODIFIED: Fri Feb 11 13:48:34 2022 ACCESSED: Fri Feb 11 13:49:24 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_15: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_17: Yara Rule MATCH: skip20_sqllang_hook SUBSCORE: 60 
DESCRIPTION: YARA rule to detect if a sqllang.dll version is targeted by skip-2.0. Each byte pattern corresponds to a function hooked by skip-2.0. If _0 or _1 match, it is probably targeted as it corresponds to the hook responsible for bypassing the authentication. REF: https://www.welivesecurity.com/ AUTHOR: Mathieu Tartare <mathieu.tartare@eset.com> 
MATCHES: Str1: 8bc1488b8c24300200004833cc
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:49:26Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
60		win_mutex
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
10		anti_dbg
60		skip20_sqllang_hook
20		isExecutable
10		Contains_PE_File

Score total: 409

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e24b2506af9f97069b171dc87240b2f7                                                   |
| sha1                   | 5718a9bcae2706e6e5e5b9d322a0d3be0e1a3558                                           |
| sha256                 | 18d51bd52b4fa76870407f7ee4a0b0bd0b86c0fbdd7f00322edc50d3d4ff15d2                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FOdcfk2jz1RkJ6LN99.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
|                             | Interprocess Communication::Create Pipe [C0003.001]                           |
|                             | Interprocess Communication::Read Pipe [C0003.003]                             |
| CRYPTOGRAPHY                | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-debugging instructions (2 matches)      | anti-analysis/anti-debugging/debugger-detection      |
| get geographical location (4 matches)                | collection                                           |
| check HTTP status code (2 matches)                   | communication/http/client                            |
| create pipe                                          | communication/named-pipe/create                      |
| read pipe                                            | communication/named-pipe/read                        |
| encode data using XOR (36 matches)                   | data-manipulation/encoding/xor                       |
| hash data using murmur3 (2 matches)                  | data-manipulation/hashing/murmur                     |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (10 matches) | executable/resource                                  |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get file system object information                   | host-interaction/file-system                         |
| check if file exists (11 matches)                    | host-interaction/file-system/exists                  |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| get graphical window text (2 matches)                | host-interaction/gui/window/get-text                 |
| get disk information (3 matches)                     | host-interaction/hardware/storage                    |
| get disk size                                        | host-interaction/hardware/storage                    |
| get storage device properties (2 matches)            | host-interaction/hardware/storage                    |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| create mutex (2 matches)                             | host-interaction/mutex                               |
| get thread local storage value (2 matches)           | host-interaction/process                             |
| set thread local storage value (2 matches)           | host-interaction/process                             |
| create process on Windows (3 matches)                | host-interaction/process/create                      |
| terminate process via fastfail (14 matches)          | host-interaction/process/terminate                   |
| link many functions at runtime (2 matches)           | linking/runtime-linking                              |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
1.5		- Discovery::System Location Discovery [T1614;1.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 36.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:48:34                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FOdcfk2jz1RkJ6LN99.exe
Real Name:	/SpaceControl.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1	- Discovery::System Information Discovery [T1082;1]
3	- Execution::System Services::Service Execution [T1569.002;3]
1.5	- Discovery::System Location Discovery [T1614;1.5]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
65	screenshot
60	win_mutex
10	win_files_operation
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
10	anti_dbg
60	skip20_sqllang_hook
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	36.0
ClamAV:	0
Loki:	409
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
7200.507590554749
==================================================================


==================================================================
Fichier HTTP-FOdcfk2jz1RkJ6LN99.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fdj5uA2HWBsPTIovI1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 05db5eaffee4d667b4fde07041bbbef6                                                   |
| sha1                   | bc35edb25aceb0826c4e4f638f9fe19c1192cc84                                           |
| sha256                 | 71a4f9b800d81ff6632b9892a6a502c412c141341e46d697a8c004e2f460913b                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fdj5uA2HWBsPTIovI1.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount (9 matches)    | anti-analysis/anti-debugging/debugger-detection      |
| obfuscated with callobfuscator                       | anti-analysis/obfuscation                            |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| write file on Windows                                | host-interaction/file-system/write                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 14.5

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:50:04Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fdj5uA2HWBsPTIovI1.exe SCORE: 149 TYPE: EXE SIZE: 292864 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fc39e935400> 
MD5: 05db5eaffee4d667b4fde07041bbbef6 
SHA1: bc35edb25aceb0826c4e4f638f9fe19c1192cc84 
SHA256: 71a4f9b800d81ff6632b9892a6a502c412c141341e46d697a8c004e2f460913b CREATED: Fri Feb 11 13:50:04 2022 MODIFIED: Fri Feb 11 13:50:04 2022 ACCESSED: Fri Feb 11 13:50:42 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_7 SUBSCORE: 2 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_10: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:50:43Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_7
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		IsPacked
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 149

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fdj5uA2HWBsPTIovI1.exe: Win.Countermeasure.LoaderWinGeneric-9804845-2 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.29 MB
Data read: 0.28 MB (ratio 1.06:1)
Time: 43.255 sec (0 m 43 s)
Start Date: 2022:02:11 13:50:04
End Date:   2022:02:11 13:50:47

-------- Score ----------------
Scores		Rules
.......		...............
60		Win.Countermeasure.LoaderWinGeneric-9804845-2

Score total: 60.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 45/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:50:04                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fdj5uA2HWBsPTIovI1.exe
Real Name:	/71a4f9b800d81ff6632b9892a6a502c412c141341e46d697a8c004e2f460913b.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
8.5	- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
60	Win.Countermeasure.LoaderWinGeneric-9804845-2

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_7
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	IsPacked
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	14.5
ClamAV:	60.0
Loki:	149
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
5406.159139514047
==================================================================


==================================================================
Fichier HTTP-Fdj5uA2HWBsPTIovI1.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FERUbE3dvgyZvwXJ34.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FERUbE3dvgyZvwXJ34.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.16 MB
Data read: 0.15 MB (ratio 1.05:1)
Time: 29.204 sec (0 m 29 s)
Start Date: 2022:02:11 13:50:48
End Date:   2022:02:11 13:51:17

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 4c220a9fd4d1aee3e5861fea1ab3573e                                                   |
| sha1                   | ba6a6627917900a5740110e589c8ea602c2ba341                                           |
| sha256                 | b95769a76e3148e35b76eae351f22c1ac609c6a4fbf5e0794deeeac13b55bd1d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FERUbE3dvgyZvwXJ34.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| enumerate PE sections                                | load-code/pe                                         |
| inspect section memory permissions                   | load-code/pe                                         |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:50:48Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FERUbE3dvgyZvwXJ34.exe SCORE: 239 TYPE: EXE SIZE: 158208 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7efcb5c04400> 
MD5: 4c220a9fd4d1aee3e5861fea1ab3573e 
SHA1: ba6a6627917900a5740110e589c8ea602c2ba341 
SHA256: b95769a76e3148e35b76eae351f22c1ac609c6a4fbf5e0794deeeac13b55bd1d CREATED: Fri Feb 11 13:50:48 2022 MODIFIED: Fri Feb 11 13:50:48 2022 ACCESSED: Fri Feb 11 13:51:41 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:51:42Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 239

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/65
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:50:48                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FERUbE3dvgyZvwXJ34.exe
Real Name:	/mimofcodec.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	239
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3847.7525994311272
==================================================================


==================================================================
Fichier HTTP-FERUbE3dvgyZvwXJ34.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FOiPIq4oBWWilWMUbk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a117edc0e74ab4770acf7f7e86e573f7                                                   |
| sha1                   | 5ceffb1a5e05e52aafcbc2d44e1e8445440706f3                                           |
| sha256                 | b5bc4fce58403ea554691db678e6c8c448310fe59990990f0e37cd4357567d37                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FOiPIq4oBWWilWMUbk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                             |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                       |
|                        | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Location Discovery:: \[T1614]\                                               |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| spoof parent PID                                     | anti-analysis/anti-forensic                          |
| get geographical location                            | collection                                           |
| log keystrokes via polling                           | collection/keylog                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| query environment variable (5 matches)               | host-interaction/environment-variable                |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists (2 matches)                     | host-interaction/file-system/exists                  |
| get file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| find graphical window (2 matches)                    | host-interaction/gui/window/find                     |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| check mutex (7 matches)                              | host-interaction/mutex                               |
| create mutex                                         | host-interaction/mutex                               |
| get system information on Windows                    | host-interaction/os/info                             |
| read process memory                                  | host-interaction/process                             |
| create process on Windows (4 matches)                | host-interaction/process/create                      |
| enumerate process modules                            | host-interaction/process/modules/list                |
| terminate process via fastfail (5 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (12 matches)       | host-interaction/registry                            |
| delete registry key (3 matches)                      | host-interaction/registry/delete                     |
| delete registry value                                | host-interaction/registry/delete                     |
| get session user name                                | host-interaction/session                             |
| get token membership                                 | host-interaction/session                             |
| link function at runtime on Windows (3 matches)      | linking/runtime-linking                              |
| parse PE header (8 matches)                          | load-code/pe                                         |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
1.5		- Discovery::System Location Discovery [T1614;1.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
3		- Discovery::Account Discovery [T1087;3]

Score total: 43.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FOiPIq4oBWWilWMUbk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.12 MB
Data read: 0.12 MB (ratio 1.00:1)
Time: 42.053 sec (0 m 42 s)
Start Date: 2022:02:11 13:51:43
End Date:   2022:02:11 13:52:25

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:51:43Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FOiPIq4oBWWilWMUbk.exe SCORE: 499 TYPE: EXE SIZE: 126464 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7efdcc99a400> 
MD5: a117edc0e74ab4770acf7f7e86e573f7 
SHA1: 5ceffb1a5e05e52aafcbc2d44e1e8445440706f3 
SHA256: b5bc4fce58403ea554691db678e6c8c448310fe59990990f0e37cd4357567d37 CREATED: Fri Feb 11 13:51:43 2022 MODIFIED: Fri Feb 11 13:51:43 2022 ACCESSED: Fri Feb 11 13:52:32 2022 
REASON_1: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e84b0400004883c428e97efdffffcccccccccccccccccccccccccccc
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_10: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:52:32Z

-------- Score ----------------
Scores		Rules
.......		...............
80		keylogger
60		win_mutex
20		win_registry
65		win_token
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 499

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/69
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:51:43                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FOiPIq4oBWWilWMUbk.exe
Real Name:	/Utilman.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
3	- Discovery::System Owner/User Discovery [T1033;3]
1	- Discovery::System Information Discovery [T1082;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1	- Discovery::Query Registry [T1012;1]
1.5	- Discovery::System Location Discovery [T1614;1.5]
6	- Collection::Input Capture::Keylogging [T1056.001;6]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4	- Discovery::Process Discovery [T1057;4]
3	- Discovery::Account Discovery [T1087;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
80	keylogger
60	win_mutex
20	win_registry
65	win_token
10	ft_exe
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	43.0
ClamAV:	0
Loki:	499
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
8766.579825817573
==================================================================


==================================================================
Fichier HTTP-FOiPIq4oBWWilWMUbk.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FU1bIO5UXKe6GjhQi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FU1bIO5UXKe6GjhQi.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.48 MB
Data read: 0.46 MB (ratio 1.05:1)
Time: 42.850 sec (0 m 42 s)
Start Date: 2022:02:11 13:52:34
End Date:   2022:02:11 13:53:17

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:52:34Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FU1bIO5UXKe6GjhQi.exe SCORE: 419 TYPE: EXE SIZE: 486736 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f54b2c68400> 
MD5: 4b944d93d5c75ef05f64ccb9d877d9f5 
SHA1: f343691790795f06b22a1f6995c53124fb70f8f2 
SHA256: 5cbb22f583517b32f8bdca9e5d8083761c8a414588b8506adf5c5761a528dfbe CREATED: Fri Feb 11 13:52:34 2022 MODIFIED: Fri Feb 11 13:52:34 2022 ACCESSED: Fri Feb 11 13:53:28 2022 
REASON_1: Yara Rule MATCH: network_dropper SUBSCORE: 65 
DESCRIPTION: File downloader/dropper REF: - AUTHOR: x0r 
MATCHES: Str1: urlmon.dll Str2: URLDownloadToFile
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_4: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DESCRIPTION\System Str2: identifier
REASON_17: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DESCRIPTION\System Str2: identifier
REASON_18: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_19: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:53:29Z

-------- Score ----------------
Scores		Rules
.......		...............
65		network_dropper
60		win_mutex
10		Str_Win32_Http_API
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File
5		BASE64_table

Score total: 419

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 4b944d93d5c75ef05f64ccb9d877d9f5                                                   |
| sha1                   | f343691790795f06b22a1f6995c53124fb70f8f2                                           |
| sha256                 | 5cbb22f583517b32f8bdca9e5d8083761c8a414588b8506adf5c5761a528dfbe                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FU1bIO5UXKe6GjhQi.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Download URL [C0002.006]                                  |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | HTTP Communication::Set Header [C0002.013]                                    |
|                             | HTTP Communication::WinHTTP [C0002.008]                                       |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| receive data                                         | communication                                        |
| initialize WinHTTP library                           | communication/http                                   |
| read HTTP header (2 matches)                         | communication/http                                   |
| set HTTP header (2 matches)                          | communication/http                                   |
| check HTTP status code                               | communication/http/client                            |
| prepare HTTP request                                 | communication/http/client                            |
| receive HTTP response (3 matches)                    | communication/http/client                            |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (14 matches)                   | data-manipulation/encoding/xor                       |
| hash data using fnv (14 matches)                     | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| linked against CPP regex library                     | linking/static/cppregex                              |
| enumerate PE sections (2 matches)                    | load-code/pe                                         |
| parse PE header (11 matches)                         | load-code/pe                                         |
| persist via Run registry key (2 matches)             | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 24.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:52:34                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FU1bIO5UXKe6GjhQi.exe
Real Name:	/QualityUpdateAssistant.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
65	network_dropper
60	win_mutex
10	Str_Win32_Http_API
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File
5	BASE64_table

============================[ Scores ]============================
CAPA:	24.0
ClamAV:	0
Loki:	419
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
7119.565432004595
==================================================================


==================================================================
Fichier HTTP-FU1bIO5UXKe6GjhQi.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FCfxjc4rdOc7Dc29P4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ffeae4a391a1d5203bd04b4161557227                                                   |
| sha1                   | 7c7013dd8def75c94828b40ffa139b6d89ec4683                                           |
| sha256                 | 81fc45c95bdb421257645b4ff91a6afc82201d3ffe570c059994d79ff1484f90                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FCfxjc4rdOc7Dc29P4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                          |
|                        | Input Capture::Keylogging \[T1056.001]\                                             |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                             |
|                        | Hide Artifacts::Hidden Window \[T1564.003]\                                         |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | System Information Discovery:: \[T1082]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
|                        | Resource Hijacking:: \[T1496]\                                                      |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Send Data [C0002.005]                                     |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Encryption Key::Import Public Key [C0028.001]                                 |
|                             | Generate Pseudo-random Sequence::Mersenne Twister [C0021.005]                 |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+--------------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                                   | NAMESPACE                                            |
|--------------------------------------------------------------+------------------------------------------------------|
| inspect load icon resource                                   | anti-analysis                                        |
| log keystrokes via polling (3 matches)                       | collection/keylog                                    |
| receive data                                                 | communication                                        |
| send data (2 matches)                                        | communication                                        |
| connect to HTTP server                                       | communication/http/client                            |
| create HTTP request                                          | communication/http/client                            |
| encode data using XOR (15 matches)                           | data-manipulation/encoding/xor                       |
| create new key via CryptAcquireContext (3 matches)           | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt (4 matches)                  | data-manipulation/encryption                         |
| import public key                                            | data-manipulation/encryption                         |
| encrypt data using AES via WinAPI (2 matches)                | data-manipulation/encryption/aes                     |
| reference public RSA key                                     | data-manipulation/encryption/rsa                     |
| hash data via WinCrypt                                       | data-manipulation/hashing                            |
| hash data using SHA1                                         | data-manipulation/hashing/sha1                       |
| hash data using SHA1 via WinCrypt                            | data-manipulation/hashing/sha1                       |
| generate random numbers using a Mersenne Twister (3 matches) | data-manipulation/prng/mersenne                      |
| contain a resource (.rsrc) section                           | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (3 matches)          | executable/resource                                  |
| accept command line arguments (2 matches)                    | host-interaction/cli                                 |
| replace clipboard data                                       | host-interaction/clipboard                           |
| query environment variable (2 matches)                       | host-interaction/environment-variable                |
| get common file path (3 matches)                             | host-interaction/file-system                         |
| get file system object information                           | host-interaction/file-system                         |
| copy file                                                    | host-interaction/file-system/copy                    |
| delete file (5 matches)                                      | host-interaction/file-system/delete                  |
| check if file exists                                         | host-interaction/file-system/exists                  |
| enumerate files recursively                                  | host-interaction/file-system/files/list              |
| get file attributes                                          | host-interaction/file-system/meta                    |
| get file size (2 matches)                                    | host-interaction/file-system/meta                    |
| set file attributes (9 matches)                              | host-interaction/file-system/meta                    |
| move file                                                    | host-interaction/file-system/move                    |
| read file on Windows (2 matches)                             | host-interaction/file-system/read                    |
| write file on Windows (5 matches)                            | host-interaction/file-system/write                   |
| get graphical window text (2 matches)                        | host-interaction/gui/window/get-text                 |
| hide graphical window (6 matches)                            | host-interaction/gui/window/hide                     |
| get disk information (2 matches)                             | host-interaction/hardware/storage                    |
| get disk size (2 matches)                                    | host-interaction/hardware/storage                    |
| check mutex and exit                                         | host-interaction/mutex                               |
| get hostname                                                 | host-interaction/os/hostname                         |
| get system information on Windows                            | host-interaction/os/info                             |
| check OS version                                             | host-interaction/os/version                          |
| create process on Windows (5 matches)                        | host-interaction/process/create                      |
| terminate process                                            | host-interaction/process/terminate                   |
| query or enumerate registry key                              | host-interaction/registry                            |
| query or enumerate registry value (8 matches)                | host-interaction/registry                            |
| delete registry key                                          | host-interaction/registry/delete                     |
| delete registry value (2 matches)                            | host-interaction/registry/delete                     |
| create thread                                                | host-interaction/thread/create                       |
| resume thread                                                | host-interaction/thread/resume                       |
| mine cryptocurrency                                          | impact/cryptocurrency                                |
| link function at runtime on Windows (7 matches)              | linking/runtime-linking                              |
| parse PE exports                                             | load-code/pe                                         |
| parse PE header (7 matches)                                  | load-code/pe                                         |
| persist via Run registry key (3 matches)                     | persistence/registry/run                             |
+--------------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
4		- Execution::Command and Scripting Interpreter [T1059;4]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
5		- Defense Evasion::File and Directory Permissions Modification [T1222;5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
6		- Collection::Clipboard Data [T1115;6]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
8		- Impact::Resource Hijacking [T1496;8]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 75.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FCfxjc4rdOc7Dc29P4.exe: Win.Trojan.Cryptolocker-2 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.34 MB
Data read: 0.33 MB (ratio 1.04:1)
Time: 43.889 sec (0 m 43 s)
Start Date: 2022:02:11 13:54:15
End Date:   2022:02:11 13:54:59

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Cryptolocker-2

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:54:15Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FCfxjc4rdOc7Dc29P4.exe SCORE: 729 TYPE: EXE SIZE: 348160 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f75a4c94400> 
MD5: ffeae4a391a1d5203bd04b4161557227 
SHA1: 7c7013dd8def75c94828b40ffa139b6d89ec4683 
SHA256: 81fc45c95bdb421257645b4ff91a6afc82201d3ffe570c059994d79ff1484f90 CREATED: Fri Feb 11 13:54:15 2022 MODIFIED: Fri Feb 11 13:54:15 2022 ACCESSED: Fri Feb 11 13:55:09 2022 
REASON_1: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: InternetWriteFile Str6: HttpOpenRequest Str7: HttpS ... (truncated)
REASON_2: Yara Rule MATCH: network_dga SUBSCORE: 45 
DESCRIPTION: Communication using dga REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: WININET.dll Str3: CRYPT32.dll Str4: SystemTimeToFileTime Str5: GetSystemTime Str6: CryptCreateHash Str7: CryptAcqu ... (truncated)
REASON_3: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_4: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_5: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_6: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_7: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_8: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_9: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_10: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_11: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: win_cryptolocker_auto SUBSCORE: 45 
DESCRIPTION: Detects win.cryptolocker. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 8b47048d140833c93bc273168d9b00000000 Str2: 8bf1578b46088d3c85040000008b460485ff751e Str3: 8bec8b45085356578bf98b5704 Str4: eb096a006a ... (truncated)
REASON_13: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 2 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_15: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_19: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_21: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_22: Yara Rule MATCH: Win32_Ransomware_CryptoLocker SUBSCORE: 60 
DESCRIPTION: Yara rule that detects CryptoLocker ransomware. REF: - AUTHOR: ReversingLabs 
MATCHES: Str1: 558bec83ec4053568bc1578945f4e82dfdffff84c00f84620100008b5d0832c00f57c08845fb660f1345c4eb038d490084c074086a00ff15a82141006a006a00ff75c ... (truncated)
REASON_23: Yara Rule MATCH: ransomware_windows_cryptolocker SUBSCORE: 85 
DESCRIPTION: The CryptoLocker malware propagated via infected email attachments, and via an existing botnet; when activated, the malware encrypts files stored on local and mounted network drives REF: https://www.secureworks.com/research/cryptolocker-ransomware AUTHOR: @fusionrace 
MATCHES: Str1: bb to select the method of payment and the currency. Str2: Where can I purchase a MoneyPak? Str3: Ukash is electronic cash and e-comm ... (truncated)
REASON_24: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_25: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_26: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:55:10Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_http
45		network_dga
65		screenshot
80		keylogger
60		win_mutex
20		win_registry
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
45		win_cryptolocker_auto
2		math_entropy_close_8
5		executable_pe
10		IsPE32
10		IsWindowsGUI
10		IsPacked
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
40		SEH_Init
60		Win32_Ransomware_CryptoLocker
85		ransomware_windows_cryptolocker
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API

Score total: 729

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 50/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:54:15                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FCfxjc4rdOc7Dc29P4.exe
Real Name:	/ffeae4a391a1d5203bd04b4161557227.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6	- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
4	- Execution::Command and Scripting Interpreter [T1059;4]
4	- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
5	- Defense Evasion::File and Directory Permissions Modification [T1222;5]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
6	- Collection::Clipboard Data [T1115;6]
1	- Discovery::System Information Discovery [T1082;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1	- Discovery::Query Registry [T1012;1]
8	- Impact::Resource Hijacking [T1496;8]
6	- Collection::Input Capture::Keylogging [T1056.001;6]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
45	Win.Trojan.Cryptolocker-2

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
45	network_http
45	network_dga
65	screenshot
80	keylogger
60	win_mutex
20	win_registry
10	win_files_operation
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	Str_Win32_Http_API
10	ft_exe
45	win_cryptolocker_auto
2	math_entropy_close_8
5	executable_pe
10	IsPE32
10	IsWindowsGUI
10	IsPacked
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
40	SEH_Init
60	Win32_Ransomware_CryptoLocker
85	ransomware_windows_cryptolocker
20	isExecutable
10	Contains_PE_File
20	Advapi_Hash_API

============================[ Scores ]============================
CAPA:	75.5
ClamAV:	45.0
Loki:	729
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
15626.810856150398
==================================================================


==================================================================
Fichier HTTP-FCfxjc4rdOc7Dc29P4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FfnWLSzWgtwOR0pP.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ba947eb07d8c823949316a97364d060f                                                   |
| sha1                   | fc28eb7c35d2652df0ea88366489bdc5d1b1c3f6                                           |
| sha256                 | 547c396ad518ed087962182c01608c53d08ad61fcfaf63390cddea1d175b1a33                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FfnWLSzWgtwOR0pP.exe                          |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Execution Guardrails::Runs as Service [E1480.m07]                             |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Set Header [C0002.013]                                    |
|                             | HTTP Communication::WinHTTP [C0002.008]                                       |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DEFENSE EVASION             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| initialize WinHTTP library                           | communication/http                                   |
| set HTTP header                                      | communication/http                                   |
| prepare HTTP request                                 | communication/http/client                            |
| receive HTTP response                                | communication/http/client                            |
| create new key via CryptAcquireContext (3 matches)   | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt                      | data-manipulation/encryption                         |
| encrypt data using AES via WinAPI                    | data-manipulation/encryption/aes                     |
| hash data via WinCrypt                               | data-manipulation/hashing                            |
| hash data with MD5                                   | data-manipulation/hashing/md5                        |
| hash data using SHA1                                 | data-manipulation/hashing/sha1                       |
| hash data using SHA1 via WinCrypt                    | data-manipulation/hashing/sha1                       |
| generate random numbers via WinAPI (2 matches)       | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes               | host-interaction/driver                              |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| create directory (2 matches)                         | host-interaction/file-system/create                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| read file on Windows (2 matches)                     | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| create process on Windows                            | host-interaction/process/create                      |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| query service status                                 | host-interaction/service                             |
| run as service                                       | host-interaction/service                             |
| start service (2 matches)                            | host-interaction/service/start                       |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::Query Registry [T1012;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 25.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FfnWLSzWgtwOR0pP.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 34.870 sec (0 m 34 s)
Start Date: 2022:02:11 13:55:11
End Date:   2022:02:11 13:55:46

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x86 in position 36: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 62: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:55:11Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FfnWLSzWgtwOR0pP.exe SCORE: 225 TYPE: EXE SIZE: 38120 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fc6ad489400> 
MD5: ba947eb07d8c823949316a97364d060f 
SHA1: fc28eb7c35d2652df0ea88366489bdc5d1b1c3f6 
SHA256: 547c396ad518ed087962182c01608c53d08ad61fcfaf63390cddea1d175b1a33 CREATED: Fri Feb 11 13:55:11 2022 MODIFIED: Fri Feb 11 13:55:11 2022 ACCESSED: Fri Feb 11 13:56:05 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegCloseKey
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: FindClose
REASON_3: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_4: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: db_connection SUBSCORE: 1 
DESCRIPTION: not set REF: https://github.com/kevthehermit/PasteHunter AUTHOR: @KevTheHermit 
MATCHES: Str1: 687474703a2f2f6f6373702e64696769636572742e636f6d304906082b06010505073002863d687474703a2f2f636163657274732e64696769636572742e636f6d2f4 ... (truncated)
REASON_18: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
REASON_19: Yara Rule MATCH: MD5_Constants SUBSCORE: 20 
DESCRIPTION: Look for MD5 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: 78a46ad7
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:56:05Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
10		Str_Win32_Http_API
10		misc_pe_signature
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsWindowsGUI
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File
1		db_connection
20		Advapi_Hash_API
20		MD5_Constants

Score total: 225

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:55:11                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FfnWLSzWgtwOR0pP.exe
Real Name:	/ba947eb07d8c823949316a97364d060f.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1	- Discovery::Query Registry [T1012;1]
3	- Execution::System Services::Service Execution [T1569.002;3]
2	- Discovery::File and Directory Discovery [T1083;2]
4	- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
20	win_registry
10	win_files_operation
10	Str_Win32_Http_API
10	misc_pe_signature
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsWindowsGUI
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File
1	db_connection
20	Advapi_Hash_API
20	MD5_Constants

============================[ Scores ]============================
CAPA:	25.0
ClamAV:	0
Loki:	225
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4064.825261779725
==================================================================


==================================================================
Fichier HTTP-FfnWLSzWgtwOR0pP.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FV40VL3DN8fD2mLrb5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 64f5611cc62e65748d140e6f288ce1ea                                                   |
| sha1                   | d337d3576ae4b7495f1d58926868af8bf296cf87                                           |
| sha256                 | ec1dc1a2ee200da0c787328df4fb91a2b978fd09ca1f83f3e55994c0f9ba1d11                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FV40VL3DN8fD2mLrb5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| check mutex and exit                                 | host-interaction/mutex                               |
| access PE header                                     | load-code/pe                                         |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 7.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FV40VL3DN8fD2mLrb5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 35.672 sec (0 m 35 s)
Start Date: 2022:02:11 13:56:06
End Date:   2022:02:11 13:56:42

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:56:06Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FV40VL3DN8fD2mLrb5.exe SCORE: 284 TYPE: EXE SIZE: 14848 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fba9175c400> 
MD5: 64f5611cc62e65748d140e6f288ce1ea 
SHA1: d337d3576ae4b7495f1d58926868af8bf296cf87 
SHA256: ec1dc1a2ee200da0c787328df4fb91a2b978fd09ca1f83f3e55994c0f9ba1d11 CREATED: Fri Feb 11 13:56:06 2022 MODIFIED: Fri Feb 11 13:56:06 2022 ACCESSED: Fri Feb 11 13:57:00 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:57:00Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
65		win_token
10		ft_exe
2		math_entropy_4
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 284

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:56:06                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FV40VL3DN8fD2mLrb5.exe
Real Name:	/efsui.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
65	win_token
10	ft_exe
2	math_entropy_4
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	7.0
ClamAV:	0
Loki:	284
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4640.765028637384
==================================================================


==================================================================
Fichier HTTP-FV40VL3DN8fD2mLrb5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F0KXPi2cENqNW71BZd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9db13dadd1f105cdb739a3243a1463cf                                                   |
| sha1                   | a24eb7199732b56cedf040a594d3dff8eabfd285                                           |
| sha256                 | cfdd7cc431d1ed6ca72b43292daad839066425661b5a7fe30a680ae6735cfd3a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F0KXPi2cENqNW71BZd.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable                           | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| get hostname                                         | host-interaction/os/hostname                         |
| create process on Windows (2 matches)                | host-interaction/process/create                      |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F0KXPi2cENqNW71BZd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 42.922 sec (0 m 42 s)
Start Date: 2022:02:11 13:57:01
End Date:   2022:02:11 13:57:44

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:57:02Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F0KXPi2cENqNW71BZd.exe SCORE: 159 TYPE: EXE SIZE: 20480 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f29ace28400> 
MD5: 9db13dadd1f105cdb739a3243a1463cf 
SHA1: a24eb7199732b56cedf040a594d3dff8eabfd285 
SHA256: cfdd7cc431d1ed6ca72b43292daad839066425661b5a7fe30a680ae6735cfd3a CREATED: Fri Feb 11 13:57:01 2022 MODIFIED: Fri Feb 11 13:57:01 2022 ACCESSED: Fri Feb 11 13:57:55 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:57:56Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 159

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/69
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:57:01                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F0KXPi2cENqNW71BZd.exe
Real Name:	/runas.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
1	- Discovery::System Information Discovery [T1082;1]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	10.0
ClamAV:	0
Loki:	159
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
2719.506407510058
==================================================================


==================================================================
Fichier HTTP-F0KXPi2cENqNW71BZd.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FMf7Nf2LGmaydHxUF8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 690a9f472f6aafba0e90bedab91366c2                                                   |
| sha1                   | 8f4e4a8634d704fd98d6df491149cdb472ba30ab                                           |
| sha256                 | 44b1c84811495b426ec69a15888d5824a894421df052cc378fd6ada5c32a112f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FMf7Nf2LGmaydHxUF8.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (5 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FMf7Nf2LGmaydHxUF8.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 42.231 sec (0 m 42 s)
Start Date: 2022:02:11 13:57:57
End Date:   2022:02:11 13:58:39

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:57:57Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FMf7Nf2LGmaydHxUF8.exe SCORE: 229 TYPE: EXE SIZE: 23552 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa2fcab3400> 
MD5: 690a9f472f6aafba0e90bedab91366c2 
SHA1: 8f4e4a8634d704fd98d6df491149cdb472ba30ab 
SHA256: 44b1c84811495b426ec69a15888d5824a894421df052cc378fd6ada5c32a112f CREATED: Fri Feb 11 13:57:57 2022 MODIFIED: Fri Feb 11 13:57:57 2022 ACCESSED: Fri Feb 11 13:58:47 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e81b0500004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:58:47Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:57:57                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FMf7Nf2LGmaydHxUF8.exe
Real Name:	/rwinsta.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
1	- Discovery::System Information Discovery [T1082;1]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	10.0
ClamAV:	0
Loki:	229
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3828.9316422328375
==================================================================


==================================================================
Fichier HTTP-FMf7Nf2LGmaydHxUF8.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FAqRo52W0ADJCfhr4k.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6db032025bd266e5a3a52259f57f9247                                                   |
| sha1                   | 700463b333e6f007018d80048921187987840b5b                                           |
| sha256                 | 71d8a301c01f61d1bb69784d823a8040fa43cf3f063325b68e97b47cc3e3814c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FAqRo52W0ADJCfhr4k.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FAqRo52W0ADJCfhr4k.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 33.519 sec (0 m 33 s)
Start Date: 2022:02:11 13:58:49
End Date:   2022:02:11 13:59:22

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:58:49Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FAqRo52W0ADJCfhr4k.exe SCORE: 264 TYPE: EXE SIZE: 40960 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fc5fcde8400> 
MD5: 6db032025bd266e5a3a52259f57f9247 
SHA1: 700463b333e6f007018d80048921187987840b5b 
SHA256: 71d8a301c01f61d1bb69784d823a8040fa43cf3f063325b68e97b47cc3e3814c CREATED: Fri Feb 11 13:58:49 2022 MODIFIED: Fri Feb 11 13:58:49 2022 ACCESSED: Fri Feb 11 13:59:42 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T12:59:43Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 264

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:58:49                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FAqRo52W0ADJCfhr4k.exe
Real Name:	/SpectrumSyncClient.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	2.0
ClamAV:	0
Loki:	264
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4224.023274396717
==================================================================


==================================================================
Fichier HTTP-FAqRo52W0ADJCfhr4k.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FbAlwDoRRHzH4FEi2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FbAlwDoRRHzH4FEi2.exe: Win.Exploit.CVE_2017_0213-6306933-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 41.571 sec (0 m 41 s)
Start Date: 2022:02:11 13:59:44
End Date:   2022:02:11 14:00:25

-------- Score ----------------
Scores		Rules
.......		...............
25		Win.Exploit.CVE_2017_0213-6306933-0

Score total: 25.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x91 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcf in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa5 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xae in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T12:59:44Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FbAlwDoRRHzH4FEi2.exe SCORE: 429 TYPE: EXE SIZE: 55808 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f033ddcf400> 
MD5: 1195d0d18be9362fb8dd9e1738404c9d 
SHA1: ef02cc3dbdff915c9149aef86911b4e780b89ae6 
SHA256: dd79b2abc21e766fe3076038482ded43e5069a1af9e0ad29e06dce387bfae900 CREATED: Fri Feb 11 13:59:44 2022 MODIFIED: Fri Feb 11 13:59:44 2022 ACCESSED: Fri Feb 11 14:00:38 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: DuplicateTokenEx Str3: AdjustTokenPrivileges Str4: OpenProcessToken
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: Ran_Mem_RagnarLocker_Nov_2020_1 SUBSCORE: 75 
DESCRIPTION: Detect memory artefacts of the Ragnarlocker ransomware (Nov 2020) REF: Internal Research AUTHOR: Arkbird_SOLG 
MATCHES: Str1: \.\PHYSICALDRIVE%d Str2: bootfont.bin Str3: bootsect.bak Str4: bootmgr.efi Str5: Internet Explorer Str6:   </trustInfo> Str7: Tor br ... (truncated)
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Crypt32_CryptBinaryToString_API SUBSCORE: 25 
DESCRIPTION: Looks for crypt32 CryptBinaryToStringA function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: CRYPT32.dll Str2: CryptBinaryToStringA
REASON_18: Yara Rule MATCH: SHA512_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA384/SHA512 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: 982f8a42 Str2: 91443771 Str3: cffbc0b5 Str4: a5dbb5e9 Str5: 22ae28d7
REASON_19: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:00:38Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
65		win_token
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
75		Ran_Mem_RagnarLocker_Nov_2020_1
20		isExecutable
10		Contains_PE_File
25		Crypt32_CryptBinaryToString_API
20		SHA512_Constants
20		SHA2_BLAKE2_IVs

Score total: 429

==================[ Vérification MalwareBazaar ]==================
Fichier trouvé !
Malware connu -> Score: 2000
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 58/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 13:59:44                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FbAlwDoRRHzH4FEi2.exe
Real Name:	/1195d0d18be9362fb8dd9e1738404c9d.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
25	Win.Exploit.CVE_2017_0213-6306933-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
70	escalate_priv
20	win_registry
65	win_token
10	win_files_operation
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE32
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
75	Ran_Mem_RagnarLocker_Nov_2020_1
20	isExecutable
10	Contains_PE_File
25	Crypt32_CryptBinaryToString_API
20	SHA512_Constants
20	SHA2_BLAKE2_IVs

============================[ Scores ]============================
CAPA:	0
ClamAV:	25.0
Loki:	429
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	2000
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
11113.923148606718
==================================================================


==================================================================
Fichier HTTP-FbAlwDoRRHzH4FEi2.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FXycKOpphNeXoeSM9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 37f9f0d495cebf0359d06cf96e85a51f                                                   |
| sha1                   | b4e674db12ab0c2d39260dab1a7779d9947a4908                                           |
| sha256                 | 8958aec70d263062a01f77a71e2787275470340d0d39cce267b800ef09dd1538                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FXycKOpphNeXoeSM9.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
|                             | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)  | executable/resource                                  |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| create directory                                     | host-interaction/file-system/create                  |
| delete directory                                     | host-interaction/file-system/delete                  |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| read .ini file                                       | host-interaction/file-system/read                    |
| find graphical window                                | host-interaction/gui/window/find                     |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| access the Windows event log                         | host-interaction/log/winevt/access                   |
| check mutex and exit                                 | host-interaction/mutex                               |
| create process on Windows                            | host-interaction/process/create                      |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry value (6 matches)        | host-interaction/registry                            |
| set registry value (6 matches)                       | host-interaction/registry/create                     |
| delete registry key                                  | host-interaction/registry/delete                     |
| delete registry value (2 matches)                    | host-interaction/registry/delete                     |
| query service status                                 | host-interaction/service                             |
| modify service                                       | host-interaction/service/modify                      |
| start service                                        | host-interaction/service/start                       |
| stop service                                         | host-interaction/service/stop                        |
| link function at runtime on Windows (4 matches)      | linking/runtime-linking                              |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
9		- Impact::Service Stop [T1489;9]
3		- Execution::System Services::Service Execution [T1569.002;3]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 37.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FXycKOpphNeXoeSM9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.21 MB
Data read: 0.20 MB (ratio 1.04:1)
Time: 42.744 sec (0 m 42 s)
Start Date: 2022:02:11 14:00:39
End Date:   2022:02:11 14:01:22

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:00:40Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FXycKOpphNeXoeSM9.exe SCORE: 224 TYPE: EXE SIZE: 210944 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3798260400> 
MD5: 37f9f0d495cebf0359d06cf96e85a51f 
SHA1: b4e674db12ab0c2d39260dab1a7779d9947a4908 
SHA256: 8958aec70d263062a01f77a71e2787275470340d0d39cce267b800ef09dd1538 CREATED: Fri Feb 11 14:00:39 2022 MODIFIED: Fri Feb 11 14:00:39 2022 ACCESSED: Fri Feb 11 14:01:29 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: IsDebuggerPresent Str4: OutputDebugString
REASON_14: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:01:30Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
20		win_registry
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 224

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:00:39                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FXycKOpphNeXoeSM9.exe
Real Name:	/sti_ci.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
9	- Impact::Service Stop [T1489;9]
3	- Execution::System Services::Service Execution [T1569.002;3]
2	- Discovery::File and Directory Discovery [T1083;2]
4	- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
20	win_registry
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsDLL
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	37.5
ClamAV:	0
Loki:	224
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
4298.384119226223
==================================================================


==================================================================
Fichier HTTP-FXycKOpphNeXoeSM9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FCdp1U3vr6ooi8tG0i.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e88b0d6398970e74de1de457b971003f                                                   |
| sha1                   | 861185d8d7100db4acc6f1f18e67cb360e7d109c                                           |
| sha256                 | 0c3031f630adc6cdd7b877fa1c2982909cde01dff612db5dd7df58cc778dd919                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FCdp1U3vr6ooi8tG0i.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::OutputDebugString [B0001.016]                             |
|                             | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for OutputDebugString error                    | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB BeingDebugged flag                     | anti-analysis/anti-debugging/debugger-detection      |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| find graphical window                                | host-interaction/gui/window/find                     |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| create thread                                        | host-interaction/thread/create                       |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
4		- Discovery::Application Window Discovery [T1010;4]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 11.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FCdp1U3vr6ooi8tG0i.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 43.439 sec (0 m 43 s)
Start Date: 2022:02:11 14:01:31
End Date:   2022:02:11 14:02:14

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 24/69
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:01:31                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FCdp1U3vr6ooi8tG0i.exe
Real Name:	/Practical Malware Analysis Lab 16-02.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
4	- Discovery::Application Window Discovery [T1010;4]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	ft_exe
2	math_entropy_4
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Armadillo_v4x
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsConsole
10	HasRichSignature
2	PE_File
30	Check_OutputDebugStringA_iat_v1
30	Check_FindWindowA_iat_v1
40	SEH_Save
40	SEH_Init
30	Check_OutputDebugStringA_iat
20	Check_FindWindowA_iat
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	11.5
ClamAV:	0
Loki:	709
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
13466.347900770716
==================================================================


==================================================================
Fichier HTTP-FCdp1U3vr6ooi8tG0i.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FufX713gOIaNvApHh5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f3edff85de5fd002692d54a04bcb1c09                                                   |
| sha1                   | 4c844c5b0ee7cb230c9c28290d079143e00cb216                                           |
| sha256                 | caf29650446db3842e1c1e8e5e1bafadaf90fc82c5c37b9e2c75a089b7476131                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FufX713gOIaNvApHh5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Delete Directory:: [C0048]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes (4 matches)   | host-interaction/driver                              |
| delete directory                                     | host-interaction/file-system/delete                  |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 15.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FufX713gOIaNvApHh5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 35.536 sec (0 m 35 s)
Start Date: 2022:02:11 14:02:25
End Date:   2022:02:11 14:03:01

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:02:26Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FufX713gOIaNvApHh5.exe SCORE: 229 TYPE: EXE SIZE: 18944 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f92e64d2400> 
MD5: f3edff85de5fd002692d54a04bcb1c09 
SHA1: 4c844c5b0ee7cb230c9c28290d079143e00cb216 
SHA256: caf29650446db3842e1c1e8e5e1bafadaf90fc82c5c37b9e2c75a089b7476131 CREATED: Fri Feb 11 14:02:25 2022 MODIFIED: Fri Feb 11 14:02:25 2022 ACCESSED: Fri Feb 11 14:03:07 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e81b0500004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:03:07Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/65
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:02:25                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FufX713gOIaNvApHh5.exe
Real Name:	/mountvol.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Discovery::System Information Discovery [T1082;1]
3	- Execution::System Services::Service Execution [T1569.002;3]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	15.0
ClamAV:	0
Loki:	229
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3928.6947579812813
==================================================================


==================================================================
Fichier HTTP-FufX713gOIaNvApHh5.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FnaOHH2Qa7op9aXWNh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 34404a3fb9804977c6ab86cb991fb130                                                   |
| sha1                   | b345e6fae155bfaf79c67b38cf488bb17d5be56d                                           |
| sha256                 | c6930e298bba86c01d0fe2c8262c46b4fce97c6c5037a193904cfc634246fbec                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FnaOHH2Qa7op9aXWNh.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                         |
|                        | Input Capture::Keylogging \[T1056.001]\                                            |
|                        | Screen Capture:: \[T1113]\                                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
|                             | Screen Capture::WinAPI [E1113.m01]                                            |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key::RC4 KSA [C0028.002]                                           |
|                             | Generate Pseudo-random Sequence:: [C0021]                                     |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Compression Library:: [C0060]                                                 |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+----------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                               | NAMESPACE                                            |
|----------------------------------------------------------+------------------------------------------------------|
| log keystrokes                                           | collection/keylog                                    |
| log keystrokes via polling                               | collection/keylog                                    |
| capture screenshot                                       | collection/screenshot                                |
| encode data using XOR (5 matches)                        | data-manipulation/encoding/xor                       |
| encrypt data using RC4 KSA                               | data-manipulation/encryption/rc4                     |
| encrypt data using RC4 PRGA (2 matches)                  | data-manipulation/encryption/rc4                     |
| generate random numbers using the Delphi LCG (3 matches) | data-manipulation/prng/lcg                           |
| contain a resource (.rsrc) section                       | executable/pe/section/rsrc                           |
| read clipboard data                                      | host-interaction/clipboard                           |
| set environment variable                                 | host-interaction/environment-variable                |
| get common file path                                     | host-interaction/file-system                         |
| create directory                                         | host-interaction/file-system/create                  |
| delete directory (2 matches)                             | host-interaction/file-system/delete                  |
| delete file (2 matches)                                  | host-interaction/file-system/delete                  |
| check if file exists                                     | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions                   | host-interaction/file-system/files/list              |
| read file on Windows                                     | host-interaction/file-system/read                    |
| write file on Windows (5 matches)                        | host-interaction/file-system/write                   |
| get graphical window text                                | host-interaction/gui/window/get-text                 |
| get session user name                                    | host-interaction/session                             |
| create thread                                            | host-interaction/thread/create                       |
| terminate thread                                         | host-interaction/thread/terminate                    |
| linked against XZip                                      | linking/static/xzip                                  |
| enumerate PE sections (2 matches)                        | load-code/pe                                         |
| parse PE header (2 matches)                              | load-code/pe                                         |
+----------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
3		- Discovery::System Owner/User Discovery [T1033;3]
6		- Collection::Clipboard Data [T1115;6]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
6		- Collection::Screen Capture [T1113;6]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
3		- Discovery::Account Discovery [T1087;3]

Score total: 44.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FnaOHH2Qa7op9aXWNh.exe: Win.Malware.EccentricBandwagon-9748740-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.17 MB
Data read: 0.16 MB (ratio 1.05:1)
Time: 44.280 sec (0 m 44 s)
Start Date: 2022:02:11 14:03:08
End Date:   2022:02:11 14:03:53

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.EccentricBandwagon-9748740-0

Score total: 50.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa2 in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa2 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:03:09Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FnaOHH2Qa7op9aXWNh.exe SCORE: 569 TYPE: EXE SIZE: 175104 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f71586bf400> 
MD5: 34404a3fb9804977c6ab86cb991fb130 
SHA1: b345e6fae155bfaf79c67b38cf488bb17d5be56d 
SHA256: c6930e298bba86c01d0fe2c8262c46b4fce97c6c5037a193904cfc634246fbec CREATED: Fri Feb 11 14:03:08 2022 MODIFIED: Fri Feb 11 14:03:08 2022 ACCESSED: Fri Feb 11 14:04:02 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_2: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetAsyncKeyState Str3: GetKeyState Str4: MapVirtualKey
REASON_3: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: FindFirstFileA Str7: FindClose
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: win_pslogger_auto SUBSCORE: 45 
DESCRIPTION: Detects win.pslogger. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 8d7608660fd60f8d7f088b048d04ed4100ffe0 Str2: 899de4feffffe8788500008d95e8feffffe81d210000538d55e88d8de8feffff Str3: 81e6fdff000083ce0 ... (truncated)
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8f3020000e980feffff Str2: e8340d0000e977ffffff Str3: e8050b0000e977ffffff Str4: e8c8080000e976ffffff Str5: e823b7ffffe96cffffff
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3:    Str4:   Str5:    Str6: PDT Str7: PDT Str8: PDT Str9: PDT Str10: PDT Str11: PDT Str12: PDT Str13: PDT Str14: PDT St ... (truncated)
REASON_10: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_16: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_17: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_18: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_21: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:04:03Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
80		keylogger
10		win_files_operation
10		ft_exe
45		win_pslogger_auto
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
25		CRC32_poly_Constant
25		CRC32_table

Score total: 569

==================[ Vérification MalwareBazaar ]==================
Fichier trouvé !
Malware connu -> Score: 2000
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 56/66
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:03:08                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FnaOHH2Qa7op9aXWNh.exe
Real Name:	/34404a3fb9804977c6ab86cb991fb130.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
3	- Discovery::System Owner/User Discovery [T1033;3]
6	- Collection::Clipboard Data [T1115;6]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
6	- Collection::Screen Capture [T1113;6]
6	- Collection::Input Capture::Keylogging [T1056.001;6]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
3	- Discovery::Account Discovery [T1087;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
50	Win.Malware.EccentricBandwagon-9748740-0

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
65	screenshot
80	keylogger
10	win_files_operation
10	ft_exe
45	win_pslogger_auto
2	math_entropy_6
5	executable_pe
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
40	SEH_Save
40	SEH_Init
10	anti_dbg
20	isExecutable
10	Contains_PE_File
25	CRC32_poly_Constant
25	CRC32_table

============================[ Scores ]============================
CAPA:	44.0
ClamAV:	50.0
Loki:	569
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	2000
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
14525.420389587125
==================================================================


==================================================================
Fichier HTTP-FnaOHH2Qa7op9aXWNh.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fa1STj1cbALG8WSgI.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fa1STj1cbALG8WSgI.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.19 MB
Data read: 0.18 MB (ratio 1.04:1)
Time: 36.783 sec (0 m 36 s)
Start Date: 2022:02:11 14:04:04
End Date:   2022:02:11 14:04:41

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5a968a83780406c060335be361e0ea99                                                   |
| sha1                   | c7ec1d45372f648657ed041b6c1c410e41117489                                           |
| sha256                 | f41032bfb7ef0b2a228c46b30b40b28e9cbd7dc19879b1996e1d71f2a5782eec                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fa1STj1cbALG8WSgI.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (2 matches)                | collection                                           |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| check OS version (2 matches)                         | host-interaction/os/version                          |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1.5		- Discovery::System Location Discovery [T1614;1.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 5.5

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:04:04Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fa1STj1cbALG8WSgI.exe SCORE: 194 TYPE: EXE SIZE: 195072 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f311ba34400> 
MD5: 5a968a83780406c060335be361e0ea99 
SHA1: c7ec1d45372f648657ed041b6c1c410e41117489 
SHA256: f41032bfb7ef0b2a228c46b30b40b28e9cbd7dc19879b1996e1d71f2a5782eec CREATED: Fri Feb 11 14:04:04 2022 MODIFIED: Fri Feb 11 14:04:04 2022 ACCESSED: Fri Feb 11 14:04:58 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:04:59Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 194

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:04:04                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fa1STj1cbALG8WSgI.exe
Real Name:	/nlhtml.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1.5	- Discovery::System Location Discovery [T1614;1.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1	- Discovery::System Information Discovery [T1082;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsDLL
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	5.5
ClamAV:	0
Loki:	194
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3184.432220697848
==================================================================


==================================================================
Fichier HTTP-Fa1STj1cbALG8WSgI.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FexrZp4O1LH5hjwwai.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FexrZp4O1LH5hjwwai.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 2.91 MB
Data read: 2.74 MB (ratio 1.06:1)
Time: 53.449 sec (0 m 53 s)
Start Date: 2022:02:11 14:05:00
End Date:   2022:02:11 14:05:54

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:05:00Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:05:59Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 648fc498110b11b4313a47a776e6ba40                                                   |
| sha1                   | 3a182e146f3549715e760b34722411eb2dad6578                                           |
| sha256                 | b483b6f21601752ff800ba52092e358050e4b370117503a9309787fd57935926                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FexrZp4O1LH5hjwwai.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                          |
|                        | Input Capture::Keylogging \[T1056.001]\                                             |
|                        | Screen Capture:: \[T1113]\                                                          |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                         |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                         |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                       |
|                        | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Location Discovery:: \[T1614]\                                               |
|                        | System Network Configuration Discovery::Internet Connection Discovery \[T1016.001]\ |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Virtual Machine Detection:: [B0009]                                           |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
|                             | Screen Capture::WinAPI [E1113.m01]                                            |
| COMMAND AND CONTROL         | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | HTTP Communication::Set Header [C0002.013]                                    |
|                             | HTTP Communication::WinHTTP [C0002.008]                                       |
|                             | Interprocess Communication::Create Pipe [C0003.001]                           |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence:: [C0021]                                     |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Compression Library:: [C0060]                                                 |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Suspend Thread:: [C0055]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| inspect load icon resource                            | anti-analysis                                        |
| check for software breakpoints (2 matches)            | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via GetTickCount (3 matches)     | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-VM instructions (2 matches)              | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Xen               | anti-analysis/anti-vm/vm-detection                   |
| get geographical location (5 matches)                 | collection                                           |
| log keystrokes                                        | collection/keylog                                    |
| log keystrokes via polling (9 matches)                | collection/keylog                                    |
| capture screenshot                                    | collection/screenshot                                |
| send data                                             | communication                                        |
| initialize WinHTTP library                            | communication/http                                   |
| read HTTP header                                      | communication/http                                   |
| set HTTP header (3 matches)                           | communication/http                                   |
| receive HTTP response (2 matches)                     | communication/http/client                            |
| create pipe                                           | communication/named-pipe/create                      |
| compiled with Borland Delphi                          | compiler/delphi                                      |
| reference Base64 string                               | data-manipulation/encoding/base64                    |
| encode data using XOR (13 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA (4 matches)               | data-manipulation/encryption/rc4                     |
| generate random numbers using the Delphi LCG          | data-manipulation/prng/lcg                           |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section         | executable/pe/section/tls                            |
| extract resource via kernel32 functions (4 matches)   | executable/resource                                  |
| accept command line arguments (2 matches)             | host-interaction/cli                                 |
| read clipboard data                                   | host-interaction/clipboard                           |
| replace clipboard data                                | host-interaction/clipboard                           |
| query environment variable                            | host-interaction/environment-variable                |
| create directory                                      | host-interaction/file-system/create                  |
| delete directory                                      | host-interaction/file-system/delete                  |
| delete file                                           | host-interaction/file-system/delete                  |
| check if file exists (2 matches)                      | host-interaction/file-system/exists                  |
| get file attributes (2 matches)                       | host-interaction/file-system/meta                    |
| get file size                                         | host-interaction/file-system/meta                    |
| get file version info (2 matches)                     | host-interaction/file-system/meta                    |
| read file on Windows (2 matches)                      | host-interaction/file-system/read                    |
| write file on Windows (4 matches)                     | host-interaction/file-system/write                   |
| enumerate gui resources (3 matches)                   | host-interaction/gui                                 |
| set application hook (4 matches)                      | host-interaction/gui                                 |
| set global application hook                           | host-interaction/gui                                 |
| find graphical window (2 matches)                     | host-interaction/gui/window/find                     |
| get graphical window text (2 matches)                 | host-interaction/gui/window/get-text                 |
| hide graphical window (15 matches)                    | host-interaction/gui/window/hide                     |
| get number of processors                              | host-interaction/hardware/cpu                        |
| get keyboard layout (5 matches)                       | host-interaction/hardware/keyboard/layout            |
| get disk size                                         | host-interaction/hardware/storage                    |
| check Internet connectivity via WinINet               | host-interaction/network/connectivity                |
| get hostname                                          | host-interaction/os/hostname                         |
| get system information on Windows                     | host-interaction/os/info                             |
| check OS version (3 matches)                          | host-interaction/os/version                          |
| get thread local storage value                        | host-interaction/process                             |
| set thread local storage value                        | host-interaction/process                             |
| create a process with modified I/O handles and window | host-interaction/process/create                      |
| create process on Windows                             | host-interaction/process/create                      |
| allocate RWX memory                                   | host-interaction/process/inject                      |
| query or enumerate registry key (3 matches)           | host-interaction/registry                            |
| query or enumerate registry value (6 matches)         | host-interaction/registry                            |
| set registry value                                    | host-interaction/registry/create                     |
| delete registry key                                   | host-interaction/registry/delete                     |
| delete registry value                                 | host-interaction/registry/delete                     |
| get session user name                                 | host-interaction/session                             |
| create thread (2 matches)                             | host-interaction/thread/create                       |
| resume thread (2 matches)                             | host-interaction/thread/resume                       |
| suspend thread                                        | host-interaction/thread/suspend                      |
| access PEB ldr_data (3 matches)                       | linking/runtime-linking                              |
| link function at runtime on Windows (4 matches)       | linking/runtime-linking                              |
| linked against ZLIB                                   | linking/static/zlib                                  |
| enumerate PE sections (5 matches)                     | load-code/pe                                         |
| parse PE header (13 matches)                          | load-code/pe                                         |
| persist via Run registry key                          | persistence/registry/run                             |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4		- Execution::Command and Scripting Interpreter [T1059;4]
4		- Discovery::Application Window Discovery [T1010;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
6		- Collection::Screen Capture [T1113;6]
2		- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
3		- Discovery::Account Discovery [T1087;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1.5		- Discovery::System Location Discovery [T1614;1.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6		- Collection::Clipboard Data [T1115;6]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 93.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 45/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:05:00                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FexrZp4O1LH5hjwwai.exe
Real Name:	/648fc498110b11b4313a47a776e6ba40.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6	- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
8.5	- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
4	- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4	- Execution::Command and Scripting Interpreter [T1059;4]
4	- Discovery::Application Window Discovery [T1010;4]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3	- Discovery::System Owner/User Discovery [T1033;3]
6	- Collection::Screen Capture [T1113;6]
2	- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]
2	- Discovery::File and Directory Discovery [T1083;2]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
3	- Discovery::Account Discovery [T1087;3]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1.5	- Discovery::System Location Discovery [T1614;1.5]
6	- Collection::Input Capture::Keylogging [T1056.001;6]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6	- Collection::Clipboard Data [T1115;6]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

============================[ Scores ]============================
CAPA:	93.0
ClamAV:	0
Loki:	0
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
3855.593952921058
==================================================================


==================================================================
Fichier HTTP-FexrZp4O1LH5hjwwai.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FmPB4r451esVw8tCT2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FmPB4r451esVw8tCT2.exe: Win.Trojan.Agent-375080 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.04 MB (ratio 1.44:1)
Time: 41.267 sec (0 m 41 s)
Start Date: 2022:02:11 14:12:16
End Date:   2022:02:11 14:12:58

-------- Score ----------------
Scores		Rules
.......		...............
70		Win.Trojan.Agent-375080
75		Win.Trojan.Agent-375080
45		Win.Trojan.Agent-375080

Score total: 190.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:12:17Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FmPB4r451esVw8tCT2.exe SCORE: 714 TYPE: EXE SIZE: 36864 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f1172723400> 
MD5: 56bed8249e7c2982a90e54e1e55391a2 
SHA1: 92c1802eeec9c5a15af83961e53c07b04476bd4a 
SHA256: e2aed4398e0178670d9678961ca89a0f15a3eac20f396bdf29de8ac66cb853fa CREATED: Fri Feb 11 14:12:16 2022 MODIFIED: Fri Feb 11 14:12:16 2022 ACCESSED: Fri Feb 11 14:13:02 2022 
REASON_1: Yara Rule MATCH: network_dropper SUBSCORE: 65 
DESCRIPTION: File downloader/dropper REF: - AUTHOR: x0r 
MATCHES: Str1: urlmon.dll Str2: URLDownloadToFile
REASON_2: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: SeDebugPrivilege Str3: AdjustTokenPrivileges
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: CreateFileA
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_1 SUBSCORE: 2 
DESCRIPTION: Very low entropy - repeating 2 bytes REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff6898204000681017400064a100000000506489250000000083ec20535657 Str3: 558bec6aff6858204000687012400064a100000000506489 ... (truncated)
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6898204000681017400064a10000000050 Str2: 558bec6aff6858204000687012400064a10000000050
REASON_10: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6898204000681017400064a10000000050 Str2: 558bec6aff6858204000687012400064a10000000050
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec81 Str2: 558bec83 Str3: 558becb8 Str4: 558bec6a Str5: 558bec6aff6898204000681017400064a10000000050 Str6: 558bec6aff685820400068 ... (truncated)
REASON_12: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff6898204000681017400064a1000000005064892500000000 Str2: 558bec6aff6858204000687012400064a1000000005064892500000000
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:13:02Z

-------- Score ----------------
Scores		Rules
.......		...............
65		network_dropper
70		escalate_priv
65		win_token
10		win_files_operation
10		ft_exe
2		math_entropy_1
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
35		Embedded_PE
2		PE_File
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 714

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 54/67
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:12:16                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FmPB4r451esVw8tCT2.exe
Real Name:	/Practical Malware Analysis Lab 12-04.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
70	Win.Trojan.Agent-375080
75	Win.Trojan.Agent-375080
45	Win.Trojan.Agent-375080

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
65	network_dropper
70	escalate_priv
65	win_token
10	win_files_operation
10	ft_exe
2	math_entropy_1
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
35	Embedded_PE
2	PE_File
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	0
ClamAV:	190.0
Loki:	714
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
15708.095676581266
==================================================================


==================================================================
Fichier HTTP-FmPB4r451esVw8tCT2.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FxGgxpEJjrzKjtcp8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 773290480d5445f11d3dc1b800728966                                                   |
| sha1                   | e70318439993e073dc298d45a9c8eaa8cee79e4d                                           |
| sha256                 | 7b8c44c6eba0246f755f1700cc71d39ce756f23b5358957b7fe55b7ac6c30dce                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FxGgxpEJjrzKjtcp8.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Virtualization/Sandbox Evasion:: \[T1497]\                                          |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                         |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                       |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | Software Discovery:: \[T1518]\                                                      |
|                        | System Network Configuration Discovery:: \[T1016]\                                  |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
|                             | Virtual Machine Detection::Product Key/ID Testing [B0007.005]                 |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for microsoft office emulation                 | anti-analysis/anti-vm/vm-detection                   |
| check for sandbox username                           | anti-analysis/anti-vm/vm-detection                   |
| check for windows sandbox via device                 | anti-analysis/anti-vm/vm-detection                   |
| check for windows sandbox via dns suffix             | anti-analysis/anti-vm/vm-detection                   |
| check for windows sandbox via genuine state          | anti-analysis/anti-vm/vm-detection                   |
| check for windows sandbox via process name           | anti-analysis/anti-vm/vm-detection                   |
| check for windows sandbox via registry               | anti-analysis/anti-vm/vm-detection                   |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| get local IPv4 addresses                             | host-interaction/network/address                     |
| query or enumerate registry value                    | host-interaction/registry                            |
| get session user name                                | host-interaction/session                             |
| parse PE header (7 matches)                          | load-code/pe                                         |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
7		- Defense Evasion::Virtualization/Sandbox Evasion [T1497;7]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Network Configuration Discovery [T1016;3]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::Query Registry [T1012;1]
4		- Discovery::Software Discovery [T1518;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4		- Discovery::Process Discovery [T1057;4]
3		- Discovery::Account Discovery [T1087;3]

Score total: 43.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FxGgxpEJjrzKjtcp8.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.13 MB
Data read: 0.12 MB (ratio 1.03:1)
Time: 43.579 sec (0 m 43 s)
Start Date: 2022:02:11 14:13:03
End Date:   2022:02:11 14:13:47

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:13:04Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FxGgxpEJjrzKjtcp8.exe SCORE: 229 TYPE: EXE SIZE: 131072 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f664f313400> 
MD5: 773290480d5445f11d3dc1b800728966 
SHA1: e70318439993e073dc298d45a9c8eaa8cee79e4d 
SHA256: 7b8c44c6eba0246f755f1700cc71d39ce756f23b5358957b7fe55b7ac6c30dce CREATED: Fri Feb 11 14:13:03 2022 MODIFIED: Fri Feb 11 14:13:03 2022 ACCESSED: Fri Feb 11 14:13:56 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: FindClose
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453594b1e80d4c8644d8d6a0b933385ff6203000000433a5c55736572735c50435c736f757263655c7265706f735c57696e646f77732053616e64626f7820446 ... (truncated)
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:13:57Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		ft_exe
50		ConventionEngine_Term_Users
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 229

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 4/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:13:03                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FxGgxpEJjrzKjtcp8.exe
Real Name:	/773290480d5445f11d3dc1b800728966.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
7	- Defense Evasion::Virtualization/Sandbox Evasion [T1497;7]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
3	- Discovery::System Network Configuration Discovery [T1016;3]
3	- Discovery::System Owner/User Discovery [T1033;3]
1	- Discovery::Query Registry [T1012;1]
4	- Discovery::Software Discovery [T1518;4]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
4	- Discovery::Process Discovery [T1057;4]
3	- Discovery::Account Discovery [T1087;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	ft_exe
50	ConventionEngine_Term_Users
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	43.0
ClamAV:	0
Loki:	229
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
6487.368206172568
==================================================================


==================================================================
Fichier HTTP-FxGgxpEJjrzKjtcp8.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FAMTNq1ocDDYhvILvg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FAMTNq1ocDDYhvILvg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.23 MB
Data read: 0.22 MB (ratio 1.04:1)
Time: 43.430 sec (0 m 43 s)
Start Date: 2022:02:11 14:13:58
End Date:   2022:02:11 14:14:42

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 695500833b489cbcbfecd08b1faf81c5                                                   |
| sha1                   | 6d4b085c151f3849630516795077166028c14e27                                           |
| sha256                 | 2a8993f81a3a8e23829fe6f13dfaf32840633b2d1aec73a7c2ac7acf15acee72                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FAMTNq1ocDDYhvILvg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
| DATA                        | Non-Cryptographic Hash::FNV [C0030.005]                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-debugging instructions                  | anti-analysis/anti-debugging/debugger-detection      |
| hash data using fnv                                  | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| query environment variable                           | host-interaction/environment-variable                |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 10.5

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:13:58Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FAMTNq1ocDDYhvILvg.exe SCORE: 419 TYPE: EXE SIZE: 235520 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4daa06d400> 
MD5: 695500833b489cbcbfecd08b1faf81c5 
SHA1: 6d4b085c151f3849630516795077166028c14e27 
SHA256: 2a8993f81a3a8e23829fe6f13dfaf32840633b2d1aec73a7c2ac7acf15acee72 CREATED: Fri Feb 11 14:13:58 2022 MODIFIED: Fri Feb 11 14:13:58 2022 ACCESSED: Fri Feb 11 14:14:52 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier Str3: identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier Str3: identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier Str3: identifier
REASON_13: Yara Rule MATCH: VM_Detect_VirtualPC_XEN_Wine_v1 SUBSCORE: 60 
DESCRIPTION: Xen detection, VirtualPC, Red Pill, Wine and other REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: 45c70001
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_15: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: 45c70001
REASON_16: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: 45c70001
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:14:52Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		VM_Detect_VirtualPC_XEN_Wine_v1
35		Anti_Automated_Sandbox
60		vmdetect_2
60		vmdetect
20		isExecutable
10		Contains_PE_File

Score total: 419

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:13:58                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FAMTNq1ocDDYhvILvg.exe
Real Name:	/mpeval.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1	- Discovery::System Information Discovery [T1082;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
60	VM_Detect_VirtualPC_XEN_Wine_v1
35	Anti_Automated_Sandbox
60	vmdetect_2
60	vmdetect
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	10.5
ClamAV:	0
Loki:	419
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
6850.205019483797
==================================================================


==================================================================
Fichier HTTP-FAMTNq1ocDDYhvILvg.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FEtHtV38DtRe9YBCH6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FEtHtV38DtRe9YBCH6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.32 MB
Data read: 0.30 MB (ratio 1.05:1)
Time: 41.884 sec (0 m 41 s)
Start Date: 2022:02:11 14:14:53
End Date:   2022:02:11 14:15:35

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:14:53Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FEtHtV38DtRe9YBCH6.exe SCORE: 324 TYPE: EXE SIZE: 316928 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f74574ed400> 
MD5: 93aeb0de230121bad93f8cb76254faef 
SHA1: 925c9e08d60cc7607b466a57a85161c5b166924b 
SHA256: 2b3453d38387189a5b837ed8a4db7014514e5408d4b287403dadf08e4700ff58 CREATED: Fri Feb 11 14:14:53 2022 MODIFIED: Fri Feb 11 14:14:53 2022 ACCESSED: Fri Feb 11 14:15:44 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_14: Yara Rule MATCH: skip20_sqllang_hook SUBSCORE: 60 
DESCRIPTION: YARA rule to detect if a sqllang.dll version is targeted by skip-2.0. Each byte pattern corresponds to a function hooked by skip-2.0. If _0 or _1 match, it is probably targeted as it corresponds to the hook responsible for bypassing the authentication. REF: https://www.welivesecurity.com/ AUTHOR: Mathieu Tartare <mathieu.tartare@eset.com> 
MATCHES: Str1: 8bc1488b8c24300200004833cc
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:15:45Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		skip20_sqllang_hook
20		isExecutable
10		Contains_PE_File

Score total: 324

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 93aeb0de230121bad93f8cb76254faef                                                   |
| sha1                   | 925c9e08d60cc7607b466a57a85161c5b166924b                                           |
| sha256                 | 2b3453d38387189a5b837ed8a4db7014514e5408d4b287403dadf08e4700ff58                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FEtHtV38DtRe9YBCH6.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| enumerate PE sections (2 matches)                    | load-code/pe                                         |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 9.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:14:53                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FEtHtV38DtRe9YBCH6.exe
Real Name:	/msIso.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
60	skip20_sqllang_hook
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	9.5
ClamAV:	0
Loki:	324
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5324.603863496051
==================================================================


==================================================================
Fichier HTTP-FEtHtV38DtRe9YBCH6.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FIg8jK3CU3f8xGVcRl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 7e17f0f35d50f49407841372f24fbd38                                                   |
| sha1                   | 921ad55a3f593239b906163cf1bb8001194822f3                                           |
| sha256                 | 934c3445fe9d1a3d4cca4d3ec09c9191d8f9067e13e58fa0b288cb520cd40785                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FIg8jK3CU3f8xGVcRl.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Automated Collection:: \[T1119]\                                                   |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| parse credit card information                        | collection/credit-card                               |
| encrypt data using RC4 PRGA (5 matches)              | data-manipulation/encryption/rc4                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| allocate thread local storage                        | host-interaction/process                             |
| terminate process                                    | host-interaction/process/terminate                   |
| link many functions at runtime                       | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6		- Collection::Automated Collection [T1119;6]

Score total: 12.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FIg8jK3CU3f8xGVcRl.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.18 MB
Data read: 0.17 MB (ratio 1.05:1)
Time: 43.881 sec (0 m 43 s)
Start Date: 2022:02:11 14:16:22
End Date:   2022:02:11 14:17:06

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 61: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 61: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 45: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 29: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 13: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:16:23Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FIg8jK3CU3f8xGVcRl.exe SCORE: 324 TYPE: EXE SIZE: 183296 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb867364400> 
MD5: 7e17f0f35d50f49407841372f24fbd38 
SHA1: 921ad55a3f593239b906163cf1bb8001194822f3 
SHA256: 934c3445fe9d1a3d4cca4d3ec09c9191d8f9067e13e58fa0b288cb520cd40785 CREATED: Fri Feb 11 14:16:22 2022 MODIFIED: Fri Feb 11 14:16:22 2022 ACCESSED: Fri Feb 11 14:17:12 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.DLL Str2: kernel32.dll Str3: KERNEL32.dll Str4: WriteFile Str5: SetFilePointer Str6: CreateFileA
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645d0ccc645d1ccc645d2ccc645 Str2: c645d1ccc645d2ccc645d3ccc645 Str3: c645d2ccc645d3ccc645d4ccc645 Str4: c645d3ccc645d4ccc645d5ccc645 ... (truncated)
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e86c330000e916feffff Str2: e8d3410000e915ffffff Str3: e812fcffffe9e5feffff Str4: e8b796ffffe97cffffff
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @@ Str2:  Str3: 0000000000002240000000000020614000000000000066400000000000804b4000000000000050400000000000c06d40000000000000514000000 ... (truncated)
REASON_8: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_13: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_14: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.DLL Str2: kernel32.dll Str3: KERNEL32.dll Str4: IsDebuggerPresent
REASON_15: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:17:13Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		obfuscation_singlebyte_mov
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 324

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 50/70
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:16:22                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FIg8jK3CU3f8xGVcRl.exe
Real Name:	/7e17f0f35d50f49407841372f24fbd38.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6	- Collection::Automated Collection [T1119;6]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	ft_exe
2	math_entropy_6
5	obfuscation_singlebyte_mov
5	executable_pe
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
40	SEH_Save
40	SEH_Init
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	12.0
ClamAV:	0
Loki:	324
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
7374.485421370273
==================================================================


==================================================================
Fichier HTTP-FIg8jK3CU3f8xGVcRl.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FufV9V3wTsonkRmpa9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 433d943ce267eaa3485137e0d21a7348                                                   |
| sha1                   | 0ffbae84afadf220cd379bc823f0ba7e95e50ea5                                           |
| sha256                 | 3c4de3f013d4611bbdb14ea17207e4d93eb406e14e639b1d87ce217c96747cf2                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FufV9V3wTsonkRmpa9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 1.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:17:14Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FufV9V3wTsonkRmpa9.exe SCORE: 194 TYPE: EXE SIZE: 70144 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f60a8ba6400> 
MD5: 433d943ce267eaa3485137e0d21a7348 
SHA1: 0ffbae84afadf220cd379bc823f0ba7e95e50ea5 
SHA256: 3c4de3f013d4611bbdb14ea17207e4d93eb406e14e639b1d87ce217c96747cf2 CREATED: Fri Feb 11 14:17:14 2022 MODIFIED: Fri Feb 11 14:17:14 2022 ACCESSED: Fri Feb 11 14:17:45 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_7: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 10 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_10: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_11: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_12: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:17:46Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
10		IsPE64
10		IsConsole
10		HasDebugData
10		ImportTableIsBad
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File

Score total: 194

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FufV9V3wTsonkRmpa9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 39.959 sec (0 m 39 s)
Start Date: 2022:02:11 14:17:14
End Date:   2022:02:11 14:17:54

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/69
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:17:14                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FufV9V3wTsonkRmpa9.exe
Real Name:	/tzsync.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
10	IsPE64
10	IsConsole
10	HasDebugData
10	ImportTableIsBad
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	1.0
ClamAV:	0
Loki:	194
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3094.6454165242485
==================================================================


==================================================================
Fichier HTTP-FufV9V3wTsonkRmpa9.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fwi7hK2FzkAqLVv8Ah.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fwi7hK2FzkAqLVv8Ah.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.62 MB
Data read: 0.59 MB (ratio 1.05:1)
Time: 43.319 sec (0 m 43 s)
Start Date: 2022:02:11 14:17:55
End Date:   2022:02:11 14:18:38

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 79: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 71: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 70: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 63: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 55: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 47: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 39: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 31: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 23: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 71: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 70: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 63: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 62: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 55: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 47: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 46: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 39: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 31: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 30: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 23: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 7: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:17:55Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fwi7hK2FzkAqLVv8Ah.exe SCORE: 719 TYPE: EXE SIZE: 623104 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fadf35fb400> 
MD5: 6b25f1e754ef486bbb28a66d46bababe 
SHA1: a010d69bd8eec8e207578723b1052e8e018eeec5 
SHA256: 38749e9c35921ab2fb0b8a80f8e13f89521c58c4d65d18dc4109c816c210e0fe CREATED: Fri Feb 11 14:17:55 2022 MODIFIED: Fri Feb 11 14:17:55 2022 ACCESSED: Fri Feb 11 14:18:49 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: Kernel32.DLL Str2: kernel32.dll Str3: KERNEL32.dll Str4: WriteFile Str5: SetFilePointer Str6: ReadFile Str7: DeleteFileA Str8: Create ... (truncated)
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: Havex SUBSCORE: 85 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 07e8b6b0ffff59895dfce897ffffff8945e08d45e450e840ffffff593bc374 Str2: 8a46038847038a46028847028a46018847018b45085e5fc9c3 Str3: e8234f0 ... (truncated)
REASON_7: Yara Rule MATCH: math_entropy_7 SUBSCORE: 2 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645d0ccc645d1ccc645d2ccc645 Str2: c645d1ccc645d2ccc645d3ccc645 Str3: c645d2ccc645d3ccc645d4ccc645 Str4: c645d3ccc645d4ccc645d5ccc645 ... (truncated)
REASON_9: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_10: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e844f7ffffe961ffffff Str2: e820f8ffffe9ddffffff Str3: e811f8ffffe9ceffffff Str4: e863b60000e978feffff Str5: e8752e0000e91cffffff Str6 ... (truncated)
REASON_11: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3:  Str4:  Str5:  Str6:  Str7:  Str8:  Str9:  Str10:  Str11:  Str12:  Str13:  Str14:  Str15:  Str16:  Str17:  Str18:  St ... (truncated)
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsPacked SUBSCORE: 10 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_16: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_17: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_19: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_20: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_21: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: Kernel32.DLL Str2: kernel32.dll Str3: KERNEL32.dll Str4: IsDebuggerPresent
REASON_22: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_23: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_24: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: BBBBBBBBBBBBBBBBBBBB
REASON_25: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_26: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
REASON_27: Yara Rule MATCH: CRC32b_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32b [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: b71dc104
REASON_28: Yara Rule MATCH: VC8_Random SUBSCORE: 15 
DESCRIPTION: Look for Random function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: e80f4100008b481469c9fd43030081c1c39e26008948148bc1c1e81025ff7f0000c3
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:18:50Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
65		win_token
10		win_files_operation
10		ft_exe
85		Havex
2		math_entropy_7
5		obfuscation_singlebyte_mov
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		IsPacked
10		HasOverlay
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
10		Big_Numbers0
25		CRC32_poly_Constant
25		CRC32_table
25		CRC32b_poly_Constant
15		VC8_Random

Score total: 719

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6b25f1e754ef486bbb28a66d46bababe                                                   |
| sha1                   | a010d69bd8eec8e207578723b1052e8e018eeec5                                           |
| sha256                 | 38749e9c35921ab2fb0b8a80f8e13f89521c58c4d65d18dc4109c816c210e0fe                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fwi7hK2FzkAqLVv8Ah.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | System Shutdown/Reboot:: \[T1529]\                                                 |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | Interprocess Communication::Create Pipe [C0003.001]                           |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
|                             | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| create pipe                                           | communication/named-pipe/create                      |
| compiled with exe4j                                   | compiler/exe4j                                       |
| encode data using XOR (3 matches)                     | data-manipulation/encoding/xor                       |
| debug build                                           | executable/pe/debug                                  |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)   | executable/resource                                  |
| accept command line arguments (2 matches)             | host-interaction/cli                                 |
| query environment variable (12 matches)               | host-interaction/environment-variable                |
| set environment variable (4 matches)                  | host-interaction/environment-variable                |
| get common file path (6 matches)                      | host-interaction/file-system                         |
| create directory (4 matches)                          | host-interaction/file-system/create                  |
| delete directory (4 matches)                          | host-interaction/file-system/delete                  |
| delete file (3 matches)                               | host-interaction/file-system/delete                  |
| check if file exists                                  | host-interaction/file-system/exists                  |
| enumerate files recursively                           | host-interaction/file-system/files/list              |
| read file on Windows (8 matches)                      | host-interaction/file-system/read                    |
| write file on Windows (3 matches)                     | host-interaction/file-system/write                   |
| enumerate gui resources                               | host-interaction/gui                                 |
| shutdown system                                       | host-interaction/os                                  |
| check OS version (3 matches)                          | host-interaction/os/version                          |
| allocate thread local storage                         | host-interaction/process                             |
| create a process with modified I/O handles and window | host-interaction/process/create                      |
| create process on Windows (4 matches)                 | host-interaction/process/create                      |
| modify access privileges                              | host-interaction/process/modify                      |
| terminate process (4 matches)                         | host-interaction/process/terminate                   |
| query or enumerate registry key (2 matches)           | host-interaction/registry                            |
| query or enumerate registry value (5 matches)         | host-interaction/registry                            |
| set registry value (2 matches)                        | host-interaction/registry/create                     |
| create thread                                         | host-interaction/thread/create                       |
| link many functions at runtime (2 matches)            | linking/runtime-linking                              |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
9		- Impact::System Shutdown/Reboot [T1529;9]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 48.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 2/67
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:17:55                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fwi7hK2FzkAqLVv8Ah.exe
Real Name:	/6b25f1e754ef486bbb28a66d46bababe.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
5	- Privilege Escalation::Access Token Manipulation [T1134;5]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::System Information Discovery [T1082;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1	- Discovery::Query Registry [T1012;1]
9	- Impact::System Shutdown/Reboot [T1529;9]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
70	escalate_priv
20	win_registry
65	win_token
10	win_files_operation
10	ft_exe
85	Havex
2	math_entropy_7
5	obfuscation_singlebyte_mov
5	executable_pe
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsWindowsGUI
10	IsPacked
10	HasOverlay
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
40	SEH_Save
40	SEH_Init
10	anti_dbg
20	isExecutable
10	Contains_PE_File
10	Big_Numbers0
25	CRC32_poly_Constant
25	CRC32_table
25	CRC32b_poly_Constant
15	VC8_Random

============================[ Scores ]============================
CAPA:	48.0
ClamAV:	0
Loki:	719
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
14353.107964980467
==================================================================


==================================================================
Fichier HTTP-Fwi7hK2FzkAqLVv8Ah.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FtDqHx3GvVXUNPZKB8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | edc83f2d9e0f3906eeff6c5056ebeca6                                                   |
| sha1                   | 3c3bd1889d01ee717b15af7100bf1897beabda49                                           |
| sha256                 | d036bcd15fb7054aa1951bd72c776e3ba089c3e6ab5020a850a1b52ed0ed2f08                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FtDqHx3GvVXUNPZKB8.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (3 matches)                | collection                                           |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1.5		- Discovery::System Location Discovery [T1614;1.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 5.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FtDqHx3GvVXUNPZKB8.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 43.325 sec (0 m 43 s)
Start Date: 2022:02:11 14:19:03
End Date:   2022:02:11 14:19:46

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:19:03Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FtDqHx3GvVXUNPZKB8.exe SCORE: 314 TYPE: EXE SIZE: 49664 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f82801c1400> 
MD5: edc83f2d9e0f3906eeff6c5056ebeca6 
SHA1: 3c3bd1889d01ee717b15af7100bf1897beabda49 
SHA256: d036bcd15fb7054aa1951bd72c776e3ba089c3e6ab5020a850a1b52ed0ed2f08 CREATED: Fri Feb 11 14:19:03 2022 MODIFIED: Fri Feb 11 14:19:03 2022 ACCESSED: Fri Feb 11 14:19:55 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_12: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_13: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:19:55Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
60		DebuggerException__SetConsoleCtrl_v1
20		isExecutable
10		Contains_PE_File

Score total: 314

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/62
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:19:03                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FtDqHx3GvVXUNPZKB8.exe
Real Name:	/typeperf.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1.5	- Discovery::System Location Discovery [T1614;1.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1	- Discovery::System Information Discovery [T1082;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
60	DebuggerException__SetConsoleCtrl_v1
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	5.5
ClamAV:	0
Loki:	314
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5086.304051651185
==================================================================


==================================================================
Fichier HTTP-FtDqHx3GvVXUNPZKB8.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fywyr73yTZJftVbqQ.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fywyr73yTZJftVbqQ.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.19 MB
Data read: 0.18 MB (ratio 1.04:1)
Time: 40.426 sec (0 m 40 s)
Start Date: 2022:02:11 14:19:56
End Date:   2022:02:11 14:20:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:19:57Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fywyr73yTZJftVbqQ.exe SCORE: 159 TYPE: EXE SIZE: 190976 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb6d9283400> 
MD5: 914530f2fcb9110f4dcb2b1e027e5ae2 
SHA1: 970f592957e9466de3b0c76d6520a2e8e2a45c72 
SHA256: cd4aa8eb12f2013a19ac68d3858d0c103588096a6b81b0fd6e252bdbf5f09c85 CREATED: Fri Feb 11 14:19:56 2022 MODIFIED: Fri Feb 11 14:19:56 2022 ACCESSED: Fri Feb 11 14:20:48 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:20:49Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 159

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 914530f2fcb9110f4dcb2b1e027e5ae2                                                   |
| sha1                   | 970f592957e9466de3b0c76d6520a2e8e2a45c72                                           |
| sha256                 | cd4aa8eb12f2013a19ac68d3858d0c103588096a6b81b0fd6e252bdbf5f09c85                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fywyr73yTZJftVbqQ.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (10 matches)          | host-interaction/process/terminate                   |
| create thread (4 matches)                            | host-interaction/thread/create                       |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:19:56                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fywyr73yTZJftVbqQ.exe
Real Name:	/SettingsHandlers_OneCore_BatterySaver.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	159
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
2579.8380454622366
==================================================================


==================================================================
Fichier HTTP-Fywyr73yTZJftVbqQ.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FYgXEg1y8ahfcHD742.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2d3edc218a90f03089cc01715a9f047f                                                   |
| sha1                   | 52c402ab80daf46fe997151819442d8ac97932f6                                           |
| sha256                 | e606530456555bfa92c98365539b16d20bf678fae1ce180d9574a0ea48cc8a9f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FYgXEg1y8ahfcHD742.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                             |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                         |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | Software Discovery:: \[T1518]\                                                      |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | System Services::Service Execution \[T1569.002]\                                    |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
|                        | Service Stop:: \[T1489]\                                                            |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
|                        | Create or Modify System Process::Windows Service \[T1543.003]\                      |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | Interprocess Communication::Connect Pipe [C0003.002]                          |
|                             | Interprocess Communication::Create Pipe [C0003.001]                           |
|                             | Interprocess Communication::Read Pipe [C0003.003]                             |
|                             | Interprocess Communication::Write Pipe [C0003.004]                            |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Checksum::CRC32 [C0032.001]                                                   |
|                             | Checksum::Luhn [C0032.002]                                                    |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| receive data                                         | communication                                        |
| send data                                            | communication                                        |
| create pipe                                          | communication/named-pipe/create                      |
| read pipe (2 matches)                                | communication/named-pipe/read                        |
| write pipe (3 matches)                               | communication/named-pipe/write                       |
| hash data with CRC32                                 | data-manipulation/checksum/crc32                     |
| validate payment card number using luhn algorithm    | data-manipulation/checksum/luhn                      |
| encode data using XOR (3 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| contain an embedded PE file                          | executable/subfile/pe                                |
| get common file path                                 | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| create directory                                     | host-interaction/file-system/create                  |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| set file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| read file on Windows (2 matches)                     | host-interaction/file-system/read                    |
| write file on Windows (3 matches)                    | host-interaction/file-system/write                   |
| get disk information                                 | host-interaction/hardware/storage                    |
| check mutex                                          | host-interaction/mutex                               |
| create mutex                                         | host-interaction/mutex                               |
| get hostname                                         | host-interaction/os/hostname                         |
| read process memory                                  | host-interaction/process                             |
| create process on Windows (2 matches)                | host-interaction/process/create                      |
| inject thread                                        | host-interaction/process/inject                      |
| enumerate processes (4 matches)                      | host-interaction/process/list                        |
| terminate process (2 matches)                        | host-interaction/process/terminate                   |
| query or enumerate registry value                    | host-interaction/registry                            |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| start service                                        | host-interaction/service/start                       |
| stop service                                         | host-interaction/service/stop                        |
| get token membership                                 | host-interaction/session                             |
| terminate thread                                     | host-interaction/thread/terminate                    |
| spawn thread to RWX shellcode                        | load-code/shellcode                                  |
| persist via Run registry key                         | persistence/registry/run                             |
| write file to startup folder                         | persistence/startup-folder                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
9		- Impact::Service Stop [T1489;9]
3		- Execution::System Services::Service Execution [T1569.002;3]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
5		- Defense Evasion::File and Directory Permissions Modification [T1222;5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
4		- Discovery::Process Discovery [T1057;4]
4		- Discovery::Software Discovery [T1518;4]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 81.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FYgXEg1y8ahfcHD742.exe: Win.Trojan.ProPOS-1 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 39.505 sec (0 m 39 s)
Start Date: 2022:02:11 14:21:04
End Date:   2022:02:11 14:21:44

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.ProPOS-1

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xee in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xde in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 79: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xac in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 20: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 19: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 18: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 79: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 78: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:21:04Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FYgXEg1y8ahfcHD742.exe SCORE: 1084 TYPE: EXE SIZE: 42496 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f041079e400> 
MD5: 2d3edc218a90f03089cc01715a9f047f 
SHA1: 52c402ab80daf46fe997151819442d8ac97932f6 
SHA256: e606530456555bfa92c98365539b16d20bf678fae1ce180d9574a0ea48cc8a9f CREATED: Fri Feb 11 14:21:04 2022 MODIFIED: Fri Feb 11 14:21:04 2022 ACCESSED: Fri Feb 11 14:21:58 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: HttpOpenRequest Str6: HttpSendRequest
REASON_3: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_4: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: DeleteFileA Str5: CreateFileA Str6: SetFileAttributesA Str7: CopyFile
REASON_6: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_7: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_8: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_9: Yara Rule MATCH: malware_shellcode_hash SUBSCORE: 70 
DESCRIPTION: detect shellcode api hash value REF: - AUTHOR: JPCERT/CC Incident Response Group 
MATCHES: Str1: eeeac01f Str2: 2680acc8
REASON_10: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: ConventionEngine_Anomaly_NulledOut SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344536ade19bb8007d04f92147832a36de67f0b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_12: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_14: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: Visual_Cpp_2005_Release_Microsoft SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e88a030000e963fdffff
REASON_16: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e88a030000e963fdffff
REASON_17: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2: @B Str3:  Str4: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_18: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_21: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_23: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_24: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_25: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_26: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: SOFTWARE\Microsoft\Windows\CurrentVersion Str2: Software\Microsoft\Windows\CurrentVersion Str3: RegQueryValue
REASON_27: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_28: Yara Rule MATCH: Antivirus_strings SUBSCORE: 50 
DESCRIPTION: Contains references to security software REF: - AUTHOR: Jerome Athias 
MATCHES: Str1: firewall.exe
REASON_29: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_30: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_31: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_32: Yara Rule MATCH: easterjackpos SUBSCORE: 60 
DESCRIPTION: Identify JackPOS REF: - AUTHOR: Brian Wallace @botnet_hunter 
MATCHES: Str1: updateinterval= Str2: cardinterval= Str3: {[!17!]}{[!18!]}
REASON_33: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_34: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_35: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:21:58Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
45		network_http
60		win_mutex
20		win_registry
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
70		malware_shellcode_hash
10		ft_exe
50		ConventionEngine_Anomaly_NulledOut
2		math_entropy_6
5		executable_pe
15		dll_injection_thread
70		Visual_Cpp_2005_Release_Microsoft
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
35		Embedded_PE
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
45		Inject_Thread
50		Antivirus_strings
40		SEH_Save
40		SEH_Init
10		anti_dbg
60		easterjackpos
20		isExecutable
10		Contains_PE_File
25		CRC32_poly_Constant

Score total: 1084

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 51/71
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:21:04                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FYgXEg1y8ahfcHD742.exe
Real Name:	/2d3edc218a90f03089cc01715a9f047f.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
8.5	- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
9	- Impact::Service Stop [T1489;9]
3	- Execution::System Services::Service Execution [T1569.002;3]
4	- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
4	- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
5	- Defense Evasion::File and Directory Permissions Modification [T1222;5]
6.5	- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
3	- Discovery::System Owner/User Discovery [T1033;3]
4	- Discovery::Process Discovery [T1057;4]
4	- Discovery::Software Discovery [T1518;4]
2	- Discovery::File and Directory Discovery [T1083;2]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6	- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
45	Win.Trojan.ProPOS-1

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	inject_thread
45	network_http
60	win_mutex
20	win_registry
10	win_files_operation
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	Str_Win32_Http_API
70	malware_shellcode_hash
10	ft_exe
50	ConventionEngine_Anomaly_NulledOut
2	math_entropy_6
5	executable_pe
15	dll_injection_thread
70	Visual_Cpp_2005_Release_Microsoft
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
35	Embedded_PE
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
45	Inject_Thread
50	Antivirus_strings
40	SEH_Save
40	SEH_Init
10	anti_dbg
60	easterjackpos
20	isExecutable
10	Contains_PE_File
25	CRC32_poly_Constant

============================[ Scores ]============================
CAPA:	81.0
ClamAV:	45.0
Loki:	1084
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
21362.921116710633
==================================================================


==================================================================
Fichier HTTP-FYgXEg1y8ahfcHD742.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F1T9Jn25dVu3tCsAme.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ae3f3dc3ed900f2a582bad86a764508c                                                   |
| sha1                   | 1e44ee63bdb2cf3a6e48b521844204218a001344                                           |
| sha256                 | 1a1876c5eed2b8cd9e14ebff3f4eeb7e21552a4c6aab4bf392a55f8df3612dab                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F1T9Jn25dVu3tCsAme.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 3.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F1T9Jn25dVu3tCsAme.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 42.907 sec (0 m 42 s)
Start Date: 2022:02:11 14:22:00
End Date:   2022:02:11 14:22:42

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:22:00Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F1T9Jn25dVu3tCsAme.exe SCORE: 229 TYPE: EXE SIZE: 17920 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa932c31400> 
MD5: ae3f3dc3ed900f2a582bad86a764508c 
SHA1: 1e44ee63bdb2cf3a6e48b521844204218a001344 
SHA256: 1a1876c5eed2b8cd9e14ebff3f4eeb7e21552a4c6aab4bf392a55f8df3612dab CREATED: Fri Feb 11 14:22:00 2022 MODIFIED: Fri Feb 11 14:22:00 2022 ACCESSED: Fri Feb 11 14:22:48 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e86b0200004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:22:48Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/68
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:22:00                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-F1T9Jn25dVu3tCsAme.exe
Real Name:	/find.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	3.0
ClamAV:	0
Loki:	229
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3689.263280185016
==================================================================


==================================================================
Fichier HTTP-F1T9Jn25dVu3tCsAme.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fwk60rhWgEiD0ZMo7.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fwk60rhWgEiD0ZMo7.exe: Win.Trojan.Agent-899040 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 43.274 sec (0 m 43 s)
Start Date: 2022:02:11 14:22:49
End Date:   2022:02:11 14:23:32

-------- Score ----------------
Scores		Rules
.......		...............
70		Win.Trojan.Agent-899040
75		Win.Trojan.Agent-899040
45		Win.Trojan.Agent-899040

Score total: 190.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:22:49Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fwk60rhWgEiD0ZMo7.exe SCORE: 744 TYPE: EXE SIZE: 22016 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7ff96ddf8400> 
MD5: c335a9d41185a32ad918c5389ee54235 
SHA1: c14680366c5148cde9043a29ef8f13392159bc28 
SHA256: 77003a5710a7c95df61ea015b6e4c204daee7f54cbf69e95f3fdbdda69e05403 CREATED: Fri Feb 11 14:22:49 2022 MODIFIED: Fri Feb 11 14:22:49 2022 ACCESSED: Fri Feb 11 14:23:42 2022 
REASON_1: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: InternetWriteFile Str6: HttpOpenRequest Str7: HttpS ... (truncated)
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA Str6: RegCreateKeyA
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: DeleteFileA Str5: CopyFile
REASON_6: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_7: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_8: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_9: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_10: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_13: Yara Rule MATCH: Microsoft_Visual_Cpp_v60 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Q Str2: 558bec6aff68f0094000684837400064a100000000506489250000000083ec20535657
REASON_14: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68f0094000684837400064a10000000050
REASON_15: Yara Rule MATCH: Microsoft_Visual_Cpp_50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68f0094000684837400064a10000000050
REASON_16: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec56 Str2: 558bec6a Str3: 558bec6aff68f0094000684837400064a10000000050
REASON_17: Yara Rule MATCH: Microsoft_Visual_Cpp SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec6aff68f0094000684837400064a1000000005064892500000000
REASON_18: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_21: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_23: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_24: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_25: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:23:42Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_http
60		win_mutex
20		win_registry
65		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_v60
70		Microsoft_Visual_Cpp_v50v60_MFC_additional
70		Microsoft_Visual_Cpp_50
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Microsoft_Visual_Cpp
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
40		SEH_Init
20		isExecutable
10		Contains_PE_File

Score total: 744

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 50/62
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:22:49                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-Fwk60rhWgEiD0ZMo7.exe
Real Name:	/c335a9d41185a32ad918c5389ee54235.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
70	Win.Trojan.Agent-899040
75	Win.Trojan.Agent-899040
45	Win.Trojan.Agent-899040

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
45	network_http
60	win_mutex
20	win_registry
65	win_token
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	Str_Win32_Wininet_Library
10	Str_Win32_Internet_API
10	Str_Win32_Http_API
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	0
ClamAV:	190.0
Loki:	744
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
16183.5636343196
==================================================================


==================================================================
Fichier HTTP-Fwk60rhWgEiD0ZMo7.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FNU0mnoiMKz8kTsjb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 18ec5becfa3991fb654e105bafbd5a4b                                                   |
| sha1                   | 1f3f79edbb6607b9640dd6a99856ee858af9cb55                                           |
| sha256                 | bf023ff344efe2db0e0a963869368f0ef352764666bc368ad61b7a4c1d9f5975                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FNU0mnoiMKz8kTsjb.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Get File Attributes:: [C0049]                                                 |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| copy file                                            | host-interaction/file-system/copy                    |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| read file via mapping                                | host-interaction/file-system/read                    |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::File and Directory Discovery [T1083;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FNU0mnoiMKz8kTsjb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 43.436 sec (0 m 43 s)
Start Date: 2022:02:11 14:23:43
End Date:   2022:02:11 14:24:27

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 30/70
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:23:43                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FNU0mnoiMKz8kTsjb.exe
Real Name:	/Practical Malware Analysis Lab 11-03.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Discovery::File and Directory Discovery [T1083;2]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	ft_exe
2	math_entropy_4
5	executable_pe
70	Microsoft_Visual_Cpp_v60
70	Microsoft_Visual_Cpp_v50v60_MFC_additional
70	Microsoft_Visual_Cpp_50
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Armadillo_v4x
70	Microsoft_Visual_Cpp
10	IsPE32
10	IsConsole
10	HasRichSignature
2	PE_File
40	SEH_Save
40	SEH_Init
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	10.0
ClamAV:	0
Loki:	589
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
11534.547135092846
==================================================================


==================================================================
Fichier HTTP-FNU0mnoiMKz8kTsjb.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FSgmHi3VTJ2wsywkO4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 1ef610b1f9646063f96ad880aad9569d                                                   |
| sha1                   | bb1ca3681747a48d82d2a95d573ee82adff2b0bd                                           |
| sha256                 | 563653399b82cd443f120eceff836ea3678d4cf11d9b351bb737573c2d856299                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FSgmHi3VTJ2wsywkO4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Virtual Machine Detection:: [B0009]                                           |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| reference anti-VM strings targeting VirtualBox       | anti-analysis/anti-vm/vm-detection                   |
| encode data using XOR (3 matches)                    | data-manipulation/encoding/xor                       |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| interact with driver via control codes               | host-interaction/driver                              |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via ntdll functions                  | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| check mutex and exit                                 | host-interaction/mutex                               |
| get system information on Windows                    | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| terminate process                                    | host-interaction/process/terminate                   |
| create or open registry key                          | host-interaction/registry                            |
| query service status                                 | host-interaction/service                             |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| start service                                        | host-interaction/service/start                       |
| stop service (2 matches)                             | host-interaction/service/stop                        |
| get ntdll base address (2 matches)                   | linking/runtime-linking                              |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| access PE header (2 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
9		- Impact::Service Stop [T1489;9]
3		- Execution::System Services::Service Execution [T1569.002;3]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 50.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FSgmHi3VTJ2wsywkO4.exe: Win.Trojan.ZeroCleare-7511225-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FSgmHi3VTJ2wsywkO4.exe: Win.Trojan.ZeroCleare-7511333-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FSgmHi3VTJ2wsywkO4.exe: Win.Trojan.ZeroCleare-7580180-2 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.14 MB
Data read: 0.14 MB (ratio 1.06:1)
Time: 40.980 sec (0 m 40 s)
Start Date: 2022:02:11 14:24:39
End Date:   2022:02:11 14:25:20

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.ZeroCleare-7511225-0
45		Win.Trojan.ZeroCleare-7511333-0
45		Win.Trojan.ZeroCleare-7580180-2

Score total: 135.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x87 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x87 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:24:40Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FSgmHi3VTJ2wsywkO4.exe SCORE: 569 TYPE: EXE SIZE: 146944 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f72d0654400> 
MD5: 1ef610b1f9646063f96ad880aad9569d 
SHA1: bb1ca3681747a48d82d2a95d573ee82adff2b0bd 
SHA256: 563653399b82cd443f120eceff836ea3678d4cf11d9b351bb737573c2d856299 CREATED: Fri Feb 11 14:24:39 2022 MODIFIED: Fri Feb 11 14:24:39 2022 ACCESSED: Fri Feb 11 14:25:33 2022 
REASON_1: Yara Rule MATCH: create_service SUBSCORE: 45 
DESCRIPTION: Create a windows service REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: CreateService Str3: ControlService Str4: StartService Str5: QueryServiceStatus
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: Intezer_Iranian_Wipers SUBSCORE: 90 
DESCRIPTION: Shamoon, ZeroCleare and Dustman REF: https://analyze.intezer.com AUTHOR: Intezer Labs
REASON_6: Yara Rule MATCH: ConventionEngine_Term_Desktop SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445387df26eb529a5949bb381fa6a09edbd90c000000433a5c55736572735c53445c4465736b746f705c54444c5c536f757263655c4675727574616b615c6f757 ... (truncated)
REASON_7: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445387df26eb529a5949bb381fa6a09edbd90c000000433a5c55736572735c53445c4465736b746f705c54444c5c536f757263655c4675727574616b615c6f757 ... (truncated)
REASON_8: Yara Rule MATCH: SUSP_XORed_URL_in_EXE SUBSCORE: 50 
DESCRIPTION: Detects an XORed URL in an executable REF: https://twitter.com/stvemillertime/status/1237035794973560834 AUTHOR: Florian Roth 
MATCHES: Str1: c2dededa908585
REASON_9: Yara Rule MATCH: MAL_ME_RawDisk_Agent_Jan20_2 SUBSCORE: 70 
DESCRIPTION: Detects suspicious malware using ElRawDisk REF: https://twitter.com/jfslowik/status/1212501454549741568?s=09 AUTHOR: Florian Roth 
MATCHES: Str1: The Magic Word! Str2: Software\Oracle\VirtualBox Str3: \.\%s Str4: 4981c6ffffff7f4c89b42498
REASON_10: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_12: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: VBox Str2: VirtualBox
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:25:34Z

-------- Score ----------------
Scores		Rules
.......		...............
45		create_service
60		win_mutex
20		win_registry
10		ft_exe
90		Intezer_Iranian_Wipers
50		ConventionEngine_Term_Desktop
50		ConventionEngine_Term_Users
50		SUSP_XORed_URL_in_EXE
70		MAL_ME_RawDisk_Agent_Jan20_2
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
35		VBox_Detection
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 569

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 48/65
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:24:39                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FSgmHi3VTJ2wsywkO4.exe
Real Name:	/563653399b82cd443f120eceff836ea3678d4cf11d9b351bb737573c2d856299.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
8.5	- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
4	- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
1	- Discovery::System Information Discovery [T1082;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
9	- Impact::Service Stop [T1489;9]
3	- Execution::System Services::Service Execution [T1569.002;3]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
45	Win.Trojan.ZeroCleare-7511225-0
45	Win.Trojan.ZeroCleare-7511333-0
45	Win.Trojan.ZeroCleare-7580180-2

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
45	create_service
60	win_mutex
20	win_registry
10	ft_exe
90	Intezer_Iranian_Wipers
50	ConventionEngine_Term_Desktop
50	ConventionEngine_Term_Users
50	SUSP_XORed_URL_in_EXE
70	MAL_ME_RawDisk_Agent_Jan20_2
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
35	VBox_Detection
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	50.5
ClamAV:	135.0
Loki:	569
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
13725.199040085146
==================================================================


==================================================================
Fichier HTTP-FSgmHi3VTJ2wsywkO4.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FRzMXm1aZQJoD7FSqb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e5369ac309f1be6d77afeeb3edab0ed8                                                   |
| sha1                   | b7afd3c57b074109bf576b77b33d641fd8e87871                                           |
| sha256                 | 478383fb588665c254d416b7c50a124f82291124b002d9bad9fd758a59fd728f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FRzMXm1aZQJoD7FSqb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                          |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                             |
|                        | Hide Artifacts::Hidden Window \[T1564.003]\                                         |
|                        | Indicator Removal on Host:: \[T1070]\                                               |
|                        | Indicator Removal on Host::Clear Windows Event Logs \[T1070.001]\                   |
|                        | Indicator Removal on Host::File Deletion \[T1070.004]\                              |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                  |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Subvert Trust Controls::Mark-of-the-Web Bypass \[T1553.005]\                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                         |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Network Share Discovery:: \[T1135]\                                                 |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Software Discovery:: \[T1518]\                                                      |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
|                        | Inhibit System Recovery:: \[T1490]\                                                 |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
|                             | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
|                             | Disk Content Wipe::Delete Shadow Drive [F0014.001]                            |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-debugging instructions                  | anti-analysis/anti-debugging/debugger-detection      |
| impersonate file version information                 | anti-analysis/anti-forensic                          |
| clear the Windows event log (2 matches)              | anti-analysis/anti-forensic/clear-logs               |
| timestomp file (3 matches)                           | anti-analysis/anti-forensic/timestomp                |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| create new key via CryptAcquireContext               | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt                      | data-manipulation/encryption                         |
| encrypt data using AES via WinAPI                    | data-manipulation/encryption/aes                     |
| hash data via WinCrypt                               | data-manipulation/hashing                            |
| initialize hashing via WinCrypt                      | data-manipulation/hashing                            |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| replace clipboard data                               | host-interaction/clipboard                           |
| query environment variable (6 matches)               | host-interaction/environment-variable                |
| bypass Mark of the Web                               | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| delete file (4 matches)                              | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files recursively (2 matches)              | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| get file size (2 matches)                            | host-interaction/file-system/meta                    |
| set file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| move file (2 matches)                                | host-interaction/file-system/move                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (3 matches)                    | host-interaction/file-system/write                   |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| hide graphical window (2 matches)                    | host-interaction/gui/window/hide                     |
| get number of processors                             | host-interaction/hardware/cpu                        |
| get disk information (2 matches)                     | host-interaction/hardware/storage                    |
| access the Windows event log (2 matches)             | host-interaction/log/winevt/access                   |
| check mutex and exit                                 | host-interaction/mutex                               |
| enumerate network shares                             | host-interaction/network                             |
| create process on Windows (3 matches)                | host-interaction/process/create                      |
| create process suspended (3 matches)                 | host-interaction/process/create                      |
| enumerate processes                                  | host-interaction/process/list                        |
| terminate process (3 matches)                        | host-interaction/process/terminate                   |
| delete registry value                                | host-interaction/registry/delete                     |
| get session information                              | host-interaction/session                             |
| create thread (3 matches)                            | host-interaction/thread/create                       |
| terminate thread                                     | host-interaction/thread/terminate                    |
| delete volume shadow copies                          | impact/inhibit-system-recovery                       |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| persist via Run registry key (2 matches)             | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4		- Execution::Command and Scripting Interpreter [T1059;4]
4		- Discovery::Application Window Discovery [T1010;4]
5		- Defense Evasion::File and Directory Permissions Modification [T1222;5]
3		- Discovery::System Owner/User Discovery [T1033;3]
8.5		- Defense Evasion::Indicator Removal on Host [T1070;8.5]
8.5		- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]
8.5		- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
6		- Defense Evasion::Subvert Trust Controls::Mark-of-the-Web Bypass [T1553.005;6]
4		- Discovery::Software Discovery [T1518;4]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
2		- Discovery::File and Directory Discovery [T1083;2]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6		- Collection::Clipboard Data [T1115;6]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Inhibit System Recovery [T1490;8]
4		- Discovery::Process Discovery [T1057;4]

Score total: 114.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FRzMXm1aZQJoD7FSqb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 42.956 sec (0 m 42 s)
Start Date: 2022:02:11 14:25:35
End Date:   2022:02:11 14:26:18

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:25:35Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FRzMXm1aZQJoD7FSqb.exe SCORE: 909 TYPE: EXE SIZE: 18432 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f51af38a400> 
MD5: e5369ac309f1be6d77afeeb3edab0ed8 
SHA1: b7afd3c57b074109bf576b77b33d641fd8e87871 
SHA256: 478383fb588665c254d416b7c50a124f82291124b002d9bad9fd758a59fd728f CREATED: Fri Feb 11 14:25:35 2022 MODIFIED: Fri Feb 11 14:25:35 2022 ACCESSED: Fri Feb 11 14:26:26 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: Destructive_Ransomware_Gen1 SUBSCORE: 70 
DESCRIPTION: Detects destructive malware REF: http://blog.talosintelligence.com/2018/02/olympic-destroyer.html AUTHOR: Florian Roth 
MATCHES: Str1: delete shadows /all /quiet
REASON_7: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_v50v60_MFC SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_10: Yara Rule MATCH: Borland_Delphi_30_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_11: Yara Rule MATCH: Borland_Delphi_30_ SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_12: Yara Rule MATCH: Borland_Delphi_v40_v50 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_13: Yara Rule MATCH: Borland_Delphi_v30 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_14: Yara Rule MATCH: Borland_Delphi_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 558bec83
REASON_15: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_18: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_20: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_21: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_22: Yara Rule MATCH: Win32_Ransomware_Kangaroo SUBSCORE: 60 
DESCRIPTION: Yara rule that detects Kangaroo ransomware. REF: - AUTHOR: ReversingLabs 
MATCHES: Str1: 83ec3053558b6c243c565733ff57576a03576a0768000000c033db55895c2440897c2434897c2430ff15003140008bf083feff0f84f60100008d442428508d4c24345 ... (truncated)
REASON_23: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_24: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_25: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:26:26Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
60		win_mutex
20		win_registry
10		win_files_operation
10		ft_exe
70		Destructive_Ransomware_Gen1
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_v50v60_MFC
70		Borland_Delphi_30_additional
70		Borland_Delphi_30_
70		Borland_Delphi_v40_v50
70		Borland_Delphi_v30
70		Borland_Delphi_DLL
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
60		Win32_Ransomware_Kangaroo
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API

Score total: 909

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 56/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:25:35                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FRzMXm1aZQJoD7FSqb.exe
Real Name:	/e5369ac309f1be6d77afeeb3edab0ed8.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
6	- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;6]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
4	- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4	- Execution::Command and Scripting Interpreter [T1059;4]
4	- Discovery::Application Window Discovery [T1010;4]
5	- Defense Evasion::File and Directory Permissions Modification [T1222;5]
3	- Discovery::System Owner/User Discovery [T1033;3]
8.5	- Defense Evasion::Indicator Removal on Host [T1070;8.5]
8.5	- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]
8.5	- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
6	- Defense Evasion::Subvert Trust Controls::Mark-of-the-Web Bypass [T1553.005;6]
4	- Discovery::Software Discovery [T1518;4]
8.5	- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
2	- Discovery::File and Directory Discovery [T1083;2]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6	- Collection::Clipboard Data [T1115;6]
1	- Discovery::System Information Discovery [T1082;1]
8	- Impact::Inhibit System Recovery [T1490;8]
4	- Discovery::Process Discovery [T1057;4]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
65	screenshot
60	win_mutex
20	win_registry
10	win_files_operation
10	ft_exe
70	Destructive_Ransomware_Gen1
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_v50v60_MFC
70	Borland_Delphi_30_additional
70	Borland_Delphi_30_
70	Borland_Delphi_v40_v50
70	Borland_Delphi_v30
70	Borland_Delphi_DLL
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
60	Win32_Ransomware_Kangaroo
20	isExecutable
10	Contains_PE_File
20	Advapi_Hash_API

============================[ Scores ]============================
CAPA:	114.0
ClamAV:	0
Loki:	909
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
18681.278158536043
==================================================================


==================================================================
Fichier HTTP-FRzMXm1aZQJoD7FSqb.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FiB7pu3xZ4doeWTuA6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FiB7pu3xZ4doeWTuA6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.48 MB
Data read: 0.46 MB (ratio 1.05:1)
Time: 44.116 sec (0 m 44 s)
Start Date: 2022:02:11 14:26:27
End Date:   2022:02:11 14:27:11

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 78: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 25: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 21: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 16: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 77: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 70: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 17: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 46: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 24: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 23: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 46: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 20: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 46: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 45: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 39: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 38: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 33: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 32: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 24: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 77: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 45: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 31: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 24: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 23: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 29: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 13: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:26:28Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FiB7pu3xZ4doeWTuA6.exe SCORE: 1849 TYPE: EXE SIZE: 485888 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe78d995400> 
MD5: 321338196a46b600ea330fc5d98d0699 
SHA1: 4383ae835ced10ee49f88fe5a965d70679d4a8bc 
SHA256: 66e51558f8bf9a329f2e9a2feb4592a4a30fd9124e171a8e2f17ba00fb902b0f CREATED: Fri Feb 11 14:26:27 2022 MODIFIED: Fri Feb 11 14:26:27 2022 ACCESSED: Fri Feb 11 14:27:18 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: FindClose
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e805000000e95affffff Str2: e805000000e945ffffff Str3: e861aeffffe9abfdffff Str4: e831acffffe97bfbffff Str5: e844a8ffffe98ef7ffff Str6 ... (truncated)
REASON_6: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: stager_reverse_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_12: Yara Rule MATCH: stager_bind_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_13: Yara Rule MATCH: win32_stage_boot_winsock_conn_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_14: Yara Rule MATCH: win32_stage_boot_bind_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_15: Yara Rule MATCH: win32_stage_boot_reverse_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_16: Yara Rule MATCH: win32_stage_boot_winsock_conn_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_17: Yara Rule MATCH: stager_reverse_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_18: Yara Rule MATCH: win32_stage_boot_bind_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_19: Yara Rule MATCH: win32_stage_boot_reverse_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_20: Yara Rule MATCH: win32_stage_boot_reverse_shell_revert_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_21: Yara Rule MATCH: win32_stage_winexec_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_22: Yara Rule MATCH: stager_bind_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_23: Yara Rule MATCH: win32_stage_boot_winsock_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_24: Yara Rule MATCH: win32_stage_boot_reverse_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_25: Yara Rule MATCH: win32_stage_api_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_26: Yara Rule MATCH: win32_stage_boot_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_27: Yara Rule MATCH: win32_stage_boot_reverse_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_28: Yara Rule MATCH: win32_stage_boot_reverse_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_29: Yara Rule MATCH: win32_stage_boot_bind_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_30: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_31: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_32: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_33: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: dbghelp.dll
REASON_34: Yara Rule MATCH: antisb_threatExpert SUBSCORE: 60 
DESCRIPTION: Anti-Sandbox checks for ThreatExpert REF: - AUTHOR: x0r 
MATCHES: Str1: dbghelp.dll
REASON_35: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_36: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_37: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: IsDebuggerPresent
REASON_38: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_39: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:27:18Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		ft_exe
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsConsole
10		HasDebugData
2		PE_File
70		stager_reverse_tcp_nx_ldone_x86
70		stager_bind_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_conn_ldone_x86
70		win32_stage_boot_bind_read_ldone_x86
70		win32_stage_boot_reverse_read_ldone_x86
70		win32_stage_boot_winsock_conn_udp_ldone_x86
70		stager_reverse_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_bind_inlineegg_ldone_x86
70		win32_stage_boot_reverse_ldone_x86
70		win32_stage_boot_reverse_shell_revert_ldone_x86
70		win32_stage_winexec_ldone_x86
70		stager_bind_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_bind_ldone_x86
70		win32_stage_boot_reverse_shell_ldone_x86
70		win32_stage_api_ldone_x86
70		win32_stage_boot_bind_ldone_x86
70		win32_stage_boot_reverse_udp_ldone_x86
70		win32_stage_boot_reverse_inlineegg_ldone_x86
70		win32_stage_boot_bind_shell_ldone_x86
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
60		antisb_threatExpert
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File

Score total: 1849

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 321338196a46b600ea330fc5d98d0699                                                   |
| sha1                   | 4383ae835ced10ee49f88fe5a965d70679d4a8bc                                           |
| sha256                 | 66e51558f8bf9a329f2e9a2feb4592a4a30fd9124e171a8e2f17ba00fb902b0f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FiB7pu3xZ4doeWTuA6.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check QueryPerformanceCounter [B0001.033]    |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| PROCESS                     | Resume Thread:: [C0054]                                                       |
|                             | Suspend Thread:: [C0055]                                                      |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via QueryPerformanceCounter     | anti-analysis/anti-debugging/debugger-detection      |
| compiled with dmd                                    | compiler/d                                           |
| encode data using XOR (3 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA (2 matches)              | data-manipulation/encryption/rc4                     |
| hash data using murmur3 (3 matches)                  | data-manipulation/hashing/murmur                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| query environment variable                           | host-interaction/environment-variable                |
| write file on Windows (3 matches)                    | host-interaction/file-system/write                   |
| get memory capacity (2 matches)                      | host-interaction/hardware/memory                     |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| resume thread (3 matches)                            | host-interaction/thread/resume                       |
| suspend thread                                       | host-interaction/thread/suspend                      |
| terminate thread                                     | host-interaction/thread/terminate                    |
| access PEB ldr_data (3 matches)                      | linking/runtime-linking                              |
| link many functions at runtime                       | linking/runtime-linking                              |
| parse PE exports (9 matches)                         | load-code/pe                                         |
| parse PE header (32 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 19.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 1/58
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:26:27                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FiB7pu3xZ4doeWTuA6.exe
Real Name:	/321338196a46b600ea330fc5d98d0699.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
8.5	- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
2	- Execution::Shared Modules [T1129;2]
1	- Discovery::System Information Discovery [T1082;1]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	ft_exe
2	math_entropy_6
5	executable_pe
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsConsole
10	HasDebugData
2	PE_File
70	stager_reverse_tcp_nx_ldone_x86
70	stager_bind_tcp_nx_ldone_x86
70	win32_stage_boot_winsock_conn_ldone_x86
70	win32_stage_boot_bind_read_ldone_x86
70	win32_stage_boot_reverse_read_ldone_x86
70	win32_stage_boot_winsock_conn_udp_ldone_x86
70	stager_reverse_ipv6_tcp_nx_ldone_x86
70	win32_stage_boot_bind_inlineegg_ldone_x86
70	win32_stage_boot_reverse_ldone_x86
70	win32_stage_boot_reverse_shell_revert_ldone_x86
70	win32_stage_winexec_ldone_x86
70	stager_bind_ipv6_tcp_nx_ldone_x86
70	win32_stage_boot_winsock_bind_ldone_x86
70	win32_stage_boot_reverse_shell_ldone_x86
70	win32_stage_api_ldone_x86
70	win32_stage_boot_bind_ldone_x86
70	win32_stage_boot_reverse_udp_ldone_x86
70	win32_stage_boot_reverse_inlineegg_ldone_x86
70	win32_stage_boot_bind_shell_ldone_x86
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
60	antisb_threatExpert
40	SEH_Save
40	SEH_Init
10	anti_dbg
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	19.5
ClamAV:	0
Loki:	1849
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
31693.751280024917
==================================================================


==================================================================
Fichier HTTP-FiB7pu3xZ4doeWTuA6.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FPFgQr1PlDMJhnPUc3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FPFgQr1PlDMJhnPUc3.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.20 MB
Data read: 0.19 MB (ratio 1.04:1)
Time: 35.761 sec (0 m 35 s)
Start Date: 2022:02:11 14:28:40
End Date:   2022:02:11 14:29:16

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 39009536cafe30c6ef2501fe46c9df5e                                                   |
| sha1                   | 6ff7b4d30f31186de899665c704a105227704b72                                           |
| sha256                 | 93d2604f7fdf7f014ac5bef63ab177b6107f3cfc26da6cbd9a7ab50c96564a04                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FPFgQr1PlDMJhnPUc3.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                             |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Service Discovery:: \[T1007]\                                                |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
|                        | System Services::Service Execution \[T1569.002]\                                    |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
|                        | Create or Modify System Process::Windows Service \[T1543.003]\                      |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                               |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| log keystrokes via polling                           | collection/keylog                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (5 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable (5 matches)               | host-interaction/environment-variable                |
| create directory                                     | host-interaction/file-system/create                  |
| delete file (3 matches)                              | host-interaction/file-system/delete                  |
| get file version info                                | host-interaction/file-system/meta                    |
| find graphical window                                | host-interaction/gui/window/find                     |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| get disk information                                 | host-interaction/hardware/storage                    |
| get system information on Windows                    | host-interaction/os/info                             |
| create process on Windows                            | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| modify access privileges                             | host-interaction/process/modify                      |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (4 matches)        | host-interaction/registry                            |
| set registry value (4 matches)                       | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| enumerate services                                   | host-interaction/service/list                        |
| modify service                                       | host-interaction/service/modify                      |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4		- Execution::Command and Scripting Interpreter [T1059;4]
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
2		- Discovery::File and Directory Discovery [T1083;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 47.5

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:28:40Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FPFgQr1PlDMJhnPUc3.exe SCORE: 494 TYPE: EXE SIZE: 197632 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f608f36f400> 
MD5: 39009536cafe30c6ef2501fe46c9df5e 
SHA1: 6ff7b4d30f31186de899665c704a105227704b72 
SHA256: 93d2604f7fdf7f014ac5bef63ab177b6107f3cfc26da6cbd9a7ab50c96564a04 CREATED: Fri Feb 11 14:28:40 2022 MODIFIED: Fri Feb 11 14:28:40 2022 ACCESSED: Fri Feb 11 14:29:34 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_3: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_4: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_5: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_10: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:29:35Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
65		screenshot
80		keylogger
20		win_registry
65		win_token
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsWindowsGUI
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Anti_Automated_Sandbox
20		isExecutable
10		Contains_PE_File

Score total: 494

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/65
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:28:40                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FPFgQr1PlDMJhnPUc3.exe
Real Name:	/msconfig.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
4	- Execution::Command and Scripting Interpreter [T1059;4]
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
5	- Privilege Escalation::Access Token Manipulation [T1134;5]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
3	- Execution::System Services::Service Execution [T1569.002;3]
6	- Collection::Input Capture::Keylogging [T1056.001;6]
2	- Discovery::File and Directory Discovery [T1083;2]
4	- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
8	- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
70	escalate_priv
65	screenshot
80	keylogger
20	win_registry
65	win_token
10	ft_exe
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsWindowsGUI
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Anti_Automated_Sandbox
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	47.5
ClamAV:	0
Loki:	494
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
8777.121970368116
==================================================================


==================================================================
Fichier HTTP-FPFgQr1PlDMJhnPUc3.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FweEUe4X489smFlZfj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FweEUe4X489smFlZfj.exe: Win.Exploit.CVE_2019_1219-7151042-2 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.52 MB
Data read: 0.50 MB (ratio 1.06:1)
Time: 43.300 sec (0 m 43 s)
Start Date: 2022:02:11 14:29:36
End Date:   2022:02:11 14:30:19

-------- Score ----------------
Scores		Rules
.......		...............
25		Win.Exploit.CVE_2019_1219-7151042-2

Score total: 25.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3cb21ae76ff3da4b7e02d77ff76e82be                                                   |
| sha1                   | 7156270661549f75c253f169fe8988690f6fc700                                           |
| sha256                 | c2c49f2592f78b7a70fd984dbbb25f7251dd1c851caa884f39ff1c8075f0b228                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FweEUe4X489smFlZfj.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Data from Information Repositories:: \[T1213]\                                     |
|                        | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Asynchronous Procedure Call \[T1055.004]\                       |
|                        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
|                        | Virtualization/Sandbox Evasion::User Activity Based Checks \[T1497.002]\           |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
|                        | Windows Management Instrumentation:: \[T1047]\                                     |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection:: [B0001]                                                  |
|                             | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
|                             | Debugger Detection::CheckRemoteDebuggerPresent [B0001.002]                    |
|                             | Debugger Detection::Memory Write Watching [B0001.010]                         |
|                             | Debugger Detection::OutputDebugString [B0001.016]                             |
|                             | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
|                             | Debugger Detection::Process Environment Block NtGlobalFlag [B0001.036]        |
|                             | Debugger Detection::SetHandleInformation [B0001.024]                          |
|                             | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Debugger Detection::WudfIsAnyDebuggerPresent [B0001.031]                      |
|                             | Emulator Detection:: [B0004]                                                  |
|                             | Virtual Machine Detection:: [B0009]                                           |
|                             | Virtual Machine Detection::Human User Check [B0009.012]                       |
| COLLECTION                  | Keylogging::Application Hook [F0002.001]                                      |
| COMMUNICATION               | ICMP Communication::Echo Request [C0014.002]                                  |
| DISCOVERY                   | Analysis Tool Discovery::Process Detection [B0013.001]                        |
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference analysis tools strings                     | anti-analysis                                        |
| check for OutputDebugString error                    | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB BeingDebugged flag                     | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB NtGlobalFlag flag                      | anti-analysis/anti-debugging/debugger-detection      |
| check for debugger via API                           | anti-analysis/anti-debugging/debugger-detection      |
| check for protected handle exception                 | anti-analysis/anti-debugging/debugger-detection      |
| check for software breakpoints                       | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| check for trap flag exception                        | anti-analysis/anti-debugging/debugger-detection      |
| check for unexpected memory writes (3 matches)       | anti-analysis/anti-debugging/debugger-detection      |
| check process job object                             | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-debugging instructions (2 matches)      | anti-analysis/anti-debugging/debugger-detection      |
| check if process is running under wine (2 matches)   | anti-analysis/anti-emulation/wine                    |
| check for unmoving mouse cursor                      | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Parallels        | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Qemu             | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VMWare           | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VirtualBox       | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VirtualPC        | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Xen              | anti-analysis/anti-vm/vm-detection                   |
| reference WMI statements (30 matches)                | collection/database/wmi                              |
| log keystrokes via application hook                  | collection/keylog                                    |
| get MAC address on Windows                           | collection/network                                   |
| send ICMP echo request                               | communication/icmp                                   |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| interact with driver via control codes               | host-interaction/driver                              |
| query environment variable (4 matches)               | host-interaction/environment-variable                |
| get Program Files directory (2 matches)              | host-interaction/file-system                         |
| get common file path (5 matches)                     | host-interaction/file-system                         |
| read raw disk data                                   | host-interaction/file-system                         |
| check if file exists (2 matches)                     | host-interaction/file-system/exists                  |
| get file attributes (2 matches)                      | host-interaction/file-system/meta                    |
| set console window title                             | host-interaction/gui/console                         |
| find graphical window                                | host-interaction/gui/window/find                     |
| get number of processor cores                        | host-interaction/hardware/cpu                        |
| get number of processors                             | host-interaction/hardware/cpu                        |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| enumerate disk properties                            | host-interaction/hardware/storage                    |
| get disk information (2 matches)                     | host-interaction/hardware/storage                    |
| get disk size (2 matches)                            | host-interaction/hardware/storage                    |
| print debug messages (6 matches)                     | host-interaction/log/debug/write-event               |
| create mutex                                         | host-interaction/mutex                               |
| get system information on Windows (4 matches)        | host-interaction/os/info                             |
| get process heap flags (2 matches)                   | host-interaction/process                             |
| get process heap force flags (2 matches)             | host-interaction/process                             |
| read process memory (2 matches)                      | host-interaction/process                             |
| allocate RWX memory (2 matches)                      | host-interaction/process/inject                      |
| inject APC                                           | host-interaction/process/inject                      |
| inject dll                                           | host-interaction/process/inject                      |
| inject thread                                        | host-interaction/process/inject                      |
| enumerate processes                                  | host-interaction/process/list                        |
| get Explorer PID                                     | host-interaction/process/list                        |
| acquire debug privileges                             | host-interaction/process/modify                      |
| modify access privileges                             | host-interaction/process/modify                      |
| enumerate process modules (2 matches)                | host-interaction/process/modules/list                |
| terminate process                                    | host-interaction/process/terminate                   |
| terminate process via fastfail (3 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry value                    | host-interaction/registry                            |
| enumerate services                                   | host-interaction/service/list                        |
| enumerate threads (2 matches)                        | host-interaction/thread/list                         |
| connect to WMI namespace via WbemLocator             | host-interaction/wmi                                 |
| get kernel32 base address                            | linking/runtime-linking                              |
| link function at runtime on Windows (7 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
4		- Defense Evasion::Process Injection::Asynchronous Procedure Call [T1055.004;4]
3		- Execution::System Services::Service Execution [T1569.002;3]
5		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
4		- Discovery::Application Window Discovery [T1010;4]
4		- Discovery::Software Discovery [T1518;4]
4.5		- Execution::Windows Management Instrumentation [T1047;4.5]
2		- Discovery::File and Directory Discovery [T1083;2]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
5		- Collection::Data from Information Repositories [T1213;5]
7.5		- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]
4		- Discovery::Process Discovery [T1057;4]

Score total: 88.0

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 43/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:29:36                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FweEUe4X489smFlZfj.exe
Real Name:	/al-khaser_x64.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
8.5	- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
4	- Defense Evasion::Process Injection::Asynchronous Procedure Call [T1055.004;4]
3	- Execution::System Services::Service Execution [T1569.002;3]
5	- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
4	- Discovery::Application Window Discovery [T1010;4]
4	- Discovery::Software Discovery [T1518;4]
4.5	- Execution::Windows Management Instrumentation [T1047;4.5]
2	- Discovery::File and Directory Discovery [T1083;2]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
2.5	- Defense Evasion::Modify Registry [T1112;2.5]
6	- Collection::Input Capture::Keylogging [T1056.001;6]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
6	- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;6]
5	- Privilege Escalation::Access Token Manipulation [T1134;5]
1	- Discovery::System Information Discovery [T1082;1]
1	- Discovery::Query Registry [T1012;1]
5	- Collection::Data from Information Repositories [T1213;5]
7.5	- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]
4	- Discovery::Process Discovery [T1057;4]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
25	Win.Exploit.CVE_2019_1219-7151042-2

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	inject_thread
70	escalate_priv
65	screenshot
80	keylogger
45	migrate_apc
60	win_mutex
20	win_registry
65	win_token
10	win_private_profile
10	win_files_operation
10	ft_exe
50	ConventionEngine_Term_Desktop
50	ConventionEngine_Term_Users
2	math_entropy_5
5	obfuscation_singlebyte_mov
5	executable_pe
15	self_inject
15	dll_injection_thread
15	dll_injection_hook
25	possible_includes_base64_packed_functions
70	Microsoft_Visual_Cpp_V80_Debug
70	Microsoft_Visual_Cpp_80_Debug_
70	Microsoft_Visual_Cpp_80_Debug
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
10	virtualbox_detection
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
60	VM_Detect_VirtualPC_XEN_Wine_v1
35	Anti_Automated_Sandbox
30	Check_Dlls
60	Check_VBox_DeviceMap
60	Check_VBox_VideoDrivers
60	Check_VmTools
60	vmdetect_2
50	WMI_VM_Detect_v1
35	AtomTable_Inject
40	DLL_inject
45	Inject_Thread
35	Win_Hook_v12
35	Process_Doppelganging
40	Atom_Bombing
40	APC_Inject
60	Debugger_Check__GlobalFlags
60	Debugger_Check__QueryInfo
60	Debugger_Check__RemoteAPI
60	Debugger_Hiding__Thread
60	DebuggerHiding__Active_v1
60	DebuggerException__ConsoleCtrl_v1
60	DebuggerException__SetConsoleCtrl_v1
60	ThreadControl__Context_v1
60	SEH__vectored_v1
60	Check_Debugger_v1
40	Check_Qemu_Description
40	Check_Qemu_DeviceMap
60	vmdetect
50	WMI_VM_Detect
10	anti_dbg
50	vmdetect_misc
70	INDICATOR_SUSPICIOUS_EXE_SandboxHookingDLL
70	INDICATOR_SUSPICIOUS_References_SecTools
70	INDICATOR_SUSPICIOUS_VM_Evasion_VirtDrvComb
70	INDICATOR_SUSPICIOUS_VM_Evasion_MACAddrComb
25	VMdetectMisc
70	SandboxDetectMisc
70	avdetect_procs
70	dbgdetect_procs
60	TrojanDownloaderCbeplaySample
20	isExecutable
10	Contains_PE_File
25	MD5_API

============================[ Scores ]============================
CAPA:	88.0
ClamAV:	25.0
Loki:	3199
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
54771.29541695217
==================================================================


==================================================================
Fichier HTTP-FweEUe4X489smFlZfj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FXroAsX4scUgnKIj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c62801f2fd980d444ec12455f83cf536                                                   |
| sha1                   | 82f508b9caaf23f766935d03d43c28c787ae1b2b                                           |
| sha256                 | 5b63cdaa6b386340186d48fca6687b51d666f4457c1d1228c4915bdd2917a315                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FXroAsX4scUgnKIj.exe                          |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get disk information                                 | host-interaction/hardware/storage                    |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FXroAsX4scUgnKIj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 37.045 sec (0 m 37 s)
Start Date: 2022:02:11 14:31:16
End Date:   2022:02:11 14:31:53

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:31:16Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FXroAsX4scUgnKIj.exe SCORE: 229 TYPE: EXE SIZE: 17920 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7c418bf400> 
MD5: c62801f2fd980d444ec12455f83cf536 
SHA1: 82f508b9caaf23f766935d03d43c28c787ae1b2b 
SHA256: 5b63cdaa6b386340186d48fca6687b51d666f4457c1d1228c4915bdd2917a315 CREATED: Fri Feb 11 14:31:16 2022 MODIFIED: Fri Feb 11 14:31:16 2022 ACCESSED: Fri Feb 11 14:32:09 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 2 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: Microsoft_Visual_Cpp_80 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28e86b0200004883c428e91efeffffcccccccccccccccccccccccccccc
REASON_5: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:32:09Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_5
5		executable_pe
70		Microsoft_Visual_Cpp_80
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 229

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:31:16                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FXroAsX4scUgnKIj.exe
Real Name:	/label.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
1	- Discovery::System Information Discovery [T1082;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_5
5	executable_pe
70	Microsoft_Visual_Cpp_80
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	4.0
ClamAV:	0
Loki:	229
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
3709.2159033347043
==================================================================


==================================================================
Fichier HTTP-FXroAsX4scUgnKIj.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FqD823XimoNNfQXsd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FqD823XimoNNfQXsd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.32 MB
Data read: 0.30 MB (ratio 1.05:1)
Time: 39.945 sec (0 m 39 s)
Start Date: 2022:02:11 14:32:10
End Date:   2022:02:11 14:32:50

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 4-5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 4-5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 78: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 63: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xca in position 62: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 14: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 19: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 18: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 15: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 14: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:32:10Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FqD823XimoNNfQXsd.exe SCORE: 524 TYPE: EXE SIZE: 315904 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7feb1bf78400> 
MD5: e4c33ac3638eef68311f8ac0d72483c7 
SHA1: f78bc256038330de1b23be28e93206d9b64d03ef 
SHA256: 033f4cb193b78f18f70c36e53ab46b21b81449c59e9fe302e1778a6898a5479a CREATED: Fri Feb 11 14:32:10 2022 MODIFIED: Fri Feb 11 14:32:10 2022 ACCESSED: Fri Feb 11 14:33:04 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: CreateFileA Str6: FindClose
REASON_2: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453e9937259b583cf48a17705ed53425f9301000000433a5c55736572735c757365725c736f757263655c7265706f735c61737369676e6d656e74325c4465627 ... (truncated)
REASON_5: Yara Rule MATCH: ConventionEngine_Term_Users_User SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453e9937259b583cf48a17705ed53425f9301000000433a5c55736572735c757365725c736f757263655c7265706f735c61737369676e6d656e74325c4465627 ... (truncated)
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_8: Yara Rule MATCH: VC8_Microsoft_Corporation SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: e8ca030000e917feffff Str2: e804720000e9a1ffffff Str3: e806000000e962ffffff Str4: e81ee5ffffe92affffff Str5: e804000000e9d3fdffff Str6 ... (truncated)
REASON_9: Yara Rule MATCH: Microsoft_Visual_Cpp_8 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: @B Str2:  Str3:  Str4:  Str5:  Str6:  Str7:  Str8:  Str9:  Str10:  Str11:  Str12:  Str13:  Str14:  Str15:  Str16:  Str17:  Str18:  St ... (truncated)
REASON_10: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_16: Yara Rule MATCH: SEH_Save SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_17: Yara Rule MATCH: SEH_Init SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_19: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: Crypt32_CryptBinaryToString_API SUBSCORE: 25 
DESCRIPTION: Looks for crypt32 CryptBinaryToStringA function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: CRYPT32.dll Str2: CryptBinaryToStringA
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:33:05Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		ft_exe
50		ConventionEngine_Term_Users
50		ConventionEngine_Term_Users_User
2		math_entropy_6
5		executable_pe
70		VC8_Microsoft_Corporation
70		Microsoft_Visual_Cpp_8
10		IsPE32
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
60		DebuggerException__SetConsoleCtrl_v1
40		SEH_Save
40		SEH_Init
10		anti_dbg
20		isExecutable
10		Contains_PE_File
25		Crypt32_CryptBinaryToString_API

Score total: 524

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e4c33ac3638eef68311f8ac0d72483c7                                                   |
| sha1                   | f78bc256038330de1b23be28e93206d9b64d03ef                                           |
| sha256                 | 033f4cb193b78f18f70c36e53ab46b21b81449c59e9fe302e1778a6898a5479a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FqD823XimoNNfQXsd.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| initialize Winsock library                           | communication/socket                                 |
| encode data using Base64 via WinAPI                  | data-manipulation/encoding/base64                    |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| set environment variable (2 matches)                 | host-interaction/environment-variable                |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| read file via mapping                                | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| print debug messages (2 matches)                     | host-interaction/log/debug/write-event               |
| get hostname                                         | host-interaction/os/hostname                         |
| get session user name                                | host-interaction/session                             |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| inject DLL reflectively                              | load-code/pe                                         |
| inspect section memory permissions                   | load-code/pe                                         |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
5.5		- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2		- Execution::Shared Modules [T1129;2]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::System Information Discovery [T1082;1]
2		- Discovery::File and Directory Discovery [T1083;2]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]
3		- Discovery::Account Discovery [T1087;3]

Score total: 25.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Fichier non trouvé sur VirusTotal...
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:32:10                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FqD823XimoNNfQXsd.exe
Real Name:	/e4c33ac3638eef68311f8ac0d72483c7.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
5	- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;5]
5.5	- Command and Control::Non-Application Layer Protocol [T1095;5.5]
2	- Execution::Shared Modules [T1129;2]
3	- Discovery::System Owner/User Discovery [T1033;3]
1	- Discovery::System Information Discovery [T1082;1]
2	- Discovery::File and Directory Discovery [T1083;2]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]
3	- Discovery::Account Discovery [T1087;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	win_files_operation
10	Str_Win32_Winsock2_Library
10	ft_exe
50	ConventionEngine_Term_Users
50	ConventionEngine_Term_Users_User
2	math_entropy_6
5	executable_pe
70	VC8_Microsoft_Corporation
70	Microsoft_Visual_Cpp_8
10	IsPE32
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
60	DebuggerException__SetConsoleCtrl_v1
40	SEH_Save
40	SEH_Init
10	anti_dbg
20	isExecutable
10	Contains_PE_File
25	Crypt32_CryptBinaryToString_API

============================[ Scores ]============================
CAPA:	25.5
ClamAV:	0
Loki:	524
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
8813.632218813298
==================================================================


==================================================================
Fichier HTTP-FqD823XimoNNfQXsd.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FlvqN32QMrXjJOW9Gd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FlvqN32QMrXjJOW9Gd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.23 MB
Data read: 0.23 MB (ratio 1.03:1)
Time: 35.639 sec (0 m 35 s)
Start Date: 2022:02:11 14:33:40
End Date:   2022:02:11 14:34:16

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:33:40Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FlvqN32QMrXjJOW9Gd.exe SCORE: 309 TYPE: EXE SIZE: 239416 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9f5516e400> 
MD5: 05aeb5e395b205d60ae010c5105b71f9 
SHA1: b2ae6398c50353baf9de5b1c16a74f79437f9310 
SHA256: 29649c628aa857904fa83bf577ef4f70527fa73bb4fa4c1539f6dc8ddfb896aa CREATED: Fri Feb 11 14:33:40 2022 MODIFIED: Fri Feb 11 14:33:40 2022 ACCESSED: Fri Feb 11 14:34:32 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_17: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:34:32Z

-------- Score ----------------
Scores		Rules
.......		...............
60		win_mutex
10		misc_pe_signature
10		ft_exe
20		research_pe_signed_outside_timestamp
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
20		isExecutable
10		Contains_PE_File
5		BASE64_table

Score total: 309

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 05aeb5e395b205d60ae010c5105b71f9                                                   |
| sha1                   | b2ae6398c50353baf9de5b1c16a74f79437f9310                                           |
| sha256                 | 29649c628aa857904fa83bf577ef4f70527fa73bb4fa4c1539f6dc8ddfb896aa                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FlvqN32QMrXjJOW9Gd.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location                            | collection                                           |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| enumerate gui resources                              | host-interaction/gui                                 |
| terminate process via fastfail (6 matches)           | host-interaction/process/terminate                   |
| create thread (2 matches)                            | host-interaction/thread/create                       |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Discovery::Application Window Discovery [T1010;4]
2		- Execution::Shared Modules [T1129;2]
1.5		- Discovery::System Location Discovery [T1614;1.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 11.5

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/64
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:33:40                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FlvqN32QMrXjJOW9Gd.exe
Real Name:	/SettingsHandlers_SIUF.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Discovery::Application Window Discovery [T1010;4]
2	- Execution::Shared Modules [T1129;2]
1.5	- Discovery::System Location Discovery [T1614;1.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
60	win_mutex
10	misc_pe_signature
10	ft_exe
20	research_pe_signed_outside_timestamp
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
20	isExecutable
10	Contains_PE_File
5	BASE64_table

============================[ Scores ]============================
CAPA:	11.5
ClamAV:	0
Loki:	309
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
5126.775130926261
==================================================================


==================================================================
Fichier HTTP-FlvqN32QMrXjJOW9Gd.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FZCQBdVml64nUuYM1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b1116e05a2aeda8e95f89e74c1525a6c                                                   |
| sha1                   | 7685045ccd89e21943330c049a84e6f0184104be                                           |
| sha256                 | 1cdf9d33b2c92a212c8a297802178127f354131d6d05641b6fdb6c52aff5fde3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FZCQBdVml64nUuYM1.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
| PROCESS                     | Resume Thread:: [C0054]                                                       |
|                             | Suspend Thread:: [C0055]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| decode data using Base64 via WinAPI                  | data-manipulation/encoding/base64                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| read file on Windows                                 | host-interaction/file-system/read                    |
| check OS version                                     | host-interaction/os/version                          |
| acquire debug privileges                             | host-interaction/process/modify                      |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| resume thread                                        | host-interaction/thread/resume                       |
| suspend thread                                       | host-interaction/thread/suspend                      |
| parse PE header (5 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
1		- Discovery::System Information Discovery [T1082;1]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

Score total: 19.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FZCQBdVml64nUuYM1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.28 MB
Data read: 0.27 MB (ratio 1.06:1)
Time: 43.260 sec (0 m 43 s)
Start Date: 2022:02:11 14:34:52
End Date:   2022:02:11 14:35:35

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:34:52Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FZCQBdVml64nUuYM1.exe SCORE: 544 TYPE: EXE SIZE: 282488 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa419e91400> 
MD5: b1116e05a2aeda8e95f89e74c1525a6c 
SHA1: 7685045ccd89e21943330c049a84e6f0184104be 
SHA256: 1cdf9d33b2c92a212c8a297802178127f354131d6d05641b6fdb6c52aff5fde3 CREATED: Fri Feb 11 14:34:52 2022 MODIFIED: Fri Feb 11 14:34:52 2022 ACCESSED: Fri Feb 11 14:35:45 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 60 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: misc_pe_signature SUBSCORE: 10 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_7: Yara Rule MATCH: Microsoft_Visual_Cpp_80_DLL SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 4883ec28
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 10 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_17: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_18: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread
REASON_19: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 340b71789a9b7dc52cae1c90b8a71a90
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:35:46Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
60		win_mutex
10		misc_pe_signature
10		ft_exe
2		math_entropy_6
5		executable_pe
70		Microsoft_Visual_Cpp_80_DLL
10		IsPE64
10		IsConsole
10		HasOverlay
10		HasDebugData
10		HasRichSignature
2		PE_File
35		Qemu_Detection
35		VBox_Detection
35		VMWare_Detection
35		Anti_Automated_Sandbox
45		Inject_Thread
60		Debugger_Check__QueryInfo
20		isExecutable
10		Contains_PE_File
10		Big_Numbers1

Score total: 544

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/66
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:34:52                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FZCQBdVml64nUuYM1.exe
Real Name:	/ttdinject.exe
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
2	- Execution::Shared Modules [T1129;2]
5	- Privilege Escalation::Access Token Manipulation [T1134;5]
4	- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
1	- Discovery::System Information Discovery [T1082;1]
6.5	- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
50	inject_thread
60	win_mutex
10	misc_pe_signature
10	ft_exe
2	math_entropy_6
5	executable_pe
70	Microsoft_Visual_Cpp_80_DLL
10	IsPE64
10	IsConsole
10	HasOverlay
10	HasDebugData
10	HasRichSignature
2	PE_File
35	Qemu_Detection
35	VBox_Detection
35	VMWare_Detection
35	Anti_Automated_Sandbox
45	Inject_Thread
60	Debugger_Check__QueryInfo
20	isExecutable
10	Contains_PE_File
10	Big_Numbers1

============================[ Scores ]============================
CAPA:	19.5
ClamAV:	0
Loki:	544
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
9010.895118407387
==================================================================


==================================================================
Fichier HTTP-FZCQBdVml64nUuYM1.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FeiQul17v7Zlmg1bJi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FeiQul17v7Zlmg1bJi.exe: Win.Trojan.Buzus-9327 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.57 MB
Data read: 0.41 MB (ratio 1.39:1)
Time: 41.080 sec (0 m 41 s)
Start Date: 2022:02:11 14:35:47
End Date:   2022:02:11 14:36:28

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Buzus-9327

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:35:47Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FeiQul17v7Zlmg1bJi.exe SCORE: 799 TYPE: EXE SIZE: 429568 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb28b5fb400> 
MD5: db9fe790b4e18abf55df31aa0b81e558 
SHA1: 97f2462c4462364babbc82ad49b7bd65e8647474 
SHA256: d7dbe8d8a68c26bf5d00adb957a4dbf5bd6415a81b50a823a4b872a6d2f494cf CREATED: Fri Feb 11 14:35:47 2022 MODIFIED: Fri Feb 11 14:35:47 2022 ACCESSED: Fri Feb 11 14:36:39 2022 
REASON_1: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: USER32.DLL Str3: GetAsyncKeyState
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: KERNEL32.DLL Str3: WriteFile Str4: DeleteFileA Str5: CreateFileA
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_4 SUBSCORE: 2 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_6: Yara Rule MATCH: PEBundle_v244_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 9c60e80200000033c08bc483c004938be38b5bfc81eb0720400087dd83bd
REASON_7: Yara Rule MATCH: PEBundle_v310 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 9c60e80200000033c08bc483c004938be38b5bfc81eb0720400087dd83bd3d29400001
REASON_8: Yara Rule MATCH: PEBundle_v310_additional SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 9c60e80200000033c08bc483c004938be38b5bfc81eb0720400087dd83bd3d29400001
REASON_9: Yara Rule MATCH: PEBundle_20x_24x_Jeremy_Collake SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 9c60e80200000033c08bc483c004938be38b5bfc81eb0720400087dd83bd
REASON_10: Yara Rule MATCH: PEBundle_v244 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 9c60e80200000033c08bc483c004938be38b5bfc81eb0720400087dd83bd
REASON_11: Yara Rule MATCH: PEBundlev310 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: 9c60e80200000033c08bc483c004938be38b5bfc81eb0720400087dd83bd3d29400001
REASON_12: Yara Rule MATCH: PEBundlev244 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: malware-lu 
MATCHES: Str1: 9c60e80200000033c08bc483c004938be38b5bfc81eb0720400087dd83bd
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: USER32.DLL Str3: SetWindowsHookExA Str4: CallNextHookEx
REASON_19: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: pebundle
REASON_20: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 88888888888888888888
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:36:40Z

-------- Score ----------------
Scores		Rules
.......		...............
80		keylogger
10		win_files_operation
10		ft_exe
2		math_entropy_4
5		executable_pe
70		PEBundle_v244_additional
70		PEBundle_v310
70		PEBundle_v310_additional
70		PEBundle_20x_24x_Jeremy_Collake
70		PEBundle_v244
70		PEBundlev310
70		PEBundlev244
10		IsPE32
10		IsWindowsGUI
10		HasRichSignature
35		Embedded_PE
2		PE_File
35		Win_Hook_v12
60		suspicious_packer_section
20		isExecutable
10		Contains_PE_File
10		Big_Numbers0

Score total: 799

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 39/64
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:35:47                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FeiQul17v7Zlmg1bJi.exe
Real Name:	/db9fe790b4e18abf55df31aa0b81e558.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
0	No Match

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
45	Win.Trojan.Buzus-9327

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
80	keylogger
10	win_files_operation
10	ft_exe
2	math_entropy_4
5	executable_pe
70	PEBundle_v244_additional
70	PEBundle_v310
70	PEBundle_v310_additional
70	PEBundle_20x_24x_Jeremy_Collake
70	PEBundle_v244
70	PEBundlev310
70	PEBundlev244
10	IsPE32
10	IsWindowsGUI
10	HasRichSignature
35	Embedded_PE
2	PE_File
35	Win_Hook_v12
60	suspicious_packer_section
20	isExecutable
10	Contains_PE_File
10	Big_Numbers0

============================[ Scores ]============================
CAPA:	0
ClamAV:	45.0
Loki:	799
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
15229.813043071672
==================================================================


==================================================================
Fichier HTTP-FeiQul17v7Zlmg1bJi.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FgDbRb2zjht8mHjXng.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FgDbRb2zjht8mHjXng.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.11 MB
Data read: 0.11 MB (ratio 1.00:1)
Time: 38.386 sec (0 m 38 s)
Start Date: 2022:02:11 14:36:41
End Date:   2022:02:11 14:37:19

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ad82b246ddc7b8a49936670ec1ecbec8                                                   |
| sha1                   | e7be001f09b210ad402f76a7f7d336477440d762                                           |
| sha256                 | f405ef44de0fa7c79c20a4843fe0f76eebf64e34d32ebb29aa98d998acf89036                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FgDbRb2zjht8mHjXng.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::3DES [C0027.004]                                                |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DEFENSE EVASION             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| create new key via CryptAcquireContext               | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt (3 matches)          | data-manipulation/encryption                         |
| encrypt data using AES via WinAPI (2 matches)        | data-manipulation/encryption/aes                     |
| encrypt data using DES via WinAPI                    | data-manipulation/encryption/des                     |
| hash data via WinCrypt (2 matches)                   | data-manipulation/hashing                            |
| hash data using SHA1                                 | data-manipulation/hashing/sha1                       |
| hash data using SHA1 via WinCrypt                    | data-manipulation/hashing/sha1                       |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 4.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:36:41Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FgDbRb2zjht8mHjXng.exe SCORE: 184 TYPE: EXE SIZE: 111616 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7b8b6d3400> 
MD5: ad82b246ddc7b8a49936670ec1ecbec8 
SHA1: e7be001f09b210ad402f76a7f7d336477440d762 
SHA256: f405ef44de0fa7c79c20a4843fe0f76eebf64e34d32ebb29aa98d998acf89036 CREATED: Fri Feb 11 14:36:41 2022 MODIFIED: Fri Feb 11 14:36:41 2022 ACCESSED: Fri Feb 11 14:37:30 2022 
REASON_1: Yara Rule MATCH: win_token SUBSCORE: 65 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 10 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 10 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:37:31Z

-------- Score ----------------
Scores		Rules
.......		...............
65		win_token
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE64
10		IsDLL
10		IsConsole
10		HasDebugData
10		HasRichSignature
2		PE_File
20		isExecutable
10		Contains_PE_File
20		Advapi_Hash_API

Score total: 184

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 0/67
Fichier légitime -> Score: 0
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:36:41                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FgDbRb2zjht8mHjXng.exe
Real Name:	/secproc_ssp.dll
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
65	win_token
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE64
10	IsDLL
10	IsConsole
10	HasDebugData
10	HasRichSignature
2	PE_File
20	isExecutable
10	Contains_PE_File
20	Advapi_Hash_API

============================[ Scores ]============================
CAPA:	4.0
ClamAV:	0
Loki:	184
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	0
==========================[ SCORE_FINAL ]=========================
2996.0139667272033
==================================================================


==================================================================
Fichier HTTP-FgDbRb2zjht8mHjXng.exe Légitime
==================================================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FRLpQc3GMACNrvHAne.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5b3968b47eb16a1cb88525e3b565eab1                                                   |
| sha1                   | 43f2c73e08b589d6885bd248b056fe4ac99a590b                                           |
| sha256                 | 5f70c76b6771b7c56bc5da34e424eb9a090cedeb807c795795a88c415a2e772c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FRLpQc3GMACNrvHAne.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| compiled with MinGW for Windows                      | compiler/mingw                                       |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable                           | host-interaction/environment-variable                |
| write file on Windows                                | host-interaction/file-system/write                   |
| get thread local storage value                       | host-interaction/process                             |
| execute command                                      | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| enumerate PE sections                                | load-code/pe                                         |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (4 matches)                          | load-code/pe                                         |
| load NCR ATM library                                 | targeting/automated-teller-machine/ncr               |
| reference NCR ATM library routines                   | targeting/automated-teller-machine/ncr               |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
1		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3		- Defense Evasion::Obfuscated Files or Information [T1027;3]

Score total: 11.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FRLpQc3GMACNrvHAne.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8778515
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 42.367 sec (0 m 42 s)
Start Date: 2022:02:11 14:37:32
End Date:   2022:02:11 14:38:14

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 2: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220211T13:37:32Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3976 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FRLpQc3GMACNrvHAne.exe SCORE: 79 TYPE: EXE SIZE: 50176 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fdd64262400> 
MD5: 5b3968b47eb16a1cb88525e3b565eab1 
SHA1: 43f2c73e08b589d6885bd248b056fe4ac99a590b 
SHA256: 5f70c76b6771b7c56bc5da34e424eb9a090cedeb807c795795a88c415a2e772c CREATED: Fri Feb 11 14:37:32 2022 MODIFIED: Fri Feb 11 14:37:32 2022 ACCESSED: Fri Feb 11 14:38:27 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 10 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_6 SUBSCORE: 2 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: executable_pe SUBSCORE: 5 
DESCRIPTION: Detect PE executable based on MZ and PE magic REF: - AUTHOR: - 
MATCHES: Str1: PE
REASON_4: Yara Rule MATCH: IsPE32 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsConsole SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: MinGW_1 SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: _pusher_ 
MATCHES: Str1: msvcrt.dll Str2: mingw32 Str3: Mingw runtime failure:
REASON_7: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: isExecutable SUBSCORE: 20 
DESCRIPTION: Yara rule to check for unobfuscated rat created with njrat REF: - AUTHOR: 73mp74710n 
MATCHES: Str1: 4d5a9000 Str2: PE
REASON_9: Yara Rule MATCH: Contains_PE_File SUBSCORE: 10 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220211T13:38:27Z

-------- Score ----------------
Scores		Rules
.......		...............
10		ft_exe
2		math_entropy_6
5		executable_pe
10		IsPE32
10		IsConsole
10		MinGW_1
2		PE_File
20		isExecutable
10		Contains_PE_File

Score total: 79

==================[ Vérification MalwareBazaar ]==================
Fichier introuvable...
Malware inconnu -> Score: 0
==================================================================


===================[ Vérification Virus Total ]===================
Detecté par: 39/68
Fichier malveillant -> Score: 2000
==================================================================



==================================================================
=                                                                =
=                   Résumé de l'analyse statique                 =
=                      2022-02-11 14:37:32                       =
=                                                                =
==================================================================
=========================[ Informations ]=========================
Extract Name:	HTTP-FRLpQc3GMACNrvHAne.exe
Real Name:	/5b3968b47eb16a1cb88525e3b565eab1.exe_
============================[ Rules ]=============================

--------------------------[ CAPA_Rules ]--------------------------
Scores	Rules
.......	...............
4	- Execution::Command and Scripting Interpreter [T1059;4]
2	- Execution::Shared Modules [T1129;2]
1	- Discovery::System Information Discovery [T1082;1]
1	- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;1]
3	- Defense Evasion::Obfuscated Files or Information [T1027;3]

-------------------------[ ClamAV_Rules ]-------------------------
Scores	Rules
.......	...............
0	No Match

--------------------------[ LOKI_Rules ]--------------------------
Scores	Rules
.......	...............
10	ft_exe
2	math_entropy_6
5	executable_pe
10	IsPE32
10	IsConsole
10	MinGW_1
2	PE_File
20	isExecutable
10	Contains_PE_File

============================[ Scores ]============================
CAPA:	11.0
ClamAV:	0
Loki:	79
- - - - - - - - - - - - - - - - - - - - - - - -
MalwareBazaar:	0
VirusTotal:	2000
==========================[ SCORE_FINAL ]=========================
3471.5444766908563
==================================================================


==================================================================
Fichier HTTP-FRLpQc3GMACNrvHAne.exe Légitime
==================================================================

