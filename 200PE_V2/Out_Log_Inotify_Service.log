

==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fcpezz4wqChJuOk4Yk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 504e51418d856d664db23dd55a61352d                                                   |
| sha1                   | 522c0fb1ed2b9594e7a2aab9481883da57d8ca23                                           |
| sha256                 | f190e142f402de460455ff2d1835294a3e118ba74d76aa092af49372bb9b76f4                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fcpezz4wqChJuOk4Yk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fcpezz4wqChJuOk4Yk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.00 MB
Data read: 0.00 MB (ratio 1.00:1)
Time: 30.552 sec (0 m 30 s)
Start Date: 2022:01:28 12:21:17
End Date:   2022:01:28 12:21:48

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:21:18Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:21:50Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
39.905246299377595
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FAxBza10cZ92HN9t3a.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FAxBza10cZ92HN9t3a.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 4.88 MB
Data read: 4.59 MB (ratio 1.06:1)
Time: 30.320 sec (0 m 30 s)
Start Date: 2022:01:28 12:21:51
End Date:   2022:01:28 12:22:21

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf2 in position 4: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:21:51Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FAxBza10cZ92HN9t3a.exe SCORE: 292 TYPE: EXE SIZE: 4809232 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa91821d670> 
MD5: 2be5d5def542fd59a2278a656b074f65 
SHA1: 9bbc3f83076e41f3b69c11aa061adea74fca7e7c 
SHA256: 09d53831ce63aea279aaa08d670b6290312f63fedfe1981f819e58d774a68fa0 CREATED: Fri Jan 28 12:21:51 2022 MODIFIED: Fri Jan 28 12:21:51 2022 ACCESSED: Fri Jan 28 12:22:19 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier
REASON_14: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier
REASON_15: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier
REASON_16: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_17: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_18: Yara Rule MATCH: Debugger_Check__RemoteAPI SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: CheckRemoteDebuggerPresent
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: Crypt32_CryptBinaryToString_API SUBSCORE: 25 
DESCRIPTION: Looks for crypt32 CryptBinaryToStringA function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: CRYPT32.dll Str2: CryptBinaryToStringA
REASON_21: Yara Rule MATCH: RIPEMD160_Constants SUBSCORE: 15 
DESCRIPTION: Look for RIPEMD-160 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3
REASON_22: Yara Rule MATCH: SHA1_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA1 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3 Str6: d6c162ca
REASON_23: Yara Rule MATCH: RijnDael_AES_CHAR SUBSCORE: 15 
DESCRIPTION: RijnDael AES (check2) [char] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:22:26Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		misc_pe_signature
1		ft_exe
20		research_pe_signed_outside_timestamp
1		math_entropy_6
1		IsPE64
1		IsDLL
1		IsConsole
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
60		Debugger_Check__QueryInfo
60		Debugger_Check__RemoteAPI
1		Contains_PE_File
25		Crypt32_CryptBinaryToString_API
15		RIPEMD160_Constants
20		SHA1_Constants
15		RijnDael_AES_CHAR

Score total: 292

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2be5d5def542fd59a2278a656b074f65                                                   |
| sha1                   | 9bbc3f83076e41f3b69c11aa061adea74fca7e7c                                           |
| sha256                 | 09d53831ce63aea279aaa08d670b6290312f63fedfe1981f819e58d774a68fa0                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FAxBza10cZ92HN9t3a.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
|                             | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
| DATA                        | Decompress Data::QuickLZ [C0025.001]                                          |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints (2 matches)           | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-debugging instructions                  | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-VM instructions (15 matches)            | anti-analysis/anti-vm/vm-detection                   |
| check HTTP status code (3 matches)                   | communication/http/client                            |
| decompress data using QuickLZ                        | data-manipulation/compression                        |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| encode data using XOR (32 matches)                   | data-manipulation/encoding/xor                       |
| hash data via BCrypt (4 matches)                     | data-manipulation/hashing                            |
| hash data using murmur3                              | data-manipulation/hashing/murmur                     |
| hash data using SHA1 (3 matches)                     | data-manipulation/hashing/sha1                       |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes (3 matches)   | host-interaction/driver                              |
| get system information on Windows (21 matches)       | host-interaction/os/info                             |
| check OS version (2 matches)                         | host-interaction/os/version                          |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (48 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Execution::System Services::Service Execution [T1569.002;3]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 25.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('Debugger_Check__QueryInfo', '60'), ('Debugger_Check__RemoteAPI', '60'), ('Contains_PE_File', '1'), ('Crypt32_CryptBinaryToString_API', '25'), ('RIPEMD160_Constants', '15'), ('SHA1_Constants', '20'), ('RijnDael_AES_CHAR', '15')]
-------------- LOKI_Score ------------
['292']
-------------- CAPA_Score ------------
['25.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5126.703700728671
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F1aEVh2EPylWPAN0V1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f72d773f13ceb6b842a9d29c56f8880f                                                   |
| sha1                   | 967eea1c315970db632b9dabeaf10ee5b9d47696                                           |
| sha256                 | d66e15eea51ebd4bfd13f8c97646253740b1e6a99328d22232fd01ae13ef5d05                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F1aEVh2EPylWPAN0V1.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| EXECUTION              | System Services::Service Execution \[T1569.002]\                                   |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | HTTP Communication::IWebBrowser [C0002.010]                                   |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| initialize IWebBrowser2                              | communication/http                                   |
| interact with driver via control codes               | host-interaction/driver                              |
| write file on Windows                                | host-interaction/file-system/write                   |
| create service                                       | host-interaction/service/create                      |
| start service                                        | host-interaction/service/start                       |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
3		- Execution::System Services::Service Execution [T1569.002;3]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]

Score total: 13.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F1aEVh2EPylWPAN0V1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 26.972 sec (0 m 26 s)
Start Date: 2022:01:28 12:35:10
End Date:   2022:01:28 12:35:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:35:11Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:35:42Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['13.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
269.3604125207988
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FT9dv14kLAjRzbrB51.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | d707382b7d60eb8830a2da9d6480062a                                                   |
| sha1                   | 4c721616200b2cd92d7716981999d94f549732a8                                           |
| sha256                 | bf331cdf306fe1d01a5b4b81b898a268d0d1c8461c4aeda19d5c67f5fad981b1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FT9dv14kLAjRzbrB51.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 5.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FT9dv14kLAjRzbrB51.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 24.724 sec (0 m 24 s)
Start Date: 2022:01:28 12:35:42
End Date:   2022:01:28 12:36:07

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:35:42Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:36:08Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['5.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
99.763115748444
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Ftyni32ZKkZ8SDwGg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5f69f4f8683151a59c5a11265b4a3c96                                                   |
| sha1                   | 95ae738ab6b2cc92d88e3debbaacdd924bc27f5e                                           |
| sha256                 | edc1b6a3e4fde216a323329e35f4192b0f49bc68285ee67036deff9e94c4e33a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Ftyni32ZKkZ8SDwGg.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Ftyni32ZKkZ8SDwGg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 24.990 sec (0 m 24 s)
Start Date: 2022:01:28 12:36:08
End Date:   2022:01:28 12:36:33

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:36:08Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:36:34Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
39.905246299377595
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FiAUPC1vnp8KbuZ2Ci.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x87 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x91 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcf in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa5 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xae in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:36:35Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FiAUPC1vnp8KbuZ2Ci.exe SCORE: 1965 TYPE: EXE SIZE: 4691915 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fdda9eb2670> 
MD5: ed888dc2f04f5eac83d6d14088d002de 
SHA1: b6ec6a00d53f4ee8ef51d7e533f63d4f9cd171f4 
SHA256: c78dae3e6ef91539408d1def9724f89b1aae44e4003f464d21f20e28abc8310a CREATED: Fri Jan 28 12:36:35 2022 MODIFIED: Fri Jan 28 12:36:35 2022 ACCESSED: Fri Jan 28 12:37:01 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: RegQueryValueExA Str4: RegOpenKeyExA Str5: RegCloseKey Str6: RegSetValueExA Str7: RegCreateKeyA
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: SetFilePointer Str3: DeleteFileA Str4: CreateFileA Str5: FindFirstFileA Str6: FindClose Str7: SetFileAttributesA
REASON_3: Yara Rule MATCH: ldpreload SUBSCORE: 15 
DESCRIPTION: not set REF: https://stuff.rop.io/ AUTHOR: xorseed 
MATCHES: Str1: dlopen Str2: fopen Str3: accept Str4: open Str5: Open Str6: OPEN Str7: Open Str8: rmdir Str9: unlink
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: ConventionEngine_Anomaly_OutsideOfDebug SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344538738d6b3a6d8014b93df5d1d1ee850dc01000000433a5c6275696c6432375c63707974686f6e5c50436275696c645c707974686f6e32372e70646200
REASON_6: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 1 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsPacked SUBSCORE: 5 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: stager_reverse_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_15: Yara Rule MATCH: stager_bind_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_16: Yara Rule MATCH: win32_stage_boot_winsock_conn_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_17: Yara Rule MATCH: win32_stage_boot_bind_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_18: Yara Rule MATCH: win32_stage_boot_reverse_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_19: Yara Rule MATCH: win32_stage_boot_winsock_conn_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_20: Yara Rule MATCH: stager_reverse_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_21: Yara Rule MATCH: win32_stage_boot_bind_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_22: Yara Rule MATCH: win32_stage_boot_reverse_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_23: Yara Rule MATCH: win32_stage_boot_reverse_shell_revert_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_24: Yara Rule MATCH: win32_stage_winexec_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_25: Yara Rule MATCH: stager_bind_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_26: Yara Rule MATCH: win32_stage_boot_winsock_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_27: Yara Rule MATCH: win32_stage_boot_reverse_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_28: Yara Rule MATCH: win32_stage_api_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_29: Yara Rule MATCH: win32_stage_boot_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_30: Yara Rule MATCH: win32_stage_boot_reverse_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_31: Yara Rule MATCH: win32_stage_boot_reverse_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_32: Yara Rule MATCH: win32_stage_boot_bind_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_33: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_34: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_35: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_36: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_37: Yara Rule MATCH: DebuggerException__ConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: GenerateConsoleCtrlEvent
REASON_38: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_39: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_40: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_41: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000
REASON_42: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_43: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_44: Yara Rule MATCH: Netwalker SUBSCORE: 60 
DESCRIPTION: Detects Netwalker Ransomware REF: https://github.com/f0wl/configwalker AUTHOR: Marius 'f0wL' Genheimer <hello@dissectingmalwa.re> 
MATCHES: Str1: mode Str2: white Str3: path Str4: file Str5: kill Str6: ignore Str7: disk Str8: unlock
REASON_45: Yara Rule MATCH: py2exe SUBSCORE: 5 
DESCRIPTION: Detect PE file produced by py2exe REF: - AUTHOR: Didier Stevens (https://www.nviso.be)
REASON_46: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_47: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_48: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
REASON_49: Yara Rule MATCH: CRC16_table SUBSCORE: 15 
DESCRIPTION: Look for CRC16 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00002110422063308440a550c660e770088129914aa16bb18cc1add1cee1eff13112100273325222b5529442f772d662399318837bb35aa3bdd39cc3fff3dee3
REASON_50: Yara Rule MATCH: MD5_Constants SUBSCORE: 20 
DESCRIPTION: Look for MD5 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: 78a46ad7
REASON_51: Yara Rule MATCH: RIPEMD160_Constants SUBSCORE: 15 
DESCRIPTION: Look for RIPEMD-160 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3
REASON_52: Yara Rule MATCH: SHA1_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA1 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3 Str6: d6c162ca
REASON_53: Yara Rule MATCH: SHA512_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA384/SHA512 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: 982f8a42 Str2: 91443771 Str3: cffbc0b5 Str4: a5dbb5e9 Str5: 22ae28d7
REASON_54: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
REASON_55: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:37:06Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
15		ldpreload
1		ft_exe
50		ConventionEngine_Anomaly_OutsideOfDebug
1		math_entropy_close_8
1		IsPE32
2		IsWindowsGUI
5		IsPacked
1		HasOverlay
1		HasRichSignature
35		Embedded_PE
2		PE_File
70		stager_reverse_tcp_nx_ldone_x86
70		stager_bind_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_conn_ldone_x86
70		win32_stage_boot_bind_read_ldone_x86
70		win32_stage_boot_reverse_read_ldone_x86
70		win32_stage_boot_winsock_conn_udp_ldone_x86
70		stager_reverse_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_bind_inlineegg_ldone_x86
70		win32_stage_boot_reverse_ldone_x86
70		win32_stage_boot_reverse_shell_revert_ldone_x86
70		win32_stage_winexec_ldone_x86
70		stager_bind_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_bind_ldone_x86
70		win32_stage_boot_reverse_shell_ldone_x86
70		win32_stage_api_ldone_x86
70		win32_stage_boot_bind_ldone_x86
70		win32_stage_boot_reverse_udp_ldone_x86
70		win32_stage_boot_reverse_inlineegg_ldone_x86
70		win32_stage_boot_bind_shell_ldone_x86
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
60		DebuggerException__ConsoleCtrl_v1
60		DebuggerException__SetConsoleCtrl_v1
30		Check_OutputDebugStringA_iat_v1
5		SEH_Save
5		SEH_Init
30		Check_OutputDebugStringA_iat
10		anti_dbg
60		Netwalker
5		py2exe
1		Contains_PE_File
25		CRC32_poly_Constant
25		CRC32_table
15		CRC16_table
20		MD5_Constants
15		RIPEMD160_Constants
20		SHA1_Constants
20		SHA512_Constants
20		SHA2_BLAKE2_IVs
5		BASE64_table

Score total: 1965

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ed888dc2f04f5eac83d6d14088d002de                                                   |
| sha1                   | b6ec6a00d53f4ee8ef51d7e533f63d4f9cd171f4                                           |
| sha256                 | c78dae3e6ef91539408d1def9724f89b1aae44e4003f464d21f20e28abc8310a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FiAUPC1vnp8KbuZ2Ci.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
|                        | System Information Discovery:: \[T1082]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Check String:: [C0019]                                                        |
|                             | Compression Library:: [C0060]                                                 |
|                             | Encode Data::Base64 [C0026.001]                                               |
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| compiled with py2exe (2 matches)                     | compiler/py2exe                                      |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (3 matches)  | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| read file via mapping                                | host-interaction/file-system/read                    |
| print debug messages (2 matches)                     | host-interaction/log/debug/write-event               |
| terminate process                                    | host-interaction/process/terminate                   |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| linked against ZLIB                                  | linking/static/zlib                                  |
| parse PE header                                      | load-code/pe                                         |
| reference startup folder                             | persistence/startup-folder                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 18.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FiAUPC1vnp8KbuZ2Ci.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 22.61 MB
Data read: 4.47 MB (ratio 5.06:1)
Time: 52.678 sec (0 m 52 s)
Start Date: 2022:01:28 12:36:35
End Date:   2022:01:28 12:37:27

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('ldpreload', '15'), ('ft_exe', '1'), ('ConventionEngine_Anomaly_OutsideOfDebug', '50'), ('math_entropy_close_8', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('IsPacked', '5'), ('HasOverlay', '1'), ('HasRichSignature', '1'), ('Embedded_PE', '35'), ('PE_File', '2'), ('stager_reverse_tcp_nx_ldone_x86', '70'), ('stager_bind_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_ldone_x86', '70'), ('win32_stage_boot_bind_read_ldone_x86', '70'), ('win32_stage_boot_reverse_read_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_udp_ldone_x86', '70'), ('stager_reverse_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_bind_inlineegg_ldone_x86', '70'), ('win32_stage_boot_reverse_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_revert_ldone_x86', '70'), ('win32_stage_winexec_ldone_x86', '70'), ('stager_bind_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_ldone_x86', '70'), ('win32_stage_api_ldone_x86', '70'), ('win32_stage_boot_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_udp_ldone_x86', '70'), ('win32_stage_boot_reverse_inlineegg_ldone_x86', '70'), ('win32_stage_boot_bind_shell_ldone_x86', '70'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('DebuggerException__ConsoleCtrl_v1', '60'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('Check_OutputDebugStringA_iat_v1', '30'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('Netwalker', '60'), ('py2exe', '5'), ('Contains_PE_File', '1'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25'), ('CRC16_table', '15'), ('MD5_Constants', '20'), ('RIPEMD160_Constants', '15'), ('SHA1_Constants', '20'), ('SHA512_Constants', '20'), ('SHA2_BLAKE2_IVs', '20'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['1965']
-------------- CAPA_Score ------------
['18.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
31502.298448555273
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F24Hjq4wagldhViLb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F24Hjq4wagldhViLb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 1.30 MB
Data read: 1.23 MB (ratio 1.06:1)
Time: 25.885 sec (0 m 25 s)
Start Date: 2022:01:28 12:37:27
End Date:   2022:01:28 12:37:53

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:37:27Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] 
FILE: /tmp/.Loki_Scan/HTTP-F24Hjq4wagldhViLb.exe SCORE: 50 TYPE: EXE SIZE: 1288704 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f738ab44670> 
MD5: 84aa261b1e0160be470ee27610bc65aa 
SHA1: cb517e3380f9b826bc4feccb23b0485951d86bc9 
SHA256: 352f2217ae1b5baabe77d8c9b74356cdbcd893799add6580b2960b19efb8800a CREATED: Fri Jan 28 12:37:27 2022 MODIFIED: Fri Jan 28 12:37:27 2022 ACCESSED: Fri Jan 28 12:37:53 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: possible_includes_base64_packed_functions SUBSCORE: 25 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: atob Str2: This Str3: prog Str4: rogr Str5: ogra Str6: gram Str7: cann Str8: anno Str9: nnot Str10: mode Str11: Rich Str12: ichq Str1 ... (truncated)
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 75e40ac34da01d8b94fb6c09da8faff9 Str2: fd9a02c99d8294ea49df9fe274c83d4e Str3: f0b3cb648fe4baa9256ee1b64fd823bb Str4: 246bafd328781690 ... (truncated)
[NOTICE] Results: 0 alerts, 0 warnings, 2 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:38:02Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		ft_exe
1		math_entropy_6
25		possible_includes_base64_packed_functions
1		IsPE64
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
1		Contains_PE_File
10		Big_Numbers1

Score total: 50

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 84aa261b1e0160be470ee27610bc65aa                                                   |
| sha1                   | cb517e3380f9b826bc4feccb23b0485951d86bc9                                           |
| sha256                 | 352f2217ae1b5baabe77d8c9b74356cdbcd893799add6580b2960b19efb8800a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F24Hjq4wagldhViLb.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| encode data using XOR (3 matches)                    | data-manipulation/encoding/xor                       |
| hash data using fnv (3 matches)                      | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| access PEB ldr_data (41 matches)                     | linking/runtime-linking                              |
| parse PE header (125 matches)                        | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 8.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('possible_includes_base64_packed_functions', '25'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Contains_PE_File', '1'), ('Big_Numbers1', '10')]
-------------- LOKI_Score ------------
['50']
-------------- CAPA_Score ------------
['8.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
952.0675814280671
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FGzIDK2ovFLWI9Wfx4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FGzIDK2ovFLWI9Wfx4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 24.769 sec (0 m 24 s)
Start Date: 2022:01:28 12:39:56
End Date:   2022:01:28 12:40:21

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 0: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:39:56Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FGzIDK2ovFLWI9Wfx4.exe SCORE: 124 TYPE: EXE SIZE: 51712 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f072c51b670> 
MD5: a45e377dbb98a6b44fd4034bc3fff9b0 
SHA1: d5b05cdc08c7498afb2d0faf269b420c1f4ea730 
SHA256: cc0b39c7495e1b2cba0661496c9414fd5c91a16652272bed5acabed51a986629 CREATED: Fri Jan 28 12:39:56 2022 MODIFIED: Fri Jan 28 12:39:56 2022 ACCESSED: Fri Jan 28 12:40:21 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: CreateFileA
REASON_2: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_11: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_12: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: VC6_Random SUBSCORE: 15 
DESCRIPTION: Look for Random function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: a1a0b0400069c0fd43030005c39e2600a3a0b04000c1f81025ff7f0000c3
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:40:21Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Winsock2_Library
1		ft_exe
1		math_entropy_5
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
2		PE_File
30		Check_OutputDebugStringA_iat_v1
5		SEH_Save
5		SEH_Init
30		Check_OutputDebugStringA_iat
10		anti_dbg
1		Contains_PE_File
15		VC6_Random

Score total: 124

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Check_OutputDebugStringA_iat_v1', '30'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('Contains_PE_File', '1'), ('VC6_Random', '15')]
-------------- LOKI_Score ------------
['124']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1965.2675586517805
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FQlj8Y6SRvahopx5i.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5108f54e67cc5d1a44db4fb64a6045c2                                                   |
| sha1                   | 5cb13a7e44537498c988358cd59a155d2d497c0d                                           |
| sha256                 | 8c43c3947c1d6599e9f115eb82c6e6829fa3affd993f0b4207a1e3bf023d1fe8                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FQlj8Y6SRvahopx5i.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| check if file exists (6 matches)                     | host-interaction/file-system/exists                  |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value                    | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| delete registry key (2 matches)                      | host-interaction/registry/delete                     |
| delete registry value                                | host-interaction/registry/delete                     |
| create thread (2 matches)                            | host-interaction/thread/create                       |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 12.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FQlj8Y6SRvahopx5i.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 24.519 sec (0 m 24 s)
Start Date: 2022:01:28 12:40:22
End Date:   2022:01:28 12:40:46

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:40:22Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FQlj8Y6SRvahopx5i.exe SCORE: 110 TYPE: EXE SIZE: 69120 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa395aed670> 
MD5: 5108f54e67cc5d1a44db4fb64a6045c2 
SHA1: 5cb13a7e44537498c988358cd59a155d2d497c0d 
SHA256: 8c43c3947c1d6599e9f115eb82c6e6829fa3affd993f0b4207a1e3bf023d1fe8 CREATED: Fri Jan 28 12:40:22 2022 MODIFIED: Fri Jan 28 12:40:22 2022 ACCESSED: Fri Jan 28 12:40:47 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:40:47Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_token
1		ft_exe
1		math_entropy_5
1		IsPE64
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
10		anti_dbg
1		Contains_PE_File

Score total: 110

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_token', '10'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['110']
-------------- CAPA_Score ------------
['12.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1992.7903010783348
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fq43ZzpHTvs7plWq8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fq43ZzpHTvs7plWq8.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.24 MB
Data read: 0.23 MB (ratio 1.02:1)
Time: 24.484 sec (0 m 24 s)
Start Date: 2022:01:28 12:40:47
End Date:   2022:01:28 12:41:12

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:40:48Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fq43ZzpHTvs7plWq8.exe SCORE: 215 TYPE: EXE SIZE: 245760 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd2b0133670> 
MD5: 01e057351737ec63730e86352e4e7436 
SHA1: e59a43da67d67361a7db486148e1ba86008725f9 
SHA256: a275b52cf71d8809455e69e46b073d9c802f5a045850c2598885d3d974ad07a5 CREATED: Fri Jan 28 12:40:47 2022 MODIFIED: Fri Jan 28 12:40:47 2022 ACCESSED: Fri Jan 28 12:41:13 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateThread
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateThread
REASON_14: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_15: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:41:13Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
5		win_mutex
20		win_registry
10		win_token
1		ft_exe
1		math_entropy_6
1		IsPE64
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
45		Inject_Thread
60		Debugger_Check__QueryInfo
10		anti_dbg
1		Contains_PE_File

Score total: 215

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 01e057351737ec63730e86352e4e7436                                                   |
| sha1                   | e59a43da67d67361a7db486148e1ba86008725f9                                           |
| sha256                 | a275b52cf71d8809455e69e46b073d9c802f5a045850c2598885d3d974ad07a5                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fq43ZzpHTvs7plWq8.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
| DISCOVERY                   | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Get File Attributes:: [C0049]                                                 |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
|                             | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| hash data via BCrypt (2 matches)                     | data-manipulation/hashing                            |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| accept command line arguments (3 matches)            | host-interaction/cli                                 |
| query environment variable                           | host-interaction/environment-variable                |
| set environment variable                             | host-interaction/environment-variable                |
| get common file path (6 matches)                     | host-interaction/file-system                         |
| create directory                                     | host-interaction/file-system/create                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| get file size                                        | host-interaction/file-system/meta                    |
| get file version info                                | host-interaction/file-system/meta                    |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| get disk information (2 matches)                     | host-interaction/hardware/storage                    |
| print debug messages (7 matches)                     | host-interaction/log/debug/write-event               |
| access the Windows event log                         | host-interaction/log/winevt/access                   |
| check mutex                                          | host-interaction/mutex                               |
| check mutex and exit                                 | host-interaction/mutex                               |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| read process memory (21 matches)                     | host-interaction/process                             |
| enumerate process modules (6 matches)                | host-interaction/process/modules/list                |
| terminate process via fastfail (10 matches)          | host-interaction/process/terminate                   |
| query or enumerate registry value (14 matches)       | host-interaction/registry                            |
| set registry value (12 matches)                      | host-interaction/registry/create                     |
| delete registry key (4 matches)                      | host-interaction/registry/delete                     |
| delete registry value (2 matches)                    | host-interaction/registry/delete                     |
| start service                                        | host-interaction/service/start                       |
| get token membership (4 matches)                     | host-interaction/session                             |
| access PEB ldr_data                                  | linking/runtime-linking                              |
| access PE header                                     | load-code/pe                                         |
| parse PE header (11 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Execution::Command and Scripting Interpreter [T1059;4]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 26.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('win_mutex', '5'), ('win_registry', '20'), ('win_token', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Inject_Thread', '45'), ('Debugger_Check__QueryInfo', '60'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['215']
-------------- CAPA_Score ------------
['26.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3936.264877258147
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fruhrgo7PAcYW6BGl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fruhrgo7PAcYW6BGl.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.45 MB
Data read: 0.43 MB (ratio 1.05:1)
Time: 25.274 sec (0 m 25 s)
Start Date: 2022:01:28 12:41:20
End Date:   2022:01:28 12:41:45

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x82 in position 9: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:41:20Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fruhrgo7PAcYW6BGl.exe SCORE: 123 TYPE: EXE SIZE: 453168 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f6ce7c2a670> 
MD5: 811f0bf8bf1262b9fdc256b21599e800 
SHA1: 0f0b33ac2b42e951c556560a9a7e11dff8a691fa 
SHA256: d2f7a0266bcc4eb8521bcdbf98a37dccc27891b6cc96aaf7fc2c1ec77b4d81b7 CREATED: Fri Jan 28 12:41:20 2022 MODIFIED: Fri Jan 28 12:41:20 2022 ACCESSED: Fri Jan 28 12:41:46 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasDigitalSignature SUBSCORE: 1 
DESCRIPTION: DigitalSignature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 30600000000202003082602206092a864886f70d010702a08260133082600f020101310b300906052b0e03021a05003068060a2b060104018237020104a05a3058303 ... (truncated)
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:41:47Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
1		misc_pe_signature
1		ft_exe
20		research_pe_signed_outside_timestamp
1		math_entropy_6
1		IsPE64
1		IsDLL
1		IsConsole
1		HasOverlay
1		HasDigitalSignature
1		HasDebugData
1		HasRichSignature
2		PE_File
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
1		Contains_PE_File

Score total: 123

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 811f0bf8bf1262b9fdc256b21599e800                                                   |
| sha1                   | 0f0b33ac2b42e951c556560a9a7e11dff8a691fa                                           |
| sha256                 | d2f7a0266bcc4eb8521bcdbf98a37dccc27891b6cc96aaf7fc2c1ec77b4d81b7                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fruhrgo7PAcYW6BGl.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| encode data using XOR (36 matches)                   | data-manipulation/encoding/xor                       |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| check OS version                                     | host-interaction/os/version                          |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE exports (5 matches)                         | load-code/pe                                         |
| parse PE header (29 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 12.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasOverlay', '1'), ('HasDigitalSignature', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Check_OutputDebugStringA_iat_v1', '30'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['123']
-------------- CAPA_Score ------------
['12.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2198.8264160982794
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FgeQr14gEwR7MyXrW5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c0781854a5cd83024f2f8683eb888a3c                                                   |
| sha1                   | 9fe6eb078a48b15a5c2be4ffbebf42f611bca0ff                                           |
| sha256                 | 17656523a20593ad128ec1bb0df99e025a3430e33b6a2cf4f613d14a00ae41d3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FgeQr14gEwR7MyXrW5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FgeQr14gEwR7MyXrW5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 24.445 sec (0 m 24 s)
Start Date: 2022:01:28 12:42:08
End Date:   2022:01:28 12:42:32

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:42:08Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:42:34Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
79.81049259875519
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F7v3om26W6OYajeJve.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F7v3om26W6OYajeJve.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.95 MB
Data read: 0.89 MB (ratio 1.06:1)
Time: 25.528 sec (0 m 25 s)
Start Date: 2022:01:28 12:42:34
End Date:   2022:01:28 12:42:59

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:42:34Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F7v3om26W6OYajeJve.exe SCORE: 870 TYPE: EXE SIZE: 937984 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa83aa74670> 
MD5: ad4229879180e267f431ac6666b6a0a2 
SHA1: c191c35ac423b381efc84edce74d7a96dbd9ac7d 
SHA256: aa52dcaf6df43c6aa872fe0f73725f61e082d32c33fc976741d4eca17679533d CREATED: Fri Jan 28 12:42:34 2022 MODIFIED: Fri Jan 28 12:42:34 2022 ACCESSED: Fri Jan 28 12:43:00 2022 
REASON_1: Malware Hash TYPE: SHA1 HASH: c191c35ac423b381efc84edce74d7a96dbd9ac7d SUBSCORE: 100 DESC: Continued GreenBug/Shamoon attacks against Saudi Arabia https://twitter.com/eyalsela/status/885893685325574144
REASON_2: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: socket Str3: connect
REASON_3: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_5: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: win_ismdoor_auto SUBSCORE: 45 
DESCRIPTION: Detects win.ismdoor. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 32c0eb05c0e804240184c00f94c3 Str2: c1e00803c88bd98bc148c1e81283e03f Str3: 83e11f49c1e805428b04820fa3c873034533c9 Str4: 4883ec40488bda ... (truncated)
REASON_8: Yara Rule MATCH: Recon_Commands_Windows_Gen1 SUBSCORE: 60 
DESCRIPTION: Detects a set of reconnaissance commands on Windows systems REF: https://goo.gl/MSJCxP AUTHOR: Florian Roth 
MATCHES: Str1: netstat -an Str2: net view Str3: net user Str4: systeminfo Str5: net user administrator
REASON_9: Yara Rule MATCH: ConventionEngine_Keyword_Bot SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453893a59277c0e5b419e162343a5ffcf3f01000000433a5c55736572735c6d655c446f63756d656e74735c56697375616c2053747564696f20323031335c507 ... (truncated)
REASON_10: Yara Rule MATCH: ConventionEngine_Term_Documents SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453893a59277c0e5b419e162343a5ffcf3f01000000433a5c55736572735c6d655c446f63756d656e74735c56697375616c2053747564696f20323031335c507 ... (truncated)
REASON_11: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453893a59277c0e5b419e162343a5ffcf3f01000000433a5c55736572735c6d655c446f63756d656e74735c56697375616c2053747564696f20323031335c507 ... (truncated)
REASON_12: Yara Rule MATCH: ConventionEngine_Term_VisualStudio SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453893a59277c0e5b419e162343a5ffcf3f01000000433a5c55736572735c6d655c446f63756d656e74735c56697375616c2053747564696f20323031335c507 ... (truncated)
REASON_13: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_17: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_18: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_20: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_21: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_22: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_23: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_24: Yara Rule MATCH: Greenbug_Malware_4 SUBSCORE: 60 
DESCRIPTION: Detects ISMDoor Backdoor REF: https://goo.gl/urp4CD AUTHOR: Florian Roth 
MATCHES: Str1: c:\windows	emp	mp8873
REASON_25: Yara Rule MATCH: Greenbug_Malware_5 SUBSCORE: 60 
DESCRIPTION: Auto-generated rule REF: https://goo.gl/urp4CD AUTHOR: Florian Roth 
MATCHES: Str1: cmd /u /c WMIC /Node:localhost /Namespace:oot\SecurityCenter Str2: cmd /a /c net user administrator /domain >> Str3: ============= ... (truncated)
REASON_26: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_27: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: A67D0DB885A343257654
REASON_28: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: A67D0DB8A2A173347654432503702AA3 Str2: A67D0DB8A2A173347654432503701111 Str3: A67D0DB885A3432576548A2A03707334 Str4: A67D0DB885A34325 ... (truncated)
REASON_29: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_30: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
REASON_31: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:43:01Z

-------- Score ----------------
Scores		Rules
.......		...............
100		Malware Hash
50		network_tcp_socket
65		screenshot
10		win_files_operation
10		Str_Win32_Winsock2_Library
1		ft_exe
45		win_ismdoor_auto
60		Recon_Commands_Windows_Gen1
50		ConventionEngine_Keyword_Bot
50		ConventionEngine_Term_Documents
50		ConventionEngine_Term_Users
50		ConventionEngine_Term_VisualStudio
1		math_entropy_6
1		IsPE64
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
60		DebuggerException__SetConsoleCtrl_v1
10		anti_dbg
60		Greenbug_Malware_4
60		Greenbug_Malware_5
1		Contains_PE_File
10		Big_Numbers0
10		Big_Numbers1
25		CRC32_poly_Constant
25		CRC32_table
5		BASE64_table

Score total: 870

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ad4229879180e267f431ac6666b6a0a2                                                   |
| sha1                   | c191c35ac423b381efc84edce74d7a96dbd9ac7d                                           |
| sha256                 | aa52dcaf6df43c6aa872fe0f73725f61e082d32c33fc976741d4eca17679533d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F7v3om26W6OYajeJve.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Screen Capture:: \[T1113]\                                                          |
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005             |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
|                        | System Network Configuration Discovery:: \[T1016]\                                  |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COLLECTION                  | Screen Capture::WinAPI [E1113.m01]                                            |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | Socket Communication::Get Socket Status [C0001.012]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
| CRYPTOGRAPHY                | Generate Pseudo-random Sequence:: [C0021]                                     |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Checksum::Adler [C0032.005]                                                   |
|                             | Compression Library:: [C0060]                                                 |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+----------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                               | NAMESPACE                                            |
|----------------------------------------------------------+------------------------------------------------------|
| contain obfuscated stackstrings (2 matches)              | anti-analysis/obfuscation/string/stackstring         |
| capture screenshot                                       | collection/screenshot                                |
| receive data                                             | communication                                        |
| send data (2 matches)                                    | communication                                        |
| reference Google Public DNS server                       | communication/dns                                    |
| get socket status                                        | communication/socket                                 |
| initialize Winsock library (2 matches)                   | communication/socket                                 |
| compute adler32 checksum                                 | data-manipulation/checksum/adler32                   |
| encode data using Base64                                 | data-manipulation/encoding/base64                    |
| reference Base64 string                                  | data-manipulation/encoding/base64                    |
| encode data using XOR (10 matches)                       | data-manipulation/encoding/xor                       |
| hash data using fnv (6 matches)                          | data-manipulation/hashing/fnv                        |
| authenticate HMAC                                        | data-manipulation/hmac                               |
| generate random numbers using the Delphi LCG (5 matches) | data-manipulation/prng/lcg                           |
| contains PDB path                                        | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                       | executable/pe/section/rsrc                           |
| get common file path (4 matches)                         | host-interaction/file-system                         |
| copy file                                                | host-interaction/file-system/copy                    |
| create directory (2 matches)                             | host-interaction/file-system/create                  |
| delete file                                              | host-interaction/file-system/delete                  |
| check if file exists (3 matches)                         | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions                   | host-interaction/file-system/files/list              |
| get file attributes (4 matches)                          | host-interaction/file-system/meta                    |
| get file size                                            | host-interaction/file-system/meta                    |
| move file                                                | host-interaction/file-system/move                    |
| read file on Windows (5 matches)                         | host-interaction/file-system/read                    |
| write file on Windows (6 matches)                        | host-interaction/file-system/write                   |
| print debug messages                                     | host-interaction/log/debug/write-event               |
| allocate thread local storage                            | host-interaction/process                             |
| get thread local storage value (7 matches)               | host-interaction/process                             |
| set thread local storage value (4 matches)               | host-interaction/process                             |
| create process on Windows                                | host-interaction/process/create                      |
| terminate process (2 matches)                            | host-interaction/process/terminate                   |
| create thread (11 matches)                               | host-interaction/thread/create                       |
| linked against XZip                                      | linking/static/xzip                                  |
| enumerate PE sections (2 matches)                        | load-code/pe                                         |
| parse PE header (5 matches)                              | load-code/pe                                         |
| get startup folder                                       | persistence/startup-folder                           |
+----------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
1		- Discovery::File and Directory Discovery [T1083;1]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
4		- Collection::Screen Capture [T1113;4]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
3		- Discovery::System Network Configuration Discovery [T1016;3]

Score total: 33.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Collection::Screen Capture [T1113;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('Malware Hash', '100'), ('network_tcp_socket', '50'), ('screenshot', '65'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('win_ismdoor_auto', '45'), ('Recon_Commands_Windows_Gen1', '60'), ('ConventionEngine_Keyword_Bot', '50'), ('ConventionEngine_Term_Documents', '50'), ('ConventionEngine_Term_Users', '50'), ('ConventionEngine_Term_VisualStudio', '50'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('anti_dbg', '10'), ('Greenbug_Malware_4', '60'), ('Greenbug_Malware_5', '60'), ('Contains_PE_File', '1'), ('Big_Numbers0', '10'), ('Big_Numbers1', '10'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['870']
-------------- CAPA_Score ------------
['33.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
14447.007338351417
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F87Frn2PtD7sOjfCOb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 480f710806b68dfe478ca1ec7d7e79cc                                                   |
| sha1                   | b4fc97fed2dbff9c4874cb65ede7b50699db37cd                                           |
| sha256                 | 2416cd4aa577dbb2f8790a61e36fbab2b30bff81a4e1f67a5151c2fec29585bc                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F87Frn2PtD7sOjfCOb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (3 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| print debug messages (5 matches)                     | host-interaction/log/debug/write-event               |
| query or enumerate registry key                      | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| create thread (2 matches)                            | host-interaction/thread/create                       |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 11.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F87Frn2PtD7sOjfCOb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.08 MB
Data read: 0.08 MB (ratio 1.00:1)
Time: 25.266 sec (0 m 25 s)
Start Date: 2022:01:28 12:43:57
End Date:   2022:01:28 12:44:23

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:43:57Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F87Frn2PtD7sOjfCOb.exe SCORE: 177 TYPE: EXE SIZE: 87312 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3f3a56c670> 
MD5: 480f710806b68dfe478ca1ec7d7e79cc 
SHA1: b4fc97fed2dbff9c4874cb65ede7b50699db37cd 
SHA256: 2416cd4aa577dbb2f8790a61e36fbab2b30bff81a4e1f67a5151c2fec29585bc CREATED: Fri Jan 28 12:43:57 2022 MODIFIED: Fri Jan 28 12:43:57 2022 ACCESSED: Fri Jan 28 12:44:23 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:44:23Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
1		misc_pe_signature
1		ft_exe
20		research_pe_signed_outside_timestamp
1		math_entropy_6
1		IsPE64
2		IsWindowsGUI
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
1		Contains_PE_File

Score total: 177

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Check_OutputDebugStringA_iat_v1', '30'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['177']
-------------- CAPA_Score ------------
['11.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3034.716116877592
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FrIkMl4jOiqX88j0aj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 138c71e94961fe9e31cec5dfba62a639                                                   |
| sha1                   | 7cc00da91f83d9e2f06172275f680501a09edd7c                                           |
| sha256                 | f81c70bc3d908f8152e3bfcdabf6538291d6a649fb6957d646fbde54d1ca1caf                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FrIkMl4jOiqX88j0aj.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings                             | anti-analysis/anti-vm/vm-detection                   |
| query remote server for available data                | communication                                        |
| receive data (2 matches)                              | communication                                        |
| parse URL (4 matches)                                 | communication/http                                   |
| check HTTP status code                                | communication/http/client                            |
| connect to HTTP server                                | communication/http/client                            |
| create HTTP request                                   | communication/http/client                            |
| obtain TransmitPackets callback function via WSAIoctl | communication/socket/tcp/send                        |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions               | executable/resource                                  |
| accept command line arguments                         | host-interaction/cli                                 |
| get local IPv4 addresses (2 matches)                  | host-interaction/network/address                     |
| get hostname                                          | host-interaction/os/hostname                         |
| get system information on Windows (2 matches)         | host-interaction/os/info                             |
| check OS version                                      | host-interaction/os/version                          |
| query or enumerate registry key (3 matches)           | host-interaction/registry                            |
| query or enumerate registry value (10 matches)        | host-interaction/registry                            |
| set registry value (8 matches)                        | host-interaction/registry/create                     |
| delete registry key                                   | host-interaction/registry/delete                     |
| delete registry value                                 | host-interaction/registry/delete                     |
| compare security identifiers                          | host-interaction/sid                                 |
| create thread (2 matches)                             | host-interaction/thread/create                       |
| link many functions at runtime                        | linking/runtime-linking                              |
| parse PE header                                       | load-code/pe                                         |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Network Configuration Discovery [T1016;3]

Score total: 33.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FrIkMl4jOiqX88j0aj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 25.414 sec (0 m 25 s)
Start Date: 2022:01:28 12:44:24
End Date:   2022:01:28 12:44:49

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:44:24Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FrIkMl4jOiqX88j0aj.exe SCORE: 221 TYPE: EXE SIZE: 95232 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe963bfa670> 
MD5: 138c71e94961fe9e31cec5dfba62a639 
SHA1: 7cc00da91f83d9e2f06172275f680501a09edd7c 
SHA256: f81c70bc3d908f8152e3bfcdabf6538291d6a649fb6957d646fbde54d1ca1caf CREATED: Fri Jan 28 12:44:24 2022 MODIFIED: Fri Jan 28 12:44:24 2022 ACCESSED: Fri Jan 28 12:44:50 2022 
REASON_1: Yara Rule MATCH: network_udp_sock SUBSCORE: 20 
DESCRIPTION: Communications over UDP network REF: - AUTHOR: x0r 
MATCHES: Str1: ws2_32.DLL Str2: WSOCK32.dll Str3: WSASendTo Str4: WSARecvFrom
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: HttpOpenRequest Str6: HttpSendRequest
REASON_3: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: ws2_32.DLL Str2: WSOCK32.dll Str3: WSASocket Str4: WSASend Str5: WSAConnect
REASON_4: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: RegQueryValueExA Str4: RegOpenKeyExA Str5: RegCloseKey Str6: RegSetValueExA
REASON_5: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: OpenProcessToken
REASON_6: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: ws2_32.DLL Str2: WSOCK32.dll
REASON_7: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_8: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_9: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_10: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645e780c645e85fc645e948c645 Str2: c645e85fc645e948c645eaa1c645 Str3: c645f780c645f85fc645f948c645 Str4: c645f85fc645f948c645faa1c645
REASON_13: Yara Rule MATCH: winsocks SUBSCORE: 5 
DESCRIPTION: Imports Winsock Library REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_17: Yara Rule MATCH: IsBeyondImageSize SUBSCORE: 1 
DESCRIPTION: Data Beyond ImageSize Check REF: - AUTHOR: _pusher_
REASON_18: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_19: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_21: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_22: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000
REASON_23: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:44:50Z

-------- Score ----------------
Scores		Rules
.......		...............
20		network_udp_sock
45		network_http
50		network_tcp_socket
20		win_registry
10		win_token
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
1		ft_exe
1		math_entropy_6
5		obfuscation_singlebyte_mov
5		winsocks
1		IsPE32
2		IsWindowsGUI
1		HasDebugData
1		IsBeyondImageSize
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
5		SEH_Save
5		SEH_Init
1		Contains_PE_File

Score total: 221

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_udp_sock', '20'), ('network_http', '45'), ('network_tcp_socket', '50'), ('win_registry', '20'), ('win_token', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('obfuscation_singlebyte_mov', '5'), ('winsocks', '5'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('IsBeyondImageSize', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['221']
-------------- CAPA_Score ------------
['33.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4171.026830853635
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F8wfcybmH0PM8J1Q7.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:44:50Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F8wfcybmH0PM8J1Q7.exe SCORE: 274 TYPE: EXE SIZE: 707072 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe776a39670> 
MD5: 477743976643213d96b66ed5041a3b12 
SHA1: c1cd5adff4e3e03bd736c1896019c33764b06ff6 
SHA256: da5acdec87c3b5e3dcdbde1d82650d5c1e1f1ce420bdbc99347b662c1a71dda3 CREATED: Fri Jan 28 12:44:50 2022 MODIFIED: Fri Jan 28 12:44:50 2022 ACCESSED: Fri Jan 28 12:45:16 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.DLL Str2: GDI32.dll Str3: user32.dll Str4: USER32.DLL Str5: USER32.dll Str6: BitBlt Str7: GetDC
REASON_2: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: USER32.DLL Str3: USER32.dll Str4: GetKeyState
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA Str6: RegCreateKeyA
REASON_4: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: GetPrivateProfileIntA Str4: GetPrivateProfileStringA Str5: WritePrivateProfileStringA
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: DeleteFileA Str7: CreateFileA Str8: FindFir ... (truncated)
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645d0ccc645d1ccc645d2ccc645 Str2: c645d1ccc645d2ccc645d3ccc645 Str3: c645d2ccc645d3ccc645d4ccc645 Str4: c645d3ccc645d4ccc645d5ccc645 ... (truncated)
REASON_9: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_15: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: USER32.DLL Str3: USER32.dll Str4: UnhookWindowsHookEx Str5: SetWindowsHookExA Str6: CallNextHookEx
REASON_16: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_17: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: IsDebuggerPresent
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:45:17Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
80		keylogger
20		win_registry
10		win_private_profile
10		win_files_operation
1		ft_exe
1		math_entropy_6
5		obfuscation_singlebyte_mov
15		dll_injection_hook
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
35		Win_Hook_v12
5		SEH_Save
5		SEH_Init
10		anti_dbg
1		Contains_PE_File

Score total: 274

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F8wfcybmH0PM8J1Q7.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.71 MB
Data read: 0.67 MB (ratio 1.06:1)
Time: 27.615 sec (0 m 27 s)
Start Date: 2022:01:28 12:44:50
End Date:   2022:01:28 12:45:18

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 477743976643213d96b66ed5041a3b12                                                   |
| sha1                   | c1cd5adff4e3e03bd736c1896019c33764b06ff6                                           |
| sha256                 | da5acdec87c3b5e3dcdbde1d82650d5c1e1f1ce420bdbc99347b662c1a71dda3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F8wfcybmH0PM8J1Q7.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | System Shutdown/Reboot:: \[T1529]\                                                 |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| log keystrokes via polling                           | collection/keylog                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (5 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| get common file path                                 | host-interaction/file-system                         |
| delete file (2 matches)                              | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| move file                                            | host-interaction/file-system/move                    |
| read .ini file                                       | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| enumerate gui resources                              | host-interaction/gui                                 |
| set application hook                                 | host-interaction/gui                                 |
| get graphical window text (3 matches)                | host-interaction/gui/window/get-text                 |
| hide graphical window                                | host-interaction/gui/window/hide                     |
| shutdown system                                      | host-interaction/os                                  |
| allocate thread local storage                        | host-interaction/process                             |
| enumerate process modules                            | host-interaction/process/modules/list                |
| terminate process                                    | host-interaction/process/terminate                   |
| create or open registry key (2 matches)              | host-interaction/registry                            |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| get session user name                                | host-interaction/session                             |
| create thread                                        | host-interaction/thread/create                       |
| link many functions at runtime                       | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Execution::Command and Scripting Interpreter [T1059;4]
3		- Discovery::Account Discovery [T1087;3]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
3		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
9		- Impact::System Shutdown/Reboot [T1529;9]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]

Score total: 48.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Impact::System Shutdown/Reboot [T1529;9]', '9'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('screenshot', '65'), ('keylogger', '80'), ('win_registry', '20'), ('win_private_profile', '10'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('obfuscation_singlebyte_mov', '5'), ('dll_injection_hook', '15'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Win_Hook_v12', '35'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['274']
-------------- CAPA_Score ------------
['48.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5310.309570103357
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FqhFla4PBa8c1BywPc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FqhFla4PBa8c1BywPc.exe: Win.Exploit.CVE_2017_0213-6306933-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 24.295 sec (0 m 24 s)
Start Date: 2022:01:28 12:45:54
End Date:   2022:01:28 12:46:19

-------- Score ----------------
Scores		Rules
.......		...............
25		Win.Exploit.CVE_2017_0213-6306933-0

Score total: 25.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd1 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x99 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfa in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x91 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcf in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa5 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xae in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:45:54Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FqhFla4PBa8c1BywPc.exe SCORE: 360 TYPE: EXE SIZE: 48640 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f85a6f6d670> 
MD5: 3ca359f5085bb96a7950d4735b089ffe 
SHA1: 60747604d54a18c4e4dc1a2c209e77a793e64dde 
SHA256: 7af61ce420051640c50b0e73e718dd8c55dddfcb58917a3bead9d3ece2f3e929 CREATED: Fri Jan 28 12:45:54 2022 MODIFIED: Fri Jan 28 12:45:54 2022 ACCESSED: Fri Jan 28 12:46:19 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: DuplicateTokenEx Str3: OpenProcessToken
REASON_3: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: win_ragnarlocker_auto SUBSCORE: 45 
DESCRIPTION: Detects win.ragnarlocker. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 8bec518b450c5356578d1c80 Str2: 8bfac1ef070fa4ca190bf2c1e11931750c0bf9 Str3: 8d4d10518d8d4cf5ffff51680401000050 Str4: 0f47d152ffd68d45 ... (truncated)
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: MAL_RANSOM_Ragna_Locker_Apr20_1 SUBSCORE: 60 
DESCRIPTION: Detects Ragna Locker Ransomware REF: https://otx.alienvault.com/indicator/file/c2bd70495630ed8279de0713a010e5e55f3da29323b59ef71401b12942ba52f6 AUTHOR: Florian Roth 
MATCHES: Str1: ---RAGNAR SECRET--- Str2: 
%s

%s
%s
%s

%s
.ragnar_ Str3: -forceWinSta0\Default
otepad.exe Str4: bootfont.bin Str5: Windows ... (truncated)
REASON_14: Yara Rule MATCH: ragnarlocker_ransomware SUBSCORE: 60 
DESCRIPTION: Rule to detect RagnarLocker samples REF: https://www.bleepingcomputer.com/news/security/ragnar-locker-ransomware-targets-msp-enterprise-support-tools/ AUTHOR: McAfee ATR Team 
MATCHES: Str1: ---RAGNAR SECRET--- Str2: 668b858af7ffff663b45d2b8010000000f44 Str3: 558bec53578b7d088bd985ff0f84 Str4: ff15448140003dea0000000f85 St ... (truncated)
REASON_15: Yara Rule MATCH: Ran_Mem_RagnarLocker_Nov_2020_1 SUBSCORE: 75 
DESCRIPTION: Detect memory artefacts of the Ragnarlocker ransomware (Nov 2020) REF: Internal Research AUTHOR: Arkbird_SOLG 
MATCHES: Str1: \.\PHYSICALDRIVE%d Str2: bootfont.bin Str3: bootsect.bak Str4: bootmgr.efi Str5: ---RAGNAR SECRET--- Str6: Internet Explorer Str7:   ... (truncated)
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Crypt32_CryptBinaryToString_API SUBSCORE: 25 
DESCRIPTION: Looks for crypt32 CryptBinaryToStringA function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: CRYPT32.dll Str2: CryptBinaryToStringA
REASON_18: Yara Rule MATCH: SHA512_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA384/SHA512 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: 982f8a42 Str2: 91443771 Str3: cffbc0b5 Str4: a5dbb5e9 Str5: 22ae28d7
REASON_19: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:46:19Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_token
10		win_files_operation
1		ft_exe
45		win_ragnarlocker_auto
1		math_entropy_6
1		IsPE32
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
60		MAL_RANSOM_Ragna_Locker_Apr20_1
60		ragnarlocker_ransomware
75		Ran_Mem_RagnarLocker_Nov_2020_1
1		Contains_PE_File
25		Crypt32_CryptBinaryToString_API
20		SHA512_Constants
20		SHA2_BLAKE2_IVs

Score total: 360

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Exploit.CVE_2017_0213-6306933-0', '25')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_token', '10'), ('win_files_operation', '10'), ('ft_exe', '1'), ('win_ragnarlocker_auto', '45'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('MAL_RANSOM_Ragna_Locker_Apr20_1', '60'), ('ragnarlocker_ransomware', '60'), ('Ran_Mem_RagnarLocker_Nov_2020_1', '75'), ('Contains_PE_File', '1'), ('Crypt32_CryptBinaryToString_API', '25'), ('SHA512_Constants', '20'), ('SHA2_BLAKE2_IVs', '20')]
-------------- LOKI_Score ------------
['360']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['25.0']
-------------- SCORE FINAL ------------
6020.34684580855
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FuSUH1cAoFyn33OBg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FuSUH1cAoFyn33OBg.exe: Win.Malware.Phobos-6981135-1 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 24.988 sec (0 m 24 s)
Start Date: 2022:01:28 12:46:19
End Date:   2022:01:28 12:46:44

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Phobos-6981135-1

Score total: 50.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:46:20Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FuSUH1cAoFyn33OBg.exe SCORE: 139 TYPE: EXE SIZE: 72704 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f29fb91e670> 
MD5: e59ffeaf7acb0c326e452fa30bb71a36 
SHA1: c88fad293256bfead6962124394de4f8b97765aa 
SHA256: a91491f45b851a07f91ba5a200967921bf796d38677786de51a4a8fe5ddeafd2 CREATED: Fri Jan 28 12:46:19 2022 MODIFIED: Fri Jan 28 12:46:19 2022 ACCESSED: Fri Jan 28 12:46:45 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: DuplicateTokenEx Str4: OpenProcessToken
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_5: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_14: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_15: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_18: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:46:45Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
20		win_registry
10		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
1		ft_exe
1		math_entropy_6
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
5		SEH_Save
5		SEH_Init
10		anti_dbg
1		Contains_PE_File
25		CRC32_poly_Constant
25		CRC32_table

Score total: 139

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Phobos-6981135-1', '50')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('win_registry', '20'), ('win_token', '10'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25')]
-------------- LOKI_Score ------------
['139']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['50.0']
-------------- SCORE FINAL ------------
2832.464243418031
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FC1Uc34uGpumNrRgb8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b2ad4409323147b63e370745e5209996                                                   |
| sha1                   | 15e8fac9c9d5e541940a3c2782df6196ec1e9326                                           |
| sha256                 | 867991ade335186baa19a227e3a044c8321a6cef96c23c98eef21fe6b87edf6a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FC1Uc34uGpumNrRgb8.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Process Discovery:: \[T1057]\                                                      |
|                        | Software Discovery:: \[T1518]\                                                     |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| write file on Windows                                | host-interaction/file-system/write                   |
| check mutex                                          | host-interaction/mutex                               |
| create mutex                                         | host-interaction/mutex                               |
| inject thread                                        | host-interaction/process/inject                      |
| enumerate processes                                  | host-interaction/process/list                        |
| terminate process                                    | host-interaction/process/terminate                   |
| link many functions at runtime                       | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
| spawn thread to RWX shellcode                        | load-code/shellcode                                  |
| identify ATM dispenser service provider              | targeting/automated-teller-machine                   |
| reference Diebold ATM routines                       | targeting/automated-teller-machine/diebold-nixdorf   |
| load NCR ATM library                                 | targeting/automated-teller-machine/ncr               |
| reference NCR ATM library routines (2 matches)       | targeting/automated-teller-machine/ncr               |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
4		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2		- Discovery::Software Discovery [T1518;2]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]

Score total: 20.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FC1Uc34uGpumNrRgb8.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.210 sec (0 m 24 s)
Start Date: 2022:01:28 12:46:46
End Date:   2022:01:28 12:47:10

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:46:46Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FC1Uc34uGpumNrRgb8.exe SCORE: 265 TYPE: EXE SIZE: 26112 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9044f03670> 
MD5: b2ad4409323147b63e370745e5209996 
SHA1: 15e8fac9c9d5e541940a3c2782df6196ec1e9326 
SHA256: 867991ade335186baa19a227e3a044c8321a6cef96c23c98eef21fe6b87edf6a CREATED: Fri Jan 28 12:46:46 2022 MODIFIED: Fri Jan 28 12:46:46 2022 ACCESSED: Fri Jan 28 12:47:11 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: win_dispenserxfs_auto SUBSCORE: 45 
DESCRIPTION: Detects win.dispenserxfs. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 6689854affffff33c066898574ffffff8d45cc6a06898578ffffff Str2: e9b20000006a0057893d508c4000b80000008033ff57 Str3: 0fb74106500fb74102500 ... (truncated)
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c6459047c6459165c6459274c645 Str2: c6459165c6459274c6459350c645 Str3: c6459274c6459350c6459472c645 Str4: c6459350c6459472c645956fc645 ... (truncated)
REASON_7: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_8: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_14: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_15: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_16: Yara Rule MATCH: ATM_Malware_DispenserXFS SUBSCORE: 80 
DESCRIPTION: Detects ATM Malware DispenserXFS REF: https://twitter.com/r3c0nst/status/1100775857306652673 AUTHOR: @Xylit0l @r3c0nst / Modified by Florian Roth 
MATCHES: Str1: 68ffff00006860ea00006a10 Str2: \dispenserXFS.pdb Str3: C:\xfsasdf.txt Str4: Injected mxsfs killer into %d. Str5: Waiting for freeze m ... (truncated)
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:47:11Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
5		win_mutex
1		ft_exe
45		win_dispenserxfs_auto
1		math_entropy_6
5		obfuscation_singlebyte_mov
15		dll_injection_thread
1		IsPE32
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
45		Inject_Thread
5		SEH_Save
5		SEH_Init
80		ATM_Malware_DispenserXFS
1		Contains_PE_File

Score total: 265

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Discovery::Software Discovery [T1518;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('win_mutex', '5'), ('ft_exe', '1'), ('win_dispenserxfs_auto', '45'), ('math_entropy_6', '1'), ('obfuscation_singlebyte_mov', '5'), ('dll_injection_thread', '15'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Inject_Thread', '45'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('ATM_Malware_DispenserXFS', '80'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['265']
-------------- CAPA_Score ------------
['20.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4608.9957345905705
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FH3HW72OXYygM3DBxb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c8403fb05244e23a7931c766409b5e22                                                   |
| sha1                   | c10a1d36b136c1df20c4135ea67bfb4c3934a4d8                                           |
| sha256                 | 42b610e7f4f0a0275ec3ede3895287e673c7cdad11fc352f86b1f2f7ed050fa0                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FH3HW72OXYygM3DBxb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| initialize Winsock library                           | communication/socket                                 |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| create process on Windows                            | host-interaction/process/create                      |
| terminate process                                    | host-interaction/process/terminate                   |
| link many functions at runtime                       | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
3		- Discovery::System Network Configuration Discovery [T1016;3]

Score total: 16.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FH3HW72OXYygM3DBxb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 24.255 sec (0 m 24 s)
Start Date: 2022:01:28 12:47:11
End Date:   2022:01:28 12:47:35

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:47:11Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:47:36Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['16.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
319.24197039502076
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FAzhPz1eQ4DsNnZq9f.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 09cee5d093127aa9c9ff4b90f6a90581                                                   |
| sha1                   | b67e776551f3a451f0d5ffbcb6c3a9f096920386                                           |
| sha256                 | 4fa837762a3a76bcee46f7d34f8d2e3e4ea59a0d8f9094a8ca96144e137370f9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FAzhPz1eQ4DsNnZq9f.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FAzhPz1eQ4DsNnZq9f.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.261 sec (0 m 24 s)
Start Date: 2022:01:28 12:47:36
End Date:   2022:01:28 12:48:00

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:47:36Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:48:01Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['10.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
199.526231496888
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FAXGXt2zmEb7zR2fHd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 7faafc7e4a5c736ebfee6abbbc812d80                                                   |
| sha1                   | 625628d4c91d4193474735da011903642b2c916e                                           |
| sha256                 | 309217d8088871e09a7a03ee68ee46f60583a73945006f95021ec85fc1ec959e                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FAXGXt2zmEb7zR2fHd.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Indicator Removal on Host::File Deletion \[T1070.004]\                             |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
|                             | Debugger Detection::Process Environment Block NtGlobalFlag [B0001.036]        |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | Socket Communication::Connect Socket [C0001.004]                              |
|                             | Socket Communication::Create TCP Socket [C0001.011]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::TCP Client [C0001.008]                                  |
| DEFENSE EVASION             | Self Deletion::COMSPEC Environment Variable [F0007.001]                       |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag (24 matches)        | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB NtGlobalFlag flag (24 matches)         | anti-analysis/anti-debugging/debugger-detection      |
| self delete                                          | anti-analysis/anti-forensic/self-deletion            |
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| read and send data from client to server             | c2/file-transfer                                     |
| receive and write data from server to client         | c2/file-transfer                                     |
| creates tcp or udp socket                            | communication/socket                                 |
| initialize Winsock library                           | communication/socket                                 |
| act as TCP client                                    | communication/tcp/client                             |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| create process on Windows                            | host-interaction/process/create                      |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| modify service                                       | host-interaction/service/modify                      |
| persist via Windows service                          | persistence/service                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Discovery::File and Directory Discovery [T1083;1]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
3		- Execution::System Services::Service Execution [T1569.002;3]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
8.5		- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]

Score total: 58.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FAXGXt2zmEb7zR2fHd.exe: Win.Dropper.Ulise-9937584-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FAXGXt2zmEb7zR2fHd.exe: Win.Trojan.Downloader-15920 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 24.675 sec (0 m 24 s)
Start Date: 2022:01:28 12:48:01
End Date:   2022:01:28 12:48:26

-------- Score ----------------
Scores		Rules
.......		...............
30		Win.Dropper.Ulise-9937584-0
45		Win.Trojan.Downloader-15920

Score total: 75.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 0: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:48:01Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FAXGXt2zmEb7zR2fHd.exe SCORE: 78 TYPE: EXE SIZE: 61440 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7af1b41670> 
MD5: 7faafc7e4a5c736ebfee6abbbc812d80 
SHA1: 625628d4c91d4193474735da011903642b2c916e 
SHA256: 309217d8088871e09a7a03ee68ee46f60583a73945006f95021ec85fc1ec959e CREATED: Fri Jan 28 12:48:01 2022 MODIFIED: Fri Jan 28 12:48:01 2022 ACCESSED: Fri Jan 28 12:48:27 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegSetValueExA
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: kernel32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: DeleteFileA Str7: CreateFileA Str8: CopyFil ... (truncated)
REASON_3: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_11: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_12: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: VC6_Random SUBSCORE: 15 
DESCRIPTION: Look for Random function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: a180c1400069c0fd43030005c39e2600a380c14000c1f81025ff7f0000c3
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:48:27Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
10		Str_Win32_Winsock2_Library
1		ft_exe
1		math_entropy_5
1		IsPE32
1		IsConsole
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
5		SEH_Save
5		SEH_Init
1		Contains_PE_File
15		VC6_Random

Score total: 78

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]', '8.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]', '8.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5')]
---------------- ClamAV_Rules --------------
[('Win.Dropper.Ulise-9937584-0', '30'), ('Win.Trojan.Downloader-15920', '45')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Contains_PE_File', '1'), ('VC6_Random', '15')]
-------------- LOKI_Score ------------
['78']
-------------- CAPA_Score ------------
['58.5']
-------------- CLAMAV_Score ------------
['75.0']
-------------- SCORE FINAL ------------
3347.6392032220883
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FpEY9Bg0lRE9UOkak.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ba4cfe6461afa1004c52f19c8f2169dc                                                   |
| sha1                   | ab8539ef6b2a93ff9589dec4b34a0257b6296c92                                           |
| sha256                 | e86870769ee6c797e09457bd99c58d9bf2303cf0193a24ef9b1222c2c3daf628                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FpEY9Bg0lRE9UOkak.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (3 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FpEY9Bg0lRE9UOkak.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.10 MB
Data read: 0.10 MB (ratio 1.00:1)
Time: 24.901 sec (0 m 24 s)
Start Date: 2022:01:28 12:48:27
End Date:   2022:01:28 12:48:52

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:48:27Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] 
FILE: /tmp/.Loki_Scan/HTTP-FpEY9Bg0lRE9UOkak.exe SCORE: 42 TYPE: EXE SIZE: 103288 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7ffba8299670> 
MD5: ba4cfe6461afa1004c52f19c8f2169dc 
SHA1: ab8539ef6b2a93ff9589dec4b34a0257b6296c92 
SHA256: e86870769ee6c797e09457bd99c58d9bf2303cf0193a24ef9b1222c2c3daf628 CREATED: Fri Jan 28 12:48:27 2022 MODIFIED: Fri Jan 28 12:48:27 2022 ACCESSED: Fri Jan 28 12:48:53 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 0 warnings, 2 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:48:53Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		misc_pe_signature
1		ft_exe
20		research_pe_signed_outside_timestamp
1		math_entropy_6
1		IsPE64
2		IsWindowsGUI
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
1		Contains_PE_File

Score total: 42

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['42']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
745.4656334324228
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FHK71g8BiEDx1zMAd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FHK71g8BiEDx1zMAd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.33 MB
Data read: 0.31 MB (ratio 1.05:1)
Time: 26.034 sec (0 m 26 s)
Start Date: 2022:01:28 12:48:53
End Date:   2022:01:28 12:49:19

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:48:53Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FHK71g8BiEDx1zMAd.exe SCORE: 245 TYPE: EXE SIZE: 328192 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7ff19829b670> 
MD5: 6be0ae5cb7c3155f70d608fc7670d2d9 
SHA1: a3d3d6c2adc7cb7d747c279810036bc104e80376 
SHA256: 223afed3106fb9cdde89eac273894e2fbe392f66b87ab8b9408cd6ef1bce8fa4 CREATED: Fri Jan 28 12:48:53 2022 MODIFIED: Fri Jan 28 12:48:53 2022 ACCESSED: Fri Jan 28 12:49:19 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CreateFileA Str7: FindFirstFileA Str8: MoveF ... (truncated)
REASON_2: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_3: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: Gamaredon_GetImportByHash SUBSCORE: 70 
DESCRIPTION: Detects Gamaredon APIHashing REF: - AUTHOR: Frank Boldewin (@r3c0nst) 
MATCHES: Str1: 8b503c03d08b527803d08b4a1c03c8 Str2: 8b7508ba051500008bc2c1e20503d033db8a1e03d34633db8a1e85db75
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_16: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_17: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_18: Yara Rule MATCH: MAL_SUSP_Gamaredon_GetImportByHash SUBSCORE: 60 
DESCRIPTION: Detects Gamaredon APIHashing REF: https://twitter.com/r3c0nst/status/1392405576131436546?s=20 AUTHOR: Frank Boldewin (@r3c0nst) 
MATCHES: Str1: 8b503c03d08b527803d08b4a1c03c8 Str2: 8b7508ba051500008bc2c1e20503d033db8a1e03d34633db8a1e85db75
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:49:19Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
1		ft_exe
70		Gamaredon_GetImportByHash
1		math_entropy_6
1		IsPE32
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		SEH_Save
5		SEH_Init
10		anti_dbg
60		MAL_SUSP_Gamaredon_GetImportByHash
1		Contains_PE_File

Score total: 245

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6be0ae5cb7c3155f70d608fc7670d2d9                                                   |
| sha1                   | a3d3d6c2adc7cb7d747c279810036bc104e80376                                           |
| sha256                 | 223afed3106fb9cdde89eac273894e2fbe392f66b87ab8b9408cd6ef1bce8fa4                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FHK71g8BiEDx1zMAd.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Non-Cryptographic Hash:: [C0030]                                              |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check HTTP status code                               | communication/http/client                            |
| encrypt data using RC4 PRGA (2 matches)              | data-manipulation/encryption/rc4                     |
| hash data using djb2                                 | data-manipulation/hashing/djb2                       |
| write file on Windows (3 matches)                    | host-interaction/file-system/write                   |
| get number of processors                             | host-interaction/hardware/cpu                        |
| access PEB ldr_data                                  | linking/runtime-linking                              |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
2		- Execution::Shared Modules [T1129;2]

Score total: 13.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '1'), ('Gamaredon_GetImportByHash', '70'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('MAL_SUSP_Gamaredon_GetImportByHash', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['245']
-------------- CAPA_Score ------------
['13.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4152.348734050526
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FrhIni2iwcA1GuMRFg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3d760b6fc84571c928bed835863fc302                                                   |
| sha1                   | adcf9ade7a4dc14b7bf656e86ea15766b843e3b6                                           |
| sha256                 | 8ac21275d0db7f3e990551f343e16ac105d6a513810ff71934de4855999cc9c5                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FrhIni2iwcA1GuMRFg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+------------------------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                                   |
|-----------------------------+------------------------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                                            |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                                     |
|                             | Virtual Machine Detection::Unique Hardware/Firmware Check - I/O Communication Port [B0009.025] |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                                     |
|                             | C2 Communication::Send Data [B0030.001]                                                        |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                                         |
|                             | HTTP Communication::Connect to Server [C0002.009]                                              |
|                             | HTTP Communication::Create Request [C0002.012]                                                 |
|                             | HTTP Communication::Get Response [C0002.017]                                                   |
|                             | HTTP Communication::Read Header [C0002.014]                                                    |
|                             | HTTP Communication::Send Data [C0002.005]                                                      |
|                             | HTTP Communication::Send Request [C0002.003]                                                   |
| FILE SYSTEM                 | Read File:: [C0051]                                                                            |
|                             | Writes File:: [C0052]                                                                          |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                                      |
|                             | Registry::Open Registry Key [C0036.003]                                                        |
|                             | Registry::Query Registry Value [C0036.006]                                                     |
|                             | Registry::Set Registry Key [C0036.001]                                                         |
+-----------------------------+------------------------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-VM instructions                         | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VMWare           | anti-analysis/anti-vm/vm-detection                   |
| reference the VMWare IO port                         | anti-analysis/anti-vm/vm-detection                   |
| receive and write data from server to client         | c2/file-transfer                                     |
| get geographical location                            | collection                                           |
| send data (3 matches)                                | communication                                        |
| parse URL (2 matches)                                | communication/http                                   |
| check HTTP status code                               | communication/http/client                            |
| hash data with MD5                                   | data-manipulation/hashing/md5                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get file size                                        | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| get CPU information                                  | host-interaction/hardware/cpu                        |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| get hostname                                         | host-interaction/os/hostname                         |
| get system information on Windows                    | host-interaction/os/info                             |
| check OS version (2 matches)                         | host-interaction/os/version                          |
| set registry value                                   | host-interaction/registry/create                     |
| compare security identifiers                         | host-interaction/sid                                 |
| access PEB ldr_data (3 matches)                      | linking/runtime-linking                              |
| parse PE exports (2 matches)                         | load-code/pe                                         |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Location Discovery [T1614;3]
1		- Discovery::File and Directory Discovery [T1083;1]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Network Configuration Discovery [T1016;3]

Score total: 33.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FrhIni2iwcA1GuMRFg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 24.094 sec (0 m 24 s)
Start Date: 2022:01:28 12:49:32
End Date:   2022:01:28 12:49:56

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:49:32Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FrhIni2iwcA1GuMRFg.exe SCORE: 1719 TYPE: EXE SIZE: 57856 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9cc9ee6670> 
MD5: 3d760b6fc84571c928bed835863fc302 
SHA1: adcf9ade7a4dc14b7bf656e86ea15766b843e3b6 
SHA256: 8ac21275d0db7f3e990551f343e16ac105d6a513810ff71934de4855999cc9c5 CREATED: Fri Jan 28 12:49:32 2022 MODIFIED: Fri Jan 28 12:49:32 2022 ACCESSED: Fri Jan 28 12:49:57 2022 
REASON_1: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: InternetWriteFile Str6: HttpOpenRequest Str7: HttpS ... (truncated)
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: DeleteFileA Str5: CreateFileA Str6: FindFirstFileA
REASON_5: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_6: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_7: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_8: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_9: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: stager_reverse_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_16: Yara Rule MATCH: stager_bind_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_17: Yara Rule MATCH: win32_stage_boot_winsock_conn_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_18: Yara Rule MATCH: win32_stage_boot_bind_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_19: Yara Rule MATCH: win32_stage_boot_reverse_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_20: Yara Rule MATCH: win32_stage_boot_winsock_conn_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_21: Yara Rule MATCH: stager_reverse_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_22: Yara Rule MATCH: win32_stage_boot_bind_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_23: Yara Rule MATCH: win32_stage_boot_reverse_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_24: Yara Rule MATCH: win32_stage_boot_reverse_shell_revert_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_25: Yara Rule MATCH: win32_stage_winexec_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_26: Yara Rule MATCH: stager_bind_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_27: Yara Rule MATCH: win32_stage_boot_winsock_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_28: Yara Rule MATCH: win32_stage_boot_reverse_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_29: Yara Rule MATCH: win32_stage_api_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_30: Yara Rule MATCH: win32_stage_boot_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_31: Yara Rule MATCH: win32_stage_boot_reverse_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_32: Yara Rule MATCH: win32_stage_boot_reverse_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_33: Yara Rule MATCH: win32_stage_boot_bind_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_34: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DESCRIPTION\System
REASON_35: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: vmware Str2: b868584d56bb00000000b90a000000ba58560000ed
REASON_36: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_37: Yara Rule MATCH: antivm_vmware SUBSCORE: 60 
DESCRIPTION: AntiVM checks for VMWare REF: - AUTHOR: x0r 
MATCHES: Str1: b868584d56bb00000000b90a000000ba58560000ed
REASON_38: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: vmware
REASON_39: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_40: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: vmware
REASON_41: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_42: Yara Rule MATCH: MD5_Constants SUBSCORE: 20 
DESCRIPTION: Look for MD5 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: 78a46ad7
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:49:57Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_http
20		win_registry
10		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
1		ft_exe
1		math_entropy_6
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
2		PE_File
70		stager_reverse_tcp_nx_ldone_x86
70		stager_bind_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_conn_ldone_x86
70		win32_stage_boot_bind_read_ldone_x86
70		win32_stage_boot_reverse_read_ldone_x86
70		win32_stage_boot_winsock_conn_udp_ldone_x86
70		stager_reverse_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_bind_inlineegg_ldone_x86
70		win32_stage_boot_reverse_ldone_x86
70		win32_stage_boot_reverse_shell_revert_ldone_x86
70		win32_stage_winexec_ldone_x86
70		stager_bind_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_bind_ldone_x86
70		win32_stage_boot_reverse_shell_ldone_x86
70		win32_stage_api_ldone_x86
70		win32_stage_boot_bind_ldone_x86
70		win32_stage_boot_reverse_udp_ldone_x86
70		win32_stage_boot_reverse_inlineegg_ldone_x86
70		win32_stage_boot_bind_shell_ldone_x86
35		Qemu_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
60		antivm_vmware
60		vmdetect_2
5		SEH_Init
60		vmdetect
1		Contains_PE_File
20		MD5_Constants

Score total: 1719

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_http', '45'), ('win_registry', '20'), ('win_token', '10'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('PE_File', '2'), ('stager_reverse_tcp_nx_ldone_x86', '70'), ('stager_bind_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_ldone_x86', '70'), ('win32_stage_boot_bind_read_ldone_x86', '70'), ('win32_stage_boot_reverse_read_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_udp_ldone_x86', '70'), ('stager_reverse_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_bind_inlineegg_ldone_x86', '70'), ('win32_stage_boot_reverse_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_revert_ldone_x86', '70'), ('win32_stage_winexec_ldone_x86', '70'), ('stager_bind_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_ldone_x86', '70'), ('win32_stage_api_ldone_x86', '70'), ('win32_stage_boot_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_udp_ldone_x86', '70'), ('win32_stage_boot_reverse_inlineegg_ldone_x86', '70'), ('win32_stage_boot_bind_shell_ldone_x86', '70'), ('Qemu_Detection', '35'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('antivm_vmware', '60'), ('vmdetect_2', '60'), ('SEH_Init', '5'), ('vmdetect', '60'), ('Contains_PE_File', '1'), ('MD5_Constants', '20')]
-------------- LOKI_Score ------------
['1719']
-------------- CAPA_Score ------------
['33.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
27912.726853921115
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FlvczE172f0ct5Izsg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a6933d1262da26403faf968672a1baf0                                                   |
| sha1                   | 3047bada98818c4b4699eb6bd5ffb19d9e9868a8                                           |
| sha256                 | ce8d7590182db2e51372a4a04d6a0927a65b2640739f9ec01cfd6c143b1110da                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FlvczE172f0ct5Izsg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Portable Executable Injection \[T1055.002]\                     |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| set environment variable                             | host-interaction/environment-variable                |
| hide graphical window                                | host-interaction/gui/window/hide                     |
| inject pe                                            | host-interaction/process/inject                      |
| inject thread                                        | host-interaction/process/inject                      |
| access PE header                                     | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
| spawn thread to RWX shellcode                        | load-code/shellcode                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]
2		- Execution::Shared Modules [T1129;2]
4		- Defense Evasion::Process Injection::Portable Executable Injection [T1055.002;4]
3		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 15.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FlvczE172f0ct5Izsg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.10 MB
Data read: 0.10 MB (ratio 1.00:1)
Time: 25.053 sec (0 m 25 s)
Start Date: 2022:01:28 12:49:57
End Date:   2022:01:28 12:50:22

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:49:57Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FlvczE172f0ct5Izsg.exe SCORE: 249 TYPE: EXE SIZE: 104448 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f2ab6927670> 
MD5: a6933d1262da26403faf968672a1baf0 
SHA1: 3047bada98818c4b4699eb6bd5ffb19d9e9868a8 
SHA256: ce8d7590182db2e51372a4a04d6a0927a65b2640739f9ec01cfd6c143b1110da CREATED: Fri Jan 28 12:49:57 2022 MODIFIED: Fri Jan 28 12:49:57 2022 ACCESSED: Fri Jan 28 12:50:22 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: FindClose
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: ConventionEngine_Term_Desktop SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445336f6360ba646a14aaeb3260c022cd49002000000433a5c55736572735c656e6467616d655c4465736b746f705c504557696e646f775c52656c656173655c5 ... (truncated)
REASON_5: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445336f6360ba646a14aaeb3260c022cd49002000000433a5c55736572735c656e6467616d655c4465736b746f705c504557696e646f775c52656c656173655c5 ... (truncated)
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread
REASON_14: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_15: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:50:22Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
10		win_files_operation
1		ft_exe
50		ConventionEngine_Term_Desktop
50		ConventionEngine_Term_Users
1		math_entropy_6
15		dll_injection_thread
1		IsPE32
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
45		Inject_Thread
5		SEH_Save
5		SEH_Init
10		anti_dbg
1		Contains_PE_File

Score total: 249

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Process Injection::Portable Executable Injection [T1055.002;4]', '4'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('win_files_operation', '10'), ('ft_exe', '1'), ('ConventionEngine_Term_Desktop', '50'), ('ConventionEngine_Term_Users', '50'), ('math_entropy_6', '1'), ('dll_injection_thread', '15'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Inject_Thread', '45'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['249']
-------------- CAPA_Score ------------
['15.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4245.673396473504
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FS6HZq1px7ODzsOPv9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FS6HZq1px7ODzsOPv9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 23.244 sec (0 m 23 s)
Start Date: 2022:01:28 12:50:23
End Date:   2022:01:28 12:50:46

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:50:23Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FS6HZq1px7ODzsOPv9.exe SCORE: 84 TYPE: EXE SIZE: 65536 
FIRST_BYTES: 4d5a636f6e73706972616379504500004c010100 / <filter object at 0x7ffacd677670> 
MD5: f9ac6b16273556b3a57bf2c6d7e7db97 
SHA1: 8f6942cf31c97fe821d0ccd3a5c1790d9669e95d 
SHA256: 74e9a296d1b1c7ec27dcca35961d3563779c48cd8163a6ec00fa19aff17a6ed0 CREATED: Fri Jan 28 12:50:23 2022 MODIFIED: Fri Jan 28 12:50:23 2022 ACCESSED: Fri Jan 28 12:50:47 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: misc_no_dosmode_header SUBSCORE: 10 
DESCRIPTION: Detect on absence of 'DOS Mode' heaader between MZ and PE boundries REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 1 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPacked SUBSCORE: 5 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasModified_DOS_Message SUBSCORE: 1 
DESCRIPTION: DOS Message Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: kkrunchy
REASON_10: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:50:47Z

-------- Score ----------------
Scores		Rules
.......		...............
1		ft_exe
10		misc_no_dosmode_header
1		math_entropy_close_8
1		IsPE32
2		IsWindowsGUI
5		IsPacked
1		HasModified_DOS_Message
2		PE_File
60		suspicious_packer_section
1		Contains_PE_File

Score total: 84

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '1'), ('misc_no_dosmode_header', '10'), ('math_entropy_close_8', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('IsPacked', '5'), ('HasModified_DOS_Message', '1'), ('PE_File', '2'), ('suspicious_packer_section', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['84']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1331.3102816673352
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FQw66l4Bvw8BDOnTod.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FQw66l4Bvw8BDOnTod.exe: Win.Malware.Agent-6350563-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FQw66l4Bvw8BDOnTod.exe: Win.Trojan.Agent-709658 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.00 MB
Data read: 0.00 MB (ratio 0.00:1)
Time: 23.580 sec (0 m 23 s)
Start Date: 2022:01:28 12:50:47
End Date:   2022:01:28 12:51:11

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Agent-6350563-0
70		Win.Trojan.Agent-709658
75		Win.Trojan.Agent-709658
45		Win.Trojan.Agent-709658

Score total: 240.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:50:47Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FQw66l4Bvw8BDOnTod.exe SCORE: 175 TYPE: EXE SIZE: 3072 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f66585be670> 
MD5: 8363436878404da0ae3e46991e355b83 
SHA1: 5a016facbcb77e2009a01ea5c67b39af209c3fcb 
SHA256: c876a332d7dd8da331cb8eee7ab7bf32752834d4b2b54eaa362674a2a48f64a6 CREATED: Fri Jan 28 12:50:47 2022 MODIFIED: Fri Jan 28 12:50:47 2022 ACCESSED: Fri Jan 28 12:51:12 2022 
REASON_1: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_2: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetOpen
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: misc_upx_packed_binary SUBSCORE: 10 
DESCRIPTION: Detect section names indicative of UPX packed PE files REF: - AUTHOR: Jason Batchelor
REASON_5: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: upx_sections SUBSCORE: 2 
DESCRIPTION: Contains UPX sections REF: - AUTHOR: - 
MATCHES: Str1: UPX0 Str2: UPX1
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: upx SUBSCORE: 15 
DESCRIPTION: UPX packed file REF: - AUTHOR: - 
MATCHES: Str1: MZ Str2: UPX0 Str3: UPX1 Str4: UPX!
REASON_12: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: UPX0 Str2: UPX1 Str3: UPX2 Str4: UPX!
REASON_13: Yara Rule MATCH: UPX SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR:  Kevin Breen <kevin@techanarchy.net> 
MATCHES: Str1: UPX0 Str2: UPX1 Str3: UPX!
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:51:12Z

-------- Score ----------------
Scores		Rules
.......		...............
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
1		ft_exe
10		misc_upx_packed_binary
1		math_entropy_5
2		upx_sections
1		IsPE32
1		IsConsole
1		HasRichSignature
2		PE_File
15		upx
60		suspicious_packer_section
60		UPX
1		Contains_PE_File

Score total: 175

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Agent-6350563-0', '50'), ('Win.Trojan.Agent-709658', '70'), ('Win.Trojan.Agent-709658', '75'), ('Win.Trojan.Agent-709658', '45')]
-------------- LOKI_Rules ------------
[('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('ft_exe', '1'), ('misc_upx_packed_binary', '10'), ('math_entropy_5', '1'), ('upx_sections', '2'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('upx', '15'), ('suspicious_packer_section', '60'), ('UPX', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['175']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['240.0']
-------------- SCORE FINAL ------------
5794.98407511295
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F3eerd1dutZKm5VpG6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F3eerd1dutZKm5VpG6.exe: Win.Dropper.Necurs-7617964-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-F3eerd1dutZKm5VpG6.exe: Win.Malware.Necurs-7618009-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.18 MB
Data read: 0.18 MB (ratio 1.02:1)
Time: 25.068 sec (0 m 25 s)
Start Date: 2022:01:28 12:51:12
End Date:   2022:01:28 12:51:37

-------- Score ----------------
Scores		Rules
.......		...............
30		Win.Dropper.Necurs-7617964-0
50		Win.Malware.Necurs-7618009-0

Score total: 80.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 1-2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf2 in position 8: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xda in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc9 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:51:12Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F3eerd1dutZKm5VpG6.exe SCORE: 965 TYPE: EXE SIZE: 188418 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb4bde23670> 
MD5: 0596c4ea5aa8def47f22c85d75aaca95 
SHA1: f63ad8e1c86666a0d3a51f039e44f7cb17232933 
SHA256: 377fdff7fd24bf9257447480a8061e0380902f795ac5f8aac3738663b6503a3d CREATED: Fri Jan 28 12:51:12 2022 MODIFIED: Fri Jan 28 12:51:12 2022 ACCESSED: Fri Jan 28 12:51:37 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: HttpOpenRequest Str6: HttpSendRequest
REASON_3: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: DNSAPI.dll Str3: getaddrinfo Str4: DnsQuery
REASON_4: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_5: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_6: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: DuplicateTokenEx Str3: AdjustTokenPrivileges Str4: OpenProcessToken
REASON_7: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: ReadFile Str5: CopyFile
REASON_8: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_9: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_10: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_11: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_12: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: win_necurs_auto SUBSCORE: 45 
DESCRIPTION: Detects win.necurs. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 13f2a314000801893510000801890d0c000801 Str2: 397508760433c0eb12 Str3: 33d246f7f68bc20345085e5d Str4: 0f318bc8a118000801568bf2 Str5: 0 ... (truncated)
REASON_14: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_16: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_19: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_20: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_23: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_24: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: b868584d56bb00000000b90a000000ba58560000ed
REASON_25: Yara Rule MATCH: VM_Detect_VirtualPC_XEN_Wine_v1 SUBSCORE: 60 
DESCRIPTION: Xen detection, VirtualPC, Red Pill, Wine and other REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: ?
REASON_26: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_27: Yara Rule MATCH: antivm_vmware SUBSCORE: 60 
DESCRIPTION: AntiVM checks for VMWare REF: - AUTHOR: x0r 
MATCHES: Str1: b868584d56bb00000000b90a000000ba58560000ed
REASON_28: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: ?
REASON_29: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_30: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_31: Yara Rule MATCH: ThreadControl__Context_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetThreadContext
REASON_32: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_33: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: ?
REASON_34: Yara Rule MATCH: TrojanWin32NecursSample SUBSCORE: 50 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: some stupid error %u Str2: loading Str3: unloading Str4: exception %08x %swhen %s at %p Str5: microsoft.com Str6: facebook.com Str7:  ... (truncated)
REASON_35: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_36: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
REASON_37: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:51:38Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
45		network_http
50		network_dns
70		escalate_priv
20		win_registry
10		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
1		ft_exe
45		win_necurs_auto
1		math_entropy_5
15		dll_injection_thread
1		IsPE32
2		IsWindowsGUI
1		HasOverlay
1		HasRichSignature
35		Embedded_PE
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
60		VM_Detect_VirtualPC_XEN_Wine_v1
5		Anti_Automated_Sandbox
60		antivm_vmware
60		vmdetect_2
45		Inject_Thread
60		Debugger_Check__QueryInfo
60		ThreadControl__Context_v1
5		SEH_Init
60		vmdetect
50		TrojanWin32NecursSample
1		Contains_PE_File
20		Advapi_Hash_API
25		CRC32_poly_Constant

Score total: 965

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Dropper.Necurs-7617964-0', '30'), ('Win.Malware.Necurs-7618009-0', '50')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('network_http', '45'), ('network_dns', '50'), ('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '10'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '1'), ('win_necurs_auto', '45'), ('math_entropy_5', '1'), ('dll_injection_thread', '15'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasRichSignature', '1'), ('Embedded_PE', '35'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('VM_Detect_VirtualPC_XEN_Wine_v1', '60'), ('Anti_Automated_Sandbox', '5'), ('antivm_vmware', '60'), ('vmdetect_2', '60'), ('Inject_Thread', '45'), ('Debugger_Check__QueryInfo', '60'), ('ThreadControl__Context_v1', '60'), ('SEH_Init', '5'), ('vmdetect', '60'), ('TrojanWin32NecursSample', '50'), ('Contains_PE_File', '1'), ('Advapi_Hash_API', '20'), ('CRC32_poly_Constant', '25')]
-------------- LOKI_Score ------------
['965']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['80.0']
-------------- SCORE FINAL ------------
16301.359636685076
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FF0NudHt32mW8Mvmk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9dc209f66da77858e362e624d0be86b3                                                   |
| sha1                   | 60a542f76b1228b1725c51bd6e19d9763ce5cd03                                           |
| sha256                 | db36fbc490ffb8662d13388cf4a1d5daba1527ac0440fc2eff99ddedc51f4a82                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FF0NudHt32mW8Mvmk.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::3DES [C0027.004]                                                |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| encrypt data using DES                               | data-manipulation/encryption/des                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file size                                        | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| get hostname                                         | host-interaction/os/hostname                         |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| allocate thread local storage                        | host-interaction/process                             |
| terminate process                                    | host-interaction/process/terminate                   |
| set registry value (3 matches)                       | host-interaction/registry/create                     |
| delete registry key                                  | host-interaction/registry/delete                     |
| query service status                                 | host-interaction/service                             |
| create service                                       | host-interaction/service/create                      |
| modify service (2 matches)                           | host-interaction/service/modify                      |
| start service                                        | host-interaction/service/start                       |
| link many functions at runtime                       | linking/runtime-linking                              |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
| persist via Windows service                          | persistence/service                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Discovery::File and Directory Discovery [T1083;1]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
3		- Execution::System Services::Service Execution [T1569.002;3]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 28.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FF0NudHt32mW8Mvmk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.57 MB
Data read: 0.54 MB (ratio 1.06:1)
Time: 24.856 sec (0 m 24 s)
Start Date: 2022:01:28 12:51:38
End Date:   2022:01:28 12:52:03

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:51:38Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FF0NudHt32mW8Mvmk.exe SCORE: 84 TYPE: EXE SIZE: 572244 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4002ab4670> 
MD5: 9dc209f66da77858e362e624d0be86b3 
SHA1: 60a542f76b1228b1725c51bd6e19d9763ce5cd03 
SHA256: db36fbc490ffb8662d13388cf4a1d5daba1527ac0440fc2eff99ddedc51f4a82 CREATED: Fri Jan 28 12:51:38 2022 MODIFIED: Fri Jan 28 12:51:38 2022 ACCESSED: Fri Jan 28 12:52:04 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 1 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPacked SUBSCORE: 5 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_12: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_13: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: DES_sbox SUBSCORE: 15 
DESCRIPTION: DES [sbox] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 
REASON_16: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:52:04Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
1		ft_exe
1		math_entropy_close_8
1		IsPE32
1		IsConsole
5		IsPacked
1		HasOverlay
1		HasRichSignature
2		PE_File
5		SEH_Save
5		SEH_Init
10		anti_dbg
1		Contains_PE_File
15		DES_sbox
5		BASE64_table

Score total: 84

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]', '8.5'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_close_8', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('IsPacked', '5'), ('HasOverlay', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1'), ('DES_sbox', '15'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['84']
-------------- CAPA_Score ------------
['28.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1889.9837298586215
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fj34zb31U4X6cNBg9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 1f009de6a013a282d07436241512c056                                                   |
| sha1                   | f0d37e1e76a199135e00c0a36b154b191a0950a9                                           |
| sha256                 | c897c345c3bcf3e96589a0feeea8b6d26cf33c091ac3ee2162dd27f8a79c3ff5                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fj34zb31U4X6cNBg9.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fj34zb31U4X6cNBg9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 24.596 sec (0 m 24 s)
Start Date: 2022:01:28 12:52:04
End Date:   2022:01:28 12:52:29

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:52:05Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:52:30Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
79.81049259875519
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FSeGb92eQv6vj2oM09.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a7a7ef007355f853e8fc56a483c25a10                                                   |
| sha1                   | d7fcd0e6eadabd235fb969b6ee163c83fd07c991                                           |
| sha256                 | 1daad9a09bc5bc51f41a34cb604106eebe1559d35e8464785601e3e6d98c3f17                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FSeGb92eQv6vj2oM09.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (7 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FSeGb92eQv6vj2oM09.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.13 MB
Data read: 0.12 MB (ratio 1.03:1)
Time: 24.758 sec (0 m 24 s)
Start Date: 2022:01:28 12:52:30
End Date:   2022:01:28 12:52:55

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:52:30Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FSeGb92eQv6vj2oM09.exe SCORE: 92 TYPE: EXE SIZE: 131152 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd8ddf94670> 
MD5: a7a7ef007355f853e8fc56a483c25a10 
SHA1: d7fcd0e6eadabd235fb969b6ee163c83fd07c991 
SHA256: 1daad9a09bc5bc51f41a34cb604106eebe1559d35e8464785601e3e6d98c3f17 CREATED: Fri Jan 28 12:52:30 2022 MODIFIED: Fri Jan 28 12:52:30 2022 ACCESSED: Fri Jan 28 12:52:56 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:52:56Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		misc_pe_signature
1		ft_exe
20		research_pe_signed_outside_timestamp
1		math_entropy_6
1		IsPE64
2		IsWindowsGUI
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
1		Contains_PE_File

Score total: 92

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['92']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1537.9122296629794
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FX4xVl1XR3kUKzzrj2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 51cd52d8eaaeba1dbfedf2d2c4e3f796                                                   |
| sha1                   | 39eb573d623463e4e359f94b5bb605a7d89cabfe                                           |
| sha256                 | 5e3cacdc9963ee8189ee6619b205c235ec44c38faa430f176da7ed5cfb8a3343                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FX4xVl1XR3kUKzzrj2.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-VM instructions (28 matches)            | anti-analysis/anti-vm/vm-detection                   |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 12.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FX4xVl1XR3kUKzzrj2.exe: Win.Trojan.MSShellcode-6360728-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FX4xVl1XR3kUKzzrj2.exe: Win.Trojan.MSShellcode-6360730-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FX4xVl1XR3kUKzzrj2.exe: Win.Trojan.Swrort-5710536-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FX4xVl1XR3kUKzzrj2.exe: Win.Trojan.MSShellcode-6360729-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FX4xVl1XR3kUKzzrj2.exe: BC.Win.Trojan.Swrort-17210 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 24.401 sec (0 m 24 s)
Start Date: 2022:01:28 12:52:56
End Date:   2022:01:28 12:53:20

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.MSShellcode-6360728-0
45		Win.Trojan.MSShellcode-6360730-0
45		Win.Trojan.Swrort-5710536-0
45		Win.Trojan.MSShellcode-6360729-0
45		BC.Win.Trojan.Swrort-17210

Score total: 225.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xba in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xba in position 0: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:52:56Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FX4xVl1XR3kUKzzrj2.exe SCORE: 186 TYPE: EXE SIZE: 73802 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4edafb2670> 
MD5: 51cd52d8eaaeba1dbfedf2d2c4e3f796 
SHA1: 39eb573d623463e4e359f94b5bb605a7d89cabfe 
SHA256: 5e3cacdc9963ee8189ee6619b205c235ec44c38faa430f176da7ed5cfb8a3343 CREATED: Fri Jan 28 12:52:56 2022 MODIFIED: Fri Jan 28 12:52:56 2022 ACCESSED: Fri Jan 28 12:53:21 2022 
REASON_1: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: WSOCK32.dll Str3: socket Str4: send Str5: WSASend Str6: connect Str7: WSAStartup
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: CreateFileA
REASON_4: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll Str2: WSOCK32.dll
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: winsocks SUBSCORE: 5 
DESCRIPTION: Imports Winsock Library REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Hunting_Rule_ShikataGaNai SUBSCORE: 65 
DESCRIPTION: not set REF: https://www.fireeye.com/blog/threat-research/2019/10/shikata-ga-nai-encoder-still-going-strong.html AUTHOR: Steven Miller 
MATCHES: Str1: baba96367cdac9d97424f45e29c9b184315613 Str2: ba96367cdac9d97424f45e29c9b184315613
REASON_15: Yara Rule MATCH: metasploit_payload_msfpayload SUBSCORE: 25 
DESCRIPTION: This rule detects generic metasploit callback payloads generated with msfpayload REF: - AUTHOR: - 
MATCHES: Str1: asf Str2: release Str3: build Str4: support Str5: ab.pdb Str6: WS2_32.dll Str7: mswsock Str8: ntdll.dll Str9: KERNEL32.dll Str10: she ... (truncated)
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:53:21Z

-------- Score ----------------
Scores		Rules
.......		...............
50		network_tcp_socket
5		win_mutex
10		win_files_operation
10		Str_Win32_Winsock2_Library
1		ft_exe
1		math_entropy_6
5		winsocks
1		IsPE32
2		IsWindowsGUI
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
65		Hunting_Rule_ShikataGaNai
25		metasploit_payload_msfpayload
1		Contains_PE_File
5		BASE64_table

Score total: 186

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.MSShellcode-6360728-0', '45'), ('Win.Trojan.MSShellcode-6360730-0', '45'), ('Win.Trojan.Swrort-5710536-0', '45'), ('Win.Trojan.MSShellcode-6360729-0', '45'), ('BC.Win.Trojan.Swrort-17210', '45')]
-------------- LOKI_Rules ------------
[('network_tcp_socket', '50'), ('win_mutex', '5'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('winsocks', '5'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Hunting_Rule_ShikataGaNai', '65'), ('metasploit_payload_msfpayload', '25'), ('Contains_PE_File', '1'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['186']
-------------- CAPA_Score ------------
['12.5']
-------------- CLAMAV_Score ------------
['225.0']
-------------- SCORE FINAL ------------
6029.891303885658
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FwN16rcJQ43eXDH2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FwN16rcJQ43eXDH2.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.45 MB
Data read: 0.42 MB (ratio 1.06:1)
Time: 25.344 sec (0 m 25 s)
Start Date: 2022:01:28 12:53:21
End Date:   2022:01:28 12:53:47

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:53:22Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:53:48Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 761d7dcd4b60059b522fad83400d8418                                                   |
| sha1                   | 6954ba79dabf8aa903dd376cfc5f7d409dbe47d1                                           |
| sha256                 | b0b994aeb9187bbf9d819bdef803bb3de63b73720de890d151ffa8ec346ee2bd                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FwN16rcJQ43eXDH2.exe                          |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location                            | collection                                           |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| hash data using fnv                                  | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (8 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
2		- Execution::Shared Modules [T1129;2]
3		- Discovery::System Location Discovery [T1614;3]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 11.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['11.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
219.47885464657676
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F2jIaF2zJNkdq0oxCj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F2jIaF2zJNkdq0oxCj.exe: Win.Exploit.CVE_2019_1219-7151042-2 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.45 MB
Data read: 0.43 MB (ratio 1.06:1)
Time: 26.540 sec (0 m 26 s)
Start Date: 2022:01:28 12:54:30
End Date:   2022:01:28 12:54:56

-------- Score ----------------
Scores		Rules
.......		...............
25		Win.Exploit.CVE_2019_1219-7151042-2

Score total: 25.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x92 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x92 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:54:30Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F2jIaF2zJNkdq0oxCj.exe SCORE: 2374 TYPE: EXE SIZE: 448512 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fea4500b670> 
MD5: db648cd247281954344f1d810c6fd590 
SHA1: a457931874ba395917da2ab060c02159f2c418ec 
SHA256: faf351db4072395ca1e2855a379b120cdbccdb09131c48463e30dccf4245f4bb CREATED: Fri Jan 28 12:54:30 2022 MODIFIED: Fri Jan 28 12:54:30 2022 ACCESSED: Fri Jan 28 12:54:56 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: NtWriteVirtualMemory Str4: WriteProcessMemory Str5: CreateRemoteThread Str6: CreateThread
REASON_2: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_3: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetDC
REASON_4: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetAsyncKeyState Str3: GetKeyState Str4: MapVirtualKey Str5: GetKeyboardType
REASON_5: Yara Rule MATCH: migrate_apc SUBSCORE: 45 
DESCRIPTION: APC queue tasks migration REF: - AUTHOR: x0r 
MATCHES: Str1: OpenThread Str2: QueueUserAPC
REASON_6: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_7: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_8: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken
REASON_9: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: GetPrivateProfileIntA Str4: GetPrivateProfileStringA Str5: WritePrivateProfileStringA
REASON_10: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: DeleteFileA Str7: CreateFileA Str8: FindFir ... (truncated)
REASON_11: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: ConventionEngine_Term_Desktop SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445392f1ddfd7053ab429a300e69eab4e0ea01000000433a5c55736572735c737072696e675c4465736b746f705c616c2d6b68617365722d6d61737465725c446 ... (truncated)
REASON_13: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445392f1ddfd7053ab429a300e69eab4e0ea01000000433a5c55736572735c737072696e675c4465736b746f705c616c2d6b68617365722d6d61737465725c446 ... (truncated)
REASON_14: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645f400c645f500c645f600c645
REASON_16: Yara Rule MATCH: self_inject SUBSCORE: 15 
DESCRIPTION: Self Injecting code - like code packers REF: - AUTHOR: - 
MATCHES: Str1: VirtualAlloc Str2: VirtualProtect Str3: CreateProcessInternal
REASON_17: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA Str2: NtCreateThreadEx
REASON_18: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: possible_includes_base64_packed_functions SUBSCORE: 25 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: atOb Str2: This Str3: prog Str4: rogr Str5: ogra Str6: gram Str7: cann Str8: anno Str9: nnot Str10: mode Str11: 13fz Str12: 3Ric Str1 ... (truncated)
REASON_20: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_21: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_22: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_23: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_24: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_25: Yara Rule MATCH: virtualbox_detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\ACPI\DSDT\VBOX__ Str2: \.\VBoxMiniRdrDN Str3: vboxhook.dll Str4: SOFTWARE\Oracle\VirtualBox Guest Additions Str5: HARDWARE\ ... (truncated)
REASON_26: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\Description\System Str2: SystemBiosVersion Str3: QEMU Str4: qemu Str5: qemu Str6: QEMU Str7: HARDWARE\DEVICEMAP\Scsi\Scsi Po ... (truncated)
REASON_27: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\Description\System Str2: SystemBiosVersion Str3: VideoBiosVersion Str4: VBox Str5: VBox Str6: VBOX Str7: vbox Str8: vbox Str ... (truncated)
REASON_28: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DEVICEMAP\Scsi\Scsi Port 0\Scsi Bus 0\Target Id 0\Logical Unit Id 0 Str2: Identifier Str3: Identifier Str4: VMWare Str5: vmw ... (truncated)
REASON_29: Yara Rule MATCH: VM_Detect_VirtualPC_XEN_Wine_v1 SUBSCORE: 60 
DESCRIPTION: Xen detection, VirtualPC, Red Pill, Wine and other REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: wine_get_unix_file_name
REASON_30: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_31: Yara Rule MATCH: Check_Dlls SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: sbiedll.dll Str2: dbghelp.dll Str3: api_log.dll Str4: dir_watch.dll Str5: pstorec.dll Str6: vmcheck.dll Str7: wpespy.dll
REASON_32: Yara Rule MATCH: Check_VBox_DeviceMap SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DEVICEMAP\Scsi\Scsi Port 0\Scsi Bus 0\Target Id 0\Logical Unit Id 0 Str2: Identifier Str3: Identifier Str4: VBox Str5: VBox  ... (truncated)
REASON_33: Yara Rule MATCH: Check_VBox_VideoDrivers SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\Description\System Str2: VideoBiosVersion Str3: VirtualBox Str4: VIRTUALBOX Str5: virtualbox Str6: VirtualBox
REASON_34: Yara Rule MATCH: Check_VmTools SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: SOFTWARE\VMware, Inc.\VMware Tools
REASON_35: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: VMware Str2: VMWARE
REASON_36: Yara Rule MATCH: WMI_VM_Detect_v1 SUBSCORE: 50 
DESCRIPTION: Detection of Virtual Appliances through the use of WMI for use of evasion. REF: - AUTHOR: Joe Giron 
MATCHES: Str1: SELECT * FROM Win32_VideoController Str2: Parallel
REASON_37: Yara Rule MATCH: AtomTable_Inject SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: GlobalAddAtom Str2: GlobalGetAtomName Str3: QueueUserAPC
REASON_38: Yara Rule MATCH: DLL_inject SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: LoadLibraryA Str4: CreateFileA Str5: WriteProcessMemory Str6: HeapAlloc Str7: GetProcAddress S ... (truncated)
REASON_39: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: NtWriteVirtualMemory Str4: WriteProcessMemory Str5: CreateRemoteThread Str6: CreateThread
REASON_40: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: UnhookWindowsHookEx Str3: SetWindowsHookExA Str4: CallNextHookEx
REASON_41: Yara Rule MATCH: Process_Doppelganging SUBSCORE: 35 
DESCRIPTION: Detect Process Doppelganging REF: https://www.blackhat.com/docs/eu-17/materials/eu-17-Liberman-Lost-In-Transaction-Process-Doppelganging.pdf AUTHOR: McAfee ATR - Thomas Roccia - @fr0gger_ 
MATCHES: Str1: CreateTransaction Str2: CreateFileTransacted Str3: WriteFile Str4: RollbackTransaction Str5: CreateProcess Str6: CreateProcessParamet ... (truncated)
REASON_42: Yara Rule MATCH: Atom_Bombing SUBSCORE: 40 
DESCRIPTION: Detect AtomBombing Injection REF: https://blog.ensilo.com/atombombing-brand-new-code-injection-for-windows AUTHOR: McAfee ATR - Thomas Roccia - @fr0gger_  
MATCHES: Str1: GlobalAddAtom Str2: GlobalGetAtomName Str3: QueueUserAPC Str4: NtQueueApcThread Str5: NtSetContextThread
REASON_43: Yara Rule MATCH: APC_Inject SUBSCORE: 40 
DESCRIPTION: Detect APC Injection REF: - AUTHOR: McAfee ATR - Thomas Roccia - @fr0gger_  
MATCHES: Str1: NtQueueApcThread Str2: NtResumeThread Str3: NtTestAlert Str4: QueueUserAPC
REASON_44: Yara Rule MATCH: Debugger_Check__GlobalFlags SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: NtGlobalFlags
REASON_45: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_46: Yara Rule MATCH: Debugger_Check__RemoteAPI SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: CheckRemoteDebuggerPresent
REASON_47: Yara Rule MATCH: Debugger_Hiding__Thread SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetInformationThread
REASON_48: Yara Rule MATCH: DebuggerHiding__Active_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: DebugActiveProcess
REASON_49: Yara Rule MATCH: DebuggerException__ConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: GenerateConsoleCtrlEvent
REASON_50: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_51: Yara Rule MATCH: ThreadControl__Context_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetThreadContext
REASON_52: Yara Rule MATCH: SEH__vectored_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: AddVectoredExceptionHandler Str2: RemoveVectoredExceptionHandler
REASON_53: Yara Rule MATCH: Check_Debugger_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_54: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000
REASON_55: Yara Rule MATCH: Check_Qemu_Description SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\Description\System Str2: SystemBiosVersion Str3: QEMU Str4: qemu Str5: qemu Str6: QEMU
REASON_56: Yara Rule MATCH: Check_Qemu_DeviceMap SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DEVICEMAP\Scsi\Scsi Port 0\Scsi Bus 0\Target Id 0\Logical Unit Id 0 Str2: Identifier Str3: Identifier Str4: QEMU Str5: qemu  ... (truncated)
REASON_57: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: VMware Str2: VMWARE
REASON_58: Yara Rule MATCH: WMI_VM_Detect SUBSCORE: 50 
DESCRIPTION: Detection of Virtual Appliances through the use of WMI for use of evasion. REF: - AUTHOR: Joe Giron 
MATCHES: Str1: SELECT * FROM Win32_VideoController Str2: Parallel
REASON_59: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: CheckRemoteDebuggerPresent Str4: IsDebuggerPresent Str5: OutputDebugString Str6: ContinueDebugE ... (truncated)
REASON_60: Yara Rule MATCH: vmdetect_misc SUBSCORE: 50 
DESCRIPTION: Following Rule is referenced from AlienVault's Yara rule repository.This rule contains additional processes and driver names. REF: - AUTHOR: @abhinavbom 
MATCHES: Str1: VBoxService Str2: vboxservice Str3: VBoxTray Str4: vboxtray Str5: SOFTWARE\Oracle\VirtualBox Guest Additions Str6: wine_get_unix_file ... (truncated)
REASON_61: Yara Rule MATCH: VMdetectMisc SUBSCORE: 25 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: VBoxService Str2: vboxservice Str3: VBoxTray Str4: vboxtray Str5: SOFTWARE\Oracle\VirtualBox Guest Additions Str6: wine_get_unix_file ... (truncated)
REASON_62: Yara Rule MATCH: SandboxDetectMisc SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: sbiedll Str2: joeboxserver Str3: joeboxcontrol
REASON_63: Yara Rule MATCH: avdetect_procs SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: filemon.exe Str2: procmon.exe Str3: Wireshark.exe
REASON_64: Yara Rule MATCH: dbgdetect_procs SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Wireshark Str2: filemon Str3: procexp Str4: procmon Str5: regmon Str6: ImmunityDebugger Str7: ollydbg Str8: PETools
REASON_65: Yara Rule MATCH: TrojanDownloaderCbeplaySample SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: pstorec.dll Str2: VIRTUALBOX Str3: VideoBiosVersion Str4: QEMU Str5: QEMU Str6: VMWARE Str7: VMWARE Str8: VBOX Str9: VBOX Str10: VIRT ... (truncated)
REASON_66: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_67: Yara Rule MATCH: MD5_API SUBSCORE: 25 
DESCRIPTION: Looks for MD5 API REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: MD5Init Str4: MD5Update Str5: MD5Final
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:55:19Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
70		escalate_priv
65		screenshot
80		keylogger
45		migrate_apc
5		win_mutex
20		win_registry
10		win_token
10		win_private_profile
10		win_files_operation
1		ft_exe
50		ConventionEngine_Term_Desktop
50		ConventionEngine_Term_Users
1		math_entropy_5
5		obfuscation_singlebyte_mov
15		self_inject
15		dll_injection_thread
15		dll_injection_hook
25		possible_includes_base64_packed_functions
1		IsPE32
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
10		virtualbox_detection
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
60		VM_Detect_VirtualPC_XEN_Wine_v1
5		Anti_Automated_Sandbox
30		Check_Dlls
60		Check_VBox_DeviceMap
60		Check_VBox_VideoDrivers
60		Check_VmTools
60		vmdetect_2
50		WMI_VM_Detect_v1
35		AtomTable_Inject
40		DLL_inject
45		Inject_Thread
35		Win_Hook_v12
35		Process_Doppelganging
40		Atom_Bombing
40		APC_Inject
60		Debugger_Check__GlobalFlags
60		Debugger_Check__QueryInfo
60		Debugger_Check__RemoteAPI
60		Debugger_Hiding__Thread
60		DebuggerHiding__Active_v1
60		DebuggerException__ConsoleCtrl_v1
60		DebuggerException__SetConsoleCtrl_v1
60		ThreadControl__Context_v1
60		SEH__vectored_v1
60		Check_Debugger_v1
5		SEH_Init
5		Check_Qemu_Description
5		Check_Qemu_DeviceMap
60		vmdetect
50		WMI_VM_Detect
10		anti_dbg
50		vmdetect_misc
25		VMdetectMisc
70		SandboxDetectMisc
70		avdetect_procs
70		dbgdetect_procs
60		TrojanDownloaderCbeplaySample
1		Contains_PE_File
25		MD5_API

Score total: 2374

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | db648cd247281954344f1d810c6fd590                                                   |
| sha1                   | a457931874ba395917da2ab060c02159f2c418ec                                           |
| sha256                 | faf351db4072395ca1e2855a379b120cdbccdb09131c48463e30dccf4245f4bb                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F2jIaF2zJNkdq0oxCj.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Data from Information Repositories:: \[T1213]\                                     |
|                        | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Asynchronous Procedure Call \[T1055.004]\                       |
|                        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
|                        | Process Injection::Process Hollowing \[T1055.012]\                                 |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
|                        | Virtualization/Sandbox Evasion::User Activity Based Checks \[T1497.002]\           |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection:: [B0001]                                                  |
|                             | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
|                             | Debugger Detection::CheckRemoteDebuggerPresent [B0001.002]                    |
|                             | Debugger Detection::Hardware Breakpoints [B0001.005]                          |
|                             | Debugger Detection::Memory Write Watching [B0001.010]                         |
|                             | Debugger Detection::OutputDebugString [B0001.016]                             |
|                             | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
|                             | Debugger Detection::Process Environment Block NtGlobalFlag [B0001.036]        |
|                             | Debugger Detection::SetHandleInformation [B0001.024]                          |
|                             | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Debugger Detection::WudfIsAnyDebuggerPresent [B0001.031]                      |
|                             | Emulator Detection:: [B0004]                                                  |
|                             | Virtual Machine Detection:: [B0009]                                           |
|                             | Virtual Machine Detection::Human User Check [B0009.012]                       |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| COLLECTION                  | Keylogging::Application Hook [F0002.001]                                      |
| COMMUNICATION               | ICMP Communication::Echo Request [C0014.002]                                  |
| DISCOVERY                   | Analysis Tool Discovery::Process Detection [B0013.001]                        |
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+----------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                               | NAMESPACE                                            |
|----------------------------------------------------------+------------------------------------------------------|
| reference analysis tools strings                         | anti-analysis                                        |
| check for OutputDebugString error                        | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB BeingDebugged flag                         | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB NtGlobalFlag flag                          | anti-analysis/anti-debugging/debugger-detection      |
| check for debugger via API                               | anti-analysis/anti-debugging/debugger-detection      |
| check for hardware breakpoints                           | anti-analysis/anti-debugging/debugger-detection      |
| check for kernel debugger via shared user data structure | anti-analysis/anti-debugging/debugger-detection      |
| check for protected handle exception                     | anti-analysis/anti-debugging/debugger-detection      |
| check for software breakpoints (2 matches)               | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via GetTickCount                    | anti-analysis/anti-debugging/debugger-detection      |
| check for trap flag exception                            | anti-analysis/anti-debugging/debugger-detection      |
| check for unexpected memory writes (5 matches)           | anti-analysis/anti-debugging/debugger-detection      |
| check process job object                                 | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-debugging instructions (2 matches)          | anti-analysis/anti-debugging/debugger-detection      |
| check if process is running under wine (2 matches)       | anti-analysis/anti-emulation/wine                    |
| check for unmoving mouse cursor                          | anti-analysis/anti-vm/vm-detection                   |
| execute anti-VM instructions (7 matches)                 | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings                                | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Parallels            | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Qemu                 | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VMWare               | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VirtualBox           | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VirtualPC            | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Xen                  | anti-analysis/anti-vm/vm-detection                   |
| reference WMI statements (31 matches)                    | collection/database/wmi                              |
| log keystrokes via application hook                      | collection/keylog                                    |
| send ICMP echo request                                   | communication/icmp                                   |
| contains PDB path                                        | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                       | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section            | executable/pe/section/tls                            |
| interact with driver via control codes                   | host-interaction/driver                              |
| query environment variable (4 matches)                   | host-interaction/environment-variable                |
| get Program Files directory (2 matches)                  | host-interaction/file-system                         |
| get common file path (5 matches)                         | host-interaction/file-system                         |
| read raw disk data                                       | host-interaction/file-system                         |
| check if file exists (2 matches)                         | host-interaction/file-system/exists                  |
| get file attributes (2 matches)                          | host-interaction/file-system/meta                    |
| get file size                                            | host-interaction/file-system/meta                    |
| read file on Windows                                     | host-interaction/file-system/read                    |
| set console window title                                 | host-interaction/gui/console                         |
| find graphical window                                    | host-interaction/gui/window/find                     |
| get number of processor cores                            | host-interaction/hardware/cpu                        |
| get number of processors                                 | host-interaction/hardware/cpu                        |
| get memory capacity                                      | host-interaction/hardware/memory                     |
| enumerate disk properties                                | host-interaction/hardware/storage                    |
| get disk information (2 matches)                         | host-interaction/hardware/storage                    |
| get disk size (2 matches)                                | host-interaction/hardware/storage                    |
| print debug messages (6 matches)                         | host-interaction/log/debug/write-event               |
| create mutex                                             | host-interaction/mutex                               |
| get system information on Windows (5 matches)            | host-interaction/os/info                             |
| check OS version                                         | host-interaction/os/version                          |
| get process heap flags (2 matches)                       | host-interaction/process                             |
| get process heap force flags (2 matches)                 | host-interaction/process                             |
| read process memory (3 matches)                          | host-interaction/process                             |
| create process on Windows                                | host-interaction/process/create                      |
| allocate RWX memory (3 matches)                          | host-interaction/process/inject                      |
| inject APC                                               | host-interaction/process/inject                      |
| inject dll                                               | host-interaction/process/inject                      |
| inject thread                                            | host-interaction/process/inject                      |
| use process replacement                                  | host-interaction/process/inject                      |
| enumerate processes                                      | host-interaction/process/list                        |
| get Explorer PID                                         | host-interaction/process/list                        |
| acquire debug privileges                                 | host-interaction/process/modify                      |
| modify access privileges (2 matches)                     | host-interaction/process/modify                      |
| enumerate process modules (5 matches)                    | host-interaction/process/modules/list                |
| terminate process                                        | host-interaction/process/terminate                   |
| terminate process via fastfail (3 matches)               | host-interaction/process/terminate                   |
| query or enumerate registry value                        | host-interaction/registry                            |
| enumerate services                                       | host-interaction/service/list                        |
| enumerate threads (2 matches)                            | host-interaction/thread/list                         |
| get ntdll base address                                   | linking/runtime-linking                              |
| link function at runtime on Windows (8 matches)          | linking/runtime-linking                              |
| enumerate PE sections                                    | load-code/pe                                         |
| parse PE header (3 matches)                              | load-code/pe                                         |
+----------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
4		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;4]
2		- Execution::Shared Modules [T1129;2]
5		- Collection::Data from Information Repositories [T1213;5]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
4		- Defense Evasion::Process Injection::Asynchronous Procedure Call [T1055.004;4]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
3		- Execution::System Services::Service Execution [T1569.002;3]
4		- Defense Evasion::Process Injection::Process Hollowing [T1055.012;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Discovery::Software Discovery [T1518;2]
1		- Discovery::System Information Discovery [T1082;1]
7.5		- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]
1		- Discovery::Query Registry [T1012;1]

Score total: 78.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Collection::Data from Information Repositories [T1213;5]', '5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Defense Evasion::Process Injection::Asynchronous Procedure Call [T1055.004;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Process Injection::Process Hollowing [T1055.012;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]', '4'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Discovery::Software Discovery [T1518;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]', '7.5'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('Win.Exploit.CVE_2019_1219-7151042-2', '25')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('escalate_priv', '70'), ('screenshot', '65'), ('keylogger', '80'), ('migrate_apc', '45'), ('win_mutex', '5'), ('win_registry', '20'), ('win_token', '10'), ('win_private_profile', '10'), ('win_files_operation', '10'), ('ft_exe', '1'), ('ConventionEngine_Term_Desktop', '50'), ('ConventionEngine_Term_Users', '50'), ('math_entropy_5', '1'), ('obfuscation_singlebyte_mov', '5'), ('self_inject', '15'), ('dll_injection_thread', '15'), ('dll_injection_hook', '15'), ('possible_includes_base64_packed_functions', '25'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('virtualbox_detection', '10'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('VM_Detect_VirtualPC_XEN_Wine_v1', '60'), ('Anti_Automated_Sandbox', '5'), ('Check_Dlls', '30'), ('Check_VBox_DeviceMap', '60'), ('Check_VBox_VideoDrivers', '60'), ('Check_VmTools', '60'), ('vmdetect_2', '60'), ('WMI_VM_Detect_v1', '50'), ('AtomTable_Inject', '35'), ('DLL_inject', '40'), ('Inject_Thread', '45'), ('Win_Hook_v12', '35'), ('Process_Doppelganging', '35'), ('Atom_Bombing', '40'), ('APC_Inject', '40'), ('Debugger_Check__GlobalFlags', '60'), ('Debugger_Check__QueryInfo', '60'), ('Debugger_Check__RemoteAPI', '60'), ('Debugger_Hiding__Thread', '60'), ('DebuggerHiding__Active_v1', '60'), ('DebuggerException__ConsoleCtrl_v1', '60'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('ThreadControl__Context_v1', '60'), ('SEH__vectored_v1', '60'), ('Check_Debugger_v1', '60'), ('SEH_Init', '5'), ('Check_Qemu_Description', '5'), ('Check_Qemu_DeviceMap', '5'), ('vmdetect', '60'), ('WMI_VM_Detect', '50'), ('anti_dbg', '10'), ('vmdetect_misc', '50'), ('VMdetectMisc', '25'), ('SandboxDetectMisc', '70'), ('avdetect_procs', '70'), ('dbgdetect_procs', '70'), ('TrojanDownloaderCbeplaySample', '60'), ('Contains_PE_File', '1'), ('MD5_API', '25')]
-------------- LOKI_Score ------------
['2374']
-------------- CAPA_Score ------------
['78.0']
-------------- CLAMAV_Score ------------
['25.0']
-------------- SCORE FINAL ------------
39496.40034765109
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FZ64ss43asMGzOuuv1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FZ64ss43asMGzOuuv1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.43 MB
Data read: 0.41 MB (ratio 1.06:1)
Time: 25.012 sec (0 m 25 s)
Start Date: 2022:01:28 12:55:22
End Date:   2022:01:28 12:55:47

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:55:22Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FZ64ss43asMGzOuuv1.exe SCORE: 84 TYPE: EXE SIZE: 429056 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f437c75c670> 
MD5: b28148e4dc7bd3e63dc0162ebc33685c 
SHA1: fde2ab2cfba3d62c79b74d214c4ac9bb31bcd2b6 
SHA256: 2ece870892bb1c19ae933a5411560d1fe4eb51dd6b6b510f82b05f2b1ba49851 CREATED: Fri Jan 28 12:55:22 2022 MODIFIED: Fri Jan 28 12:55:22 2022 ACCESSED: Fri Jan 28 12:55:47 2022 
REASON_1: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue Str2: dbghelp.dll
REASON_10: Yara Rule MATCH: antisb_threatExpert SUBSCORE: 60 
DESCRIPTION: Anti-Sandbox checks for ThreatExpert REF: - AUTHOR: x0r 
MATCHES: Str1: dbghelp.dll
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:55:48Z

-------- Score ----------------
Scores		Rules
.......		...............
10		Str_Win32_Winsock2_Library
1		ft_exe
1		math_entropy_6
1		IsPE64
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
60		antisb_threatExpert
1		Contains_PE_File

Score total: 84

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b28148e4dc7bd3e63dc0162ebc33685c                                                   |
| sha1                   | fde2ab2cfba3d62c79b74d214c4ac9bb31bcd2b6                                           |
| sha256                 | 2ece870892bb1c19ae933a5411560d1fe4eb51dd6b6b510f82b05f2b1ba49851                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FZ64ss43asMGzOuuv1.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| DATA                        | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (3 matches)                | collection                                           |
| check HTTP status code                               | communication/http/client                            |
| initialize Winsock library                           | communication/socket                                 |
| hash data using murmur3 (3 matches)                  | data-manipulation/hashing/murmur                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| check OS version (2 matches)                         | host-interaction/os/version                          |
| terminate process via fastfail (74 matches)          | host-interaction/process/terminate                   |
| inspect section memory permissions                   | load-code/pe                                         |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (13 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Location Discovery [T1614;3]
1		- Discovery::File and Directory Discovery [T1083;1]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 20.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('antisb_threatExpert', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['84']
-------------- CAPA_Score ------------
['20.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1740.3390562359555
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FF90Qh2Yh5aoyispOb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f716498e51219f64bfb4afabab44a796                                                   |
| sha1                   | 5a9f9a54524497784c31064bdb14e25a9d7f185e                                           |
| sha256                 | 62054b4aebc9da850fe32c6a056ceaa2039c5bd3f51e3f1471116792e8778ed9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FF90Qh2Yh5aoyispOb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 8.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FF90Qh2Yh5aoyispOb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.08 MB
Data read: 0.08 MB (ratio 1.00:1)
Time: 24.550 sec (0 m 24 s)
Start Date: 2022:01:28 12:56:06
End Date:   2022:01:28 12:56:31

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:56:06Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] 
FILE: /tmp/.Loki_Scan/HTTP-FF90Qh2Yh5aoyispOb.exe SCORE: 41 TYPE: EXE SIZE: 85840 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe02fb0b670> 
MD5: f716498e51219f64bfb4afabab44a796 
SHA1: 5a9f9a54524497784c31064bdb14e25a9d7f185e 
SHA256: 62054b4aebc9da850fe32c6a056ceaa2039c5bd3f51e3f1471116792e8778ed9 CREATED: Fri Jan 28 12:56:06 2022 MODIFIED: Fri Jan 28 12:56:06 2022 ACCESSED: Fri Jan 28 12:56:32 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 0 warnings, 2 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:56:32Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		misc_pe_signature
1		ft_exe
20		research_pe_signed_outside_timestamp
1		math_entropy_6
1		IsPE64
1		IsConsole
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
1		Contains_PE_File

Score total: 41

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsConsole', '1'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['41']
-------------- CAPA_Score ------------
['8.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
809.4271941065667
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Ft4xj24wJW8x7SN3hb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Ft4xj24wJW8x7SN3hb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.68 MB
Data read: 0.64 MB (ratio 1.06:1)
Time: 25.575 sec (0 m 25 s)
Start Date: 2022:01:28 12:56:32
End Date:   2022:01:28 12:56:58

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:56:32Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:56:59Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 91a4b42dbe45d072db748b2a121f4982                                                   |
| sha1                   | 0c04f8d26b21b592cade665c29bc271a6ea9a136                                           |
| sha256                 | 1a22fead39232589cae5bd5d4dee39b557af707f2d9d441d54c630b004139027                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Ft4xj24wJW8x7SN3hb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Delete Directory:: [C0048]                                                    |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| encode data using Base64 via WinAPI                  | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (12 matches)                   | data-manipulation/encoding/xor                       |
| encrypt data using DPAPI (2 matches)                 | data-manipulation/encryption/dpapi                   |
| hash data via BCrypt (3 matches)                     | data-manipulation/hashing                            |
| hash data using fnv (10 matches)                     | data-manipulation/hashing/fnv                        |
| generate random numbers via WinAPI (3 matches)       | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| delete directory                                     | host-interaction/file-system/delete                  |
| get system information on Windows                    | host-interaction/os/info                             |
| terminate process via fastfail (3 matches)           | host-interaction/process/terminate                   |
| enumerate PE sections                                | load-code/pe                                         |
| parse PE header (71 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 17.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['17.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
339.19459354470956
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FUZ5NV2Ks8evLL7Fg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FUZ5NV2Ks8evLL7Fg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.98 MB
Data read: 0.93 MB (ratio 1.05:1)
Time: 27.289 sec (0 m 27 s)
Start Date: 2022:01:28 12:57:40
End Date:   2022:01:28 12:58:07

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:57:40Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FUZ5NV2Ks8evLL7Fg.exe SCORE: 204 TYPE: EXE SIZE: 970752 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f5a6ed15670> 
MD5: 464ef2ca59782ce697bc329713698ccc 
SHA1: 91e3e135a587bcf6b782dce6c548ed08cd71a677 
SHA256: 178c7da3356a689d104bcddde9d3fb74a715b18fe27c55f43b207e9829825313 CREATED: Fri Jan 28 12:57:40 2022 MODIFIED: Fri Jan 28 12:57:40 2022 ACCESSED: Fri Jan 28 12:58:06 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: CreateFileA Str5: FindClose
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_14: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_15: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:58:13Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
10		win_token
10		win_files_operation
1		ft_exe
1		math_entropy_6
1		IsPE32
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
60		DebuggerException__SetConsoleCtrl_v1
5		SEH_Save
5		SEH_Init
10		anti_dbg
1		Contains_PE_File

Score total: 204

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 464ef2ca59782ce697bc329713698ccc                                                   |
| sha1                   | 91e3e135a587bcf6b782dce6c548ed08cd71a677                                           |
| sha256                 | 178c7da3356a689d104bcddde9d3fb74a715b18fe27c55f43b207e9829825313                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FUZ5NV2Ks8evLL7Fg.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (2 matches)                | collection                                           |
| encrypt data using RC4 PRGA (2 matches)              | data-manipulation/encryption/rc4                     |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| set environment variable (3 matches)                 | host-interaction/environment-variable                |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| print debug messages (3 matches)                     | host-interaction/log/debug/write-event               |
| allocate thread local storage (2 matches)            | host-interaction/process                             |
| get thread local storage value (2 matches)           | host-interaction/process                             |
| set thread local storage value (2 matches)           | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| modify access privileges                             | host-interaction/process/modify                      |
| terminate process (2 matches)                        | host-interaction/process/terminate                   |
| terminate process via fastfail (7 matches)           | host-interaction/process/terminate                   |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Location Discovery [T1614;3]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 22.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '10'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['204']
-------------- CAPA_Score ------------
['22.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3672.1398219138246
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F7YihM8Olkmux1vff.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2393d4f762fb671d92a59388109c24d4                                                   |
| sha1                   | 2e27346b7cff97619923c3e3199e68e7b91d142b                                           |
| sha256                 | 8d9373ebd69f42153b0b47dbda2174811599db91630651ca01627ac1795f8d56                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F7YihM8Olkmux1vff.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F7YihM8Olkmux1vff.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.458 sec (0 m 24 s)
Start Date: 2022:01:28 12:59:00
End Date:   2022:01:28 12:59:25

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:59:00Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:59:26Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['10.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
199.526231496888
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FFpncDcnvHiXe36M8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FFpncDcnvHiXe36M8.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.01 MB (ratio 3.67:1)
Time: 24.864 sec (0 m 24 s)
Start Date: 2022:01:28 12:59:26
End Date:   2022:01:28 12:59:51

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:59:26Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FFpncDcnvHiXe36M8.exe SCORE: 138 TYPE: EXE SIZE: 13824 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fdd4380a670> 
MD5: 9035bed8ee6dc82b04ab1119a221974d 
SHA1: 5c1f90abd22aa3ed55638228862b7a24d4a38cdb 
SHA256: 2ac6635a26049d354c0c46243f6451e6594b130745a08c5a99e96a64fbbbec0f CREATED: Fri Jan 28 12:59:26 2022 MODIFIED: Fri Jan 28 12:59:26 2022 ACCESSED: Fri Jan 28 12:59:51 2022 
REASON_1: Yara Rule MATCH: network_dropper SUBSCORE: 65 
DESCRIPTION: File downloader/dropper REF: - AUTHOR: x0r 
MATCHES: Str1: urlmon.dll Str2: URLDownloadToCacheFile
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 1 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPacked SUBSCORE: 5 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: UPX2
REASON_10: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T11:59:51Z

-------- Score ----------------
Scores		Rules
.......		...............
65		network_dropper
1		ft_exe
1		math_entropy_close_8
1		IsPE32
1		IsConsole
5		IsPacked
1		HasRichSignature
2		PE_File
60		suspicious_packer_section
1		Contains_PE_File

Score total: 138

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_dropper', '65'), ('ft_exe', '1'), ('math_entropy_close_8', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('IsPacked', '5'), ('HasRichSignature', '1'), ('PE_File', '2'), ('suspicious_packer_section', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['138']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2187.1526055963363
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FqCglj46YGgPnQB0v6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FqCglj46YGgPnQB0v6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 1.24 MB
Data read: 1.18 MB (ratio 1.06:1)
Time: 25.071 sec (0 m 25 s)
Start Date: 2022:01:28 12:59:51
End Date:   2022:01:28 13:00:16

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T11:59:51Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:00:18Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 8c0407e6173a8292b45d14d6ee1d9ecc                                                   |
| sha1                   | 8c4d5ef94403a5e95aca03b062f86d17fe554b93                                           |
| sha256                 | ad7e97ad48a818bd078e4f691515e05a24d8a8d865d8b3f93e1febe32efad8c1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FqCglj46YGgPnQB0v6.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key::RC4 KSA [C0028.002]                                           |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints (4 matches)           | anti-analysis/anti-debugging/debugger-detection      |
| encode data using XOR (152 matches)                  | data-manipulation/encoding/xor                       |
| encrypt data using RC4 KSA (5 matches)               | data-manipulation/encryption/rc4                     |
| encrypt data using RC4 PRGA (5 matches)              | data-manipulation/encryption/rc4                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| enumerate PE sections (7 matches)                    | load-code/pe                                         |
| parse PE exports (6 matches)                         | load-code/pe                                         |
| parse PE header (22 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 14.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['14.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
289.3130356704876
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FedVuu4HjBqik2wBZj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 81d41e225b8b55748ffb0d8747fe8bac                                                   |
| sha1                   | b8359399f1751ff1affc4a3a9f90f890cb17c9ed                                           |
| sha256                 | ac6e1f614cb902c0abe4297646e21c70590624b652a080bfbb8407b1ab52609d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FedVuu4HjBqik2wBZj.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| terminate process (3 matches)                        | host-interaction/process/terminate                   |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 8.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FedVuu4HjBqik2wBZj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 24.421 sec (0 m 24 s)
Start Date: 2022:01:28 13:01:29
End Date:   2022:01:28 13:01:53

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:01:29Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:01:54Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['8.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
159.62098519751038
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FyKvyu4DMOwtn1kRE9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FyKvyu4DMOwtn1kRE9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.76 MB
Data read: 0.72 MB (ratio 1.06:1)
Time: 25.419 sec (0 m 25 s)
Start Date: 2022:01:28 13:01:54
End Date:   2022:01:28 13:02:19

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:01:54Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FyKvyu4DMOwtn1kRE9.exe SCORE: 385 TYPE: EXE SIZE: 754688 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7f4af39670> 
MD5: c7f3ef97d20486e2b80583909df8ee12 
SHA1: 322414f78b35fa2d285334de26a8236a6addba01 
SHA256: 64066d51263176642765cf54943c92a2a73fdc52e23418c4819750a7934db708 CREATED: Fri Jan 28 13:01:54 2022 MODIFIED: Fri Jan 28 13:01:54 2022 ACCESSED: Fri Jan 28 13:02:20 2022 
REASON_1: Yara Rule MATCH: create_com_service SUBSCORE: 35 
DESCRIPTION: Create a COM server REF: - AUTHOR: x0r 
MATCHES: Str1: DllCanUnloadNow Str2: DllGetClassObject Str3: DllInstall Str4: DllRegisterServer Str5: DllUnregisterServer
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VM_Detect_VirtualPC_XEN_Wine_v1 SUBSCORE: 60 
DESCRIPTION: Xen detection, VirtualPC, Red Pill, Wine and other REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: 45c70001
REASON_16: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: 45c70001
REASON_17: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: 45c70001
REASON_19: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: f777dd4ec435cf534e5ac769899e2edc Str2: 160a746f73309ce8669c4d223c272932 Str3: 7909abc2ae44f82297bc7fd4cf7bf159 Str4: bef5238a41524bf5 ... (truncated)
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:02:21Z

-------- Score ----------------
Scores		Rules
.......		...............
35		create_com_service
5		win_mutex
20		win_registry
1		ft_exe
1		math_entropy_6
1		IsPE64
1		IsDLL
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
60		VM_Detect_VirtualPC_XEN_Wine_v1
60		vmdetect_2
30		Check_OutputDebugStringA_iat_v1
60		vmdetect
30		Check_OutputDebugStringA_iat
10		anti_dbg
1		Contains_PE_File
10		Big_Numbers1

Score total: 385

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c7f3ef97d20486e2b80583909df8ee12                                                   |
| sha1                   | 322414f78b35fa2d285334de26a8236a6addba01                                           |
| sha256                 | 64066d51263176642765cf54943c92a2a73fdc52e23418c4819750a7934db708                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FyKvyu4DMOwtn1kRE9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location                            | collection                                           |
| encode data using XOR (7 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA (2 matches)              | data-manipulation/encryption/rc4                     |
| hash data using fnv (7 matches)                      | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| interact with driver via control codes               | host-interaction/driver                              |
| query environment variable                           | host-interaction/environment-variable                |
| check if file exists (3 matches)                     | host-interaction/file-system/exists                  |
| get file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| print debug messages (3 matches)                     | host-interaction/log/debug/write-event               |
| create mutex                                         | host-interaction/mutex                               |
| get system information on Windows                    | host-interaction/os/info                             |
| allocate thread local storage                        | host-interaction/process                             |
| get thread local storage value (2 matches)           | host-interaction/process                             |
| set thread local storage value (2 matches)           | host-interaction/process                             |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry key (2 matches)          | host-interaction/registry                            |
| query or enumerate registry value (7 matches)        | host-interaction/registry                            |
| set registry value (7 matches)                       | host-interaction/registry/create                     |
| delete registry key                                  | host-interaction/registry/delete                     |
| delete registry value (3 matches)                    | host-interaction/registry/delete                     |
| link function at runtime on Windows (7 matches)      | linking/runtime-linking                              |
| parse PE header (12 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Location Discovery [T1614;3]
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
3		- Execution::System Services::Service Execution [T1569.002;3]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 19.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('create_com_service', '35'), ('win_mutex', '5'), ('win_registry', '20'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('VM_Detect_VirtualPC_XEN_Wine_v1', '60'), ('vmdetect_2', '60'), ('Check_OutputDebugStringA_iat_v1', '30'), ('vmdetect', '60'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('Contains_PE_File', '1'), ('Big_Numbers1', '10')]
-------------- LOKI_Score ------------
['385']
-------------- CAPA_Score ------------
['19.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6490.914942394218
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FbJSMK3IBxVE3b8kSg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2ea4a7b914044f15c56acf932a1569ba                                                   |
| sha1                   | 1b40046766db3713f434d61abff529f8293f8454                                           |
| sha256                 | 989f652848f7267aaf5b22f6d1ec1453377412f1fe21a78d05bf6617f6bb8872                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FbJSMK3IBxVE3b8kSg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FbJSMK3IBxVE3b8kSg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 24.649 sec (0 m 24 s)
Start Date: 2022:01:28 13:03:09
End Date:   2022:01:28 13:03:33

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:03:09Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] 
FILE: /tmp/.Loki_Scan/HTTP-FbJSMK3IBxVE3b8kSg.exe SCORE: 52 TYPE: EXE SIZE: 98120 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fdf9b1eb670> 
MD5: 2ea4a7b914044f15c56acf932a1569ba 
SHA1: 1b40046766db3713f434d61abff529f8293f8454 
SHA256: 989f652848f7267aaf5b22f6d1ec1453377412f1fe21a78d05bf6617f6bb8872 CREATED: Fri Jan 28 13:03:09 2022 MODIFIED: Fri Jan 28 13:03:09 2022 ACCESSED: Fri Jan 28 13:03:34 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 8db0ce862824541f40dfb767113f1e28
[NOTICE] Results: 0 alerts, 0 warnings, 2 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:03:34Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		misc_pe_signature
1		ft_exe
20		research_pe_signed_outside_timestamp
1		math_entropy_6
1		IsPE64
2		IsWindowsGUI
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
1		Contains_PE_File
10		Big_Numbers1

Score total: 52

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Contains_PE_File', '1'), ('Big_Numbers1', '10')]
-------------- LOKI_Score ------------
['52']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
903.9549526785341
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FC05rQ3z6wwHQXk5Z6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 53cba9af8d65fadbd0f7e5f9ff15cad3                                                   |
| sha1                   | c0c1b0c563bb9eeca89e2fd6b712aba6a119ae57                                           |
| sha256                 | 6767fd66f28a1d39cb84f59e8a86b3ea99e22d204d2aac821e0d01ac232fba56                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FC05rQ3z6wwHQXk5Z6.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
| COMMUNICATION               | HTTP Communication::Download URL [C0002.006]                                  |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| receive data                                         | communication                                        |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| create process on Windows                            | host-interaction/process/create                      |
| get session user name                                | host-interaction/session                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Owner/User Discovery [T1033;3]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
3		- Discovery::Account Discovery [T1087;3]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]

Score total: 21.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FC05rQ3z6wwHQXk5Z6.exe: Win.Trojan.Downloader-47085 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 24.195 sec (0 m 24 s)
Start Date: 2022:01:28 13:03:34
End Date:   2022:01:28 13:03:59

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Downloader-47085

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:03:35Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FC05rQ3z6wwHQXk5Z6.exe SCORE: 98 TYPE: EXE SIZE: 28672 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3677c5e670> 
MD5: 53cba9af8d65fadbd0f7e5f9ff15cad3 
SHA1: c0c1b0c563bb9eeca89e2fd6b712aba6a119ae57 
SHA256: 6767fd66f28a1d39cb84f59e8a86b3ea99e22d204d2aac821e0d01ac232fba56 CREATED: Fri Jan 28 13:03:34 2022 MODIFIED: Fri Jan 28 13:03:34 2022 ACCESSED: Fri Jan 28 13:03:59 2022 
REASON_1: Yara Rule MATCH: network_dropper SUBSCORE: 65 
DESCRIPTION: File downloader/dropper REF: - AUTHOR: x0r 
MATCHES: Str1: urlmon.dll Str2: URLDownloadToCacheFile
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_10: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:03:59Z

-------- Score ----------------
Scores		Rules
.......		...............
65		network_dropper
10		win_files_operation
1		ft_exe
1		math_entropy_5
1		IsPE32
1		IsConsole
1		HasRichSignature
2		PE_File
5		SEH_Save
5		SEH_Init
1		Contains_PE_File
5		BASE64_table

Score total: 98

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Downloader-47085', '45')]
-------------- LOKI_Rules ------------
[('network_dropper', '65'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Contains_PE_File', '1'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['98']
-------------- CAPA_Score ------------
['21.5']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
2548.693161637576
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Flof4T3CbOomJzmNB3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Flof4T3CbOomJzmNB3.exe: Win.Trojan.Hupigon-10307 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.27 MB
Data read: 0.25 MB (ratio 1.06:1)
Time: 23.870 sec (0 m 23 s)
Start Date: 2022:01:28 13:04:00
End Date:   2022:01:28 13:04:23

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Hupigon-10307

Score total: 45.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:04:00Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Flof4T3CbOomJzmNB3.exe SCORE: 384 TYPE: EXE SIZE: 267755 
FIRST_BYTES: 4d5a50000200000004000f00ffff0000b8000000 / <filter object at 0x7fef79711670> 
MD5: 02179f3ba93663074740b5c0d283bae2 
SHA1: 083fcd1ea4976fd9739dbc738a2f41faee0e0256 
SHA256: 39fb2b683dacbaceb78995cd4cedff87ae1514e8aa3678de5deec7ccec187680 CREATED: Fri Jan 28 13:04:00 2022 MODIFIED: Fri Jan 28 13:04:00 2022 ACCESSED: Fri Jan 28 13:04:24 2022 
REASON_1: Yara Rule MATCH: network_dropper SUBSCORE: 65 
DESCRIPTION: File downloader/dropper REF: - AUTHOR: x0r 
MATCHES: Str1: URLMON.DLL Str2: URLDownloadToFile
REASON_2: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WSOCK32.DLL Str2: connect Str3: WSACleanup
REASON_3: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.DLL Str2: GetKeyboardType
REASON_4: Yara Rule MATCH: rat_webcam SUBSCORE: 70 
DESCRIPTION: Remote Administration toolkit using webcam REF: - AUTHOR: x0r 
MATCHES: Str1: AVICAP32.DLL Str2: capCreateCaptureWindow
REASON_5: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.DLL Str2: RegQueryValueExA
REASON_6: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WSOCK32.DLL
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: misc_no_dosmode_header SUBSCORE: 10 
DESCRIPTION: Detect on absence of 'DOS Mode' heaader between MZ and PE boundries REF: - AUTHOR: Jason Batchelor
REASON_9: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 1 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsPacked SUBSCORE: 5 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: .nsp1 Str2: .nsp2 Str3: .nsp0 Str4: nsp0 Str5: nsp1 Str6: nsp2
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:04:25Z

-------- Score ----------------
Scores		Rules
.......		...............
65		network_dropper
50		network_tcp_socket
80		keylogger
70		rat_webcam
20		win_registry
10		Str_Win32_Winsock2_Library
1		ft_exe
10		misc_no_dosmode_header
1		math_entropy_close_8
1		IsPE32
2		IsWindowsGUI
5		IsPacked
1		HasOverlay
2		PE_File
5		Anti_Automated_Sandbox
60		suspicious_packer_section
1		Contains_PE_File

Score total: 384

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Hupigon-10307', '45')]
-------------- LOKI_Rules ------------
[('network_dropper', '65'), ('network_tcp_socket', '50'), ('keylogger', '80'), ('rat_webcam', '70'), ('win_registry', '20'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('misc_no_dosmode_header', '10'), ('math_entropy_close_8', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('IsPacked', '5'), ('HasOverlay', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('suspicious_packer_section', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['384']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
6652.50629435805
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FzHhxG35vdOwyTVkok.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FzHhxG35vdOwyTVkok.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.74 MB
Data read: 0.70 MB (ratio 1.06:1)
Time: 26.004 sec (0 m 26 s)
Start Date: 2022:01:28 13:04:25
End Date:   2022:01:28 13:04:51

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x92 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:04:25Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FzHhxG35vdOwyTVkok.exe SCORE: 125 TYPE: EXE SIZE: 739840 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f50cdd0a670> 
MD5: c3db7abc637f7c820f605b91fa6e1717 
SHA1: 5a494165a180868545c68e3c78b5c85ba39adecf 
SHA256: d10944c16053504739af3f1f2620fa652b2191622e826199aa69f19467aa494d CREATED: Fri Jan 28 13:04:25 2022 MODIFIED: Fri Jan 28 13:04:25 2022 ACCESSED: Fri Jan 28 13:04:51 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: ConventionEngine_Anomaly_Short_TripleChar SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453924b942710d8af5fe50dd84f5cbd77dd010000007664732e70646200
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER Str4: Identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER Str4: Identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER Str4: Identifier
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:04:52Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		ft_exe
50		ConventionEngine_Anomaly_Short_TripleChar
1		math_entropy_6
1		IsPE64
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
1		Contains_PE_File

Score total: 125

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c3db7abc637f7c820f605b91fa6e1717                                                   |
| sha1                   | 5a494165a180868545c68e3c78b5c85ba39adecf                                           |
| sha256                 | d10944c16053504739af3f1f2620fa652b2191622e826199aa69f19467aa494d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FzHhxG35vdOwyTVkok.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Execution Guardrails::Runs as Service [E1480.m07]                             |
| FILE SYSTEM                 | Delete Directory:: [C0048]                                                    |
| OPERATING SYSTEM            | Registry::Delete Registry Key [C0036.002]                                     |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints (4 matches)           | anti-analysis/anti-debugging/debugger-detection      |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| delete directory                                     | host-interaction/file-system/delete                  |
| get storage device properties                        | host-interaction/hardware/storage                    |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| delete registry key (2 matches)                      | host-interaction/registry/delete                     |
| run as service                                       | host-interaction/service                             |
| parse PE header (9 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
3		- Execution::System Services::Service Execution [T1569.002;3]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 28.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('ft_exe', '1'), ('ConventionEngine_Anomaly_Short_TripleChar', '50'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['125']
-------------- CAPA_Score ------------
['28.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2539.789938767678
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fu0lZz1q4Qv1ZHysv6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3e552dc653d5a927e4dd977e726340dd                                                   |
| sha1                   | 45fa65130321f800fd88fa9119245e5a5ef81183                                           |
| sha256                 | 5f24efa8e9df2a97a19f402f2461b2ad9bd12c1d92c4fbc6f4ccd163f689dea7                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fu0lZz1q4Qv1ZHysv6.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fu0lZz1q4Qv1ZHysv6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 24.297 sec (0 m 24 s)
Start Date: 2022:01:28 13:05:23
End Date:   2022:01:28 13:05:48

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:05:23Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-Fu0lZz1q4Qv1ZHysv6.exe SCORE: 70 TYPE: EXE SIZE: 52736 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7776165670> 
MD5: 3e552dc653d5a927e4dd977e726340dd 
SHA1: 45fa65130321f800fd88fa9119245e5a5ef81183 
SHA256: 5f24efa8e9df2a97a19f402f2461b2ad9bd12c1d92c4fbc6f4ccd163f689dea7 CREATED: Fri Jan 28 13:05:23 2022 MODIFIED: Fri Jan 28 13:05:23 2022 ACCESSED: Fri Jan 28 13:05:48 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_10: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_11: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:05:49Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		ft_exe
1		math_entropy_5
1		IsPE64
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
1		Contains_PE_File

Score total: 70

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['70']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1189.2357273215346
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FwhY5v1aAfWir6P4z5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be a .NET module.
WARNING:capa: 
WARNING:capa: .NET is a cross-platform framework for running managed applications.
WARNING:capa: capa cannot handle non-native files. This means that the results may be misleading or incomplete.
WARNING:capa: You may have to analyze the file manually, using a tool like the .NET decompiler dnSpy.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) dotnet file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FwhY5v1aAfWir6P4z5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 23.928 sec (0 m 23 s)
Start Date: 2022:01:28 13:05:49
End Date:   2022:01:28 13:06:13

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:05:49Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:06:14Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
0.0
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FtYy0O2vITLQJn4SAe.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c277798eb447730580ad21ea647b9d36                                                   |
| sha1                   | a38373fde7a13bfa784003fa8efed0dc784debab                                           |
| sha256                 | 49d5cc85b8f66cdb238ed1d4bb46709b975f1627acfc934385271ed3be6f77d1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FtYy0O2vITLQJn4SAe.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::File Transfer Protocol \[T1071.002]\                   |
|                        | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | FTP Communication::Send File [C0004.001]                                      |
|                             | FTP Communication::WinINet [C0004.002]                                        |
|                             | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| send file using FTP via wininet (2 matches)          | communication/ftp/send                               |
| connect to HTTP server (2 matches)                   | communication/http/client                            |
| initialize Winsock library                           | communication/socket                                 |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| write file on Windows                                | host-interaction/file-system/write                   |
| get hostname                                         | host-interaction/os/hostname                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Discovery::File and Directory Discovery [T1083;1]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
6		- Command and Control::Application Layer Protocol::File Transfer Protocol [T1071.002;6]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 19.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FtYy0O2vITLQJn4SAe.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 24.476 sec (0 m 24 s)
Start Date: 2022:01:28 13:06:14
End Date:   2022:01:28 13:06:38

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:06:14Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] 
FILE: /tmp/.Loki_Scan/HTTP-FtYy0O2vITLQJn4SAe.exe SCORE: 59 TYPE: EXE SIZE: 32768 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f5cdc655670> 
MD5: c277798eb447730580ad21ea647b9d36 
SHA1: a38373fde7a13bfa784003fa8efed0dc784debab 
SHA256: 49d5cc85b8f66cdb238ed1d4bb46709b975f1627acfc934385271ed3be6f77d1 CREATED: Fri Jan 28 13:06:14 2022 MODIFIED: Fri Jan 28 13:06:14 2022 ACCESSED: Fri Jan 28 13:06:39 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: FindFirstFileA Str5: FindClose
REASON_2: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_3: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_4: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetConnect Str3: InternetOpen
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_4 SUBSCORE: 1 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_12: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 0 warnings, 2 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:06:39Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
1		ft_exe
1		math_entropy_4
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
2		PE_File
5		SEH_Save
5		SEH_Init
1		Contains_PE_File

Score total: 59

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Command and Control::Application Layer Protocol::File Transfer Protocol [T1071.002;6]', '6'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('ft_exe', '1'), ('math_entropy_4', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('PE_File', '2'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['59']
-------------- CAPA_Score ------------
['19.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1324.1631349709883
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FabBiE3Y3EnruLs6Zc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 58e8cbd053e64539fcd87bd08ab89d1b                                                   |
| sha1                   | 70fa7d97a39cc1610a2d66d8aa227e33f5dc1a36                                           |
| sha256                 | 6e71d0bb7fa0f02071460c55433209794f95f81058186142155de0330915b3c7                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FabBiE3Y3EnruLs6Zc.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FabBiE3Y3EnruLs6Zc.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.00 MB
Data read: 0.00 MB (ratio 1.00:1)
Time: 24.116 sec (0 m 24 s)
Start Date: 2022:01:28 13:06:39
End Date:   2022:01:28 13:07:03

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:06:39Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:07:04Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
39.905246299377595
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F1bbHp4p0x6VoSN2J8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 14d4bdcc5f0fe917abde4b01e39a350e                                                   |
| sha1                   | a2a7352960517502487fb46253a057f51872625e                                           |
| sha256                 | 435be1c6e904836ad65f97f3eac4cbe19ee7ba0da48178fc7f00206270469165                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F1bbHp4p0x6VoSN2J8.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Indicator Removal on Host::File Deletion \[T1070.004]\                             |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter::Windows Command Shell \[T1059.003]\             |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
|                             | Interprocess Communication::Create Pipe [C0003.001]                           |
|                             | Interprocess Communication::Read Pipe [C0003.003]                             |
| DATA                        | Encode Data::Base64 [C0026.001]                                               |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Self Deletion::COMSPEC Environment Variable [F0007.001]                       |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| self delete                                          | anti-analysis/anti-forensic/self-deletion            |
| execute shell command and capture output             | c2/shell                                             |
| receive data                                         | communication                                        |
| create two anonymous pipes                           | communication/named-pipe/create                      |
| read pipe                                            | communication/named-pipe/read                        |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| create process on Windows (2 matches)                | host-interaction/process/create                      |
| terminate process                                    | host-interaction/process/terminate                   |
| terminate thread (5 matches)                         | host-interaction/thread/terminate                    |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
5		- Execution::Command and Scripting Interpreter::Windows Command Shell [T1059.003;5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
8.5		- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 34.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F1bbHp4p0x6VoSN2J8.exe: Win.Trojan.Agent-648031 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.00 MB
Data read: 0.00 MB (ratio 1.00:1)
Time: 24.081 sec (0 m 24 s)
Start Date: 2022:01:28 13:07:04
End Date:   2022:01:28 13:07:28

-------- Score ----------------
Scores		Rules
.......		...............
70		Win.Trojan.Agent-648031
75		Win.Trojan.Agent-648031
45		Win.Trojan.Agent-648031

Score total: 190.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:07:04Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] 
FILE: /tmp/.Loki_Scan/HTTP-F1bbHp4p0x6VoSN2J8.exe SCORE: 44 TYPE: EXE SIZE: 6656 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f32a392a670> 
MD5: 14d4bdcc5f0fe917abde4b01e39a350e 
SHA1: a2a7352960517502487fb46253a057f51872625e 
SHA256: 435be1c6e904836ad65f97f3eac4cbe19ee7ba0da48178fc7f00206270469165 CREATED: Fri Jan 28 13:07:04 2022 MODIFIED: Fri Jan 28 13:07:04 2022 ACCESSED: Fri Jan 28 13:07:29 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile
REASON_2: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_3: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetOpen
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 0 warnings, 2 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:07:29Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
1		ft_exe
1		math_entropy_5
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
2		PE_File
5		SEH_Init
1		Contains_PE_File

Score total: 44

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Execution::Command and Scripting Interpreter::Windows Command Shell [T1059.003;5]', '5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]', '8.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Agent-648031', '70'), ('Win.Trojan.Agent-648031', '75'), ('Win.Trojan.Agent-648031', '45')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('PE_File', '2'), ('SEH_Init', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['44']
-------------- CAPA_Score ------------
['34.0']
-------------- CLAMAV_Score ------------
['190.0']
-------------- SCORE FINAL ------------
3767.7004741812266
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FVcXZEv8Jq4UrLm2f.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9b0bf8d01b0fe7132f7bc6eb031eb46d                                                   |
| sha1                   | 200e768832b3d1bf345d930d1328f0528399c0c4                                           |
| sha256                 | 3ef4edafe8d587a91ef023b470e84b2b05c0327d4ca6701a34d5e0ab0ad0bbfc                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FVcXZEv8Jq4UrLm2f.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FVcXZEv8Jq4UrLm2f.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 24.058 sec (0 m 24 s)
Start Date: 2022:01:28 13:07:29
End Date:   2022:01:28 13:07:53

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:07:30Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:07:54Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
39.905246299377595
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F1o98YE5agyhXjXkk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e5d1458bc7802b7647ee4bf7eafa0e20                                                   |
| sha1                   | e942f73990453954f8852a6d4128e929a7c236f0                                           |
| sha256                 | 21406ebfb9f68e56b75045a0b9c78a6b5c5a843f3ca22ee56cacd561f721913a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F1o98YE5agyhXjXkk.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | System Services::Service Execution \[T1569.002]\                                   |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes               | host-interaction/driver                              |
| modify access privileges                             | host-interaction/process/modify                      |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
3		- Execution::System Services::Service Execution [T1569.002;3]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F1o98YE5agyhXjXkk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.374 sec (0 m 24 s)
Start Date: 2022:01:28 13:07:54
End Date:   2022:01:28 13:08:19

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:07:54Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F1o98YE5agyhXjXkk.exe SCORE: 133 TYPE: EXE SIZE: 27448 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f5a634ec670> 
MD5: e5d1458bc7802b7647ee4bf7eafa0e20 
SHA1: e942f73990453954f8852a6d4128e929a7c236f0 
SHA256: 21406ebfb9f68e56b75045a0b9c78a6b5c5a843f3ca22ee56cacd561f721913a CREATED: Fri Jan 28 13:07:54 2022 MODIFIED: Fri Jan 28 13:07:54 2022 ACCESSED: Fri Jan 28 13:08:19 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: DuplicateTokenEx Str3: AdjustTokenPrivileges Str4: OpenProcessToken
REASON_4: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:08:19Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
10		win_token
1		misc_pe_signature
1		ft_exe
20		research_pe_signed_outside_timestamp
1		math_entropy_6
1		IsPE64
1		IsDLL
2		IsWindowsGUI
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
1		Contains_PE_File

Score total: 133

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '10'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['133']
-------------- CAPA_Score ------------
['10.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2307.434177470169
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FekVdJ1CMQkviGQeK1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | fedbac964787ad4898109a744fb6ec02                                                   |
| sha1                   | 1daea40e923ee1fd8c5832274cdd478a45685e46                                           |
| sha256                 | 743f8e8a91b2d1e0db9323109034de91a1e065242a33a90bb787a63edb860b35                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FekVdJ1CMQkviGQeK1.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | ICMP Communication::Echo Request [C0014.002]                                  |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| send ICMP echo request                               | communication/icmp                                   |
| initialize Winsock library                           | communication/socket                                 |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| resolve DNS (2 matches)                              | host-interaction/network/dns/resolve                 |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
3		- Discovery::System Network Configuration Discovery [T1016;3]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 12.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FekVdJ1CMQkviGQeK1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.146 sec (0 m 24 s)
Start Date: 2022:01:28 13:08:20
End Date:   2022:01:28 13:08:44

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:08:20Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:08:45Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['12.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
239.43147779626557
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FIWvx74lVljxpi14Rb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | dc61643cd353aa826f2b8df06422b266                                                   |
| sha1                   | 7ec8f511717a71f692a79a27e348c6654d0d6f40                                           |
| sha256                 | 27858972c18afccd944453b72feeeba66b1587f2075087780aa4fc54202d8221                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FIWvx74lVljxpi14Rb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-VM instructions (9 matches)             | anti-analysis/anti-vm/vm-detection                   |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail                       | host-interaction/process/terminate                   |
| query or enumerate registry value                    | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| enumerate PE sections (9 matches)                    | load-code/pe                                         |
| parse PE header (5 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 14.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FIWvx74lVljxpi14Rb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 24.356 sec (0 m 24 s)
Start Date: 2022:01:28 13:08:45
End Date:   2022:01:28 13:09:09

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:08:45Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FIWvx74lVljxpi14Rb.exe SCORE: 86 TYPE: EXE SIZE: 76600 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fdc6aa38670> 
MD5: dc61643cd353aa826f2b8df06422b266 
SHA1: 7ec8f511717a71f692a79a27e348c6654d0d6f40 
SHA256: 27858972c18afccd944453b72feeeba66b1587f2075087780aa4fc54202d8221 CREATED: Fri Jan 28 13:08:45 2022 MODIFIED: Fri Jan 28 13:08:45 2022 ACCESSED: Fri Jan 28 13:09:10 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:09:10Z

-------- Score ----------------
Scores		Rules
.......		...............
1		misc_pe_signature
1		ft_exe
20		research_pe_signed_outside_timestamp
1		math_entropy_5
1		IsPE64
1		IsDLL
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
1		Contains_PE_File

Score total: 86

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('misc_pe_signature', '1'), ('ft_exe', '1'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['86']
-------------- CAPA_Score ------------
['14.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1642.3448696122007
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FAmZzB4Isn8idTL7f7.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | dafbea2a91f86bf5e52efa3bac3f1b16                                                   |
| sha1                   | 6a41735369934a212fc90dbd8c847c26270b3fba                                           |
| sha256                 | 1fb3c4a9109ef171fa67bdf90e67f09ef25b5a1d401dc20dc45cfccf1e4fbd99                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FAmZzB4Isn8idTL7f7.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get common file path                                 | host-interaction/file-system                         |
| inject dll                                           | host-interaction/process/inject                      |
| inject thread                                        | host-interaction/process/inject                      |
| link function at runtime on Windows                  | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
4		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]
4		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;4]

Score total: 11.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FAmZzB4Isn8idTL7f7.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 24.661 sec (0 m 24 s)
Start Date: 2022:01:28 13:09:10
End Date:   2022:01:28 13:09:35

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:09:11Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FAmZzB4Isn8idTL7f7.exe SCORE: 128 TYPE: EXE SIZE: 36864 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7ff9d70d6670> 
MD5: dafbea2a91f86bf5e52efa3bac3f1b16 
SHA1: 6a41735369934a212fc90dbd8c847c26270b3fba 
SHA256: 1fb3c4a9109ef171fa67bdf90e67f09ef25b5a1d401dc20dc45cfccf1e4fbd99 CREATED: Fri Jan 28 13:09:10 2022 MODIFIED: Fri Jan 28 13:09:10 2022 ACCESSED: Fri Jan 28 13:09:36 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_3 SUBSCORE: 1 
DESCRIPTION: Low entropy - very sparse data or repeating plaintext REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_5: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread
REASON_10: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_11: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:09:36Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
1		ft_exe
1		math_entropy_3
15		dll_injection_thread
1		IsPE32
1		IsConsole
1		HasRichSignature
2		PE_File
45		Inject_Thread
5		SEH_Save
5		SEH_Init
1		Contains_PE_File

Score total: 128

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]', '4'), ('- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;4]', '4')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('ft_exe', '1'), ('math_entropy_3', '1'), ('dll_injection_thread', '15'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Inject_Thread', '45'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['128']
-------------- CAPA_Score ------------
['11.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2248.1421409968016
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FmSQXic6sWo4CSuDi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c9d776b6a4bc22b5b9a0985ab9cd6101                                                   |
| sha1                   | fc72d96df9d0e61a0458280290b27165258d735c                                           |
| sha256                 | 81765113b2df32f13ef09fc96645c183f6064b27fcf4f3a3575088f016bbb5a5                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FmSQXic6sWo4CSuDi.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| write file on Windows                                | host-interaction/file-system/write                   |
| get token membership                                 | host-interaction/session                             |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Owner/User Discovery [T1033;3]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 7.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FmSQXic6sWo4CSuDi.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.175 sec (0 m 24 s)
Start Date: 2022:01:28 13:09:36
End Date:   2022:01:28 13:10:00

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:09:36Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:10:01Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['7.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
139.66836204782157
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F6y7oH2w0yr0Zcdxnl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9a77a7b2a0857916a97ffaac7695314b                                                   |
| sha1                   | 3d0de37b9c6b70a3c92dadcb4d4dcfda96da9527                                           |
| sha256                 | 2a9934712bcd65573605a90cd362c8c237f75d395b053df0c0d02d532b5bc405                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F6y7oH2w0yr0Zcdxnl.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| encode data using XOR (7 matches)                    | data-manipulation/encoding/xor                       |
| hash data using fnv (7 matches)                      | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 8.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F6y7oH2w0yr0Zcdxnl.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 24.438 sec (0 m 24 s)
Start Date: 2022:01:28 13:10:01
End Date:   2022:01:28 13:10:25

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:10:01Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:10:26Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['8.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
159.62098519751038
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FFSunw1ACSsHqmS5m5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FFSunw1ACSsHqmS5m5.exe: Win.Dropper.ClipBanker-9778171-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FFSunw1ACSsHqmS5m5.exe: Win.Tool.Mimikatz-9862700-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FFSunw1ACSsHqmS5m5.exe: Win.Trojan.Mimikatz-6466236-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.82 MB
Data read: 0.77 MB (ratio 1.06:1)
Time: 26.687 sec (0 m 26 s)
Start Date: 2022:01:28 13:10:27
End Date:   2022:01:28 13:10:53

-------- Score ----------------
Scores		Rules
.......		...............
30		Win.Dropper.ClipBanker-9778171-0
10		Win.Tool.Mimikatz-9862700-0
45		Win.Trojan.Mimikatz-6466236-0

Score total: 85.0
sh: 1: gentilkiwi: not found

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:10:27Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FFSunw1ACSsHqmS5m5.exe SCORE: 1276 TYPE: EXE SIZE: 808600 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f483b987670> 
MD5: 5f66b82558ca92e54e77f216ef4c066c 
SHA1: e4f82e4d7f22938dc0a0ff8a4a7ad2a763643d38 
SHA256: 131314a6f6d1d263c75b9909586b3e1bd837036329ace5e69241749e861ac01d CREATED: Fri Jan 28 13:10:27 2022 MODIFIED: Fri Jan 28 13:10:27 2022 ACCESSED: Fri Jan 28 13:10:52 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_2: Yara Rule MATCH: create_service SUBSCORE: 20 
DESCRIPTION: Create a windows service REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: CreateService Str4: ControlService Str5: StartService Str6: QueryServiceStatus
REASON_3: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: DNSAPI.dll Str2: DnsQuery
REASON_4: Yara Rule MATCH: cred_local SUBSCORE: 80 
DESCRIPTION: Steal credential REF: - AUTHOR: x0r 
MATCHES: Str1: SamIConnect Str2: SamQueryInformationUse Str3: CredEnumerateW
REASON_5: Yara Rule MATCH: spreading_share SUBSCORE: 70 
DESCRIPTION: Malware can spread east-west using share drive REF: - AUTHOR: x0r 
MATCHES: Str1: NETAPI32.dll Str2: netapi32.dll Str3: NetShareEnum
REASON_6: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_7: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: RegCloseKey
REASON_8: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: DuplicateTokenEx Str4: OpenProcessToken
REASON_9: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CreateFileA Str7: FindClose
REASON_10: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_11: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: HackTool_Producers SUBSCORE: 50 
DESCRIPTION: Hacktool Producers String REF: - AUTHOR: - 
MATCHES: Str1: gentilkiwi.com
REASON_13: Yara Rule MATCH: hacktool_windows_mimikatz_copywrite SUBSCORE: 50 
DESCRIPTION: Mimikatz credential dump tool: Author copywrite REF: https://github.com/gentilkiwi/mimikatz AUTHOR: @fusionrace 
MATCHES: Str1: Benjamin DELPY  Str2: http://blog.gentilkiwi.com/mimikatz Str3: http://blog.gentilkiwi.com/mimikatz Str4: Build with love ... (truncated)
REASON_14: Yara Rule MATCH: hacktool_windows_mimikatz_modules SUBSCORE: 50 
DESCRIPTION: Mimikatz credential dump tool: Modules REF: https://github.com/gentilkiwi/mimikatz AUTHOR: @fusionrace 
MATCHES: Str1: mimidrv
REASON_15: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645ea00c645eb00c645ec00c645 Str2: c645eb00c645ec00c645ed00c645 Str3: c645f819c645f917c645fa16c645 Str4: c645a060c645a1bac645a24fc645 ... (truncated)
REASON_17: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_18: Yara Rule MATCH: Powerkatz_DLL_Generic SUBSCORE: 80 
DESCRIPTION: Detects Powerkatz - a Mimikatz version prepared to run in memory via Powershell (overlap with other Mimikatz versions is possible) REF: PowerKatz Analysis AUTHOR: Florian Roth 
MATCHES: Str1: kuhl_m_lsadump_getUsersAndSamKey ; kull_m_registry_RegOpenKeyEx SAM Accounts (0x%08x) Str2: kuhl_m_lsadump_getComputerAndSyskey ; kuh ... (truncated)
REASON_19: Yara Rule MATCH: mimikatz SUBSCORE: 70 
DESCRIPTION: mimikatz REF: - AUTHOR: Benjamin DELPY (gentilkiwi) 
MATCHES: Str1: 89710489308d04bd Str2: 8b4de48b45f48975e8890185ff74 Str3: 8b4de88b45f48975ec890185ff74
REASON_20: Yara Rule MATCH: Mimikatz_Strings SUBSCORE: 65 
DESCRIPTION: Detects Mimikatz strings REF: not set AUTHOR: Florian Roth 
MATCHES: Str1: List tickets in MIT/Heimdall ccache Str2: kuhl_m_kerberos_ptt_file ; LsaCallKerberosPackage %08x Str3: * Injecting ticket : Str4: mim ... (truncated)
REASON_21: Yara Rule MATCH: Mimikatz_Gen_Strings SUBSCORE: 70 
DESCRIPTION: Detects Mimikatz by using some special strings REF: Internal Research AUTHOR: Florian Roth 
MATCHES: Str1: [*] '%s' service already started Str2: ** Security Callback! ** Str3: Try to export a software CA to a crypto (virtual)hardware Str4: ... (truncated)
REASON_22: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_23: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_24: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_25: Yara Rule MATCH: HasDigitalSignature SUBSCORE: 1 
DESCRIPTION: DigitalSignature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 982c00000002020030822c8906092a864886f70d010702a0822c7a30822c76020101310b300906052b0e03021a0500304c060a2b060104018237020104a03e303c301 ... (truncated)
REASON_26: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_27: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_28: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: IDENTIFIER Str2: Identifier
REASON_29: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: IDENTIFIER Str2: Identifier
REASON_30: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: IDENTIFIER Str2: Identifier
REASON_31: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_32: Yara Rule MATCH: DLL_inject SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: LoadLibraryA Str4: CreateFileA Str5: WriteProcessMemory Str6: HeapAlloc Str7: GetProcAddress S ... (truncated)
REASON_33: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_34: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_35: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_36: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_37: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_38: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_39: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_40: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_41: Yara Rule MATCH: with_sqlite SUBSCORE: 60 
DESCRIPTION: Rule to detect the presence of SQLite data in raw image REF: http://www.st2labs.com AUTHOR: Julian J. Gonzalez <info@seguridadparatodos.es> 
MATCHES: Str1: SQLite format 3
REASON_42: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_43: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00112233445566778899
REASON_44: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 0123456789ABCDEF0123456789abcdef
REASON_45: Yara Rule MATCH: Big_Numbers3 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 64:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: bd49a8271d650fa89e446b42e513b595a717b9212c91dd384aab871fc1d0f6d7
REASON_46: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext Str6: CryptAcquireContext
REASON_47: Yara Rule MATCH: MD5_API SUBSCORE: 25 
DESCRIPTION: Looks for MD5 API REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: advapi32.dll Str3: cryptdll.dll Str4: cryptdll.dll Str5: MD5Init Str6: MD5Update Str7: MD5Final
REASON_48: Yara Rule MATCH: DES_Long SUBSCORE: 15 
DESCRIPTION: DES [long] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 10801040000000000080100000001040100000401080000000800040008010000080000010001040100000000080004010001000008010400000104010000000
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:10:54Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
20		create_service
50		network_dns
80		cred_local
70		spreading_share
5		win_mutex
20		win_registry
10		win_token
10		win_files_operation
1		misc_pe_signature
1		ft_exe
50		HackTool_Producers
50		hacktool_windows_mimikatz_copywrite
50		hacktool_windows_mimikatz_modules
1		math_entropy_6
5		obfuscation_singlebyte_mov
15		dll_injection_thread
80		Powerkatz_DLL_Generic
70		mimikatz
65		Mimikatz_Strings
70		Mimikatz_Gen_Strings
1		IsPE32
1		IsConsole
1		HasOverlay
1		HasDigitalSignature
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
40		DLL_inject
45		Inject_Thread
60		Debugger_Check__QueryInfo
60		DebuggerException__SetConsoleCtrl_v1
30		Check_OutputDebugStringA_iat_v1
5		SEH_Save
5		SEH_Init
30		Check_OutputDebugStringA_iat
10		anti_dbg
60		with_sqlite
1		Contains_PE_File
10		Big_Numbers0
10		Big_Numbers1
10		Big_Numbers3
20		Advapi_Hash_API
25		MD5_API
15		DES_Long

Score total: 1276

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5f66b82558ca92e54e77f216ef4c066c                                                   |
| sha1                   | e4f82e4d7f22938dc0a0ff8a4a7ad2a763643d38                                           |
| sha256                 | 131314a6f6d1d263c75b9909586b3e1bd837036329ace5e69241749e861ac01d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FFSunw1ACSsHqmS5m5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Archive Collected Data::Archive via Library \[T1560.002]\                          |
|                        | Clipboard Data:: \[T1115]\                                                         |
|                        | Data from Information Repositories:: \[T1213]\                                     |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| CREDENTIAL ACCESS      | Credentials from Password Stores::Windows Credential Manager \[T1555.004]\         |
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Indicator Removal on Host::Clear Windows Event Logs \[T1070.001]\                  |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Domain Trust Discovery:: \[T1482]\                                                 |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Network Share Discovery:: \[T1135]\                                                |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
|                        | System Network Configuration Discovery :: \[T1016]\                                |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Execution Guardrails::Runs as Service [E1480.m07]                             |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | Interprocess Communication::Create Pipe [C0003.001]                           |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::3DES [C0027.004]                                                |
|                             | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Compress Data:: [C0024]                                                       |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| DISCOVERY                   | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Console:: [C0033]                                                             |
|                             | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| clear the Windows event log                          | anti-analysis/anti-forensic/clear-logs               |
| contain obfuscated stackstrings (4 matches)          | anti-analysis/obfuscation/string/stackstring         |
| acquire credentials from Windows Credential Manager  | collection                                           |
| reference SQL statements (2 matches)                 | collection/database/sql                              |
| get domain trust relationships                       | collection/network                                   |
| check HTTP status code                               | communication/http/client                            |
| create pipe                                          | communication/named-pipe/create                      |
| listen for remote procedure calls (2 matches)        | communication/rpc/server                             |
| compress data via WinAPI                             | data-manipulation/compression                        |
| decode data using Base64 via WinAPI (2 matches)      | data-manipulation/encoding/base64                    |
| encode data using Base64 via WinAPI (2 matches)      | data-manipulation/encoding/base64                    |
| encode data using XOR (14 matches)                   | data-manipulation/encoding/xor                       |
| create new key via CryptAcquireContext (20 matches)  | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt (13 matches)         | data-manipulation/encryption                         |
| get outbound credentials handle via CredSSP          | data-manipulation/encryption                         |
| encrypt data using DES via WinAPI (2 matches)        | data-manipulation/encryption/des                     |
| encrypt data using DPAPI (2 matches)                 | data-manipulation/encryption/dpapi                   |
| encrypt data using RC4 PRGA (5 matches)              | data-manipulation/encryption/rc4                     |
| encrypt data using RC4 via WinAPI                    | data-manipulation/encryption/rc4                     |
| hash data via WinCrypt (4 matches)                   | data-manipulation/hashing                            |
| hash data using SHA1                                 | data-manipulation/hashing/sha1                       |
| hash data using SHA1 via WinCrypt                    | data-manipulation/hashing/sha1                       |
| authenticate HMAC (2 matches)                        | data-manipulation/hmac                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments (2 matches)            | host-interaction/cli                                 |
| read clipboard data                                  | host-interaction/clipboard                           |
| manipulate console                                   | host-interaction/console                             |
| interact with driver via control codes               | host-interaction/driver                              |
| query environment variable                           | host-interaction/environment-variable                |
| get common file path (4 matches)                     | host-interaction/file-system                         |
| delete file (2 matches)                              | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| get file size                                        | host-interaction/file-system/meta                    |
| get file version info                                | host-interaction/file-system/meta                    |
| read file on Windows (8 matches)                     | host-interaction/file-system/read                    |
| read file via mapping                                | host-interaction/file-system/read                    |
| write file on Windows (5 matches)                    | host-interaction/file-system/write                   |
| set console window title                             | host-interaction/gui/console                         |
| get keyboard layout                                  | host-interaction/hardware/keyboard/layout            |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| access the Windows event log                         | host-interaction/log/winevt/access                   |
| enumerate network shares                             | host-interaction/network                             |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| get domain controller name                           | host-interaction/network/domain                      |
| get hostname (2 matches)                             | host-interaction/os/hostname                         |
| get system information on Windows                    | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| read process memory                                  | host-interaction/process                             |
| create process on Windows (5 matches)                | host-interaction/process/create                      |
| terminate process (3 matches)                        | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (3 matches)        | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| query service status                                 | host-interaction/service                             |
| run as service                                       | host-interaction/service                             |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| start service (2 matches)                            | host-interaction/service/start                       |
| stop service                                         | host-interaction/service/stop                        |
| get token membership                                 | host-interaction/session                             |
| get user security identifier (2 matches)             | host-interaction/session                             |
| create thread (5 matches)                            | host-interaction/thread/create                       |
| terminate thread (3 matches)                         | host-interaction/thread/terminate                    |
| link many functions at runtime                       | linking/runtime-linking                              |
| enumerate PE sections (6 matches)                    | load-code/pe                                         |
| parse PE exports (10 matches)                        | load-code/pe                                         |
| parse PE header (48 matches)                         | load-code/pe                                         |
| persist via Windows service                          | persistence/service                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
5		- Collection::Data from Information Repositories [T1213;5]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
8.5		- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
9		- Impact::Service Stop [T1489;9]
3		- Execution::System Services::Service Execution [T1569.002;3]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Collection::Clipboard Data [T1115;4]
3		- Discovery::Account Discovery [T1087;3]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
3		- Discovery::System Network Configuration Discovery [T1016;3]
8		- Credential Access::Credentials from Password Stores::Windows Credential Manager [T1555.004;8]
3		- Discovery::Domain Trust Discovery [T1482;3]
1		- Discovery::Query Registry [T1012;1]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]

Score total: 94.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Collection::Data from Information Repositories [T1213;5]', '5'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]', '8.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Impact::Service Stop [T1489;9]', '9'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Collection::Clipboard Data [T1115;4]', '4'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Credential Access::Credentials from Password Stores::Windows Credential Manager [T1555.004;8]', '8'), ('- Discovery::Domain Trust Discovery [T1482;3]', '3'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]', '4')]
---------------- ClamAV_Rules --------------
[('Win.Dropper.ClipBanker-9778171-0', '30'), ('Win.Tool.Mimikatz-9862700-0', '10'), ('Win.Trojan.Mimikatz-6466236-0', '45')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('create_service', '20'), ('network_dns', '50'), ('cred_local', '80'), ('spreading_share', '70'), ('win_mutex', '5'), ('win_registry', '20'), ('win_token', '10'), ('win_files_operation', '10'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('HackTool_Producers', '50'), ('hacktool_windows_mimikatz_copywrite', '50'), ('hacktool_windows_mimikatz_modules', '50'), ('math_entropy_6', '1'), ('obfuscation_singlebyte_mov', '5'), ('dll_injection_thread', '15'), ('Powerkatz_DLL_Generic', '80'), ('mimikatz', '70'), ('Mimikatz_Strings', '65'), ('Mimikatz_Gen_Strings', '70'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasOverlay', '1'), ('HasDigitalSignature', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('DLL_inject', '40'), ('Inject_Thread', '45'), ('Debugger_Check__QueryInfo', '60'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('Check_OutputDebugStringA_iat_v1', '30'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('with_sqlite', '60'), ('Contains_PE_File', '1'), ('Big_Numbers0', '10'), ('Big_Numbers1', '10'), ('Big_Numbers3', '10'), ('Advapi_Hash_API', '20'), ('MD5_API', '25'), ('DES_Long', '15')]
-------------- LOKI_Score ------------
['1276']
-------------- CAPA_Score ------------
['97.5']
-------------- CLAMAV_Score ------------
['85.0']
-------------- SCORE FINAL ------------
23238.70449292351
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F0wEPK309qM4cOUtmb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 912400a90ca88e80abc6cb8f30c1bb41                                                   |
| sha1                   | bf32f1dd03d9dfea828109824928c7f13b23ca99                                           |
| sha256                 | a174de17639a2c544d8124895f878abaaa634fdc63bf49979b407fd7a20c28bf                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F0wEPK309qM4cOUtmb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F0wEPK309qM4cOUtmb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 23.965 sec (0 m 23 s)
Start Date: 2022:01:28 13:12:21
End Date:   2022:01:28 13:12:45

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:12:22Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:12:46Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
39.905246299377595
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FYYeqrWh6xkyXQUwf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 57f0394e0c4082e04c9d635ea5e8fc98                                                   |
| sha1                   | df9779aaf47019ee0cb8b8fcbe6510a3d6b29bf5                                           |
| sha256                 | 8ef6e578c77caa6c47c512ba733b6532ac21d34f396632d8ff5ee7deca47846a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FYYeqrWh6xkyXQUwf.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
| CRYPTOGRAPHY                | Encrypt Data:: [C0027]                                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| OPERATING SYSTEM            | Registry::Query Registry Key [C0036.005]                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints                       | anti-analysis/anti-debugging/debugger-detection      |
| encrypt data using DPAPI (4 matches)                 | data-manipulation/encryption/dpapi                   |
| generate random numbers via WinAPI (2 matches)       | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| query or enumerate registry key (4 matches)          | host-interaction/registry                            |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 13.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FYYeqrWh6xkyXQUwf.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 24.624 sec (0 m 24 s)
Start Date: 2022:01:28 13:12:47
End Date:   2022:01:28 13:13:11

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:12:47Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:13:12Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['13.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
269.3604125207988
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FHjYxa32zpDuOer3zd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 61c85b1b2d5fe567546192ce83c0450b                                                   |
| sha1                   | 87e511c2ad9128e64e482b4a50473fcc1d464e4e                                           |
| sha256                 | e31535d614bcc97a14512386278f87c426ef4bf582abcf41ade75bf1acd0b437                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FHjYxa32zpDuOer3zd.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FHjYxa32zpDuOer3zd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 24.497 sec (0 m 24 s)
Start Date: 2022:01:28 13:13:13
End Date:   2022:01:28 13:13:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:13:13Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:13:38Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
39.905246299377595
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FoY2p42O2A8V0BqQR5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FoY2p42O2A8V0BqQR5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.22 MB
Data read: 0.21 MB (ratio 1.04:1)
Time: 25.020 sec (0 m 25 s)
Start Date: 2022:01:28 13:13:39
End Date:   2022:01:28 13:14:04

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x88 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:13:39Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FoY2p42O2A8V0BqQR5.exe SCORE: 218 TYPE: EXE SIZE: 226808 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f8469b46670> 
MD5: a74ee8200aace7d19dee79871bbf2ed3 
SHA1: 7929ddb899baf5f1bfda9092c8edc0ef7cc4f647 
SHA256: 807424fa3c4e03471d4acc5d35fdd8923a3689f44599f23999879abf5a74dd85 CREATED: Fri Jan 28 13:13:39 2022 MODIFIED: Fri Jan 28 13:13:39 2022 ACCESSED: Fri Jan 28 13:14:05 2022 
REASON_1: Yara Rule MATCH: create_service SUBSCORE: 20 
DESCRIPTION: Create a windows service REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: CreateService Str3: ControlService Str4: StartService Str5: QueryServiceStatus
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_4: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasDigitalSignature SUBSCORE: 1 
DESCRIPTION: DigitalSignature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 88350000000202003082357806092a864886f70d010702a082356930823565020101310b300906052b0e03021a0500304c060a2b060104018237020104a03e303c301 ... (truncated)
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_15: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_16: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_17: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_18: Yara Rule MATCH: GenerateTLSClientHelloPacket_Test SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: Novetta Threat Research & Interdiction Group - trig@novetta.com 
MATCHES: Str1: 250700008079054883c8f840
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: DES_sbox SUBSCORE: 15 
DESCRIPTION: DES [sbox] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:14:05Z

-------- Score ----------------
Scores		Rules
.......		...............
20		create_service
20		win_registry
10		Str_Win32_Winsock2_Library
1		misc_pe_signature
1		ft_exe
1		math_entropy_6
1		IsPE32
2		IsWindowsGUI
1		HasOverlay
1		HasDigitalSignature
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
60		DebuggerException__SetConsoleCtrl_v1
5		SEH_Init
10		anti_dbg
60		GenerateTLSClientHelloPacket_Test
1		Contains_PE_File
15		DES_sbox

Score total: 218

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a74ee8200aace7d19dee79871bbf2ed3                                                   |
| sha1                   | 7929ddb899baf5f1bfda9092c8edc0ef7cc4f647                                           |
| sha256                 | 807424fa3c4e03471d4acc5d35fdd8923a3689f44599f23999879abf5a74dd85                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FoY2p42O2A8V0BqQR5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Automated Collection:: \[T1119]\                                                   |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Execution Guardrails::Runs as Service [E1480.m07]                             |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Read File:: [C0051]                                                           |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                 | anti-analysis/anti-debugging/debugger-detection      |
| contain obfuscated stackstrings (5 matches)           | anti-analysis/obfuscation/string/stackstring         |
| parse credit card information                         | collection/credit-card                               |
| check HTTP status code (4 matches)                    | communication/http/client                            |
| encode data using XOR                                 | data-manipulation/encoding/xor                       |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| accept command line arguments                         | host-interaction/cli                                 |
| get common file path (2 matches)                      | host-interaction/file-system                         |
| copy file                                             | host-interaction/file-system/copy                    |
| create directory                                      | host-interaction/file-system/create                  |
| get file size                                         | host-interaction/file-system/meta                    |
| read file on Windows                                  | host-interaction/file-system/read                    |
| enumerate gui resources (2 matches)                   | host-interaction/gui                                 |
| get number of processors                              | host-interaction/hardware/cpu                        |
| print debug messages                                  | host-interaction/log/debug/write-event               |
| get hostname                                          | host-interaction/os/hostname                         |
| create a process with modified I/O handles and window | host-interaction/process/create                      |
| create process on Windows                             | host-interaction/process/create                      |
| enumerate processes                                   | host-interaction/process/list                        |
| terminate process                                     | host-interaction/process/terminate                   |
| query or enumerate registry value (2 matches)         | host-interaction/registry                            |
| query service status (2 matches)                      | host-interaction/service                             |
| run as service                                        | host-interaction/service                             |
| create service                                        | host-interaction/service/create                      |
| delete service                                        | host-interaction/service/delete                      |
| stop service (2 matches)                              | host-interaction/service/stop                        |
| create thread (4 matches)                             | host-interaction/thread/create                       |
| resume thread (2 matches)                             | host-interaction/thread/resume                       |
| terminate thread (7 matches)                          | host-interaction/thread/terminate                    |
| access PEB ldr_data (3 matches)                       | linking/runtime-linking                              |
| link function at runtime on Windows (7 matches)       | linking/runtime-linking                              |
| parse PE exports (2 matches)                          | load-code/pe                                         |
| parse PE header (4 matches)                           | load-code/pe                                         |
| persist via Windows service                           | persistence/service                                  |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::File and Directory Discovery [T1083;1]
3		- Execution::System Services::Service Execution [T1569.002;3]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Discovery::Software Discovery [T1518;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
9		- Impact::Service Stop [T1489;9]
5.5		- Collection::Automated Collection [T1119;5.5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 68.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Discovery::Software Discovery [T1518;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Impact::Service Stop [T1489;9]', '9'), ('- Collection::Automated Collection [T1119;5.5]', '5.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('create_service', '20'), ('win_registry', '20'), ('Str_Win32_Winsock2_Library', '10'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasDigitalSignature', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('GenerateTLSClientHelloPacket_Test', '60'), ('Contains_PE_File', '1'), ('DES_sbox', '15')]
-------------- LOKI_Score ------------
['218']
-------------- CAPA_Score ------------
['68.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4811.8455337440655
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FfDdEDHOYOHUBhojh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 348059b0a770e1f95d3417107968a954                                                   |
| sha1                   | d6e48a1409e6d0b4d7fefe31028851a6e0e215ff                                           |
| sha256                 | 321a9e388a0e437325411998beaaecb9213823be935f1b37fab9d7cef8984c99                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FfDdEDHOYOHUBhojh.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FfDdEDHOYOHUBhojh.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 24.358 sec (0 m 24 s)
Start Date: 2022:01:28 13:14:19
End Date:   2022:01:28 13:14:44

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:14:20Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:14:45Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
39.905246299377595
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FW5zk2vI7V4NtlkGe.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 73e4bcfce5e484f9e4ddb7f9c0e471f9                                                   |
| sha1                   | 4265c4744a852fc42fe4798d38e9dad9c239f383                                           |
| sha256                 | bb104769a2845ee2c5cac9cc89cdc0e853ee00dde202f14330954baef4cf5dee                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FW5zk2vI7V4NtlkGe.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| create thread                                        | host-interaction/thread/create                       |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 8.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FW5zk2vI7V4NtlkGe.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.110 sec (0 m 24 s)
Start Date: 2022:01:28 13:14:45
End Date:   2022:01:28 13:15:09

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:14:45Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:15:10Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['8.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
159.62098519751038
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FzaR613OacT8IzJ8Yl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b766cc43d649d30e9f27aff8f7ee7de0                                                   |
| sha1                   | c1e170856c4887c056dee663bfda189fe7a094c9                                           |
| sha256                 | e15d509ae7b77989f885edb22b6c9cccec3f6a4c4805936756af7a01f2388b03                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FzaR613OacT8IzJ8Yl.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Indicator Removal on Host::Clear Windows Event Logs \[T1070.001]\                  |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | System Shutdown/Reboot:: \[T1529]\                                                 |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Virtual Machine Detection:: [B0009]                                           |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
|                             | Socket Communication::Connect Socket [C0001.004]                              |
|                             | Socket Communication::Create TCP Socket [C0001.011]                           |
|                             | Socket Communication::Get Socket Status [C0001.012]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::Set Socket Config [C0001.001]                           |
|                             | Socket Communication::TCP Client [C0001.008]                                  |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
|                             | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| HARDWARE                    | Simulate Hardware::Ctrl-Alt-Del [C0057.001]                                   |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| clear the Windows event log                          | anti-analysis/anti-forensic/clear-logs               |
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| contain obfuscated stackstrings (3 matches)          | anti-analysis/obfuscation/string/stackstring         |
| receive and write data from server to client         | c2/file-transfer                                     |
| send data (2 matches)                                | communication                                        |
| creates tcp or udp socket                            | communication/socket                                 |
| get socket information                               | communication/socket                                 |
| get socket status                                    | communication/socket                                 |
| initialize Winsock library                           | communication/socket                                 |
| set socket configuration (2 matches)                 | communication/socket                                 |
| act as TCP client                                    | communication/tcp/client                             |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| get common file path (5 matches)                     | host-interaction/file-system                         |
| delete file                                          | host-interaction/file-system/delete                  |
| get file size                                        | host-interaction/file-system/meta                    |
| move file (2 matches)                                | host-interaction/file-system/move                    |
| read .ini file                                       | host-interaction/file-system/read                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| enumerate gui resources                              | host-interaction/gui                                 |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| get CPU information                                  | host-interaction/hardware/cpu                        |
| simulate CTRL ALT DEL                                | host-interaction/hardware/keyboard                   |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| access the Windows event log                         | host-interaction/log/winevt/access                   |
| get local IPv4 addresses                             | host-interaction/network/address                     |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| shutdown system                                      | host-interaction/os                                  |
| get hostname                                         | host-interaction/os/hostname                         |
| get system information on Windows                    | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| create process on Windows (4 matches)                | host-interaction/process/create                      |
| enumerate processes (3 matches)                      | host-interaction/process/list                        |
| modify access privileges                             | host-interaction/process/modify                      |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry key (2 matches)                      | host-interaction/registry/delete                     |
| delete registry value                                | host-interaction/registry/delete                     |
| get session information                              | host-interaction/session                             |
| get session user name                                | host-interaction/session                             |
| create thread (2 matches)                            | host-interaction/thread/create                       |
| terminate thread                                     | host-interaction/thread/terminate                    |
| link function at runtime on Windows (6 matches)      | linking/runtime-linking                              |
| enumerate PE sections                                | load-code/pe                                         |
| inspect section memory permissions                   | load-code/pe                                         |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
8.5		- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
3		- Discovery::Account Discovery [T1087;3]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Discovery::Software Discovery [T1518;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
3		- Discovery::System Network Configuration Discovery [T1016;3]
1		- Discovery::Query Registry [T1012;1]
9		- Impact::System Shutdown/Reboot [T1529;9]

Score total: 83.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FzaR613OacT8IzJ8Yl.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 24.419 sec (0 m 24 s)
Start Date: 2022:01:28 13:15:10
End Date:   2022:01:28 13:15:35

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:15:11Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FzaR613OacT8IzJ8Yl.exe SCORE: 214 TYPE: EXE SIZE: 40960 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7faea3d5f670> 
MD5: b766cc43d649d30e9f27aff8f7ee7de0 
SHA1: c1e170856c4887c056dee663bfda189fe7a094c9 
SHA256: e15d509ae7b77989f885edb22b6c9cccec3f6a4c4805936756af7a01f2388b03 CREATED: Fri Jan 28 13:15:10 2022 MODIFIED: Fri Jan 28 13:15:10 2022 ACCESSED: Fri Jan 28 13:15:36 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_4: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: kernel32.dll Str3: GetPrivateProfileStringA
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: kernel32.dll Str3: WriteFile Str4: ReadFile Str5: CreateFileA Str6: MoveFileExA
REASON_6: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_7: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_8: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetOpen
REASON_9: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: math_entropy_4 SUBSCORE: 1 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645e048c645e165c645e261c645 Str2: c645e165c645e261c645e370c645 Str3: c645e261c645e370c645e446c645 Str4: c645e370c645e446c645e572c645 ... (truncated)
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DESCRIPTION\System
REASON_17: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_18: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:15:36Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
10		win_token
10		win_private_profile
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
1		ft_exe
1		math_entropy_4
5		obfuscation_singlebyte_mov
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
2		PE_File
35		Qemu_Detection
5		Anti_Automated_Sandbox
5		SEH_Init
1		Contains_PE_File
5		BASE64_table

Score total: 214

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]', '8.5'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Discovery::Software Discovery [T1518;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Impact::System Shutdown/Reboot [T1529;9]', '9')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '10'), ('win_private_profile', '10'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('ft_exe', '1'), ('math_entropy_4', '1'), ('obfuscation_singlebyte_mov', '5'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('Anti_Automated_Sandbox', '5'), ('SEH_Init', '5'), ('Contains_PE_File', '1'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['214']
-------------- CAPA_Score ------------
['83.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5057.715464865797
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FnFlKn3xdMqijl0z.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be an installer.
WARNING:capa: 
WARNING:capa: capa cannot handle installers well. This means the results may be misleading or incomplete.
WARNING:capa: You should try to understand the install mechanism and analyze created files with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) installer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:15:36Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FnFlKn3xdMqijl0z.exe SCORE: 1560 TYPE: EXE SIZE: 782044 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa2932f1670> 
MD5: 4f11bdb380dafa2518053c6d20147a05 
SHA1: 0de61c550a355e78874703f6f0aaf5d6f79f5eb6 
SHA256: 9a9012840295bc2c62fd9cbe3d3dda692f43536861a40464f4e073d22bff179f CREATED: Fri Jan 28 13:15:36 2022 MODIFIED: Fri Jan 28 13:15:36 2022 ACCESSED: Fri Jan 28 13:16:00 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_5: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: GetPrivateProfileStringA Str3: WritePrivateProfileStringA
REASON_6: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CreateFileA Str7: FindFirstFileA Str8: MoveF ... (truncated)
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 1 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsPacked SUBSCORE: 5 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: stager_reverse_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_16: Yara Rule MATCH: stager_bind_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_17: Yara Rule MATCH: win32_stage_boot_winsock_conn_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_18: Yara Rule MATCH: win32_stage_boot_bind_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_19: Yara Rule MATCH: win32_stage_boot_reverse_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_20: Yara Rule MATCH: win32_stage_boot_winsock_conn_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_21: Yara Rule MATCH: stager_reverse_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_22: Yara Rule MATCH: win32_stage_boot_bind_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_23: Yara Rule MATCH: win32_stage_boot_reverse_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_24: Yara Rule MATCH: win32_stage_boot_reverse_shell_revert_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_25: Yara Rule MATCH: win32_stage_winexec_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_26: Yara Rule MATCH: stager_bind_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_27: Yara Rule MATCH: win32_stage_boot_winsock_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_28: Yara Rule MATCH: win32_stage_boot_reverse_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_29: Yara Rule MATCH: win32_stage_api_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_30: Yara Rule MATCH: win32_stage_boot_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_31: Yara Rule MATCH: win32_stage_boot_reverse_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_32: Yara Rule MATCH: win32_stage_boot_reverse_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_33: Yara Rule MATCH: win32_stage_boot_bind_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_34: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_35: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_36: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:16:01Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
65		screenshot
20		win_registry
10		win_token
10		win_private_profile
10		win_files_operation
1		ft_exe
1		math_entropy_close_8
1		IsPE32
2		IsWindowsGUI
5		IsPacked
1		HasOverlay
1		HasRichSignature
2		PE_File
70		stager_reverse_tcp_nx_ldone_x86
70		stager_bind_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_conn_ldone_x86
70		win32_stage_boot_bind_read_ldone_x86
70		win32_stage_boot_reverse_read_ldone_x86
70		win32_stage_boot_winsock_conn_udp_ldone_x86
70		stager_reverse_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_bind_inlineegg_ldone_x86
70		win32_stage_boot_reverse_ldone_x86
70		win32_stage_boot_reverse_shell_revert_ldone_x86
70		win32_stage_winexec_ldone_x86
70		stager_bind_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_bind_ldone_x86
70		win32_stage_boot_reverse_shell_ldone_x86
70		win32_stage_api_ldone_x86
70		win32_stage_boot_bind_ldone_x86
70		win32_stage_boot_reverse_udp_ldone_x86
70		win32_stage_boot_reverse_inlineegg_ldone_x86
70		win32_stage_boot_bind_shell_ldone_x86
5		Anti_Automated_Sandbox
1		Contains_PE_File
25		CRC32_poly_Constant

Score total: 1560

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FnFlKn3xdMqijl0z.exe: Win.Trojan.Agent-1879100 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FnFlKn3xdMqijl0z.exe: Win.Trojan.Agent-1879100 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 5.69 MB
Data read: 0.74 MB (ratio 7.66:1)
Time: 50.211 sec (0 m 50 s)
Start Date: 2022:01:28 13:15:36
End Date:   2022:01:28 13:16:26

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('screenshot', '65'), ('win_registry', '20'), ('win_token', '10'), ('win_private_profile', '10'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_close_8', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('IsPacked', '5'), ('HasOverlay', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('stager_reverse_tcp_nx_ldone_x86', '70'), ('stager_bind_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_ldone_x86', '70'), ('win32_stage_boot_bind_read_ldone_x86', '70'), ('win32_stage_boot_reverse_read_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_udp_ldone_x86', '70'), ('stager_reverse_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_bind_inlineegg_ldone_x86', '70'), ('win32_stage_boot_reverse_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_revert_ldone_x86', '70'), ('win32_stage_winexec_ldone_x86', '70'), ('stager_bind_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_ldone_x86', '70'), ('win32_stage_api_ldone_x86', '70'), ('win32_stage_boot_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_udp_ldone_x86', '70'), ('win32_stage_boot_reverse_inlineegg_ldone_x86', '70'), ('win32_stage_boot_bind_shell_ldone_x86', '70'), ('Anti_Automated_Sandbox', '5'), ('Contains_PE_File', '1'), ('CRC32_poly_Constant', '25')]
-------------- LOKI_Score ------------
['1560']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
24724.33380239337
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FXlpE20tZVLm4slT7.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | d922a26d46a2e2194be6c3af1548d0e9                                                   |
| sha1                   | d0afd35a719dc0efc018f2609144297473d711d3                                           |
| sha256                 | 4363b665cb1b4b724716d7e287fe770d8c38c76aa78fa0d1cbcd1c9bc1c2b02c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FXlpE20tZVLm4slT7.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| encrypt or decrypt data via BCrypt                   | data-manipulation/encryption                         |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| check if file exists                                 | host-interaction/file-system/exists                  |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| link function at runtime on Windows (4 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 9.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FXlpE20tZVLm4slT7.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.10 MB
Data read: 0.10 MB (ratio 1.00:1)
Time: 24.635 sec (0 m 24 s)
Start Date: 2022:01:28 13:16:26
End Date:   2022:01:28 13:16:51

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:16:26Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:16:52Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['9.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
179.57360834719918
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FGdFKyfmBKfH5Yuc1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FGdFKyfmBKfH5Yuc1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.47 MB
Data read: 0.45 MB (ratio 1.05:1)
Time: 25.337 sec (0 m 25 s)
Start Date: 2022:01:28 13:16:52
End Date:   2022:01:28 13:17:17

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:16:52Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FGdFKyfmBKfH5Yuc1.exe SCORE: 254 TYPE: EXE SIZE: 468992 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f6a55044670> 
MD5: 866989aa656cf67780143376c12df510 
SHA1: 3bacae009425ab65c13b236469caf11e8d30f2dd 
SHA256: 47a44a548c462510301785b3d849e7fa731b911fa0b174574876a1367c88cbd2 CREATED: Fri Jan 28 13:16:52 2022 MODIFIED: Fri Jan 28 13:16:52 2022 ACCESSED: Fri Jan 28 13:17:18 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_2: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_3: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_4: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetOpen
REASON_5: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_15: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: UnhookWindowsHookEx Str3: CallNextHookEx
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:17:19Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
80		keylogger
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
1		ft_exe
1		math_entropy_5
15		dll_injection_hook
1		IsPE64
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
35		Win_Hook_v12
10		anti_dbg
1		Contains_PE_File
5		BASE64_table

Score total: 254

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 866989aa656cf67780143376c12df510                                                   |
| sha1                   | 3bacae009425ab65c13b236469caf11e8d30f2dd                                           |
| sha256                 | 47a44a548c462510301785b3d849e7fa731b911fa0b174574876a1367c88cbd2                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FGdFKyfmBKfH5Yuc1.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | HTTP Communication::Set Header [C0002.013]                                    |
|                             | HTTP Communication::WinHTTP [C0002.008]                                       |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
|                             | File and Directory Discovery::Log File [E1083.m01]                            |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| log keystrokes via polling                           | collection/keylog                                    |
| initialize WinHTTP library                           | communication/http                                   |
| read HTTP header                                     | communication/http                                   |
| set HTTP header                                      | communication/http                                   |
| create HTTP request                                  | communication/http/client                            |
| prepare HTTP request                                 | communication/http/client                            |
| receive HTTP response (2 matches)                    | communication/http/client                            |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (4 matches)                    | data-manipulation/encoding/xor                       |
| hash data via BCrypt                                 | data-manipulation/hashing                            |
| hash data using fnv (4 matches)                      | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| set application hook (4 matches)                     | host-interaction/gui                                 |
| get graphical window text (2 matches)                | host-interaction/gui/window/get-text                 |
| access the Windows event log                         | host-interaction/log/winevt/access                   |
| get session user name                                | host-interaction/session                             |
| create thread                                        | host-interaction/thread/create                       |
| parse PE header (7 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
3		- Discovery::Account Discovery [T1087;3]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]

Score total: 29.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('screenshot', '65'), ('keylogger', '80'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('dll_injection_hook', '15'), ('IsPE64', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Win_Hook_v12', '35'), ('anti_dbg', '10'), ('Contains_PE_File', '1'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['254']
-------------- CAPA_Score ------------
['29.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4614.2310917670475
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Ftxenp2hZb7lJohPTh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 013710ab6de262c6e342571f1798d8c2                                                   |
| sha1                   | a798ad46810e0799d36e20a84ae2564200fcb32d                                           |
| sha256                 | ca68eff48f1e5b6158cd0f45571805717a8364a3d34ed469f4c9e76cfe88fada                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Ftxenp2hZb7lJohPTh.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Ftxenp2hZb7lJohPTh.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.00 MB
Data read: 0.00 MB (ratio 0.00:1)
Time: 24.305 sec (0 m 24 s)
Start Date: 2022:01:28 13:17:41
End Date:   2022:01:28 13:18:06

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:17:42Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:18:06Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
39.905246299377595
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FYlavN2GPGL5c3UjK5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FYlavN2GPGL5c3UjK5.exe: Win.Malware.Facido-9768987-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.81 MB
Data read: 0.77 MB (ratio 1.06:1)
Time: 26.083 sec (0 m 26 s)
Start Date: 2022:01:28 13:18:07
End Date:   2022:01:28 13:18:33

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Facido-9768987-0

Score total: 50.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:18:07Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FYlavN2GPGL5c3UjK5.exe SCORE: 534 TYPE: EXE SIZE: 805888 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f5a2b6fe670> 
MD5: c3d495bb065e8f3690efc50c70fc8c67 
SHA1: aebe79d986bedaa5ba4e2f5c7402fd759dff50cf 
SHA256: bc452cc1128ccf7fa9f76d83cda79132740414973600fed14509749fe946816e CREATED: Fri Jan 28 13:18:07 2022 MODIFIED: Fri Jan 28 13:18:07 2022 ACCESSED: Fri Jan 28 13:18:33 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: b868584d56bb00000000b90a000000ba58560000ed
REASON_13: Yara Rule MATCH: VM_Detect_VirtualPC_XEN_Wine_v1 SUBSCORE: 60 
DESCRIPTION: Xen detection, VirtualPC, Red Pill, Wine and other REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: ? Str2: 45c70001
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_15: Yara Rule MATCH: antivm_vmware SUBSCORE: 60 
DESCRIPTION: AntiVM checks for VMWare REF: - AUTHOR: x0r 
MATCHES: Str1: b868584d56bb00000000b90a000000ba58560000ed
REASON_16: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: ? Str2: 45c70001
REASON_17: Yara Rule MATCH: Antivirus_strings SUBSCORE: 50 
DESCRIPTION: Contains references to security software REF: - AUTHOR: Jerome Athias 
MATCHES: Str1: avgui.exe Str2: AvastSvc.exe
REASON_18: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_19: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_20: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: ? Str2: 45c70001
REASON_21: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_22: Yara Rule MATCH: Typical_Malware_String_Transforms SUBSCORE: 60 
DESCRIPTION: Detects typical strings in a reversed or otherwise modified form REF: Internal Research AUTHOR: Florian Roth 
MATCHES: Str1: exe.23lldnur Str2: paeHssecorPteG Str3: sserddAcorPteG
REASON_23: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_24: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 5f96de8e69f003326a5e73ab7da5f5c1 Str2: F5AACA05FCFBBAFDAACDDBDABDBBFCCD
REASON_25: Yara Rule MATCH: MD5_Constants SUBSCORE: 20 
DESCRIPTION: Look for MD5 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: 78a46ad7
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:18:34Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
1		ft_exe
1		math_entropy_6
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
35		Embedded_PE
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
60		VM_Detect_VirtualPC_XEN_Wine_v1
5		Anti_Automated_Sandbox
60		antivm_vmware
60		vmdetect_2
50		Antivirus_strings
5		SEH_Save
5		SEH_Init
60		vmdetect
10		anti_dbg
60		Typical_Malware_String_Transforms
1		Contains_PE_File
10		Big_Numbers1
20		MD5_Constants

Score total: 534

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Facido-9768987-0', '50')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('Embedded_PE', '35'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('VM_Detect_VirtualPC_XEN_Wine_v1', '60'), ('Anti_Automated_Sandbox', '5'), ('antivm_vmware', '60'), ('vmdetect_2', '60'), ('Antivirus_strings', '50'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('vmdetect', '60'), ('anti_dbg', '10'), ('Typical_Malware_String_Transforms', '60'), ('Contains_PE_File', '1'), ('Big_Numbers1', '10'), ('MD5_Constants', '20')]
-------------- LOKI_Score ------------
['534']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['50.0']
-------------- SCORE FINAL ------------
9092.792353639428
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FXFVan3INKex9uRE1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FXFVan3INKex9uRE1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.19 MB
Data read: 0.18 MB (ratio 1.04:1)
Time: 24.725 sec (0 m 24 s)
Start Date: 2022:01:28 13:18:36
End Date:   2022:01:28 13:19:01

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:18:36Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:19:02Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2666097ee8cb3d4fd7b02eb8901246a5                                                   |
| sha1                   | bfdd9101a1941b7eee511681e1793541ef80008f                                           |
| sha256                 | ddc1193d3545b1d93500c48b063dfd133273dea82a175207fb761360c1fe290f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FXFVan3INKex9uRE1.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| hash data using fnv                                  | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (9 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 8.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['8.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
159.62098519751038
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FEv5MFQfkKSgr77K9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 4bdd67ff852c221112337fecd0681eac                                                   |
| sha1                   | 4610093687b0f2c42fe80adca217988c8947a546                                           |
| sha256                 | d33d69b454efba519bffd3ba63c99ffce058e3105745f8a7ae699f72db1e70eb                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FEv5MFQfkKSgr77K9.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Process Hollowing \[T1055.012]\                                 |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Resume Thread:: [C0054]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| compiled with Borland Delphi                         | compiler/delphi                                      |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| accept command line arguments                        | host-interaction/cli                                 |
| create process on Windows                            | host-interaction/process/create                      |
| allocate RWX memory (2 matches)                      | host-interaction/process/inject                      |
| use process replacement                              | host-interaction/process/inject                      |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
| load NCR ATM library                                 | targeting/automated-teller-machine/ncr               |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
4		- Defense Evasion::Process Injection::Process Hollowing [T1055.012;4]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 12.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FEv5MFQfkKSgr77K9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 24.355 sec (0 m 24 s)
Start Date: 2022:01:28 13:19:09
End Date:   2022:01:28 13:19:34

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 2-3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:19:09Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FEv5MFQfkKSgr77K9.exe SCORE: 228 TYPE: EXE SIZE: 93184 
FIRST_BYTES: 4d5a50000200000004000f00ffff0000b8000000 / <filter object at 0x7f59b83d4670> 
MD5: 4bdd67ff852c221112337fecd0681eac 
SHA1: 4610093687b0f2c42fe80adca217988c8947a546 
SHA256: d33d69b454efba519bffd3ba63c99ffce058e3105745f8a7ae699f72db1e70eb CREATED: Fri Jan 28 13:19:09 2022 MODIFIED: Fri Jan 28 13:19:09 2022 ACCESSED: Fri Jan 28 13:19:34 2022 
REASON_1: Malware Hash TYPE: MD5 HASH: 4bdd67ff852c221112337fecd0681eac SUBSCORE: 100 DESC: SUCEFUL: Next Generation ATM Malware https://www.fireeye.com/blog/threat-research/2015/09/suceful_next_genera.html
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: misc_no_dosmode_header SUBSCORE: 10 
DESCRIPTION: Detect on absence of 'DOS Mode' heaader between MZ and PE boundries REF: - AUTHOR: Jason Batchelor
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: borland_cpp SUBSCORE: 10 
DESCRIPTION: Borland C++ REF: - AUTHOR: _pusher_ 
MATCHES: Str1: a18b404000c1e002a38f404000526a00e8f51d00008bd0e8ca1500005ae8741e0000e8031600006a00e8b81600005968344040006a00e8cf1d0000a3934040006a00e ... (truncated)
REASON_8: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: ThreadControl__Context_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetThreadContext
REASON_11: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:19:34Z

-------- Score ----------------
Scores		Rules
.......		...............
100		Malware Hash
1		ft_exe
10		misc_no_dosmode_header
1		math_entropy_5
1		IsPE32
2		IsWindowsGUI
10		borland_cpp
35		Embedded_PE
2		PE_File
60		ThreadControl__Context_v1
5		SEH_Init
1		Contains_PE_File

Score total: 228

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Process Injection::Process Hollowing [T1055.012;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('Malware Hash', '100'), ('ft_exe', '1'), ('misc_no_dosmode_header', '10'), ('math_entropy_5', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('borland_cpp', '10'), ('Embedded_PE', '35'), ('PE_File', '2'), ('ThreadControl__Context_v1', '60'), ('SEH_Init', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['228']
-------------- CAPA_Score ------------
['12.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3852.987956607604
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FUU8W94WFYbihYp3yk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 70f7d4806f949550ba5ac0afec9c042f                                                   |
| sha1                   | b7a53f5f90a5b78e8663e7372dfa61517d57d72d                                           |
| sha256                 | 6e118b779673183850a0acb474efa30bc4e91d47925aee5311364112d660e4ee                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FUU8W94WFYbihYp3yk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| print debug messages (2 matches)                     | host-interaction/log/debug/write-event               |
| create process on Windows                            | host-interaction/process/create                      |
| query or enumerate registry key                      | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| create thread                                        | host-interaction/thread/create                       |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 11.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FUU8W94WFYbihYp3yk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 24.558 sec (0 m 24 s)
Start Date: 2022:01:28 13:19:34
End Date:   2022:01:28 13:19:59

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:19:35Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FUU8W94WFYbihYp3yk.exe SCORE: 155 TYPE: EXE SIZE: 78336 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f1e837df670> 
MD5: 70f7d4806f949550ba5ac0afec9c042f 
SHA1: b7a53f5f90a5b78e8663e7372dfa61517d57d72d 
SHA256: 6e118b779673183850a0acb474efa30bc4e91d47925aee5311364112d660e4ee CREATED: Fri Jan 28 13:19:34 2022 MODIFIED: Fri Jan 28 13:19:34 2022 ACCESSED: Fri Jan 28 13:20:00 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: Advapi32.dll Str2: ADVAPI32.dll Str3: RegCloseKey
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_10: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_11: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:20:00Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
1		ft_exe
1		math_entropy_5
1		IsPE64
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
1		Contains_PE_File

Score total: 155

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Check_OutputDebugStringA_iat_v1', '30'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['155']
-------------- CAPA_Score ------------
['11.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2686.039614536147
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FHOowe27lbrZ1YlEhh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a0dea5c1f4ad089439054c8c0ae8c8ea                                                   |
| sha1                   | 5f7f1fb7dc8822573ba9130fc5395ea8d94d0258                                           |
| sha256                 | 192e53a11e563333ea528dd2682bf97690f7d9b4b15dfb8fd111a39980a513ec                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FHOowe27lbrZ1YlEhh.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FHOowe27lbrZ1YlEhh.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 24.475 sec (0 m 24 s)
Start Date: 2022:01:28 13:20:00
End Date:   2022:01:28 13:20:25

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:20:00Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:20:26Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
79.81049259875519
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fl4NKX1uIHjauqZuKg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fl4NKX1uIHjauqZuKg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.33 MB
Data read: 0.31 MB (ratio 1.05:1)
Time: 24.990 sec (0 m 24 s)
Start Date: 2022:01:28 13:20:26
End Date:   2022:01:28 13:20:51

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:20:26Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fl4NKX1uIHjauqZuKg.exe SCORE: 149 TYPE: EXE SIZE: 329728 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f54e8adc670> 
MD5: f2aa55885a2c014da99f1355f3f71e4a 
SHA1: f5671266fbf3ffbc32caa2c1effa1768893d0173 
SHA256: 508e5f70c29502d7ba66a35959a327e3d658514496ee7b9155d95e7409eb4fb8 CREATED: Fri Jan 28 13:20:26 2022 MODIFIED: Fri Jan 28 13:20:26 2022 ACCESSED: Fri Jan 28 13:20:52 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: Antivirus_strings SUBSCORE: 50 
DESCRIPTION: Contains references to security software REF: - AUTHOR: Jerome Athias 
MATCHES: Str1: rshell.exe
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:20:52Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
1		ft_exe
1		math_entropy_6
1		IsPE64
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
50		Antivirus_strings
1		Contains_PE_File

Score total: 149

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f2aa55885a2c014da99f1355f3f71e4a                                                   |
| sha1                   | f5671266fbf3ffbc32caa2c1effa1768893d0173                                           |
| sha256                 | 508e5f70c29502d7ba66a35959a327e3d658514496ee7b9155d95e7409eb4fb8                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fl4NKX1uIHjauqZuKg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)  | executable/resource                                  |
| interact with driver via control codes (3 matches)   | host-interaction/driver                              |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path (4 matches)                     | host-interaction/file-system                         |
| create directory                                     | host-interaction/file-system/create                  |
| delete directory                                     | host-interaction/file-system/delete                  |
| delete file (2 matches)                              | host-interaction/file-system/delete                  |
| check if file exists (3 matches)                     | host-interaction/file-system/exists                  |
| get file attributes (5 matches)                      | host-interaction/file-system/meta                    |
| move file                                            | host-interaction/file-system/move                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| enumerate disk volumes                               | host-interaction/hardware/storage                    |
| get disk information (3 matches)                     | host-interaction/hardware/storage                    |
| get disk size (2 matches)                            | host-interaction/hardware/storage                    |
| get hostname                                         | host-interaction/os/hostname                         |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| create process on Windows                            | host-interaction/process/create                      |
| create or open registry key (5 matches)              | host-interaction/registry                            |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| query service status (2 matches)                     | host-interaction/service                             |
| start service                                        | host-interaction/service/start                       |
| get token membership                                 | host-interaction/session                             |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
3		- Execution::System Services::Service Execution [T1569.002;3]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 31.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('Antivirus_strings', '50'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['149']
-------------- CAPA_Score ------------
['31.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2989.9984859822557
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F4NA761aB0Mur9ywM2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2116190ae866163ed485c4fd3e13d03b                                                   |
| sha1                   | 664654a40696f13dc8e23bd2df32ba55a6e0da20                                           |
| sha256                 | 608af8aef15ba4f75996d46249a428ebbff1551de06f6eb6a053c2c330da6965                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F4NA761aB0Mur9ywM2.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag                     | anti-analysis/anti-debugging/debugger-detection      |
| get geographical location                            | collection                                           |
| check HTTP status code                               | communication/http/client                            |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes (3 matches)   | host-interaction/driver                              |
| get system information on Windows (3 matches)        | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| terminate process via fastfail (3 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry key (2 matches)          | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| delete registry value (3 matches)                    | host-interaction/registry/delete                     |
| get kernel32 base address (6 matches)                | linking/runtime-linking                              |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Location Discovery [T1614;3]
3		- Execution::System Services::Service Execution [T1569.002;3]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 27.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F4NA761aB0Mur9ywM2.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.18 MB
Data read: 0.17 MB (ratio 1.05:1)
Time: 25.076 sec (0 m 25 s)
Start Date: 2022:01:28 13:21:09
End Date:   2022:01:28 13:21:34

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:21:09Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:21:36Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['27.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
548.697136616442
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FT4AU11GQjf0TYPGQ8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a7f21e412022554d187d6a876a3c08ac                                                   |
| sha1                   | 70e39bdfcaa4bcf0021311e8298266e527cf7c97                                           |
| sha256                 | 9b683d2fda7ca7adcc043e4412271009a0e115ca55f9a718c385a3f46b57ae6b                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FT4AU11GQjf0TYPGQ8.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Application Hook [F0002.001]                                      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| log keystrokes via application hook                  | collection/keylog                                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| find graphical window                                | host-interaction/gui/window/find                     |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| hide graphical window                                | host-interaction/gui/window/hide                     |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Application Window Discovery [T1010;2]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
3		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]

Score total: 11.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FT4AU11GQjf0TYPGQ8.exe: Win.Keylogger.Generic-9937589-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.180 sec (0 m 24 s)
Start Date: 2022:01:28 13:21:37
End Date:   2022:01:28 13:22:01

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Keylogger.Generic-9937589-0

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:21:37Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FT4AU11GQjf0TYPGQ8.exe SCORE: 143 TYPE: EXE SIZE: 24576 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fcb8cb2f670> 
MD5: a7f21e412022554d187d6a876a3c08ac 
SHA1: 70e39bdfcaa4bcf0021311e8298266e527cf7c97 
SHA256: 9b683d2fda7ca7adcc043e4412271009a0e115ca55f9a718c385a3f46b57ae6b CREATED: Fri Jan 28 13:21:37 2022 MODIFIED: Fri Jan 28 13:21:37 2022 ACCESSED: Fri Jan 28 13:22:02 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: CreateFileA
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_4 SUBSCORE: 1 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: USER32.dll Str3: UnhookWindowsHookEx Str4: SetWindowsHookExA Str5: CallNextHookEx
REASON_10: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_11: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_12: Yara Rule MATCH: DarkComet_Keylogs_Memory SUBSCORE: 65 
DESCRIPTION: not set REF: http://www.tekdefense.com/news/2013/12/23/analyzing-darkcomet-in-memory.html AUTHOR: - 
MATCHES: Str1: [DEL]
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:22:02Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
1		ft_exe
1		math_entropy_4
15		dll_injection_hook
1		IsPE32
1		IsConsole
1		HasRichSignature
2		PE_File
35		Win_Hook_v12
5		SEH_Save
5		SEH_Init
65		DarkComet_Keylogs_Memory
1		Contains_PE_File

Score total: 143

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]', '3')]
---------------- ClamAV_Rules --------------
[('Win.Keylogger.Generic-9937589-0', '45')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_4', '1'), ('dll_injection_hook', '15'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Win_Hook_v12', '35'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('DarkComet_Keylogs_Memory', '65'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['143']
-------------- CAPA_Score ------------
['11.0']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
3052.392555173344
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FfEBmT2tXL3BGJMfYi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FfEBmT2tXL3BGJMfYi.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.66 MB
Data read: 0.62 MB (ratio 1.06:1)
Time: 26.907 sec (0 m 26 s)
Start Date: 2022:01:28 13:22:02
End Date:   2022:01:28 13:22:29

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:22:02Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FfEBmT2tXL3BGJMfYi.exe SCORE: 334 TYPE: EXE SIZE: 650752 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7ff0cd661670> 
MD5: a563c50c5fa0fd541248acaf72cc4e7d 
SHA1: 4b8c12b074e20a796071aa50dc82fe2ff755e8f6 
SHA256: 180f82bbedb03dc29328e32e054069870a1e65078b78b2120a84c96aaed7d843 CREATED: Fri Jan 28 13:22:02 2022 MODIFIED: Fri Jan 28 13:22:02 2022 ACCESSED: Fri Jan 28 13:22:29 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: user32.dll Str3: USER32.DLL Str4: USER32.dll Str5: GetDC
REASON_2: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: USER32.DLL Str3: USER32.dll Str4: GetKeyState
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_4: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WritePrivateProfileStringA
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: CreateFileA Str7: FindFirstFileA Str8: Find ... (truncated)
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645d0ccc645d1ccc645d2ccc645 Str2: c645d1ccc645d2ccc645d3ccc645 Str3: c645d2ccc645d3ccc645d4ccc645 Str4: c645d3ccc645d4ccc645d5ccc645 ... (truncated)
REASON_9: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_15: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: USER32.DLL Str3: USER32.dll Str4: UnhookWindowsHookEx Str5: SetWindowsHookExA Str6: CallNextHookEx
REASON_16: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_17: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: IsDebuggerPresent
REASON_19: Yara Rule MATCH: IceID_Bank_trojan SUBSCORE: 60 
DESCRIPTION: Detects IcedID..adjusted several times REF: - AUTHOR: unixfreaxjp 
MATCHES: Str1: MZ Str2: e856740000e978feffff6a0c68586b Str3: CCmdTarget Str4: CUserException Str5: FlsGetValue Str6: AVCShellWrapper@@ Str7: AVCCmdT ... (truncated)
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:22:29Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
80		keylogger
20		win_registry
10		win_private_profile
10		win_files_operation
1		ft_exe
1		math_entropy_6
5		obfuscation_singlebyte_mov
15		dll_injection_hook
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
35		Win_Hook_v12
5		SEH_Save
5		SEH_Init
10		anti_dbg
60		IceID_Bank_trojan
1		Contains_PE_File

Score total: 334

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('screenshot', '65'), ('keylogger', '80'), ('win_registry', '20'), ('win_private_profile', '10'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('obfuscation_singlebyte_mov', '5'), ('dll_injection_hook', '15'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Win_Hook_v12', '35'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('IceID_Bank_trojan', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['334']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5293.543262820119
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FmmoRn2iczlilViCw5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FmmoRn2iczlilViCw5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.68 MB
Data read: 0.64 MB (ratio 1.06:1)
Time: 25.717 sec (0 m 25 s)
Start Date: 2022:01:28 13:22:38
End Date:   2022:01:28 13:23:04

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:22:38Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FmmoRn2iczlilViCw5.exe SCORE: 127 TYPE: EXE SIZE: 673184 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7b96ad3670> 
MD5: f64a684e29e8e117c8b3b1087594a673 
SHA1: b5fabc9d29c542da40b351347a3226cb1e65bb5d 
SHA256: 126ab3b346252be7227fbdc67f9fdc5f66d698df771deb1a1fda6f6b1afe810a CREATED: Fri Jan 28 13:22:38 2022 MODIFIED: Fri Jan 28 13:22:38 2022 ACCESSED: Fri Jan 28 13:23:05 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 1 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPacked SUBSCORE: 5 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: Debugger_Hiding__Thread SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetInformationThread
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
REASON_16: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:23:05Z

-------- Score ----------------
Scores		Rules
.......		...............
1		misc_pe_signature
1		ft_exe
20		research_pe_signed_outside_timestamp
1		math_entropy_close_8
1		IsPE64
2		IsWindowsGUI
5		IsPacked
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
60		Debugger_Hiding__Thread
1		Contains_PE_File
20		SHA2_BLAKE2_IVs
5		BASE64_table

Score total: 127

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f64a684e29e8e117c8b3b1087594a673                                                   |
| sha1                   | b5fabc9d29c542da40b351347a3226cb1e65bb5d                                           |
| sha256                 | 126ab3b346252be7227fbdc67f9fdc5f66d698df771deb1a1fda6f6b1afe810a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FmmoRn2iczlilViCw5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
|                             | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| CRYPTOGRAPHY                | Cryptographic Hash::SHA256 [C0029.003]                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag                     | anti-analysis/anti-debugging/debugger-detection      |
| check for software breakpoints                       | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-VM instructions (161 matches)           | anti-analysis/anti-vm/vm-detection                   |
| encode data using Base64 (2 matches)                 | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (21 matches)                   | data-manipulation/encoding/xor                       |
| hash data using murmur3 (2 matches)                  | data-manipulation/hashing/murmur                     |
| hash data using SHA256                               | data-manipulation/hashing/sha256                     |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes               | host-interaction/driver                              |
| get system information on Windows                    | host-interaction/os/info                             |
| create or open registry key                          | host-interaction/registry                            |
| query or enumerate registry value                    | host-interaction/registry                            |
| parse PE header (9 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
3		- Execution::System Services::Service Execution [T1569.002;3]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 22.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('misc_pe_signature', '1'), ('ft_exe', '1'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_close_8', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('IsPacked', '5'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Debugger_Hiding__Thread', '60'), ('Contains_PE_File', '1'), ('SHA2_BLAKE2_IVs', '20'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['127']
-------------- CAPA_Score ------------
['22.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2451.772063718767
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FgNiKhKsgrcoIqtj6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FgNiKhKsgrcoIqtj6.exe: Win.Trojan.Helminth-3 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.30 MB
Data read: 0.29 MB (ratio 1.05:1)
Time: 25.538 sec (0 m 25 s)
Start Date: 2022:01:28 13:23:21
End Date:   2022:01:28 13:23:47

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Helminth-3

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:23:22Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FgNiKhKsgrcoIqtj6.exe SCORE: 295 TYPE: EXE SIZE: 305664 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fdf94845670> 
MD5: 2a584dfc657348d164274a12bff9bbd8 
SHA1: bfeeba69f3d0f182e877e8a0efa4587fec821176 
SHA256: ef5f06c2d0518c52be10f97bd567210568611f35a954ff32af04c5bf7180bee1 CREATED: Fri Jan 28 13:23:21 2022 MODIFIED: Fri Jan 28 13:23:21 2022 ACCESSED: Fri Jan 28 13:23:47 2022 
REASON_1: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: socket Str3: connect
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegCloseKey
REASON_3: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: Kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: DeleteFileA Str7: CreateFileA
REASON_4: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_5: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_6: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetReadFile
REASON_7: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpQueryInfo
REASON_8: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_17: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_18: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_19: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_20: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_21: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: Kernel32.dll Str2: KERNEL32.dll Str3: IsDebuggerPresent Str4: OutputDebugString
REASON_22: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_23: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 55554444444141411111 Str2: 55554444222222111111 Str3: 55555555555555554444
REASON_24: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Advapi32.dll Str2: ADVAPI32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext
REASON_25: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_26: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
REASON_27: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:23:48Z

-------- Score ----------------
Scores		Rules
.......		...............
50		network_tcp_socket
20		win_registry
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
1		ft_exe
1		math_entropy_6
1		IsPE32
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
5		SEH_Save
5		SEH_Init
10		anti_dbg
1		Contains_PE_File
10		Big_Numbers0
20		Advapi_Hash_API
25		CRC32_poly_Constant
25		CRC32_table
5		BASE64_table

Score total: 295

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2a584dfc657348d164274a12bff9bbd8                                                   |
| sha1                   | bfeeba69f3d0f182e877e8a0efa4587fec821176                                           |
| sha256                 | ef5f06c2d0518c52be10f97bd567210568611f35a954ff32af04c5bf7180bee1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FgNiKhKsgrcoIqtj6.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Send Data [C0002.005]                                     |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::Set Socket Config [C0001.001]                           |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| receive data (2 matches)                             | communication                                        |
| send data (2 matches)                                | communication                                        |
| reference Google Public DNS server                   | communication/dns                                    |
| initialize Winsock library                           | communication/socket                                 |
| set socket configuration                             | communication/socket                                 |
| encode data using Base64 (2 matches)                 | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| encrypt or decrypt via WinCrypt                      | data-manipulation/encryption                         |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| encrypt data using RC4 via WinAPI                    | data-manipulation/encryption/rc4                     |
| hash data via WinCrypt                               | data-manipulation/hashing                            |
| initialize hashing via WinCrypt                      | data-manipulation/hashing                            |
| hash data with MD5                                   | data-manipulation/hashing/md5                        |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments (2 matches)            | host-interaction/cli                                 |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| get thread local storage value                       | host-interaction/process                             |
| terminate process via fastfail                       | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value                    | host-interaction/registry                            |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::File and Directory Discovery [T1083;1]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 44.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Helminth-3', '45')]
-------------- LOKI_Rules ------------
[('network_tcp_socket', '50'), ('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1'), ('Big_Numbers0', '10'), ('Advapi_Hash_API', '20'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['295']
-------------- CAPA_Score ------------
['44.5']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
6129.843083228811
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FVmnFPcY22WbpUgcg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FVmnFPcY22WbpUgcg.exe: Win.Malware.Oski-9882838-1 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.18 MB
Data read: 0.17 MB (ratio 1.05:1)
Time: 26.003 sec (0 m 26 s)
Start Date: 2022:01:28 13:23:54
End Date:   2022:01:28 13:24:20

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Oski-9882838-1

Score total: 50.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:23:54Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FVmnFPcY22WbpUgcg.exe SCORE: 304 TYPE: EXE SIZE: 183296 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7ff3c9883670> 
MD5: fbbaaf569b63f6398503e4f1979cabef 
SHA1: ff86094702212d76922e2300c8868c9398729c33 
SHA256: 0a5de60f8d242caa0bd01cb811358ce2fc9f2f8530013ab650d8ac1950cff5e1 CREATED: Fri Jan 28 13:23:54 2022 MODIFIED: Fri Jan 28 13:23:54 2022 ACCESSED: Fri Jan 28 13:24:20 2022 
REASON_1: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetOpenUrl Str5: InternetReadFile Str6: HttpOpenRequest Str7: HttpSen ... (truncated)
REASON_2: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_3: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_4: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CreateFileA Str7: FindFirstFileA Str8: FindC ... (truncated)
REASON_6: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_7: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_8: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_9: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: win_oski_auto SUBSCORE: 45 
DESCRIPTION: Detects win.oski. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 33c0e92bfeffff8bff558bec8b4508668b08 Str2: 83c120516a006a00 Str3: 25ff7f0000c38bff558bec83ec14ff7510 Str4: 50a1f4c44200508d8df0feffff ... (truncated)
REASON_11: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_17: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_18: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_19: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_22: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:24:20Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_http
65		screenshot
5		win_mutex
20		win_registry
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
1		ft_exe
45		win_oski_auto
1		math_entropy_6
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
5		SEH_Save
5		SEH_Init
10		anti_dbg
1		Contains_PE_File
25		CRC32_poly_Constant
25		CRC32_table

Score total: 304

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | fbbaaf569b63f6398503e4f1979cabef                                                   |
| sha1                   | ff86094702212d76922e2300c8868c9398729c33                                           |
| sha256                 | 0a5de60f8d242caa0bd01cb811358ce2fc9f2f8530013ab650d8ac1950cff5e1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FVmnFPcY22WbpUgcg.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Screen Capture:: \[T1113]\                                                         |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Screen Capture::WinAPI [E1113.m01]                                            |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
| CRYPTOGRAPHY                | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence:: [C0021]                                     |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Compression Library:: [C0060]                                                 |
|                             | Decompress Data::IEncodingFilterFactory [C0025.002]                           |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+----------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                               | NAMESPACE                                            |
|----------------------------------------------------------+------------------------------------------------------|
| capture screenshot                                       | collection/screenshot                                |
| receive data                                             | communication                                        |
| send data (2 matches)                                    | communication                                        |
| connect to HTTP server (2 matches)                       | communication/http/client                            |
| connect to URL                                           | communication/http/client                            |
| decompress HTTP response via IEncodingFilterFactory      | communication/http/client                            |
| decode data using Base64 via WinAPI                      | data-manipulation/encoding/base64                    |
| encode data using XOR (241 matches)                      | data-manipulation/encoding/xor                       |
| encrypt data using DPAPI (3 matches)                     | data-manipulation/encryption/dpapi                   |
| encrypt data using RC4 PRGA                              | data-manipulation/encryption/rc4                     |
| generate random numbers using the Delphi LCG (3 matches) | data-manipulation/prng/lcg                           |
| get common file path (10 matches)                        | host-interaction/file-system                         |
| copy file (5 matches)                                    | host-interaction/file-system/copy                    |
| create directory (2 matches)                             | host-interaction/file-system/create                  |
| delete directory (2 matches)                             | host-interaction/file-system/delete                  |
| delete file (7 matches)                                  | host-interaction/file-system/delete                  |
| check if file exists                                     | host-interaction/file-system/exists                  |
| enumerate files recursively (3 matches)                  | host-interaction/file-system/files/list              |
| get file size (2 matches)                                | host-interaction/file-system/meta                    |
| read .ini file                                           | host-interaction/file-system/read                    |
| read file on Windows (4 matches)                         | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                        | host-interaction/file-system/write                   |
| get memory capacity                                      | host-interaction/hardware/memory                     |
| check mutex and exit                                     | host-interaction/mutex                               |
| get hostname                                             | host-interaction/os/hostname                         |
| get system information on Windows                        | host-interaction/os/info                             |
| check OS version                                         | host-interaction/os/version                          |
| allocate thread local storage                            | host-interaction/process                             |
| create process on Windows (2 matches)                    | host-interaction/process/create                      |
| terminate process (2 matches)                            | host-interaction/process/terminate                   |
| query or enumerate registry key                          | host-interaction/registry                            |
| query or enumerate registry value (4 matches)            | host-interaction/registry                            |
| get session user name                                    | host-interaction/session                             |
| link many functions at runtime (5 matches)               | linking/runtime-linking                              |
| linked against XZip                                      | linking/static/xzip                                  |
| enumerate PE sections (2 matches)                        | load-code/pe                                         |
| parse PE header                                          | load-code/pe                                         |
+----------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
3		- Discovery::Account Discovery [T1087;3]
1		- Discovery::System Information Discovery [T1082;1]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
4		- Collection::Screen Capture [T1113;4]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 45.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Collection::Screen Capture [T1113;4]', '4'), ('- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Oski-9882838-1', '50')]
-------------- LOKI_Rules ------------
[('network_http', '45'), ('screenshot', '65'), ('win_mutex', '5'), ('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '1'), ('win_oski_auto', '45'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25')]
-------------- LOKI_Score ------------
['304']
-------------- CAPA_Score ------------
['45.0']
-------------- CLAMAV_Score ------------
['50.0']
-------------- SCORE FINAL ------------
6345.406052714864
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fb2UhJ1LgAthnMuex9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fb2UhJ1LgAthnMuex9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.23 MB
Data read: 0.22 MB (ratio 1.04:1)
Time: 24.710 sec (0 m 24 s)
Start Date: 2022:01:28 13:24:25
End Date:   2022:01:28 13:24:50

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:24:25Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fb2UhJ1LgAthnMuex9.exe SCORE: 165 TYPE: EXE SIZE: 232677 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f1ecf549670> 
MD5: 2a7429d60040465f9bd27bbae2beef88 
SHA1: e51e65cf9377c74dec0c4fdb1acfb725855ec17d 
SHA256: 943998273af79de9689508f66166c6b33cc2af5c06d9e97fd8db15f0e9b5bdc0 CREATED: Fri Jan 28 13:24:25 2022 MODIFIED: Fri Jan 28 13:24:25 2022 ACCESSED: Fri Jan 28 13:24:51 2022 
REASON_1: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: DNSAPI.dll Str3: DnsQuery
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 1 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsPacked SUBSCORE: 5 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_13: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_14: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: .petite
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:24:51Z

-------- Score ----------------
Scores		Rules
.......		...............
50		network_dns
20		win_registry
10		Str_Win32_Winsock2_Library
1		ft_exe
1		math_entropy_close_8
1		IsPE32
2		IsWindowsGUI
5		IsPacked
1		HasOverlay
1		HasRichSignature
2		PE_File
5		SEH_Save
5		SEH_Init
60		suspicious_packer_section
1		Contains_PE_File

Score total: 165

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_dns', '50'), ('win_registry', '20'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('math_entropy_close_8', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('IsPacked', '5'), ('HasOverlay', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('suspicious_packer_section', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['165']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2615.073767560837
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F0DBUM2MwHQUoARIS7.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F0DBUM2MwHQUoARIS7.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.44 MB
Data read: 0.41 MB (ratio 1.06:1)
Time: 27.077 sec (0 m 27 s)
Start Date: 2022:01:28 13:24:52
End Date:   2022:01:28 13:25:19

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc4 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd4 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdc in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe4 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xec in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf4 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfc in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xef in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xef in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xef in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xef in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xef in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xef in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xef in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xef in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xef in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xef in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xef in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xef in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xef in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xef in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:24:52Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F0DBUM2MwHQUoARIS7.exe SCORE: 884 TYPE: EXE SIZE: 437760 
FIRST_BYTES: 4d5a50000200000004000f00ffff0000b8000000 / <filter object at 0x7faeebb1c670> 
MD5: 5dd0b130d5c3d40c69e3972f39fd7d62 
SHA1: 985c53d34bb0b7c8ddb615b5ec41168dfc96802c 
SHA256: 708967cad421bb2396017bdd10a42e6799da27e29264f4b5fb095c0e3503e447 CREATED: Fri Jan 28 13:24:52 2022 MODIFIED: Fri Jan 28 13:24:52 2022 ACCESSED: Fri Jan 28 13:25:18 2022 
REASON_1: Yara Rule MATCH: network_udp_sock SUBSCORE: 20 
DESCRIPTION: Communications over UDP network REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.DLL Str2: WSAStartup Str3: sendto Str4: recvfrom Str5: WSASendTo Str6: WSARecvFrom
REASON_2: Yara Rule MATCH: network_tcp_listen SUBSCORE: 20 
DESCRIPTION: Listen for incoming communication REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.DLL Str2: bind Str3: accept Str4: GetAcceptExSockaddrs Str5: AcceptEx Str6: WSAStartup Str7: WSAAccept Str8: WSASocket Str9: l ... (truncated)
REASON_3: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.DLL Str2: WSASocket Str3: socket Str4: send Str5: WSASend Str6: WSAConnect Str7: connect Str8: WSAStartup Str9: closesocket St ... (truncated)
REASON_4: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.DLL Str2: gethostbyname Str3: WSAAsyncGetHostByName
REASON_5: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: gdi32.dll Str2: USER32.DLL Str3: User32.dll Str4: user32.dll Str5: BitBlt Str6: GetDC
REASON_6: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.DLL Str2: User32.dll Str3: user32.dll Str4: GetKeyState Str5: MapVirtualKey Str6: GetKeyboardType
REASON_7: Yara Rule MATCH: spreading_file SUBSCORE: 70 
DESCRIPTION: Malware can spread east-west file REF: - AUTHOR: x0r 
MATCHES: Str1: autorun.inf Str2: desktop.ini
REASON_8: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_9: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey
REASON_10: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CreateFileA Str7: FindFirstFileA Str8: FindC ... (truncated)
REASON_11: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.DLL
REASON_12: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: misc_no_dosmode_header SUBSCORE: 10 
DESCRIPTION: Detect on absence of 'DOS Mode' heaader between MZ and PE boundries REF: - AUTHOR: Jason Batchelor
REASON_14: Yara Rule MATCH: win_ordinypt_auto SUBSCORE: 45 
DESCRIPTION: autogenerated rule brought to you by yara-signator REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 66c74304b3d7897308c74324e42e4000c7431c5c2a4000 Str2: 84db7407c60528e945000133c08ac3c68020e9450001 Str3: c705fce84500682d4200c70500e94 ... (truncated)
REASON_15: Yara Rule MATCH: RansomWare_GermanWiper SUBSCORE: 80 
DESCRIPTION: Detects RansomWare GermanWiper in Memory or in unpacked state REF: https://twitter.com/r3c0nst/status/1158326526766657538 AUTHOR: Frank Boldewin (@r3c0nst) 
MATCHES: Str1: 6a008b4708506a006a01e80345fbff50e84d45fbff8bf08bd78bc3e8 Str2: HSDFSD-HFSD-3241-91E7-ASDGSDGHH Str3: cFgxTERNWEVhM2V Str4: oracle.exe ... (truncated)
REASON_16: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: crypto_vertical_transposition_wide SUBSCORE: 5 
DESCRIPTION: Alphabet plaintext writtent in transposition cipher REF: - AUTHOR: - 
MATCHES: Str1: B1F1J1N1R1V Str2: B7F7J7N7R7V Str3: B>F>J>N>R>V Str4: D9H9L9P9T9X Str5: D>H>L>P>T>X Str6: D5H5L5P5T5X Str7: D7H7L7P7T7X Str8: D<H<L<P ... (truncated)
REASON_18: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_21: Yara Rule MATCH: borland_delphi SUBSCORE: 1 
DESCRIPTION: Borland Delphi 2.0 - 7.0 / 2005 - 2007 REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 538bd833c0a3c4c045006a00e82bffffffa364e64500a164e64500a3d0c0450033c0a3d4c0450033c0a3
REASON_22: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_23: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_24: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.DLL Str2: User32.dll Str3: user32.dll Str4: UnhookWindowsHookEx Str5: SetWindowsHookExA Str6: CallNextHookEx
REASON_25: Yara Rule MATCH: MAL_Ransomware_GermanWiper SUBSCORE: 60 
DESCRIPTION: Detects RansomWare GermanWiper in Memory or in unpacked state REF: https://twitter.com/r3c0nst/status/1158326526766657538 AUTHOR: Frank Boldewin (@r3c0nst), modified by Florian Roth 
MATCHES: Str1: HSDFSD-HFSD-3241-91E7-ASDGSDGHH Str2: cFgxTERNWEVhM2V Str3: 6a008b4708506a006a01e80345fbff50e84d45fbff8bf08bd78bc3e8 Str4: sqbcoreser ... (truncated)
REASON_26: Yara Rule MATCH: RansomLocky SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ Str2: vssadmin.exe
REASON_27: Yara Rule MATCH: TrojanGBotSampleA_Malex SUBSCORE: 55 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 85d274248b4af8417f1a50528b42fce85c00000089c258528b48fce8f0e3ffff5a58eb04f0ff42f8871085d274148b4af8497c0ef0ff4af875088d42f8e8e6e1ffffc ... (truncated)
REASON_28: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_29: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
REASON_30: Yara Rule MATCH: Delphi_Random SUBSCORE: 15 
DESCRIPTION: Look for Random function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 5331db699308c045000584080842899308c04500f7e289d05bc3
REASON_31: Yara Rule MATCH: Delphi_FormShow SUBSCORE: 15 
DESCRIPTION: Look for Form.Show function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 538bd8b2018bc3e8e0caffff8bc3e80944feff5bc3
REASON_32: Yara Rule MATCH: Delphi_CompareCall SUBSCORE: 15 
DESCRIPTION: Look for Compare string function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 53565789c689d739d00f848f00000085f6746885ff746b8b46fc8b57fc29d0770201c252c1ea0274268b0e8b1f39d975584a74158b4e048b5f0439d9754b83c60883c ... (truncated)
REASON_33: Yara Rule MATCH: Delphi_Copy SUBSCORE: 15 
DESCRIPTION: Look for Copy function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 5385c0742d8b58fc85db74264a7c1b39da7d1f29d385c97c1939d97f1101c28b442408e8a8fbffffeb1131d2ebe589d9ebeb8b442408e8a5faffff5bc20400
REASON_34: Yara Rule MATCH: Delphi_StrToInt SUBSCORE: 15 
DESCRIPTION: Look for StrToInt function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 535683c4f48bd88bd48bc3e8b0abffff8bf0833c24007419895c2404c64424080b8d542404a1b8d5450033c9e8cffaffff8bc683c40c5e5bc3
REASON_35: Yara Rule MATCH: Delphi_DecodeDate SUBSCORE: 15 
DESCRIPTION: Look for DecodeDate (DecodeDateFully) function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 558bec83c4e85356894df48955f88945fc8b5d08ff7510ff750c8d45e8e85afdffff8b4dec85c97f248b45fc66c70000008b45f866c70000008b45f466c700000066c ... (truncated)
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:25:19Z

-------- Score ----------------
Scores		Rules
.......		...............
20		network_udp_sock
20		network_tcp_listen
50		network_tcp_socket
50		network_dns
65		screenshot
80		keylogger
70		spreading_file
5		win_mutex
20		win_registry
10		win_files_operation
10		Str_Win32_Winsock2_Library
1		ft_exe
10		misc_no_dosmode_header
45		win_ordinypt_auto
80		RansomWare_GermanWiper
1		math_entropy_6
5		crypto_vertical_transposition_wide
15		dll_injection_hook
1		IsPE32
2		IsWindowsGUI
1		borland_delphi
2		PE_File
5		Anti_Automated_Sandbox
35		Win_Hook_v12
60		MAL_Ransomware_GermanWiper
70		RansomLocky
55		TrojanGBotSampleA_Malex
1		Contains_PE_File
5		BASE64_table
15		Delphi_Random
15		Delphi_FormShow
15		Delphi_CompareCall
15		Delphi_Copy
15		Delphi_StrToInt
15		Delphi_DecodeDate

Score total: 884

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5dd0b130d5c3d40c69e3972f39fd7d62                                                   |
| sha1                   | 985c53d34bb0b7c8ddb615b5ec41168dfc96802c                                           |
| sha256                 | 708967cad421bb2396017bdd10a42e6799da27e29264f4b5fb095c0e3503e447                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F0DBUM2MwHQUoARIS7.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
|                        | Screen Capture:: \[T1113]\                                                         |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Indicator Removal on Host::File Deletion \[T1070.004]\                             |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Inhibit System Recovery:: \[T1490]\                                                |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
|                             | Screen Capture::WinAPI [E1113.m01]                                            |
| CRYPTOGRAPHY                | Generate Pseudo-random Sequence:: [C0021]                                     |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Disk Content Wipe::Delete Shadow Drive [F0014.001]                            |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Wallpaper:: [C0035]                                                           |
| PROCESS                     | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| inspect load icon resource                           | anti-analysis                                        |
| check for time delay via GetTickCount (2 matches)    | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-VM instructions (7 matches)             | anti-analysis/anti-vm/vm-detection                   |
| get geographical location (6 matches)                | collection                                           |
| log keystrokes                                       | collection/keylog                                    |
| log keystrokes via polling (7 matches)               | collection/keylog                                    |
| capture screenshot (2 matches)                       | collection/screenshot                                |
| compiled with Borland Delphi                         | compiler/delphi                                      |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| generate random numbers using the Delphi LCG         | data-manipulation/prng/lcg                           |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| manipulate boot configuration (2 matches)            | host-interaction/bootloader                          |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable                           | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| delete file                                          | host-interaction/file-system/delete                  |
| get file size (2 matches)                            | host-interaction/file-system/meta                    |
| get file version info                                | host-interaction/file-system/meta                    |
| read file on Windows (3 matches)                     | host-interaction/file-system/read                    |
| write file on Windows (4 matches)                    | host-interaction/file-system/write                   |
| enumerate gui resources (2 matches)                  | host-interaction/gui                                 |
| set application hook (2 matches)                     | host-interaction/gui                                 |
| set global application hook                          | host-interaction/gui                                 |
| change the wallpaper                                 | host-interaction/gui/session                         |
| find graphical window                                | host-interaction/gui/window/find                     |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| hide graphical window (7 matches)                    | host-interaction/gui/window/hide                     |
| get number of processors                             | host-interaction/hardware/cpu                        |
| get keyboard layout (2 matches)                      | host-interaction/hardware/keyboard/layout            |
| get disk information                                 | host-interaction/hardware/storage                    |
| get disk size                                        | host-interaction/hardware/storage                    |
| create mutex                                         | host-interaction/mutex                               |
| get system information on Windows                    | host-interaction/os/info                             |
| get thread local storage value                       | host-interaction/process                             |
| set thread local storage value                       | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry value (4 matches)        | host-interaction/registry                            |
| get session user name                                | host-interaction/session                             |
| create thread                                        | host-interaction/thread/create                       |
| delete volume shadow copies                          | impact/inhibit-system-recovery                       |
| link many functions at runtime (4 matches)           | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Location Discovery [T1614;3]
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
3		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
8		- Impact::Inhibit System Recovery [T1490;8]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
3		- Discovery::Account Discovery [T1087;3]
2		- Discovery::Application Window Discovery [T1010;2]
4		- Collection::Screen Capture [T1113;4]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
8.5		- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]

Score total: 81.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]', '3'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Impact::Inhibit System Recovery [T1490;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Collection::Screen Capture [T1113;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]', '8.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_udp_sock', '20'), ('network_tcp_listen', '20'), ('network_tcp_socket', '50'), ('network_dns', '50'), ('screenshot', '65'), ('keylogger', '80'), ('spreading_file', '70'), ('win_mutex', '5'), ('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('misc_no_dosmode_header', '10'), ('win_ordinypt_auto', '45'), ('RansomWare_GermanWiper', '80'), ('math_entropy_6', '1'), ('crypto_vertical_transposition_wide', '5'), ('dll_injection_hook', '15'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('borland_delphi', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Win_Hook_v12', '35'), ('MAL_Ransomware_GermanWiper', '60'), ('RansomLocky', '70'), ('TrojanGBotSampleA_Malex', '55'), ('Contains_PE_File', '1'), ('BASE64_table', '5'), ('Delphi_Random', '15'), ('Delphi_FormShow', '15'), ('Delphi_CompareCall', '15'), ('Delphi_Copy', '15'), ('Delphi_StrToInt', '15'), ('Delphi_DecodeDate', '15')]
-------------- LOKI_Score ------------
['884']
-------------- CAPA_Score ------------
['81.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
15626.618296481034
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fx8xbv3F6wg8d8q7d1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5e6764534b3a1e4d3abacc4810b6985d                                                   |
| sha1                   | f10ad287f126f577f197070453812a7e88c2cc52                                           |
| sha256                 | e7d3181ef643d77bb33fe328d1ea58f512b4f27c8e6ed71935a2e7548f2facc0                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fx8xbv3F6wg8d8q7d1.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings targeting VMWare           | anti-analysis/anti-vm/vm-detection                   |
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| enumerate gui resources                              | host-interaction/gui                                 |
| link function at runtime on Windows                  | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]

Score total: 16.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fx8xbv3F6wg8d8q7d1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.77 MB
Data read: 0.72 MB (ratio 1.06:1)
Time: 24.988 sec (0 m 24 s)
Start Date: 2022:01:28 13:26:43
End Date:   2022:01:28 13:27:08

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:26:43Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:27:09Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['16.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
329.21828196986513
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FGsJe72cV6VJ6qdSl8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be a .NET module.
WARNING:capa: 
WARNING:capa: .NET is a cross-platform framework for running managed applications.
WARNING:capa: capa cannot handle non-native files. This means that the results may be misleading or incomplete.
WARNING:capa: You may have to analyze the file manually, using a tool like the .NET decompiler dnSpy.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) dotnet file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FGsJe72cV6VJ6qdSl8.exe: Win.Malware.Zusy-6866357-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FGsJe72cV6VJ6qdSl8.exe: Win.Packed.Bladabindi-6866359-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 23.701 sec (0 m 23 s)
Start Date: 2022:01:28 13:27:10
End Date:   2022:01:28 13:27:33

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Zusy-6866357-0
40		Win.Packed.Bladabindi-6866359-0

Score total: 90.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:27:10Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:27:34Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Zusy-6866357-0', '50'), ('Win.Packed.Bladabindi-6866359-0', '40')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['90.0']
-------------- SCORE FINAL ------------
1133.0328706147507
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FxNI2I3GFCFad9GsRg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3f8e2b945deba235fa4888682bd0d640                                                   |
| sha1                   | d4e234ec4baf7d12dd59c3a9238326819a509a31                                           |
| sha256                 | 75eb05679a0a988dddf8badfc6d5996cc7e372c73e1023dde59efbaab6ece655                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FxNI2I3GFCFad9GsRg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                         |
| DISCOVERY              | System Network Configuration Discovery::Internet Connection Discovery \[T1016.001]\ |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Set Registry Key [C0036.001]                                        |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| receive data                                         | communication                                        |
| copy file                                            | host-interaction/file-system/copy                    |
| create directory                                     | host-interaction/file-system/create                  |
| delete file                                          | host-interaction/file-system/delete                  |
| check Internet connectivity via WinINet              | host-interaction/network/connectivity                |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
2		- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 28.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FxNI2I3GFCFad9GsRg.exe: Win.Trojan.Agent-6298583-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 24.044 sec (0 m 24 s)
Start Date: 2022:01:28 13:27:34
End Date:   2022:01:28 13:27:58

-------- Score ----------------
Scores		Rules
.......		...............
70		Win.Trojan.Agent-6298583-0
75		Win.Trojan.Agent-6298583-0
45		Win.Trojan.Agent-6298583-0

Score total: 190.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:27:35Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FxNI2I3GFCFad9GsRg.exe SCORE: 73 TYPE: EXE SIZE: 40960 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7feb8f097670> 
MD5: 3f8e2b945deba235fa4888682bd0d640 
SHA1: d4e234ec4baf7d12dd59c3a9238326819a509a31 
SHA256: 75eb05679a0a988dddf8badfc6d5996cc7e372c73e1023dde59efbaab6ece655 CREATED: Fri Jan 28 13:27:34 2022 MODIFIED: Fri Jan 28 13:27:34 2022 ACCESSED: Fri Jan 28 13:27:59 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegOpenKeyExA Str3: RegSetValueExA
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CopyFile
REASON_3: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_4: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetOpen
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_4 SUBSCORE: 1 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion
REASON_12: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_13: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:27:59Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
1		ft_exe
1		math_entropy_4
1		IsPE32
1		IsConsole
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
5		SEH_Save
5		SEH_Init
1		Contains_PE_File

Score total: 73

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]', '2'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Agent-6298583-0', '70'), ('Win.Trojan.Agent-6298583-0', '75'), ('Win.Trojan.Agent-6298583-0', '45')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('ft_exe', '1'), ('math_entropy_4', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['73']
-------------- CAPA_Score ------------
['28.0']
-------------- CLAMAV_Score ------------
['190.0']
-------------- SCORE FINAL ------------
4107.603761096817
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FH2UWcc9D6LzQQwac.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 89e7c865c8d862c55404b8b9a5f4b371                                                   |
| sha1                   | 54f5e4c43388c958a1ed947e2bb9e0e5d8a43277                                           |
| sha256                 | b48d5b58d9bbf92fbffba06d98e695218676d3ba1d4a060c08e3b9ef1650110c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FH2UWcc9D6LzQQwac.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FH2UWcc9D6LzQQwac.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.08 MB
Data read: 0.08 MB (ratio 1.00:1)
Time: 23.936 sec (0 m 23 s)
Start Date: 2022:01:28 13:27:59
End Date:   2022:01:28 13:28:23

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:27:59Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:28:24Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
79.81049259875519
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fpaxv04RXzyDLLCapd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fpaxv04RXzyDLLCapd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.65 MB
Data read: 0.62 MB (ratio 1.06:1)
Time: 25.671 sec (0 m 25 s)
Start Date: 2022:01:28 13:28:24
End Date:   2022:01:28 13:28:50

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb5 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:28:25Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fpaxv04RXzyDLLCapd.exe SCORE: 364 TYPE: EXE SIZE: 647680 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fed836f5670> 
MD5: c3341b7dfbb9d43bca8c812e07b4299f 
SHA1: 3a3e93cffca2a2cbaca24cb89cf8797c9aad7f97 
SHA256: 17e53dc9559040773a1a3537f7d1c0ebe38929b905cb998f5c4cd9a2e435627f CREATED: Fri Jan 28 13:28:24 2022 MODIFIED: Fri Jan 28 13:28:24 2022 ACCESSED: Fri Jan 28 13:28:50 2022 
REASON_1: Yara Rule MATCH: cred_local SUBSCORE: 80 
DESCRIPTION: Steal credential REF: - AUTHOR: x0r 
MATCHES: Str1: LsaEnumerateLogonSessions
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344532ab5430fcd18f94cb71bbe683db605a001000000633a5c55736572735c546573745c70726f6a656374735c6e65775f727573745f70726f6a6563745c72656 ... (truncated)
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: SOFTWARE\Microsoft\Windows\CurrentVersion Str2: dbghelp.dll
REASON_13: Yara Rule MATCH: antisb_threatExpert SUBSCORE: 60 
DESCRIPTION: Anti-Sandbox checks for ThreatExpert REF: - AUTHOR: x0r 
MATCHES: Str1: dbghelp.dll
REASON_14: Yara Rule MATCH: SEH__vectored_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: AddVectoredExceptionHandler
REASON_15: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_16: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_17: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 44444444444444444444444444444444
REASON_20: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
REASON_21: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
REASON_22: Yara Rule MATCH: SipHash_big_endian_constants SUBSCORE: 15 
DESCRIPTION: Look for SipHash constants in big endian REF: https://131002.net/siphash/siphash.pdf#page=6 AUTHOR: spelissier 
MATCHES: Str1: uespemos Str2: modnarod Str3: arenegyl Str4: setybdet
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:28:52Z

-------- Score ----------------
Scores		Rules
.......		...............
80		cred_local
20		win_registry
10		win_files_operation
1		ft_exe
50		ConventionEngine_Term_Users
1		math_entropy_6
1		IsPE32
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
60		antisb_threatExpert
60		SEH__vectored_v1
5		SEH_Save
5		SEH_Init
10		anti_dbg
1		Contains_PE_File
10		Big_Numbers1
20		SHA2_BLAKE2_IVs
5		BASE64_table
15		SipHash_big_endian_constants

Score total: 364

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c3341b7dfbb9d43bca8c812e07b4299f                                                   |
| sha1                   | 3a3e93cffca2a2cbaca24cb89cf8797c9aad7f97                                           |
| sha256                 | 17e53dc9559040773a1a3537f7d1c0ebe38929b905cb998f5c4cd9a2e435627f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fpaxv04RXzyDLLCapd.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-VM instructions (3 matches)             | anti-analysis/anti-vm/vm-detection                   |
| compiled with rust                                   | compiler/rust                                        |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA (3 matches)              | data-manipulation/encryption/rc4                     |
| hash data using murmur3                              | data-manipulation/hashing/murmur                     |
| contains PDB path                                    | executable/pe/pdb                                    |
| list groups for user account                         | host-interaction/accounts                            |
| list user accounts                                   | host-interaction/accounts                            |
| accept command line arguments                        | host-interaction/cli                                 |
| interact with driver via control codes               | host-interaction/driver                              |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| read file on Windows (3 matches)                     | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| references logon banner                              | host-interaction/gui/logon                           |
| get hostname                                         | host-interaction/os/hostname                         |
| allocate thread local storage                        | host-interaction/process                             |
| get thread local storage value (9 matches)           | host-interaction/process                             |
| set thread local storage value (10 matches)          | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| set registry value                                   | host-interaction/registry/create                     |
| get logon sessions                                   | host-interaction/session                             |
| get kernel32 base address                            | linking/runtime-linking                              |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| enumerate PE sections (23 matches)                   | load-code/pe                                         |
| parse PE exports (47 matches)                        | load-code/pe                                         |
| parse PE header (102 matches)                        | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::File and Directory Discovery [T1083;1]
3		- Discovery::Account Discovery [T1087;3]
1		- Discovery::System Information Discovery [T1082;1]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
3		- Execution::System Services::Service Execution [T1569.002;3]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 29.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('cred_local', '80'), ('win_registry', '20'), ('win_files_operation', '10'), ('ft_exe', '1'), ('ConventionEngine_Term_Users', '50'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('antisb_threatExpert', '60'), ('SEH__vectored_v1', '60'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1'), ('Big_Numbers1', '10'), ('SHA2_BLAKE2_IVs', '20'), ('BASE64_table', '5'), ('SipHash_big_endian_constants', '15')]
-------------- LOKI_Score ------------
['364']
-------------- CAPA_Score ------------
['29.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6347.6372918994275
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FOP8ZXoVutQb4UPE2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9de952f476abab0cd62bfd81e20a3deb                                                   |
| sha1                   | 109cc4467b78dad4b12a3225020ea590bccee3e6                                           |
| sha256                 | e9cb6336359ac6f71ac75af2836efb28daa3bafd10a1f0b775dcdc2ec8850a6b                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FOP8ZXoVutQb4UPE2.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                            |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DEFENSE EVASION             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| create new key via CryptAcquireContext               | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt                      | data-manipulation/encryption                         |
| encrypt data using AES via WinAPI                    | data-manipulation/encryption/aes                     |
| hash data via WinCrypt                               | data-manipulation/hashing                            |
| initialize hashing via WinCrypt                      | data-manipulation/hashing                            |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path (11 matches)                    | host-interaction/file-system                         |
| create directory (3 matches)                         | host-interaction/file-system/create                  |
| delete file (3 matches)                              | host-interaction/file-system/delete                  |
| check if file exists (4 matches)                     | host-interaction/file-system/exists                  |
| enumerate files recursively (2 matches)              | host-interaction/file-system/files/list              |
| get file size (2 matches)                            | host-interaction/file-system/meta                    |
| get file version info                                | host-interaction/file-system/meta                    |
| set file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| create shortcut via IShellLink                       | host-interaction/file-system/write                   |
| write file on Windows                                | host-interaction/file-system/write                   |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| check mutex (3 matches)                              | host-interaction/mutex                               |
| create mutex (2 matches)                             | host-interaction/mutex                               |
| get system information on Windows                    | host-interaction/os/info                             |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (6 matches)        | host-interaction/registry                            |
| set registry value (6 matches)                       | host-interaction/registry/create                     |
| delete registry value (2 matches)                    | host-interaction/registry/delete                     |
| create thread                                        | host-interaction/thread/create                       |
| link function at runtime on Windows (6 matches)      | linking/runtime-linking                              |
| parse PE header (5 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::File and Directory Discovery [T1083;1]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
4		- Defense Evasion::File and Directory Permissions Modification [T1222;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 44.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FOP8ZXoVutQb4UPE2.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 24.656 sec (0 m 24 s)
Start Date: 2022:01:28 13:29:50
End Date:   2022:01:28 13:30:15

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:29:50Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FOP8ZXoVutQb4UPE2.exe SCORE: 150 TYPE: EXE SIZE: 77824 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fbda6d58670> 
MD5: 9de952f476abab0cd62bfd81e20a3deb 
SHA1: 109cc4467b78dad4b12a3225020ea590bccee3e6 
SHA256: e9cb6336359ac6f71ac75af2836efb28daa3bafd10a1f0b775dcdc2ec8850a6b CREATED: Fri Jan 28 13:29:50 2022 MODIFIED: Fri Jan 28 13:29:50 2022 ACCESSED: Fri Jan 28 13:30:16 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_14: Yara Rule MATCH: skip20_sqllang_hook SUBSCORE: 60 
DESCRIPTION: YARA rule to detect if a sqllang.dll version is targeted by skip-2.0. Each byte pattern corresponds to a function hooked by skip-2.0. If _0 or _1 match, it is probably targeted as it corresponds to the hook responsible for bypassing the authentication. REF: https://www.welivesecurity.com/ AUTHOR: Mathieu Tartare <mathieu.tartare@eset.com> 
MATCHES: Str1: 8bc1488b8c24300200004833cc
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:30:16Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
20		win_registry
10		win_token
10		win_files_operation
1		ft_exe
1		math_entropy_5
1		IsPE64
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
10		anti_dbg
60		skip20_sqllang_hook
1		Contains_PE_File
20		Advapi_Hash_API

Score total: 150

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]', '8.5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Defense Evasion::File and Directory Permissions Modification [T1222;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('win_registry', '20'), ('win_token', '10'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('anti_dbg', '10'), ('skip20_sqllang_hook', '60'), ('Contains_PE_File', '1'), ('Advapi_Hash_API', '20')]
-------------- LOKI_Score ------------
['150']
-------------- CAPA_Score ------------
['44.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3265.2315188528214
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FSgTW81IHrYGeFJqM6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:30:16Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:30:42Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FSgTW81IHrYGeFJqM6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 6.33 MB
Data read: 5.95 MB (ratio 1.06:1)
Time: 27.148 sec (0 m 27 s)
Start Date: 2022:01:28 13:30:16
End Date:   2022:01:28 13:30:43

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 22eb6c0cdc1c8b41e079c1d6ed625973                                                   |
| sha1                   | a014d18763e071d2b2bfc552e32598b138cfdf77                                           |
| sha256                 | 01179d6668a3aa00affc7481d53894233cc8f53eb2af23d4cc148e8bef904db2                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FSgTW81IHrYGeFJqM6.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings targeting Xen              | anti-analysis/anti-vm/vm-detection                   |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 8.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['8.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
169.59729677235478
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FF5XcF1qvntGsY9Rf6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | bbdd0cfa22609724363ff4437bb47959                                                   |
| sha1                   | 68ecb50c8caa2a7205ccd50b194a43664bfde5ef                                           |
| sha256                 | b1f134a7183435671af8c9c1592d9662c1b4e1788577eb5bffa5b9e8caae148d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FF5XcF1qvntGsY9Rf6.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FF5XcF1qvntGsY9Rf6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 24.969 sec (0 m 24 s)
Start Date: 2022:01:28 13:30:45
End Date:   2022:01:28 13:31:10

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:30:45Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:31:11Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
39.905246299377595
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Ftd4Uo3lawh3IV2uab.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Ftd4Uo3lawh3IV2uab.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.28 MB
Data read: 0.27 MB (ratio 1.06:1)
Time: 25.300 sec (0 m 25 s)
Start Date: 2022:01:28 13:31:12
End Date:   2022:01:28 13:31:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:31:12Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Ftd4Uo3lawh3IV2uab.exe SCORE: 125 TYPE: EXE SIZE: 280576 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fc6d868f670> 
MD5: a5018ebb1a375f9bcf404b621c536426 
SHA1: 362280bcd1f26eca4943f2210160834fcc20da2e 
SHA256: b936f68a90d7a8e2a1e19826c6284abe2aa5cc4131bf231d1f1f08d664425d44 CREATED: Fri Jan 28 13:31:12 2022 MODIFIED: Fri Jan 28 13:31:12 2022 ACCESSED: Fri Jan 28 13:31:38 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
REASON_16: Yara Rule MATCH: Crypt32_CryptBinaryToString_API SUBSCORE: 25 
DESCRIPTION: Looks for crypt32 CryptBinaryToStringA function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: CRYPT32.dll Str2: CryptBinaryToStringA
REASON_17: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:31:38Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		ft_exe
1		math_entropy_6
1		IsPE64
1		IsDLL
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
1		Contains_PE_File
20		Advapi_Hash_API
25		Crypt32_CryptBinaryToString_API
5		BASE64_table

Score total: 125

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a5018ebb1a375f9bcf404b621c536426                                                   |
| sha1                   | 362280bcd1f26eca4943f2210160834fcc20da2e                                           |
| sha256                 | b936f68a90d7a8e2a1e19826c6284abe2aa5cc4131bf231d1f1f08d664425d44                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Ftd4Uo3lawh3IV2uab.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-debugging instructions                  | anti-analysis/anti-debugging/debugger-detection      |
| decode data using Base64 via WinAPI                  | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (4 matches)                    | data-manipulation/encoding/xor                       |
| encrypt or decrypt data via BCrypt                   | data-manipulation/encryption                         |
| encrypt data using DPAPI (4 matches)                 | data-manipulation/encryption/dpapi                   |
| hash data via BCrypt (4 matches)                     | data-manipulation/hashing                            |
| hash data using murmur3                              | data-manipulation/hashing/murmur                     |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (5 matches)           | host-interaction/process/terminate                   |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (5 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]

Score total: 18.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('Contains_PE_File', '1'), ('Advapi_Hash_API', '20'), ('Crypt32_CryptBinaryToString_API', '25'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['125']
-------------- CAPA_Score ------------
['18.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2350.2400188456345
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F0gppF41XkClXzOyR4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6fcc13563aad936c7d0f3165351cb453                                                   |
| sha1                   | 8b1757b95b7b7f9c4dfa09b52b0d3c6451b269fc                                           |
| sha256                 | 093c81f0b234c2aa0363129fdaaaf57551f161915da3d23f43a792b5f3024c1e                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F0gppF41XkClXzOyR4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Checksum::Luhn [C0032.002]                                                    |
|                             | Encode Data::Base64 [C0026.001]                                               |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| send data                                            | communication                                        |
| connect to HTTP server                               | communication/http/client                            |
| validate payment card number using luhn algorithm    | data-manipulation/checksum/luhn                      |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| allocate thread local storage                        | host-interaction/process                             |
| read process memory                                  | host-interaction/process                             |
| enumerate processes                                  | host-interaction/process/list                        |
| acquire debug privileges                             | host-interaction/process/modify                      |
| modify access privileges                             | host-interaction/process/modify                      |
| terminate process                                    | host-interaction/process/terminate                   |
| get session user name                                | host-interaction/session                             |
| access PEB ldr_data                                  | linking/runtime-linking                              |
| link many functions at runtime                       | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
3		- Discovery::System Owner/User Discovery [T1033;3]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
3		- Discovery::Account Discovery [T1087;3]
2		- Discovery::Software Discovery [T1518;2]
2		- Execution::Shared Modules [T1129;2]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]

Score total: 34.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F0gppF41XkClXzOyR4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 24.828 sec (0 m 24 s)
Start Date: 2022:01:28 13:31:45
End Date:   2022:01:28 13:32:10

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe4 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9d in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9d in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:31:45Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F0gppF41XkClXzOyR4.exe SCORE: 435 TYPE: EXE SIZE: 95232 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f68a2f44670> 
MD5: 6fcc13563aad936c7d0f3165351cb453 
SHA1: 8b1757b95b7b7f9c4dfa09b52b0d3c6451b269fc 
SHA256: 093c81f0b234c2aa0363129fdaaaf57551f161915da3d23f43a792b5f3024c1e CREATED: Fri Jan 28 13:31:45 2022 MODIFIED: Fri Jan 28 13:31:45 2022 ACCESSED: Fri Jan 28 13:32:11 2022 
REASON_1: Malware Hash TYPE: SHA256 HASH: 093c81f0b234c2aa0363129fdaaaf57551f161915da3d23f43a792b5f3024c1e SUBSCORE: 100 DESC: Kronos Banking Trojan Used to Deliver New Point-of-Sale Malware https://www.proofpoint.com/us/threat-insight/post/kronos-banking-trojan-used-to-
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: HttpOpenRequest Str5: HttpSendRequest
REASON_3: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken
REASON_5: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_6: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetConnect Str2: InternetOpen
REASON_7: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_8: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: win_scanpos_auto SUBSCORE: 45 
DESCRIPTION: Detects win.scanpos. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 03c703cf83ff1f0f87a4030000ff24bd0ce640008bc6e998030000 Str2: c745fc00000000807dd800750aba04000000e9c2000000c645fc018b16 Str3: 5dc38d4 ... (truncated)
REASON_10: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344539d555c0350104c409f8f5859b0a35bf401000000433a5c55736572735c6578616d706c655c646f63756d656e74735c76697375616c2073747564696f20323 ... (truncated)
REASON_11: Yara Rule MATCH: ConventionEngine_Term_VisualStudio SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344539d555c0350104c409f8f5859b0a35bf401000000433a5c55736572735c6578616d706c655c646f63756d656e74735c76697375616c2073747564696f20323 ... (truncated)
REASON_12: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_16: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_17: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_19: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_20: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_21: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:32:11Z

-------- Score ----------------
Scores		Rules
.......		...............
100		Malware Hash
45		network_http
70		escalate_priv
10		win_token
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
1		ft_exe
45		win_scanpos_auto
50		ConventionEngine_Term_Users
50		ConventionEngine_Term_VisualStudio
1		math_entropy_6
1		IsPE32
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
5		SEH_Save
5		SEH_Init
10		anti_dbg
1		Contains_PE_File
5		BASE64_table

Score total: 435

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::Software Discovery [T1518;2]', '2'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('Malware Hash', '100'), ('network_http', '45'), ('escalate_priv', '70'), ('win_token', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '1'), ('win_scanpos_auto', '45'), ('ConventionEngine_Term_Users', '50'), ('ConventionEngine_Term_VisualStudio', '50'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['435']
-------------- CAPA_Score ------------
['34.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
7582.650885870106
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FnurRF4SQSiQgFzeB5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FnurRF4SQSiQgFzeB5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.37 MB
Data read: 0.08 MB (ratio 4.70:1)
Time: 24.689 sec (0 m 24 s)
Start Date: 2022:01:28 13:32:11
End Date:   2022:01:28 13:32:36

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:32:11Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FnurRF4SQSiQgFzeB5.exe SCORE: 79 TYPE: EXE SIZE: 82432 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd76986c670> 
MD5: 2055994ff75b4309eee3a49c5749d306 
SHA1: 8c6f43fc11e74af34f74f1afe2edd2797f05c311 
SHA256: 8a6280552c11e62a43b8cb171e3eb95e9c004b0bb217f8ba420f59c94b73c5a2 CREATED: Fri Jan 28 13:32:11 2022 MODIFIED: Fri Jan 28 13:32:11 2022 ACCESSED: Fri Jan 28 13:32:36 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 1 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPacked SUBSCORE: 5 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_10: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: .aspack Str2: .adata
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:32:36Z

-------- Score ----------------
Scores		Rules
.......		...............
1		ft_exe
1		math_entropy_close_8
1		IsPE32
1		IsConsole
5		IsPacked
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
60		suspicious_packer_section
1		Contains_PE_File

Score total: 79

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '1'), ('math_entropy_close_8', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('IsPacked', '5'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('suspicious_packer_section', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['79']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1252.0656220442795
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F0Tof4wMOO2lHeDQk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | dfa95cf9ed03219827e5522d30d6c100                                                   |
| sha1                   | aaeafbabca133d19c49ecf1189dafb1c5ef45ef2                                           |
| sha256                 | 1a603726412f20385c8e488c9342c0da74210adf85395458b30b9ad59f78576f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F0Tof4wMOO2lHeDQk.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)  | executable/resource                                  |
| get file system object information                   | host-interaction/file-system                         |
| read .ini file (3 matches)                           | host-interaction/file-system/read                    |
| print debug messages (2 matches)                     | host-interaction/log/debug/write-event               |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value (4 matches)                       | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| link function at runtime on Windows                  | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 8.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F0Tof4wMOO2lHeDQk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 25.037 sec (0 m 25 s)
Start Date: 2022:01:28 13:32:36
End Date:   2022:01:28 13:33:01

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:32:36Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F0Tof4wMOO2lHeDQk.exe SCORE: 160 TYPE: EXE SIZE: 66048 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7ef9f69670> 
MD5: dfa95cf9ed03219827e5522d30d6c100 
SHA1: aaeafbabca133d19c49ecf1189dafb1c5ef45ef2 
SHA256: 1a603726412f20385c8e488c9342c0da74210adf85395458b30b9ad59f78576f CREATED: Fri Jan 28 13:32:36 2022 MODIFIED: Fri Jan 28 13:32:36 2022 ACCESSED: Fri Jan 28 13:33:02 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:33:02Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
1		ft_exe
1		math_entropy_5
1		IsPE64
1		IsDLL
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
1		Contains_PE_File

Score total: 160

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('Check_OutputDebugStringA_iat_v1', '30'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['160']
-------------- CAPA_Score ------------
['8.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2705.426404710136
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FTGRFQ3Fm6XwawOK4l.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | d2cdbfcf382759848b76a2ac3422b491                                                   |
| sha1                   | edc3e444b5c046a47e58144977393a5b97b9158e                                           |
| sha256                 | be8040bd37a6868acb65672d94336ef62f831ca2100297744bcabadbc7f1d200                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FTGRFQ3Fm6XwawOK4l.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get thread local storage value                       | host-interaction/process                             |
| query or enumerate registry value                    | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| create thread                                        | host-interaction/thread/create                       |
| resume thread                                        | host-interaction/thread/resume                       |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Discovery::Query Registry [T1012;1]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 5.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FTGRFQ3Fm6XwawOK4l.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.372 sec (0 m 24 s)
Start Date: 2022:01:28 13:33:02
End Date:   2022:01:28 13:33:27

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:33:03Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FTGRFQ3Fm6XwawOK4l.exe SCORE: 115 TYPE: EXE SIZE: 16384 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f442f28b670> 
MD5: d2cdbfcf382759848b76a2ac3422b491 
SHA1: edc3e444b5c046a47e58144977393a5b97b9158e 
SHA256: be8040bd37a6868acb65672d94336ef62f831ca2100297744bcabadbc7f1d200 CREATED: Fri Jan 28 13:33:02 2022 MODIFIED: Fri Jan 28 13:33:02 2022 ACCESSED: Fri Jan 28 13:33:28 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_4 SUBSCORE: 1 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:33:28Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
10		win_token
1		ft_exe
1		math_entropy_4
1		IsPE64
1		IsDLL
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
1		Contains_PE_File

Score total: 115

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '10'), ('ft_exe', '1'), ('math_entropy_4', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['115']
-------------- CAPA_Score ------------
['5.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1932.3665986535686
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Flg4mT38GuicgAA585.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 80372de850597bd9e7e021a94f13f0a1                                                   |
| sha1                   | 037db820c8dee94ae25a439b758a2b89f527cbb4                                           |
| sha256                 | 2520b15068fa108c947db179377c6b462f2c4f47037168bf8c69fcb668cb11a8                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Flg4mT38GuicgAA585.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| CRYPTOGRAPHY                | Cryptographic Hash::SHA256 [C0029.003]                                        |
|                             | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key::RC4 KSA [C0028.002]                                           |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain obfuscated stackstrings (2 matches)          | anti-analysis/obfuscation/string/stackstring         |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (11 matches)                   | data-manipulation/encoding/xor                       |
| encrypt data using Curve25519 (2 matches)            | data-manipulation/encryption/elliptic-curve          |
| encrypt data using RC4 KSA                           | data-manipulation/encryption/rc4                     |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| hash data using murmur3 (2 matches)                  | data-manipulation/hashing/murmur                     |
| hash data using SHA256                               | data-manipulation/hashing/sha256                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| enumerate PE sections (4 matches)                    | load-code/pe                                         |
| parse PE exports (6 matches)                         | load-code/pe                                         |
| parse PE header (20 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 8.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Flg4mT38GuicgAA585.exe: Win.Ransomware.Netwalker-7671868-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-Flg4mT38GuicgAA585.exe: Win.Ransomware.Razy-9848777-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 24.525 sec (0 m 24 s)
Start Date: 2022:01:28 13:33:28
End Date:   2022:01:28 13:33:52

-------- Score ----------------
Scores		Rules
.......		...............
80		Win.Ransomware.Netwalker-7671868-0
80		Win.Ransomware.Razy-9848777-0

Score total: 160.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 2-3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 5-6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:33:28Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Flg4mT38GuicgAA585.exe SCORE: 314 TYPE: EXE SIZE: 70656 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3974df8670> 
MD5: 80372de850597bd9e7e021a94f13f0a1 
SHA1: 037db820c8dee94ae25a439b758a2b89f527cbb4 
SHA256: 2520b15068fa108c947db179377c6b462f2c4f47037168bf8c69fcb668cb11a8 CREATED: Fri Jan 28 13:33:28 2022 MODIFIED: Fri Jan 28 13:33:28 2022 ACCESSED: Fri Jan 28 13:33:53 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: win_mailto_auto SUBSCORE: 45 
DESCRIPTION: Detects win.mailto. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 8b7c2410c1f81ac1f91f23c88bc1c1e01a2bf8 Str2: 03c0505655e8588e00008b742430 Str3: 85ed7ea4660f1f440000803c1e2e757656e844410000 Str4: 8b ... (truncated)
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_7: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: netwalker_ransomware_v1 SUBSCORE: 60 
DESCRIPTION: Rule to detect Netwalker ransomware REF: https://www.ccn-cert.cni.es/comunicacion-eventos/comunicados-ccn-cert/9802-publicado-un-informe-de-codigo-danino-sobre-netwalker.html AUTHOR: McAfee ATR Team 
MATCHES: Str1: cccccccccca170124100c3cccccccccccccccccccc538b5c24085533ed5785db747f8b7c241485ff74778b431085c07470c1e00250e8fb0e000083c404890785c0745 ... (truncated)
REASON_9: Yara Rule MATCH: Netwalker_v1 SUBSCORE: 60 
DESCRIPTION: Rule based on code overlap in RagnarLocker ransomware REF: - AUTHOR: McAfee ATR team 
MATCHES: Str1: c88bf28b4330f76f3803c88b434813f2f76f2003c88b433813f2f76f3003c88b434013f2f76f2803c88b432813f2f76f4003c8894d6813f289756c8b4338f76f388bc ... (truncated)
REASON_10: Yara Rule MATCH: Netwalker SUBSCORE: 60 
DESCRIPTION: Detects Netwalker Ransomware REF: https://github.com/f0wl/configwalker AUTHOR: Marius 'f0wL' Genheimer <hello@dissectingmalwa.re> 
MATCHES: Str1: svcwait Str2: mscfile Str3: pspath Str4: mode Str5: spsz Str6: idsz Str7: onion1 Str8: onion2 Str9: lfile Str10: lend Str11: white St ... (truncated)
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_13: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
REASON_14: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
REASON_15: Yara Rule MATCH: Chacha_128_constant SUBSCORE: 15 
DESCRIPTION: Look for 128-bit key Chacha stream cipher constant REF: https://www.ecrypt.eu.org/stream/salsa20pf.html AUTHOR: spelissier 
MATCHES: Str1: expand 16-byte k
REASON_16: Yara Rule MATCH: Chacha_256_constant SUBSCORE: 15 
DESCRIPTION: Look for 256-bit key Chacha stream cipher constant REF: https://tools.ietf.org/html/rfc8439#page-8 AUTHOR: spelissier 
MATCHES: Str1: expand 32-byte k Str2: expand 3 Str3: 2-byte k
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:33:54Z

-------- Score ----------------
Scores		Rules
.......		...............
1		ft_exe
45		win_mailto_auto
1		math_entropy_6
1		IsPE32
2		IsWindowsGUI
1		HasDebugData
2		PE_File
60		netwalker_ransomware_v1
60		Netwalker_v1
60		Netwalker
1		Contains_PE_File
25		CRC32_poly_Constant
20		SHA2_BLAKE2_IVs
5		BASE64_table
15		Chacha_128_constant
15		Chacha_256_constant

Score total: 314

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('Win.Ransomware.Netwalker-7671868-0', '80'), ('Win.Ransomware.Razy-9848777-0', '80')]
-------------- LOKI_Rules ------------
[('ft_exe', '1'), ('win_mailto_auto', '45'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('PE_File', '2'), ('netwalker_ransomware_v1', '60'), ('Netwalker_v1', '60'), ('Netwalker', '60'), ('Contains_PE_File', '1'), ('CRC32_poly_Constant', '25'), ('SHA2_BLAKE2_IVs', '20'), ('BASE64_table', '5'), ('Chacha_128_constant', '15'), ('Chacha_256_constant', '15')]
-------------- LOKI_Score ------------
['314']
-------------- CAPA_Score ------------
['8.0']
-------------- CLAMAV_Score ------------
['160.0']
-------------- SCORE FINAL ------------
7150.466268396074
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F4rTAS39C53ECgWPG1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6242e3d67787ccbf4e06ad2982853144                                                   |
| sha1                   | 6ac7947207d999a65890ab25fe344955da35028e                                           |
| sha256                 | 4ca10dba7ff487fdb3f1362a3681d7d929f5aa1262cdfd31b04c30826983fb1d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F4rTAS39C53ECgWPG1.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | ICMP Communication::Echo Request [C0014.002]                                  |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| send ICMP echo request                               | communication/icmp                                   |
| initialize Winsock library                           | communication/socket                                 |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| resolve DNS (4 matches)                              | host-interaction/network/dns/resolve                 |
| get routing table                                    | host-interaction/network/routing-table               |
| query or enumerate registry value                    | host-interaction/registry                            |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Network Configuration Discovery [T1016;3]

Score total: 15.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F4rTAS39C53ECgWPG1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 24.501 sec (0 m 24 s)
Start Date: 2022:01:28 13:33:54
End Date:   2022:01:28 13:34:18

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:33:54Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F4rTAS39C53ECgWPG1.exe SCORE: 164 TYPE: EXE SIZE: 15360 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f185596b670> 
MD5: 6242e3d67787ccbf4e06ad2982853144 
SHA1: 6ac7947207d999a65890ab25fe344955da35028e 
SHA256: 4ca10dba7ff487fdb3f1362a3681d7d929f5aa1262cdfd31b04c30826983fb1d CREATED: Fri Jan 28 13:33:54 2022 MODIFIED: Fri Jan 28 13:33:54 2022 ACCESSED: Fri Jan 28 13:34:19 2022 
REASON_1: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: getaddrinfo
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey
REASON_3: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_12: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_13: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_14: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:34:19Z

-------- Score ----------------
Scores		Rules
.......		...............
50		network_dns
20		win_registry
10		Str_Win32_Winsock2_Library
1		ft_exe
1		math_entropy_5
1		IsPE32
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
60		DebuggerException__SetConsoleCtrl_v1
5		SEH_Save
5		SEH_Init
1		Contains_PE_File

Score total: 164

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_dns', '50'), ('win_registry', '20'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['164']
-------------- CAPA_Score ------------
['15.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2908.490494456402
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FmXmbMqBchhrTjFrf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FmXmbMqBchhrTjFrf.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.58 MB
Data read: 0.55 MB (ratio 1.06:1)
Time: 25.969 sec (0 m 25 s)
Start Date: 2022:01:28 13:34:19
End Date:   2022:01:28 13:34:45

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:34:19Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FmXmbMqBchhrTjFrf.exe SCORE: 117 TYPE: EXE SIZE: 580056 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9dbf8b7670> 
MD5: 4e9c546a54e40d0da89bb4616dd7f8c4 
SHA1: bea77cbd4fb58a6e97a994310b63f7c3c2761cbe 
SHA256: 66af4bca3df1ee98ec1fdb65b4e5fed4146bd0743ef8318c87368434d3ac50de CREATED: Fri Jan 28 13:34:19 2022 MODIFIED: Fri Jan 28 13:34:19 2022 ACCESSED: Fri Jan 28 13:34:46 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose
REASON_3: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:34:47Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
10		win_files_operation
1		misc_pe_signature
1		ft_exe
1		math_entropy_6
1		IsPE64
2		IsWindowsGUI
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
10		anti_dbg
1		Contains_PE_File
25		CRC32_poly_Constant

Score total: 117

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 4e9c546a54e40d0da89bb4616dd7f8c4                                                   |
| sha1                   | bea77cbd4fb58a6e97a994310b63f7c3c2761cbe                                           |
| sha256                 | 66af4bca3df1ee98ec1fdb65b4e5fed4146bd0743ef8318c87368434d3ac50de                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FmXmbMqBchhrTjFrf.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
| DATA                        | Checksum::CRC32 [C0032.001]                                                   |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| hash data with CRC32                                 | data-manipulation/checksum/crc32                     |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| encrypt data using RC4 with custom key via WinAPI    | data-manipulation/encryption/rc4                     |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path (3 matches)                     | host-interaction/file-system                         |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file size                                        | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| check mutex and exit                                 | host-interaction/mutex                               |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (7 matches)                          | load-code/pe                                         |
| spawn thread to RWX shellcode                        | load-code/shellcode                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 9.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('win_files_operation', '10'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('anti_dbg', '10'), ('Contains_PE_File', '1'), ('CRC32_poly_Constant', '25')]
-------------- LOKI_Score ------------
['117']
-------------- CAPA_Score ------------
['9.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2033.8986435267016
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Faq1wm4orDIXcE2Ywe.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Faq1wm4orDIXcE2Ywe.exe: Win.Ransomware.Ryuk-9779552-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.14 MB
Data read: 0.13 MB (ratio 1.06:1)
Time: 24.683 sec (0 m 24 s)
Start Date: 2022:01:28 13:34:49
End Date:   2022:01:28 13:35:14

-------- Score ----------------
Scores		Rules
.......		...............
80		Win.Ransomware.Ryuk-9779552-0

Score total: 80.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x94 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xea in position 6: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf8 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd1 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:34:49Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Faq1wm4orDIXcE2Ywe.exe SCORE: 208 TYPE: EXE SIZE: 137680 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa50541f670> 
MD5: a5c70086b3bc4fe64f4e7a0aa452e620 
SHA1: 2ab44cf5338ef5ed118365b4e8452b906c0dab4b 
SHA256: 2ec5256a7edb90b1c05c92f79e8a48c205b29e1ac910a535aa83c30b8dbbeff8 CREATED: Fri Jan 28 13:34:49 2022 MODIFIED: Fri Jan 28 13:34:49 2022 ACCESSED: Fri Jan 28 13:35:14 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: FindClose
REASON_2: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_3: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: win_ryuk_auto SUBSCORE: 45 
DESCRIPTION: Detects win.ryuk. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 68940b02356a016a006814010000 Str2: 85c075086a01ff15200e023568940b02356a01 Str3: ff7508e8e40e00005e5dc36a086878b00135 Str4: 6a086a1868 ... (truncated)
REASON_6: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645bc48c645bd45c645be52c645 Str2: c645bd45c645be52c645bf4dc645 Str3: c645be52c645bf4dc645c045c645 Str4: c645bf4dc645c045c645c153c645
REASON_9: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasDigitalSignature SUBSCORE: 1 
DESCRIPTION: DigitalSignature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: d021000000020200308221c006092a864886f70d010702a08221b1308221ad020101310b300906052b0e03021a0500304c060a2b060104018237020104a03e303c301 ... (truncated)
REASON_13: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_17: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_19: Yara Rule MATCH: cert_blocklist_07b74c70c4aa092648b7f0d1a8a3a28f SUBSCORE: 60 
DESCRIPTION: Certificate used for digitally signing malware. REF: - AUTHOR: ReversingLabs
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:35:15Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Winsock2_Library
1		misc_pe_signature
1		ft_exe
45		win_ryuk_auto
20		research_pe_signed_outside_timestamp
1		math_entropy_6
5		obfuscation_singlebyte_mov
1		IsPE32
2		IsWindowsGUI
1		HasOverlay
1		HasDigitalSignature
1		HasDebugData
1		HasRichSignature
2		PE_File
5		SEH_Save
5		SEH_Init
10		anti_dbg
60		cert_blocklist_07b74c70c4aa092648b7f0d1a8a3a28f
1		Contains_PE_File
25		CRC32_poly_Constant

Score total: 208

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Ransomware.Ryuk-9779552-0', '80')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('win_ryuk_auto', '45'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '1'), ('obfuscation_singlebyte_mov', '5'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasDigitalSignature', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('cert_blocklist_07b74c70c4aa092648b7f0d1a8a3a28f', '60'), ('Contains_PE_File', '1'), ('CRC32_poly_Constant', '25')]
-------------- LOKI_Score ------------
['208']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['80.0']
-------------- SCORE FINAL ------------
4303.718169754449
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Funjbn1lJ9V5ssYWQj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 88abae59e3b1cf07bef2feb1efee0324                                                   |
| sha1                   | 4337778595c76e82ea011103f320d2af33dbe899                                           |
| sha256                 | 3ba837e827a5a20cf51ec82972b5e5fe028708932bfe1e58fd1224ef2fe5bb75                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Funjbn1lJ9V5ssYWQj.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| create process on Windows                            | host-interaction/process/create                      |
| inject thread                                        | host-interaction/process/inject                      |
| acquire debug privileges                             | host-interaction/process/modify                      |
| modify access privileges                             | host-interaction/process/modify                      |
| query or enumerate registry value                    | host-interaction/registry                            |
| spawn thread to RWX shellcode                        | load-code/shellcode                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Discovery::Query Registry [T1012;1]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
4		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]

Score total: 12.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Funjbn1lJ9V5ssYWQj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 24.127 sec (0 m 24 s)
Start Date: 2022:01:28 13:35:15
End Date:   2022:01:28 13:35:39

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:35:15Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Funjbn1lJ9V5ssYWQj.exe SCORE: 243 TYPE: EXE SIZE: 40960 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe883e3d670> 
MD5: 88abae59e3b1cf07bef2feb1efee0324 
SHA1: 4337778595c76e82ea011103f320d2af33dbe899 
SHA256: 3ba837e827a5a20cf51ec82972b5e5fe028708932bfe1e58fd1224ef2fe5bb75 CREATED: Fri Jan 28 13:35:15 2022 MODIFIED: Fri Jan 28 13:35:15 2022 ACCESSED: Fri Jan 28 13:35:40 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread
REASON_2: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: SeDebugPrivilege Str3: AdjustTokenPrivileges
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_4 SUBSCORE: 1 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_9: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread
REASON_15: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_16: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:35:40Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
70		escalate_priv
20		win_registry
10		win_token
10		win_files_operation
1		ft_exe
1		math_entropy_4
15		dll_injection_thread
1		IsPE32
1		IsConsole
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
45		Inject_Thread
5		SEH_Save
5		SEH_Init
1		Contains_PE_File

Score total: 243

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Query Registry [T1012;1]', '1'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]', '4')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '10'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_4', '1'), ('dll_injection_thread', '15'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Inject_Thread', '45'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['243']
-------------- CAPA_Score ------------
['12.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4100.698247051615
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FFrAe33u6j07A6JDba.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 05cff15ab2be64cdb74c1a542802f7bb                                                   |
| sha1                   | 365064133164b804317734f29e503749c5be0791                                           |
| sha256                 | 6f4a4f78ed11823f45fe9efeab507cbf8bbd90a415cd4151427b071ecc576dc0                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FFrAe33u6j07A6JDba.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag (2 matches)         | anti-analysis/anti-debugging/debugger-detection      |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| enumerate files via ntdll functions                  | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| get system information on Windows (5 matches)        | host-interaction/os/info                             |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| create or open registry key (7 matches)              | host-interaction/registry                            |
| query or enumerate registry key (3 matches)          | host-interaction/registry                            |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry key                                  | host-interaction/registry/delete                     |
| delete registry value                                | host-interaction/registry/delete                     |
| get kernel32 base address                            | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 16.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FFrAe33u6j07A6JDba.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 24.635 sec (0 m 24 s)
Start Date: 2022:01:28 13:35:40
End Date:   2022:01:28 13:36:05

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:35:40Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FFrAe33u6j07A6JDba.exe SCORE: 185 TYPE: EXE SIZE: 92160 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd6aef5e670> 
MD5: 05cff15ab2be64cdb74c1a542802f7bb 
SHA1: 365064133164b804317734f29e503749c5be0791 
SHA256: 6f4a4f78ed11823f45fe9efeab507cbf8bbd90a415cd4151427b071ecc576dc0 CREATED: Fri Jan 28 13:35:40 2022 MODIFIED: Fri Jan 28 13:35:40 2022 ACCESSED: Fri Jan 28 13:36:05 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_10: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_11: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_12: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_13: Yara Rule MATCH: Debugger_Hiding__Thread SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetInformationThread
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:36:05Z

-------- Score ----------------
Scores		Rules
.......		...............
1		ft_exe
1		math_entropy_5
1		IsPE64
1		IsDLL
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
60		Debugger_Check__QueryInfo
60		Debugger_Hiding__Thread
1		Contains_PE_File

Score total: 185

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Debugger_Check__QueryInfo', '60'), ('Debugger_Hiding__Thread', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['185']
-------------- CAPA_Score ------------
['16.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3251.2943764480806
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FyYcS62DcVzy6uOhre.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FyYcS62DcVzy6uOhre.exe: Win.Malware.Jaik-9870661-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FyYcS62DcVzy6uOhre.exe: Win.Malware.Hacktoolx-9870688-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.22 MB
Data read: 0.21 MB (ratio 1.04:1)
Time: 23.914 sec (0 m 23 s)
Start Date: 2022:01:28 13:36:06
End Date:   2022:01:28 13:36:30

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Jaik-9870661-0
50		Win.Malware.Hacktoolx-9870688-0

Score total: 100.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:36:06Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:36:30Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Jaik-9870661-0', '50'), ('Win.Malware.Hacktoolx-9870688-0', '50')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['100.0']
-------------- SCORE FINAL ------------
1258.9254117941675
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FppIgf46NKmFCjFFyi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 1d8fd13c890060464019c0f07b928b1a                                                   |
| sha1                   | 1bbcc9ba8d4ce5a1c6ca0c757d826e39619f94c0                                           |
| sha256                 | 6bffe5385dd1321fe5b99dec3f8858be9ff99c8629c1c8d6f414eebaa663a710                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FppIgf46NKmFCjFFyi.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Automated Collection:: \[T1119]\                                                   |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Software Discovery:: \[T1518]\                                                     |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Checksum::Luhn [C0032.002]                                                    |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+---------------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                                    | NAMESPACE                                            |
|---------------------------------------------------------------+------------------------------------------------------|
| parse credit card information                                 | collection/credit-card                               |
| validate payment card number using luhn algorithm (2 matches) | data-manipulation/checksum/luhn                      |
| encrypt data using RC4 PRGA                                   | data-manipulation/encryption/rc4                     |
| get file size (2 matches)                                     | host-interaction/file-system/meta                    |
| move file                                                     | host-interaction/file-system/move                    |
| read .ini file                                                | host-interaction/file-system/read                    |
| read file on Windows                                          | host-interaction/file-system/read                    |
| write file on Windows                                         | host-interaction/file-system/write                   |
| print debug messages                                          | host-interaction/log/debug/write-event               |
| check mutex and exit                                          | host-interaction/mutex                               |
| read process memory                                           | host-interaction/process                             |
| allocate RWX memory                                           | host-interaction/process/inject                      |
| enumerate processes                                           | host-interaction/process/list                        |
| acquire debug privileges                                      | host-interaction/process/modify                      |
| modify access privileges                                      | host-interaction/process/modify                      |
| terminate process (2 matches)                                 | host-interaction/process/terminate                   |
+---------------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Discovery::Software Discovery [T1518;2]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
5.5		- Collection::Automated Collection [T1119;5.5]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]

Score total: 19.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FppIgf46NKmFCjFFyi.exe: Win.Trojan.GetMyPass-1 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.515 sec (0 m 24 s)
Start Date: 2022:01:28 13:36:31
End Date:   2022:01:28 13:36:55

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.GetMyPass-1

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb9 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe0 in position 0: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:36:31Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FppIgf46NKmFCjFFyi.exe SCORE: 322 TYPE: EXE SIZE: 17376 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f891c3e5670> 
MD5: 1d8fd13c890060464019c0f07b928b1a 
SHA1: 1bbcc9ba8d4ce5a1c6ca0c757d826e39619f94c0 
SHA256: 6bffe5385dd1321fe5b99dec3f8858be9ff99c8629c1c8d6f414eebaa663a710 CREATED: Fri Jan 28 13:36:31 2022 MODIFIED: Fri Jan 28 13:36:31 2022 ACCESSED: Fri Jan 28 13:36:56 2022 
REASON_1: Malware Hash TYPE: SHA1 HASH: 1bbcc9ba8d4ce5a1c6ca0c757d826e39619f94c0 SUBSCORE: 100 DESC: Signed POS malware - Carbanak http://blog.trendmicro.com/trendlabs-security-intelligence/signed-pos-malware-us
REASON_2: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_3: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile
REASON_6: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: win_getmypass_auto SUBSCORE: 45 
DESCRIPTION: Detects win.getmypass. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 52b928444000e83df1ffff6800800000 Str2: 8b45f88b4d088948048b55f8833a00 Str3: 894204eb1a8b4d0851 Str4: e817faffff83c40c8945a0837da0ff0f ... (truncated)
REASON_9: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasDigitalSignature SUBSCORE: 1 
DESCRIPTION: DigitalSignature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: e013000000020200308213d206092a864886f70d010702a08213c3308213bf020101310b300906052b0e03021a05003068060a2b060104018237020104a05a3058303 ... (truncated)
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:36:56Z

-------- Score ----------------
Scores		Rules
.......		...............
100		Malware Hash
70		escalate_priv
5		win_mutex
10		win_token
10		win_files_operation
1		misc_pe_signature
1		ft_exe
45		win_getmypass_auto
1		math_entropy_6
1		IsPE32
2		IsWindowsGUI
1		HasOverlay
1		HasDigitalSignature
1		HasRichSignature
2		PE_File
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
1		Contains_PE_File

Score total: 322

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Discovery::Software Discovery [T1518;2]', '2'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Collection::Automated Collection [T1119;5.5]', '5.5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.GetMyPass-1', '45')]
-------------- LOKI_Rules ------------
[('Malware Hash', '100'), ('escalate_priv', '70'), ('win_mutex', '5'), ('win_token', '10'), ('win_files_operation', '10'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('win_getmypass_auto', '45'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasDigitalSignature', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Check_OutputDebugStringA_iat_v1', '30'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['322']
-------------- CAPA_Score ------------
['19.5']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
6058.948666451091
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FMrDdf43DVc1LxHLYe.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FMrDdf43DVc1LxHLYe.exe: Win.Worm.Hai-1 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 23.559 sec (0 m 23 s)
Start Date: 2022:01:28 13:36:56
End Date:   2022:01:28 13:37:20

-------- Score ----------------
Scores		Rules
.......		...............
35		Win.Worm.Hai-1

Score total: 35.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:36:56Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FMrDdf43DVc1LxHLYe.exe SCORE: 75 TYPE: EXE SIZE: 65539 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fc704f78670> 
MD5: f0a6a1bd6d760497623611e8297a81df 
SHA1: 43a0c32e8c6c1c8d78c43550bcfa5740e27fdbb4 
SHA256: e50aaa300d13af1aeb4e5f06e89fe14d02300c6e27932f0c296e6706a4170963 CREATED: Fri Jan 28 13:36:56 2022 MODIFIED: Fri Jan 28 13:36:56 2022 ACCESSED: Fri Jan 28 13:37:20 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 1 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPacked SUBSCORE: 5 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: PELOCKnt
REASON_10: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:37:20Z

-------- Score ----------------
Scores		Rules
.......		...............
1		ft_exe
1		math_entropy_close_8
1		IsPE32
2		IsWindowsGUI
5		IsPacked
1		HasOverlay
1		HasRichSignature
2		PE_File
60		suspicious_packer_section
1		Contains_PE_File

Score total: 75

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Worm.Hai-1', '35')]
-------------- LOKI_Rules ------------
[('ft_exe', '1'), ('math_entropy_close_8', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('IsPacked', '5'), ('HasOverlay', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('suspicious_packer_section', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['75']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['35.0']
-------------- SCORE FINAL ------------
1629.2937884737937
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FXW93rStig6phYQL.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 82ef69ecabf12160625a6ba15d2a2671                                                   |
| sha1                   | 5e590f68d63ba7ddf86c822498faa944a4e0990a                                           |
| sha256                 | 4ab78dc788cead8f20227c9e2abfbefd5e74c64c85677c505ae7e694b7d41565                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FXW93rStig6phYQL.exe                          |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get system information on Windows                    | host-interaction/os/info                             |
| query or enumerate registry value (4 matches)        | host-interaction/registry                            |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Discovery::Query Registry [T1012;1]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 6.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FXW93rStig6phYQL.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 24.416 sec (0 m 24 s)
Start Date: 2022:01:28 13:37:21
End Date:   2022:01:28 13:37:45

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:37:21Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FXW93rStig6phYQL.exe SCORE: 142 TYPE: EXE SIZE: 79032 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4009a69670> 
MD5: 82ef69ecabf12160625a6ba15d2a2671 
SHA1: 5e590f68d63ba7ddf86c822498faa944a4e0990a 
SHA256: 4ab78dc788cead8f20227c9e2abfbefd5e74c64c85677c505ae7e694b7d41565 CREATED: Fri Jan 28 13:37:21 2022 MODIFIED: Fri Jan 28 13:37:21 2022 ACCESSED: Fri Jan 28 13:37:46 2022 
REASON_1: Yara Rule MATCH: cred_local SUBSCORE: 80 
DESCRIPTION: Steal credential REF: - AUTHOR: x0r 
MATCHES: Str1: SamQueryInformationUse
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_4: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:37:46Z

-------- Score ----------------
Scores		Rules
.......		...............
80		cred_local
20		win_registry
10		win_token
1		misc_pe_signature
1		ft_exe
20		research_pe_signed_outside_timestamp
1		math_entropy_5
1		IsPE64
2		IsWindowsGUI
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
1		Contains_PE_File

Score total: 142

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Query Registry [T1012;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('cred_local', '80'), ('win_registry', '20'), ('win_token', '10'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['142']
-------------- CAPA_Score ------------
['6.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2370.2640721929138
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FTngb63E967YQIZVB6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FTngb63E967YQIZVB6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 23.880 sec (0 m 23 s)
Start Date: 2022:01:28 13:37:46
End Date:   2022:01:28 13:38:10

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:37:46Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FTngb63E967YQIZVB6.exe SCORE: 84 TYPE: EXE SIZE: 12288 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb9b8132670> 
MD5: 68eaaa29813d706f4024af83cf3b88dc 
SHA1: db773a25602a3b3b678ce89e26ea85ab5b8ee59b 
SHA256: b756a02776b6b33394b255ba99f4cc0379cccbe080f36fd80034a5a6e2ffaa3e CREATED: Fri Jan 28 13:37:46 2022 MODIFIED: Fri Jan 28 13:37:46 2022 ACCESSED: Fri Jan 28 13:38:11 2022 
REASON_1: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_7 SUBSCORE: 1 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPacked SUBSCORE: 5 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: pec1 Str2: pec2
REASON_10: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:38:11Z

-------- Score ----------------
Scores		Rules
.......		...............
10		Str_Win32_Winsock2_Library
1		ft_exe
1		math_entropy_7
1		IsPE32
2		IsWindowsGUI
5		IsPacked
1		HasRichSignature
2		PE_File
60		suspicious_packer_section
1		Contains_PE_File

Score total: 84

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('math_entropy_7', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('IsPacked', '5'), ('HasRichSignature', '1'), ('PE_File', '2'), ('suspicious_packer_section', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['84']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1331.3102816673352
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F61dFF1aXe6cF4q3yk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5247539e5510a12bb64bdef04027befb                                                   |
| sha1                   | c4ddbb32c13e207ce722774973d8763b47136155                                           |
| sha256                 | 2fb7c331a06b426c128ef653eb3496d0f8c8ef9a7d32195b9b660e559e6933c9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F61dFF1aXe6cF4q3yk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes (17 matches)  | host-interaction/driver                              |
| terminate process via fastfail (13 matches)          | host-interaction/process/terminate                   |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Execution::System Services::Service Execution [T1569.002;3]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 7.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F61dFF1aXe6cF4q3yk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.08 MB
Data read: 0.08 MB (ratio 1.00:1)
Time: 24.798 sec (0 m 24 s)
Start Date: 2022:01:28 13:38:11
End Date:   2022:01:28 13:38:36

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:38:11Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] 
FILE: /tmp/.Loki_Scan/HTTP-F61dFF1aXe6cF4q3yk.exe SCORE: 42 TYPE: EXE SIZE: 86864 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f39d2b3f670> 
MD5: 5247539e5510a12bb64bdef04027befb 
SHA1: c4ddbb32c13e207ce722774973d8763b47136155 
SHA256: 2fb7c331a06b426c128ef653eb3496d0f8c8ef9a7d32195b9b660e559e6933c9 CREATED: Fri Jan 28 13:38:11 2022 MODIFIED: Fri Jan 28 13:38:11 2022 ACCESSED: Fri Jan 28 13:38:37 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 0 warnings, 2 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:38:37Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		misc_pe_signature
1		ft_exe
20		research_pe_signed_outside_timestamp
1		math_entropy_6
1		IsPE64
2		IsWindowsGUI
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
1		Contains_PE_File

Score total: 42

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['42']
-------------- CAPA_Score ------------
['7.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
805.3235028814892
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FolYLE114ComaBEF0k.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | dc4dc746d8a14060fb5fc7edd4ef5282                                                   |
| sha1                   | b0f1a213545cd7bc06ce9ee42709a2b45af06b28                                           |
| sha256                 | 3cf53c1ad414913e4d57a4d6f319938cafa6edb62a5e3f7b797658f90c0ceea9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FolYLE114ComaBEF0k.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| write file on Windows                                | host-interaction/file-system/write                   |
| terminate process (2 matches)                        | host-interaction/process/terminate                   |
| link many functions at runtime                       | linking/runtime-linking                              |
| load NCR ATM library                                 | targeting/automated-teller-machine/ncr               |
| reference NCR ATM library routines                   | targeting/automated-teller-machine/ncr               |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FolYLE114ComaBEF0k.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.059 sec (0 m 24 s)
Start Date: 2022:01:28 13:38:37
End Date:   2022:01:28 13:39:01

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:38:37Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:39:02Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
39.905246299377595
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FTUsr1x7ueiN2LBX7.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | cb612bd0353ba7151c1e6898b6e962c8                                                   |
| sha1                   | b4cbfac922bbc0b99f8e8ce30ee9c2db893be21c                                           |
| sha256                 | 6248846240929afd09bd74fb91d08617e5cf07314c219562f37dc28e30474684                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FTUsr1x7ueiN2LBX7.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FTUsr1x7ueiN2LBX7.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.18 MB
Data read: 0.17 MB (ratio 1.05:1)
Time: 24.087 sec (0 m 24 s)
Start Date: 2022:01:28 13:39:02
End Date:   2022:01:28 13:39:26

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:39:02Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:39:27Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
39.905246299377595
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fj13174TNFdKxTDLL4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf1 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:39:27Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fj13174TNFdKxTDLL4.exe SCORE: 1894 TYPE: EXE SIZE: 878592 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f191ea42670> 
MD5: 5fbbfeed28b258c42e0cfeb16718b31c 
SHA1: 43e862583a091f3a88be2cee1b2c44892154dc32 
SHA256: 9b721175dcac05edf402c9b7eebe167270603c039310acdb5e609628fd591ad0 CREATED: Fri Jan 28 13:39:27 2022 MODIFIED: Fri Jan 28 13:39:27 2022 ACCESSED: Fri Jan 28 13:39:53 2022 
REASON_1: Yara Rule MATCH: create_service SUBSCORE: 20 
DESCRIPTION: Create a windows service REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: CreateService Str4: ControlService Str5: StartService Str6: QueryServiceStatus
REASON_2: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_3: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_4: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: RegCloseKey
REASON_5: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: OpenProcessToken
REASON_6: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: Kernel32.dll Str3: KERNEL32.dll Str4: WriteFile Str5: SetFilePointer Str6: ReadFile Str7: FindClose Str8: CopyFile
REASON_7: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_8: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: ConventionEngine_Anomaly_OutsideOfDebug SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453f14648d77cd4d94186c369b86649ad7601000000583a5c5057445352565c41524d36345c52656c656173655c5057445352562e70646200
REASON_10: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: stager_reverse_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_18: Yara Rule MATCH: stager_bind_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_19: Yara Rule MATCH: win32_stage_boot_winsock_conn_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_20: Yara Rule MATCH: win32_stage_boot_bind_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_21: Yara Rule MATCH: win32_stage_boot_reverse_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_22: Yara Rule MATCH: win32_stage_boot_winsock_conn_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_23: Yara Rule MATCH: stager_reverse_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_24: Yara Rule MATCH: win32_stage_boot_bind_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_25: Yara Rule MATCH: win32_stage_boot_reverse_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_26: Yara Rule MATCH: win32_stage_boot_reverse_shell_revert_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_27: Yara Rule MATCH: win32_stage_winexec_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_28: Yara Rule MATCH: stager_bind_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_29: Yara Rule MATCH: win32_stage_boot_winsock_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_30: Yara Rule MATCH: win32_stage_boot_reverse_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_31: Yara Rule MATCH: win32_stage_api_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_32: Yara Rule MATCH: win32_stage_boot_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_33: Yara Rule MATCH: win32_stage_boot_reverse_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_34: Yara Rule MATCH: win32_stage_boot_reverse_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_35: Yara Rule MATCH: win32_stage_boot_bind_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_36: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_37: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: UnhookWindowsHookEx Str3: CallNextHookEx
REASON_38: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_39: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_40: Yara Rule MATCH: Antivirus_strings SUBSCORE: 50 
DESCRIPTION: Contains references to security software REF: - AUTHOR: Jerome Athias 
MATCHES: Str1: nUI.exe
REASON_41: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_42: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: fdfb8cfc2e4d170431fb6b8c67210672 Str2: a7eb3390a15bcd2c80a978c75f2dcc4f Str3: 941dd5f1c32c7cec49703f0dfde8eba5 Str4: d2611745022d67cf ... (truncated)
REASON_43: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:39:54Z

-------- Score ----------------
Scores		Rules
.......		...............
20		create_service
65		screenshot
80		keylogger
20		win_registry
10		win_token
10		win_files_operation
10		Str_Win32_Http_API
1		ft_exe
50		ConventionEngine_Anomaly_OutsideOfDebug
1		math_entropy_6
15		dll_injection_hook
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
35		Embedded_PE
2		PE_File
70		stager_reverse_tcp_nx_ldone_x86
70		stager_bind_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_conn_ldone_x86
70		win32_stage_boot_bind_read_ldone_x86
70		win32_stage_boot_reverse_read_ldone_x86
70		win32_stage_boot_winsock_conn_udp_ldone_x86
70		stager_reverse_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_bind_inlineegg_ldone_x86
70		win32_stage_boot_reverse_ldone_x86
70		win32_stage_boot_reverse_shell_revert_ldone_x86
70		win32_stage_winexec_ldone_x86
70		stager_bind_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_bind_ldone_x86
70		win32_stage_boot_reverse_shell_ldone_x86
70		win32_stage_api_ldone_x86
70		win32_stage_boot_bind_ldone_x86
70		win32_stage_boot_reverse_udp_ldone_x86
70		win32_stage_boot_reverse_inlineegg_ldone_x86
70		win32_stage_boot_bind_shell_ldone_x86
5		Anti_Automated_Sandbox
35		Win_Hook_v12
60		Debugger_Check__QueryInfo
60		DebuggerException__SetConsoleCtrl_v1
50		Antivirus_strings
1		Contains_PE_File
10		Big_Numbers1
20		Advapi_Hash_API

Score total: 1894

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fj13174TNFdKxTDLL4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 1.66 MB
Data read: 0.84 MB (ratio 1.98:1)
Time: 28.697 sec (0 m 28 s)
Start Date: 2022:01:28 13:39:27
End Date:   2022:01:28 13:39:56

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5fbbfeed28b258c42e0cfeb16718b31c                                                   |
| sha1                   | 43e862583a091f3a88be2cee1b2c44892154dc32                                           |
| sha256                 | 9b721175dcac05edf402c9b7eebe167270603c039310acdb5e609628fd591ad0                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fj13174TNFdKxTDLL4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Automated Collection:: \[T1119]\                                                   |
|                        | Clipboard Data:: \[T1115]\                                                         |
|                        | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                            |
|                        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COLLECTION                  | Keylogging::Application Hook [F0002.001]                                      |
|                             | Keylogging::Polling [F0002.002]                                               |
| COMMUNICATION               | Interprocess Communication::Create Pipe [C0003.001]                           |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Encryption Key:: [C0028]                                                      |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Checksum::CRC32 [C0032.001]                                                   |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Console:: [C0033]                                                             |
|                             | Environment Variable::Set Variable [C0034.001]                                |
|                             | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                                  | NAMESPACE                                            |
|-------------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints                              | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via GetTickCount                       | anti-analysis/anti-debugging/debugger-detection      |
| timestomp file (2 matches)                                  | anti-analysis/anti-forensic/timestomp                |
| execute anti-VM instructions                                | anti-analysis/anti-vm/vm-detection                   |
| contain obfuscated stackstrings                             | anti-analysis/obfuscation/string/stackstring         |
| parse credit card information                               | collection/credit-card                               |
| log keystrokes via application hook                         | collection/keylog                                    |
| log keystrokes via polling                                  | collection/keylog                                    |
| create pipe                                                 | communication/named-pipe/create                      |
| hash data with CRC32 (2 matches)                            | data-manipulation/checksum/crc32                     |
| create new key via CryptAcquireContext                      | data-manipulation/encryption                         |
| hash data via WinCrypt                                      | data-manipulation/hashing                            |
| initialize hashing via WinCrypt                             | data-manipulation/hashing                            |
| hash data with MD5                                          | data-manipulation/hashing/md5                        |
| contains PDB path                                           | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                          | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (6 matches)         | executable/resource                                  |
| contain an embedded PE file                                 | executable/subfile/pe                                |
| manipulate boot configuration (3 matches)                   | host-interaction/bootloader                          |
| replace clipboard data                                      | host-interaction/clipboard                           |
| manipulate console (3 matches)                              | host-interaction/console                             |
| query environment variable (3 matches)                      | host-interaction/environment-variable                |
| set environment variable (2 matches)                        | host-interaction/environment-variable                |
| get common file path (3 matches)                            | host-interaction/file-system                         |
| read raw disk data                                          | host-interaction/file-system                         |
| copy file (2 matches)                                       | host-interaction/file-system/copy                    |
| create directory                                            | host-interaction/file-system/create                  |
| delete directory                                            | host-interaction/file-system/delete                  |
| delete file (6 matches)                                     | host-interaction/file-system/delete                  |
| check if file exists (11 matches)                           | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions (9 matches)          | host-interaction/file-system/files/list              |
| get file attributes (14 matches)                            | host-interaction/file-system/meta                    |
| get file size (3 matches)                                   | host-interaction/file-system/meta                    |
| get file version info                                       | host-interaction/file-system/meta                    |
| set file attributes (7 matches)                             | host-interaction/file-system/meta                    |
| move file                                                   | host-interaction/file-system/move                    |
| read .ini file (4 matches)                                  | host-interaction/file-system/read                    |
| read file on Windows (14 matches)                           | host-interaction/file-system/read                    |
| read file via mapping                                       | host-interaction/file-system/read                    |
| write file on Windows (11 matches)                          | host-interaction/file-system/write                   |
| enumerate gui resources                                     | host-interaction/gui                                 |
| get graphical window text (15 matches)                      | host-interaction/gui/window/get-text                 |
| hide graphical window (2 matches)                           | host-interaction/gui/window/hide                     |
| enumerate disk volumes                                      | host-interaction/hardware/storage                    |
| get disk information (17 matches)                           | host-interaction/hardware/storage                    |
| get disk size (3 matches)                                   | host-interaction/hardware/storage                    |
| get storage device properties (4 matches)                   | host-interaction/hardware/storage                    |
| get system information on Windows (3 matches)               | host-interaction/os/info                             |
| check OS version                                            | host-interaction/os/version                          |
| get thread local storage value (20 matches)                 | host-interaction/process                             |
| read process memory                                         | host-interaction/process                             |
| set thread local storage value (4 matches)                  | host-interaction/process                             |
| create a process with modified I/O handles and window       | host-interaction/process/create                      |
| create process on Windows (11 matches)                      | host-interaction/process/create                      |
| allocate RWX memory (2 matches)                             | host-interaction/process/inject                      |
| enumerate processes (2 matches)                             | host-interaction/process/list                        |
| create registry key via offline registry library            | host-interaction/registry                            |
| open registry key via offline registry library (3 matches)  | host-interaction/registry                            |
| query or enumerate registry value (8 matches)               | host-interaction/registry                            |
| query registry key via offline registry library (3 matches) | host-interaction/registry                            |
| set registry key via offline registry library (2 matches)   | host-interaction/registry                            |
| set registry value (7 matches)                              | host-interaction/registry/create                     |
| delete registry key                                         | host-interaction/registry/delete                     |
| query service status                                        | host-interaction/service                             |
| create service (2 matches)                                  | host-interaction/service/create                      |
| start service                                               | host-interaction/service/start                       |
| stop service                                                | host-interaction/service/stop                        |
| get token membership                                        | host-interaction/session                             |
| create thread (2 matches)                                   | host-interaction/thread/create                       |
| link many functions at runtime (6 matches)                  | linking/runtime-linking                              |
| parse PE exports                                            | load-code/pe                                         |
| parse PE header (41 matches)                                | load-code/pe                                         |
| persist via Windows service (2 matches)                     | persistence/service                                  |
+-------------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
3		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
9		- Impact::Service Stop [T1489;9]
4		- Defense Evasion::File and Directory Permissions Modification [T1222;4]
3		- Execution::System Services::Service Execution [T1569.002;3]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Collection::Clipboard Data [T1115;4]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Discovery::Software Discovery [T1518;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
1		- Discovery::System Information Discovery [T1082;1]
1		- Discovery::Query Registry [T1012;1]
5.5		- Collection::Automated Collection [T1119;5.5]

Score total: 97.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]', '3'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]', '8.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Impact::Service Stop [T1489;9]', '9'), ('- Defense Evasion::File and Directory Permissions Modification [T1222;4]', '4'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Collection::Clipboard Data [T1115;4]', '4'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Discovery::Software Discovery [T1518;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Collection::Automated Collection [T1119;5.5]', '5.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('create_service', '20'), ('screenshot', '65'), ('keylogger', '80'), ('win_registry', '20'), ('win_token', '10'), ('win_files_operation', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '1'), ('ConventionEngine_Anomaly_OutsideOfDebug', '50'), ('math_entropy_6', '1'), ('dll_injection_hook', '15'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('Embedded_PE', '35'), ('PE_File', '2'), ('stager_reverse_tcp_nx_ldone_x86', '70'), ('stager_bind_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_ldone_x86', '70'), ('win32_stage_boot_bind_read_ldone_x86', '70'), ('win32_stage_boot_reverse_read_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_udp_ldone_x86', '70'), ('stager_reverse_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_bind_inlineegg_ldone_x86', '70'), ('win32_stage_boot_reverse_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_revert_ldone_x86', '70'), ('win32_stage_winexec_ldone_x86', '70'), ('stager_bind_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_ldone_x86', '70'), ('win32_stage_api_ldone_x86', '70'), ('win32_stage_boot_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_udp_ldone_x86', '70'), ('win32_stage_boot_reverse_inlineegg_ldone_x86', '70'), ('win32_stage_boot_bind_shell_ldone_x86', '70'), ('Anti_Automated_Sandbox', '5'), ('Win_Hook_v12', '35'), ('Debugger_Check__QueryInfo', '60'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('Antivirus_strings', '50'), ('Contains_PE_File', '1'), ('Big_Numbers1', '10'), ('Advapi_Hash_API', '20')]
-------------- LOKI_Score ------------
['1894']
-------------- CAPA_Score ------------
['97.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
31963.257822308144
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FG4RoD0Ou2oaGdGL8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b792676216706673b65d67916460299f                                                   |
| sha1                   | 7e7351664daea80efcf57c7a55e413c59bf53ba2                                           |
| sha256                 | 15e3a70fd3f2972cd8d7826dfe4058255b0fbb974969828644d93256f7fb9c12                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FG4RoD0Ou2oaGdGL8.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FG4RoD0Ou2oaGdGL8.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 25.258 sec (0 m 25 s)
Start Date: 2022:01:28 13:40:38
End Date:   2022:01:28 13:41:03

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:40:38Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:41:04Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['10.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
199.526231496888
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FmdkpH1iiCNMsCIY8b.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 7a2e485d1bea00ee5907e4cc02cb2552                                                   |
| sha1                   | c5b482c79be28e1e8dcaf489a88a586b80e2482c                                           |
| sha256                 | b3b4c065849c81d856558e9cf91e8cef5d481648fd8aa88cdda534ab6b75e988                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FmdkpH1iiCNMsCIY8b.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005            |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
|                        | Process Injection::Process Hollowing \[T1055.012]\                                 |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+------------------------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                                   |
|-----------------------------+------------------------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                                            |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                                     |
|                             | Virtual Machine Detection::Unique Hardware/Firmware Check - I/O Communication Port [B0009.025] |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                                         |
| EXECUTION                   | Install Additional Program:: [B0023]                                                           |
| MEMORY                      | Allocate Memory:: [C0007]                                                                      |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                                      |
|                             | Registry::Open Registry Key [C0036.003]                                                        |
|                             | Registry::Query Registry Key [C0036.005]                                                       |
| PROCESS                     | Create Process:: [C0017]                                                                       |
|                             | Create Process::Create Suspended Process [C0017.003]                                           |
|                             | Create Thread:: [C0038]                                                                        |
|                             | Resume Thread:: [C0054]                                                                        |
+-----------------------------+------------------------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-VM instructions                         | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VMWare           | anti-analysis/anti-vm/vm-detection                   |
| reference the VMWare IO port                         | anti-analysis/anti-vm/vm-detection                   |
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| get common file path                                 | host-interaction/file-system                         |
| read process memory                                  | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| inject dll                                           | host-interaction/process/inject                      |
| inject thread                                        | host-interaction/process/inject                      |
| use process replacement                              | host-interaction/process/inject                      |
| enumerate processes                                  | host-interaction/process/list                        |
| query or enumerate registry key                      | host-interaction/registry                            |
| link function at runtime on Windows (3 matches)      | linking/runtime-linking                              |
| enumerate PE sections                                | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]
4		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;4]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
2		- Discovery::Software Discovery [T1518;2]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
4		- Defense Evasion::Process Injection::Process Hollowing [T1055.012;4]

Score total: 31.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FmdkpH1iiCNMsCIY8b.exe: Win.Malware.Explorerhijack-9937586-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FmdkpH1iiCNMsCIY8b.exe: Win.Malware.Explorerhijack-9937587-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FmdkpH1iiCNMsCIY8b.exe: Win.Trojan.Agent-663582 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 23.946 sec (0 m 23 s)
Start Date: 2022:01:28 13:41:05
End Date:   2022:01:28 13:41:29

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Explorerhijack-9937586-0
50		Win.Malware.Explorerhijack-9937587-0
70		Win.Trojan.Agent-663582
75		Win.Trojan.Agent-663582
45		Win.Trojan.Agent-663582

Score total: 290.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:41:05Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FmdkpH1iiCNMsCIY8b.exe SCORE: 303 TYPE: EXE SIZE: 45056 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fc991e41670> 
MD5: 7a2e485d1bea00ee5907e4cc02cb2552 
SHA1: c5b482c79be28e1e8dcaf489a88a586b80e2482c 
SHA256: b3b4c065849c81d856558e9cf91e8cef5d481648fd8aa88cdda534ab6b75e988 CREATED: Fri Jan 28 13:41:05 2022 MODIFIED: Fri Jan 28 13:41:05 2022 ACCESSED: Fri Jan 28 13:41:29 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegOpenKeyExA Str3: RegCloseKey
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_4 SUBSCORE: 1 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645c800c645c950c645ca56c645 Str2: c645c950c645ca56c645cb00c645 Str3: c645ca56c645cb00c645cc0cc645 Str4: c645cb00c645cc0cc645cd29c645 ... (truncated)
REASON_5: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_6: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: vmware Str2: b868584d56bb00000000b90a000000ba58560000ed
REASON_11: Yara Rule MATCH: antivm_vmware SUBSCORE: 60 
DESCRIPTION: AntiVM checks for VMWare REF: - AUTHOR: x0r 
MATCHES: Str1: b868584d56bb00000000b90a000000ba58560000ed
REASON_12: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: vmware
REASON_13: Yara Rule MATCH: ThreadControl__Context_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetThreadContext
REASON_14: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_15: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: vmware
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:41:30Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
1		ft_exe
1		math_entropy_4
5		obfuscation_singlebyte_mov
15		dll_injection_thread
1		IsPE32
1		IsConsole
1		HasRichSignature
2		PE_File
10		VMWare_Detection
60		antivm_vmware
60		vmdetect_2
60		ThreadControl__Context_v1
5		SEH_Init
60		vmdetect
1		Contains_PE_File

Score total: 303

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]', '4'), ('- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::Software Discovery [T1518;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Defense Evasion::Process Injection::Process Hollowing [T1055.012;4]', '4')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Explorerhijack-9937586-0', '50'), ('Win.Malware.Explorerhijack-9937587-0', '50'), ('Win.Trojan.Agent-663582', '70'), ('Win.Trojan.Agent-663582', '75'), ('Win.Trojan.Agent-663582', '45')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('ft_exe', '1'), ('math_entropy_4', '1'), ('obfuscation_singlebyte_mov', '5'), ('dll_injection_thread', '15'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('VMWare_Detection', '10'), ('antivm_vmware', '60'), ('vmdetect_2', '60'), ('ThreadControl__Context_v1', '60'), ('SEH_Init', '5'), ('vmdetect', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['303']
-------------- CAPA_Score ------------
['31.0']
-------------- CLAMAV_Score ------------
['290.0']
-------------- SCORE FINAL ------------
9071.641385000612
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FThRPp2G4DgNBlYhJk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e43555271a5a44c962d09844e7adc137                                                   |
| sha1                   | afbceceee83031342fd035141c44c0affeae274b                                           |
| sha256                 | 3d761e69cbbfe3055677c6b5ab296919c940ad0a55cc527fdab8cf52bacd487b                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FThRPp2G4DgNBlYhJk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FThRPp2G4DgNBlYhJk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 23.991 sec (0 m 23 s)
Start Date: 2022:01:28 13:41:31
End Date:   2022:01:28 13:41:55

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:41:31Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:41:55Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
39.905246299377595
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FnsFLWtdIpdmnUbu4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5d7c34b6854d48d3da4f96b71550a221                                                   |
| sha1                   | 1f0e20fbc74b4a7b1d73a0a6ac131f9543bd6cbb                                           |
| sha256                 | bec31fc132cff00910cb07cf9d66c9fcf5ff511f8182b61622a18843f0fd5841                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FnsFLWtdIpdmnUbu4.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::Set Socket Config [C0001.001]                           |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| read and send data from client to server             | c2/file-transfer                                     |
| receive and write data from server to client         | c2/file-transfer                                     |
| initialize Winsock library                           | communication/socket                                 |
| set socket configuration                             | communication/socket                                 |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| get file size                                        | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
1		- Discovery::File and Directory Discovery [T1083;1]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]

Score total: 18.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FnsFLWtdIpdmnUbu4.exe: Win.Trojan.Generickd-7 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 24.284 sec (0 m 24 s)
Start Date: 2022:01:28 13:41:55
End Date:   2022:01:28 13:42:20

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Generickd-7

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:41:56Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FnsFLWtdIpdmnUbu4.exe SCORE: 178 TYPE: EXE SIZE: 28672 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f92233ed670> 
MD5: 5d7c34b6854d48d3da4f96b71550a221 
SHA1: 1f0e20fbc74b4a7b1d73a0a6ac131f9543bd6cbb 
SHA256: bec31fc132cff00910cb07cf9d66c9fcf5ff511f8182b61622a18843f0fd5841 CREATED: Fri Jan 28 13:41:55 2022 MODIFIED: Fri Jan 28 13:41:55 2022 ACCESSED: Fri Jan 28 13:42:20 2022 
REASON_1: Malware Hash TYPE: MD5 HASH: 5d7c34b6854d48d3da4f96b71550a221 SUBSCORE: 100 DESC: Analysis of DHS NCCIC Indicators (2014) https://www.secureworks.com/research/analysis-of-dhs-nccic-indicators
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile
REASON_3: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: win_simplefilemover_auto SUBSCORE: 45 
DESCRIPTION: Detects win.simplefilemover. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 8bfcf3a5e8def2ffff81c42002000085c0 Str2: 7d0733c0e9ee0100006820020000 Str3: 8b9540daffffd1e2528d855cfaffff50 Str4: 518d9524daffff52e8 ... (truncated)
REASON_6: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:42:20Z

-------- Score ----------------
Scores		Rules
.......		...............
100		Malware Hash
10		win_files_operation
10		Str_Win32_Winsock2_Library
1		ft_exe
45		win_simplefilemover_auto
1		math_entropy_5
1		IsPE32
1		IsConsole
1		HasRichSignature
2		PE_File
5		SEH_Init
1		Contains_PE_File

Score total: 178

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]', '8.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Generickd-7', '45')]
-------------- LOKI_Rules ------------
[('Malware Hash', '100'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('win_simplefilemover_auto', '45'), ('math_entropy_5', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('SEH_Init', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['178']
-------------- CAPA_Score ------------
['18.5']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
3756.7498461574
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FcRiyv2dsb2Dyukv7.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ca042c9a80d01c409c740d0437942b4e                                                   |
| sha1                   | 715146caa48d94a6ae2f6f0b2d5268296d51773e                                           |
| sha256                 | cdaa7d2fd4328877fcab873cfa85b6b46b0a1afa6cc39017ced21dcfb139bba7                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FcRiyv2dsb2Dyukv7.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (3 matches)                | collection                                           |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| check OS version                                     | host-interaction/os/version                          |
| terminate process via fastfail (71 matches)          | host-interaction/process/terminate                   |
| access PEB ldr_data                                  | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Location Discovery [T1614;3]
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 9.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FcRiyv2dsb2Dyukv7.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.11 MB
Data read: 0.11 MB (ratio 1.00:1)
Time: 24.878 sec (0 m 24 s)
Start Date: 2022:01:28 13:42:20
End Date:   2022:01:28 13:42:45

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:42:21Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:42:46Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['9.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
179.57360834719918
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FqegvA2EObMVhZZXD4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FqegvA2EObMVhZZXD4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.51 MB
Data read: 0.48 MB (ratio 1.06:1)
Time: 28.963 sec (0 m 28 s)
Start Date: 2022:01:28 13:42:46
End Date:   2022:01:28 13:43:15

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf1 in position 3: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbc in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 8-9: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 8-9: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:42:47Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FqegvA2EObMVhZZXD4.exe SCORE: 555 TYPE: EXE SIZE: 503808 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f3d5e944670> 
MD5: 6f99a2c8944cb02ff28c6f9ced59b161 
SHA1: 2dcb89d0f72d854bef6fbca73fd7fbe503673bd0 
SHA256: c4bb8f54e3b4577bb391c0f283d1161d5636764c40f97c799b017ce5db6dbcb3 CREATED: Fri Jan 28 13:42:46 2022 MODIFIED: Fri Jan 28 13:42:46 2022 ACCESSED: Fri Jan 28 13:43:15 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: NtWriteVirtualMemory Str4: CreateThread
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetOpenUrl Str5: InternetReadFile Str6: HttpOpenRequest Str7: HttpSen ... (truncated)
REASON_3: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: socket Str3: connect
REASON_4: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_5: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_6: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_7: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: CreateFileA Str6: FindFirstFileA Str7: MoveFileExA Str8: FindC ... (truncated)
REASON_8: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_9: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_10: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_11: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_12: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: win_megumin_auto SUBSCORE: 45 
DESCRIPTION: Detects win.megumin. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 83bde8fbffff100f438dd4fbffff2bf203cf89b5e4fbffff2bf746 Str2: c78514ffffff00000000c78518ffffff0f000000e8489bfeff8b8d1cffffff8b531841c7 ... (truncated)
REASON_14: Yara Rule MATCH: ConventionEngine_Term_Desktop SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445307583034e0a56d49a76d8cffa443ec6301000000433a5c55736572735c41646d696e6973747261746f725c4465736b746f705c4d6567756d696e56325c526 ... (truncated)
REASON_15: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445307583034e0a56d49a76d8cffa443ec6301000000433a5c55736572735c41646d696e6973747261746f725c4465736b746f705c4d6567756d696e56325c526 ... (truncated)
REASON_16: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_20: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_21: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_22: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_23: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_24: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_25: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_26: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: NtWriteVirtualMemory Str4: CreateThread
REASON_27: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_28: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_29: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_30: Yara Rule MATCH: browser_pass SUBSCORE: 10 
DESCRIPTION: This module is intended for forensicators and pen-testers to find passwords in memory that can help their case/engagement. REF: https://github.com/swoodsec/YARA-RULES/blob/master/browserpass.yar AUTHOR: swood 
MATCHES: Str1: pass=
REASON_31: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_32: Yara Rule MATCH: Big_Numbers3 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 64:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 21cf114e8a601f49a4b9d36250840853917a34072663f9c8beea3b45e8f129c5 Str2: 750144f9777a15f981a79e297849a140917a34072663f9c8beea3b45e8f129 ... (truncated)
REASON_33: Yara Rule MATCH: MD5_Constants SUBSCORE: 20 
DESCRIPTION: Look for MD5 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: 78a46ad7
REASON_34: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:43:16Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
45		network_http
50		network_tcp_socket
5		win_mutex
20		win_registry
10		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
1		ft_exe
45		win_megumin_auto
50		ConventionEngine_Term_Desktop
50		ConventionEngine_Term_Users
1		math_entropy_6
1		IsPE32
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
45		Inject_Thread
5		SEH_Save
5		SEH_Init
10		anti_dbg
10		browser_pass
1		Contains_PE_File
10		Big_Numbers3
20		MD5_Constants
5		BASE64_table

Score total: 555

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6f99a2c8944cb02ff28c6f9ced59b161                                                   |
| sha1                   | 2dcb89d0f72d854bef6fbca73fd7fbe503673bd0                                           |
| sha256                 | c4bb8f54e3b4577bb391c0f283d1161d5636764c40f97c799b017ce5db6dbcb3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FqegvA2EObMVhZZXD4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                          |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                             |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005             |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Process Injection::Process Hollowing \[T1055.012]\                                  |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                         |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                       |
|                        | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | Software Discovery:: \[T1518]\                                                      |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Location Discovery:: \[T1614]\                                               |
|                        | System Network Configuration Discovery:: \[T1016]\                                  |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
|                        | Resource Hijacking:: \[T1496]\                                                      |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
|                             | Debugger Detection::Software Breakpoints [B0001.025]                          |
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | Socket Communication::Connect Socket [C0001.004]                              |
|                             | Socket Communication::Create TCP Socket [C0001.011]                           |
|                             | Socket Communication::Create UDP Socket [C0001.010]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::TCP Client [C0001.008]                                  |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
|                             | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag                     | anti-analysis/anti-debugging/debugger-detection      |
| check for software breakpoints                       | anti-analysis/anti-debugging/debugger-detection      |
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| get geographical location                            | collection                                           |
| receive data (3 matches)                             | communication                                        |
| send data (6 matches)                                | communication                                        |
| send HTTP request with Host header                   | communication/http                                   |
| get HTTP response content encoding                   | communication/http/client                            |
| creates tcp or udp socket                            | communication/socket                                 |
| initialize Winsock library                           | communication/socket                                 |
| create UDP socket                                    | communication/socket/udp/send                        |
| act as TCP client                                    | communication/tcp/client                             |
| encode data using Base64                             | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| hash data using fnv                                  | data-manipulation/hashing/fnv                        |
| hash data with MD5                                   | data-manipulation/hashing/md5                        |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| read clipboard data                                  | host-interaction/clipboard                           |
| replace clipboard data                               | host-interaction/clipboard                           |
| query environment variable                           | host-interaction/environment-variable                |
| set environment variable                             | host-interaction/environment-variable                |
| get common file path (6 matches)                     | host-interaction/file-system                         |
| get file system object information                   | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| create directory (3 matches)                         | host-interaction/file-system/create                  |
| delete file                                          | host-interaction/file-system/delete                  |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| set file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| move file                                            | host-interaction/file-system/move                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| create shortcut via IShellLink                       | host-interaction/file-system/write                   |
| write file on Windows                                | host-interaction/file-system/write                   |
| find graphical window                                | host-interaction/gui/window/find                     |
| get graphical window text (2 matches)                | host-interaction/gui/window/get-text                 |
| get keyboard layout                                  | host-interaction/hardware/keyboard/layout            |
| get disk information                                 | host-interaction/hardware/storage                    |
| check mutex and exit                                 | host-interaction/mutex                               |
| resolve DNS (2 matches)                              | host-interaction/network/dns/resolve                 |
| allocate thread local storage (3 matches)            | host-interaction/process                             |
| get thread local storage value (2 matches)           | host-interaction/process                             |
| set thread local storage value (2 matches)           | host-interaction/process                             |
| create process on Windows (11 matches)               | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| use process replacement                              | host-interaction/process/inject                      |
| enumerate processes on remote desktop session host   | host-interaction/process/list                        |
| enumerate process modules                            | host-interaction/process/modules/list                |
| terminate process by name                            | host-interaction/process/terminate                   |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| get session user name                                | host-interaction/session                             |
| create thread (5 matches)                            | host-interaction/thread/create                       |
| mine cryptocurrency                                  | impact/cryptocurrency                                |
| access PEB ldr_data (2 matches)                      | linking/runtime-linking                              |
| linked against CPP regex library                     | linking/static/cppregex                              |
| parse PE header (4 matches)                          | load-code/pe                                         |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
3		- Discovery::System Location Discovery [T1614;3]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::File and Directory Permissions Modification [T1222;4]
4		- Defense Evasion::Process Injection::Process Hollowing [T1055.012;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Collection::Clipboard Data [T1115;4]
3		- Discovery::Account Discovery [T1087;3]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Discovery::Software Discovery [T1518;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
3		- Discovery::System Network Configuration Discovery [T1016;3]
8		- Impact::Resource Hijacking [T1496;8]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
1		- Discovery::Query Registry [T1012;1]

Score total: 81.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::File and Directory Permissions Modification [T1222;4]', '4'), ('- Defense Evasion::Process Injection::Process Hollowing [T1055.012;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Collection::Clipboard Data [T1115;4]', '4'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Discovery::Software Discovery [T1518;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Impact::Resource Hijacking [T1496;8]', '8'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('network_http', '45'), ('network_tcp_socket', '50'), ('win_mutex', '5'), ('win_registry', '20'), ('win_token', '10'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '1'), ('win_megumin_auto', '45'), ('ConventionEngine_Term_Desktop', '50'), ('ConventionEngine_Term_Users', '50'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('Inject_Thread', '45'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('browser_pass', '10'), ('Contains_PE_File', '1'), ('Big_Numbers3', '10'), ('MD5_Constants', '20'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['555']
-------------- CAPA_Score ------------
['81.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
10422.296004858816
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FOn2n53XOvHjn9J2T4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FOn2n53XOvHjn9J2T4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 3.02 MB
Data read: 2.83 MB (ratio 1.06:1)
Time: 27.083 sec (0 m 27 s)
Start Date: 2022:01:28 13:44:02
End Date:   2022:01:28 13:44:29

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:44:02Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FOn2n53XOvHjn9J2T4.exe SCORE: 295 TYPE: EXE SIZE: 2970624 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa860444670> 
MD5: f4ff94ccd882cc33c6ba26e441cfcc78 
SHA1: 9450342e37a232c76c1573c0f00b83f82f034289 
SHA256: dbda182d31f85e507587ac6e37c56fe3380537d517573dd1f50050d1156b6f89 CREATED: Fri Jan 28 13:44:02 2022 MODIFIED: Fri Jan 28 13:44:02 2022 ACCESSED: Fri Jan 28 13:44:29 2022 
REASON_1: Yara Rule MATCH: network_udp_sock SUBSCORE: 20 
DESCRIPTION: Communications over UDP network REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: WSAStartup Str3: recvfrom
REASON_2: Yara Rule MATCH: network_tcp_listen SUBSCORE: 20 
DESCRIPTION: Listen for incoming communication REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: bind Str3: accept Str4: WSAStartup Str5: WSASocket Str6: listen
REASON_3: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: WSASocket Str3: socket Str4: send Str5: WSASend Str6: connect Str7: WSAStartup Str8: WSACleanup
REASON_4: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: getaddrinfo
REASON_5: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_16: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_17: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_18: Yara Rule MATCH: skip20_sqllang_hook SUBSCORE: 60 
DESCRIPTION: YARA rule to detect if a sqllang.dll version is targeted by skip-2.0. Each byte pattern corresponds to a function hooked by skip-2.0. If _0 or _1 match, it is probably targeted as it corresponds to the hook responsible for bypassing the authentication. REF: https://www.welivesecurity.com/ AUTHOR: Mathieu Tartare <mathieu.tartare@eset.com> 
MATCHES: Str1: 4c8d9c2420010000498b5b40498b7348498be3415f415e415c5f5dc3
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2962ADEAE004074C8C0D598C5387FEB3 Str2: 5FFFB6E33C19F27A8A5535D45382B9E8 Str3: 4EDDBBCE46E0542C24BEC5BF9717C971 Str4: D946354436F2F3C7 ... (truncated)
REASON_21: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:44:32Z

-------- Score ----------------
Scores		Rules
.......		...............
20		network_udp_sock
20		network_tcp_listen
50		network_tcp_socket
50		network_dns
10		Str_Win32_Winsock2_Library
1		ft_exe
1		math_entropy_6
1		IsPE64
1		IsDLL
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
60		skip20_sqllang_hook
1		Contains_PE_File
10		Big_Numbers1
5		BASE64_table

Score total: 295

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f4ff94ccd882cc33c6ba26e441cfcc78                                                   |
| sha1                   | 9450342e37a232c76c1573c0f00b83f82f034289                                           |
| sha256                 | dbda182d31f85e507587ac6e37c56fe3380537d517573dd1f50050d1156b6f89                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FOn2n53XOvHjn9J2T4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | Socket Communication::Get Socket Status [C0001.012]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::Set Socket Config [C0001.001]                           |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| receive data (3 matches)                             | communication                                        |
| send data (4 matches)                                | communication                                        |
| get socket information (2 matches)                   | communication/socket                                 |
| get socket status                                    | communication/socket                                 |
| initialize Winsock library                           | communication/socket                                 |
| set socket configuration (17 matches)                | communication/socket                                 |
| encode data using Base64 (3 matches)                 | data-manipulation/encoding/base64                    |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (50 matches)                   | data-manipulation/encoding/xor                       |
| encrypt or decrypt data via BCrypt (2 matches)       | data-manipulation/encryption                         |
| encrypt data using DPAPI                             | data-manipulation/encryption/dpapi                   |
| hash data via BCrypt                                 | data-manipulation/hashing                            |
| hash data using fnv (32 matches)                     | data-manipulation/hashing/fnv                        |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get local IPv4 addresses (3 matches)                 | host-interaction/network/address                     |
| resolve DNS (4 matches)                              | host-interaction/network/dns/resolve                 |
| enumerate PE sections                                | load-code/pe                                         |
| parse PE header (11 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
3		- Discovery::System Network Configuration Discovery [T1016;3]

Score total: 16.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_udp_sock', '20'), ('network_tcp_listen', '20'), ('network_tcp_socket', '50'), ('network_dns', '50'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('skip20_sqllang_hook', '60'), ('Contains_PE_File', '1'), ('Big_Numbers1', '10'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['295']
-------------- CAPA_Score ------------
['16.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4994.676888155305
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FsLxKk3WwseRLc58mh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be a .NET module.
WARNING:capa: 
WARNING:capa: .NET is a cross-platform framework for running managed applications.
WARNING:capa: capa cannot handle non-native files. This means that the results may be misleading or incomplete.
WARNING:capa: You may have to analyze the file manually, using a tool like the .NET decompiler dnSpy.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) dotnet file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FsLxKk3WwseRLc58mh.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 24.289 sec (0 m 24 s)
Start Date: 2022:01:28 13:49:24
End Date:   2022:01:28 13:49:48

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:49:24Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FsLxKk3WwseRLc58mh.exe SCORE: 71 TYPE: EXE SIZE: 50688 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f8d8e3f4670> 
MD5: 9e600914f713d84ad23cc64d902a25ac 
SHA1: 262c2cfd9487e3762bbaa864d6a5f32681a70654 
SHA256: 2fb7d4574d11376d545b785b8751d79ef5405b79072a3e3d8106ff1a5349f777 CREATED: Fri Jan 28 13:49:24 2022 MODIFIED: Fri Jan 28 13:49:24 2022 ACCESSED: Fri Jan 28 13:49:49 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: dotnet_libraries SUBSCORE: 5 
DESCRIPTION: .Net runtime mscoree.dll mscorwks.dll REF: - AUTHOR: - 
MATCHES: Str1: mscoree.dll Str2: _CorDllMain
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsNET_DLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:49:49Z

-------- Score ----------------
Scores		Rules
.......		...............
1		ft_exe
1		math_entropy_5
5		dotnet_libraries
1		IsPE64
1		IsNET_DLL
1		IsDLL
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
1		Contains_PE_File

Score total: 71

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '1'), ('math_entropy_5', '1'), ('dotnet_libraries', '5'), ('IsPE64', '1'), ('IsNET_DLL', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['71']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1125.2741666473905
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fy9jAB1anZFw7wySud.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fy9jAB1anZFw7wySud.exe: Win.Trojan.Agent-1250609 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.47 MB
Data read: 0.45 MB (ratio 1.04:1)
Time: 25.912 sec (0 m 25 s)
Start Date: 2022:01:28 13:49:49
End Date:   2022:01:28 13:50:15

-------- Score ----------------
Scores		Rules
.......		...............
70		Win.Trojan.Agent-1250609
75		Win.Trojan.Agent-1250609
45		Win.Trojan.Agent-1250609

Score total: 190.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:49:49Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fy9jAB1anZFw7wySud.exe SCORE: 521 TYPE: EXE SIZE: 475138 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f425fbce670> 
MD5: a70052c45e907820187c7e6bcdc7ecca 
SHA1: a8ae62aac336c119176f83e1b3d8c663e141709d 
SHA256: 8aec186d533ab9acf93965808e61ec9a8df4b7de250395f1c4bb9b7653ed6d1a CREATED: Fri Jan 28 13:49:49 2022 MODIFIED: Fri Jan 28 13:49:49 2022 ACCESSED: Fri Jan 28 13:50:16 2022 
REASON_1: Yara Rule MATCH: network_tcp_listen SUBSCORE: 20 
DESCRIPTION: Listen for incoming communication REF: - AUTHOR: x0r 
MATCHES: Str1: WSOCK32.DLL Str2: bind Str3: accept Str4: WSAStartup Str5: listen
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.DLL Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: HttpOpenRequest Str6: HttpSendRequest
REASON_3: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WSOCK32.DLL Str2: socket Str3: send Str4: connect Str5: WSAStartup Str6: closesocket Str7: WSACleanup
REASON_4: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WSOCK32.DLL Str2: gethostbyname
REASON_5: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_6: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_7: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.DLL Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_8: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: CreateFileA Str5: SetFileAttributesA
REASON_9: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WSOCK32.DLL
REASON_10: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.DLL
REASON_11: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_12: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_13: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: misc_no_dosmode_header SUBSCORE: 10 
DESCRIPTION: Detect on absence of 'DOS Mode' heaader between MZ and PE boundries REF: - AUTHOR: Jason Batchelor
REASON_15: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: winsocks SUBSCORE: 5 
DESCRIPTION: Imports Winsock Library REF: - AUTHOR: -
REASON_18: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_20: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_21: Yara Rule MATCH: HasModified_DOS_Message SUBSCORE: 1 
DESCRIPTION: DOS Message Check REF: - AUTHOR: _pusher_
REASON_22: Yara Rule MATCH: MinGW_1 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: _pusher_ 
MATCHES: Str1: msvcrt.dll Str2: -LIBGCCW32-EH-2-SJLJ-GTHR-MINGW32
REASON_23: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_24: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_25: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: UnhookWindowsHookEx Str3: SetWindowsHookExA Str4: CallNextHookEx
REASON_26: Yara Rule MATCH: sitrof_fortis_scar SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: J from THL <j@techhelplist.com> 
MATCHES: Str1: ?get&version Str2: ?get&exe Str3: ?get&download Str4: ?get&module Str5: &ver= Str6: &comp= Str7: &addinfo=
REASON_27: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:50:16Z

-------- Score ----------------
Scores		Rules
.......		...............
20		network_tcp_listen
45		network_http
50		network_tcp_socket
50		network_dns
65		screenshot
80		keylogger
20		win_registry
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
1		ft_exe
10		misc_no_dosmode_header
1		math_entropy_6
15		dll_injection_hook
5		winsocks
1		IsPE32
2		IsWindowsGUI
1		HasOverlay
1		HasModified_DOS_Message
1		MinGW_1
2		PE_File
5		Anti_Automated_Sandbox
35		Win_Hook_v12
60		sitrof_fortis_scar
1		Contains_PE_File

Score total: 521

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a70052c45e907820187c7e6bcdc7ecca                                                   |
| sha1                   | a8ae62aac336c119176f83e1b3d8c663e141709d                                           |
| sha256                 | 8aec186d533ab9acf93965808e61ec9a8df4b7de250395f1c4bb9b7653ed6d1a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fy9jAB1anZFw7wySud.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Audio Capture:: \[T1123]\                                                           |
|                        | Clipboard Data:: \[T1115]\                                                          |
|                        | Input Capture::Keylogging \[T1056.001]\                                             |
|                        | Screen Capture:: \[T1113]\                                                          |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                             |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                  |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005             |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | Software Discovery:: \[T1518]\                                                      |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Network Configuration Discovery:: \[T1016]\                                  |
|                        | System Network Configuration Discovery::Internet Connection Discovery \[T1016.001]\ |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COLLECTION                  | Keylogging::Application Hook [F0002.001]                                      |
|                             | Keylogging::Polling [F0002.002]                                               |
|                             | Screen Capture::WinAPI [E1113.m01]                                            |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | Socket Communication::Create UDP Socket [C0001.010]                           |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| contain obfuscated stackstrings                      | anti-analysis/obfuscation/string/stackstring         |
| receive and write data from server to client         | c2/file-transfer                                     |
| log keystrokes via application hook                  | collection/keylog                                    |
| log keystrokes via polling (2 matches)               | collection/keylog                                    |
| capture microphone audio                             | collection/microphone                                |
| capture screenshot                                   | collection/screenshot                                |
| send data (6 matches)                                | communication                                        |
| send HTTP request with Host header                   | communication/http                                   |
| create UDP socket                                    | communication/socket/udp/send                        |
| encode data using XOR (2 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| read clipboard data                                  | host-interaction/clipboard                           |
| query environment variable (12 matches)              | host-interaction/environment-variable                |
| create directory (3 matches)                         | host-interaction/file-system/create                  |
| delete file (10 matches)                             | host-interaction/file-system/delete                  |
| check if file exists (20 matches)                    | host-interaction/file-system/exists                  |
| set file attributes (14 matches)                     | host-interaction/file-system/meta                    |
| read file on Windows (3 matches)                     | host-interaction/file-system/read                    |
| write file on Windows (6 matches)                    | host-interaction/file-system/write                   |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| get disk information                                 | host-interaction/hardware/storage                    |
| check Internet connectivity via WinINet (3 matches)  | host-interaction/network/connectivity                |
| resolve DNS (2 matches)                              | host-interaction/network/dns/resolve                 |
| get hostname                                         | host-interaction/os/hostname                         |
| check OS version (2 matches)                         | host-interaction/os/version                          |
| allocate thread local storage (3 matches)            | host-interaction/process                             |
| get thread local storage value (10 matches)          | host-interaction/process                             |
| set thread local storage value (9 matches)           | host-interaction/process                             |
| create process on Windows (8 matches)                | host-interaction/process/create                      |
| create process suspended                             | host-interaction/process/create                      |
| enumerate processes                                  | host-interaction/process/list                        |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| create thread (7 matches)                            | host-interaction/thread/create                       |
| terminate thread                                     | host-interaction/thread/terminate                    |
| enumerate PE sections (20 matches)                   | load-code/pe                                         |
| parse PE exports (3 matches)                         | load-code/pe                                         |
| parse PE header (21 matches)                         | load-code/pe                                         |
| persist via Run registry key (2 matches)             | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
4		- Execution::Command and Scripting Interpreter [T1059;4]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
2		- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::File and Directory Permissions Modification [T1222;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::File and Directory Discovery [T1083;1]
5		- Collection::Audio Capture [T1123;5]
4		- Collection::Clipboard Data [T1115;4]
4		- Collection::Screen Capture [T1113;4]
2		- Discovery::Software Discovery [T1518;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
3		- Discovery::System Network Configuration Discovery [T1016;3]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
1		- Discovery::Query Registry [T1012;1]

Score total: 81.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]', '2'), ('- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]', '8.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::File and Directory Permissions Modification [T1222;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Collection::Audio Capture [T1123;5]', '5'), ('- Collection::Clipboard Data [T1115;4]', '4'), ('- Collection::Screen Capture [T1113;4]', '4'), ('- Discovery::Software Discovery [T1518;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Agent-1250609', '70'), ('Win.Trojan.Agent-1250609', '75'), ('Win.Trojan.Agent-1250609', '45')]
-------------- LOKI_Rules ------------
[('network_tcp_listen', '20'), ('network_http', '45'), ('network_tcp_socket', '50'), ('network_dns', '50'), ('screenshot', '65'), ('keylogger', '80'), ('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '1'), ('misc_no_dosmode_header', '10'), ('math_entropy_6', '1'), ('dll_injection_hook', '15'), ('winsocks', '5'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasModified_DOS_Message', '1'), ('MinGW_1', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Win_Hook_v12', '35'), ('sitrof_fortis_scar', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['521']
-------------- CAPA_Score ------------
['81.5']
-------------- CLAMAV_Score ------------
['190.0']
-------------- SCORE FINAL ------------
12275.390601830955
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FP0vcS1jICDuqFUtx6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FP0vcS1jICDuqFUtx6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.16 MB
Data read: 0.16 MB (ratio 1.02:1)
Time: 24.801 sec (0 m 24 s)
Start Date: 2022:01:28 13:50:21
End Date:   2022:01:28 13:50:46

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:50:22Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FP0vcS1jICDuqFUtx6.exe SCORE: 195 TYPE: EXE SIZE: 167936 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f31540d7670> 
MD5: db931bcbb03f78ecd39a793ba37201c4 
SHA1: 9f4cb9a7916366c71c07db6446c2fcbfdab4bf38 
SHA256: d19342e870809bcf20d3bac6bb7c92ca86253df615dbea835f2040e6e5a94391 CREATED: Fri Jan 28 13:50:21 2022 MODIFIED: Fri Jan 28 13:50:21 2022 ACCESSED: Fri Jan 28 13:50:47 2022 
REASON_1: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: MapVirtualKey
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: DuplicateTokenEx Str3: OpenProcessToken
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:50:47Z

-------- Score ----------------
Scores		Rules
.......		...............
80		keylogger
20		win_registry
10		win_token
1		ft_exe
1		math_entropy_6
1		IsPE64
1		IsDLL
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
1		Contains_PE_File

Score total: 195

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | db931bcbb03f78ecd39a793ba37201c4                                                   |
| sha1                   | 9f4cb9a7916366c71c07db6446c2fcbfdab4bf38                                           |
| sha256                 | d19342e870809bcf20d3bac6bb7c92ca86253df615dbea835f2040e6e5a94391                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FP0vcS1jICDuqFUtx6.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| inspect load icon resource                           | anti-analysis                                        |
| execute anti-debugging instructions                  | anti-analysis/anti-debugging/debugger-detection      |
| log keystrokes                                       | collection/keylog                                    |
| check HTTP status code                               | communication/http/client                            |
| encode data using XOR (18 matches)                   | data-manipulation/encoding/xor                       |
| hash data using murmur3                              | data-manipulation/hashing/murmur                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)  | executable/resource                                  |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| find graphical window                                | host-interaction/gui/window/find                     |
| register raw input devices (2 matches)               | host-interaction/hardware                            |
| print debug messages (2 matches)                     | host-interaction/log/debug/write-event               |
| create process on Windows                            | host-interaction/process/create                      |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (6 matches)        | host-interaction/registry                            |
| set registry value (2 matches)                       | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| link many functions at runtime                       | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Application Window Discovery [T1010;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]

Score total: 33.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('keylogger', '80'), ('win_registry', '20'), ('win_token', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Check_OutputDebugStringA_iat_v1', '30'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['195']
-------------- CAPA_Score ------------
['33.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3758.954600813746
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FBCzQn2TVRUazsleNi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3fdfb2d522e7deecaaaf2f87420f7e75                                                   |
| sha1                   | a48505f1c45f50c4f028703bce826e38fc1f9b3c                                           |
| sha256                 | 70445e660358ef905cc01149dd3ffc604822a57a7dc32698f9f799d51ad57b62                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FBCzQn2TVRUazsleNi.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| decompress data using aPLib                          | data-manipulation/compression                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| access PEB ldr_data                                  | linking/runtime-linking                              |
| parse PE header (5 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FBCzQn2TVRUazsleNi.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.933 sec (0 m 24 s)
Start Date: 2022:01:28 13:50:53
End Date:   2022:01:28 13:51:18

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:50:53Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:51:18Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
79.81049259875519
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FNT6yxQ37JW6Dlnnb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6bad650a415802b2213368d9e32e46c5                                                   |
| sha1                   | 19085001edec67a61bda3d151ee4e09a3afcc825                                           |
| sha256                 | ff851f2724c4c35995c945f67e8c156ca34dc98f6f7381febb1c09aa0c624e46                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FNT6yxQ37JW6Dlnnb.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FNT6yxQ37JW6Dlnnb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 24.736 sec (0 m 24 s)
Start Date: 2022:01:28 13:51:19
End Date:   2022:01:28 13:51:43

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:51:19Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FNT6yxQ37JW6Dlnnb.exe SCORE: 70 TYPE: EXE SIZE: 63488 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fca7084a670> 
MD5: 6bad650a415802b2213368d9e32e46c5 
SHA1: 19085001edec67a61bda3d151ee4e09a3afcc825 
SHA256: ff851f2724c4c35995c945f67e8c156ca34dc98f6f7381febb1c09aa0c624e46 CREATED: Fri Jan 28 13:51:19 2022 MODIFIED: Fri Jan 28 13:51:19 2022 ACCESSED: Fri Jan 28 13:51:44 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:51:44Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		ft_exe
1		math_entropy_5
1		IsPE64
1		IsDLL
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
1		Contains_PE_File

Score total: 70

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['70']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1189.2357273215346
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FdJqcG3CpmZJtT8Flk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FdJqcG3CpmZJtT8Flk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 3.16 MB
Data read: 2.97 MB (ratio 1.06:1)
Time: 26.482 sec (0 m 26 s)
Start Date: 2022:01:28 13:51:44
End Date:   2022:01:28 13:52:11

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa7 in position 8: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa6 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xac in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe9 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x91 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcf in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa5 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xae in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdc in position 15: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:51:45Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FdJqcG3CpmZJtT8Flk.exe SCORE: 904 TYPE: EXE SIZE: 3120640 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f1cdb8b4670> 
MD5: 6cc148363200798a12091b97a17181a1 
SHA1: be0ad25b7b48347984908175404996531cfd74b7 
SHA256: dbaf4a8c8431fd80cc5160dfdaca7adb301adc26ab7e3a48be9543edf539ea8d CREATED: Fri Jan 28 13:51:45 2022 MODIFIED: Fri Jan 28 13:51:45 2022 ACCESSED: Fri Jan 28 13:52:11 2022 
REASON_1: Yara Rule MATCH: network_tcp_listen SUBSCORE: 20 
DESCRIPTION: Listen for incoming communication REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: bind Str3: accept Str4: WSAStartup Str5: WSASocket Str6: listen
REASON_2: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: WSASocket Str3: socket Str4: send Str5: WSASend Str6: connect Str7: WSAStartup
REASON_3: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: WS2_32.dll Str2: getaddrinfo Str3: gethostbyname
REASON_4: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose
REASON_6: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: ConventionEngine_Keyword_Reverse SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_9: Yara Rule MATCH: ConventionEngine_Keyword_Shell SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_10: Yara Rule MATCH: ConventionEngine_Keyword_Proxy SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_11: Yara Rule MATCH: ConventionEngine_Keyword_Client SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_12: Yara Rule MATCH: ConventionEngine_Term_Desktop SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_13: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344534551402ba7163d4cb5a8b5c04db3dfaf01000000433a5c55736572735c763069645c4465736b746f705c726576657273655368656c6c5c636c69656e74507 ... (truncated)
REASON_14: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_18: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_19: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER
REASON_21: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER
REASON_22: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier Str3: IDENTIFIER
REASON_23: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_24: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_25: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_26: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_27: Yara Rule MATCH: browser_pass SUBSCORE: 10 
DESCRIPTION: This module is intended for forensicators and pen-testers to find passwords in memory that can help their case/engagement. REF: https://github.com/swoodsec/YARA-RULES/blob/master/browserpass.yar AUTHOR: swood 
MATCHES: Str1: password=
REASON_28: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_29: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 44f95cb9056da018991f9cc488ff7f38 Str2: e7b51236358cf576f2311ad760d4f7a8 Str3: d3284d61fdd76368e9f0ca0747334655 Str4: 0493be962c3f6830 ... (truncated)
REASON_30: Yara Rule MATCH: Big_Numbers2 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 48:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 666666666666666666666666666666666666666666666666
REASON_31: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_32: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
REASON_33: Yara Rule MATCH: BLOWFISH_Constants SUBSCORE: 25 
DESCRIPTION: Look for Blowfish constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: a60b31d1 Str2: acb5df98 Str3: db72fd2f Str4: b7df1ad0 Str5: e9707a4b Str6: 1c264cf6
REASON_34: Yara Rule MATCH: MD5_Constants SUBSCORE: 20 
DESCRIPTION: Look for MD5 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: 78a46ad7
REASON_35: Yara Rule MATCH: RIPEMD160_Constants SUBSCORE: 15 
DESCRIPTION: Look for RIPEMD-160 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3
REASON_36: Yara Rule MATCH: SHA1_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA1 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3 Str6: d6c162ca
REASON_37: Yara Rule MATCH: SHA512_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA384/SHA512 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: 982f8a42 Str2: 91443771 Str3: cffbc0b5 Str4: a5dbb5e9 Str5: 22ae28d7
REASON_38: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
REASON_39: Yara Rule MATCH: WHIRLPOOL_Constants SUBSCORE: 15 
DESCRIPTION: Look for WhirlPool constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: 18186018c07830d8 Str2: 23238c2305af4626
REASON_40: Yara Rule MATCH: DES_Long SUBSCORE: 15 
DESCRIPTION: DES [long] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 10801040000000000080100000001040100000401080000000800040008010000080000010001040100000000080004010001000008010400000104010000000
REASON_41: Yara Rule MATCH: RijnDael_AES_CHAR SUBSCORE: 15 
DESCRIPTION: RijnDael AES (check2) [char] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0
REASON_42: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
REASON_43: Yara Rule MATCH: ecc_order SUBSCORE: 15 
DESCRIPTION: Look for known Elliptic curve orders REF: - AUTHOR: spelissier 
MATCHES: Str1: fffffffffffffffffffffffe26f2fc170f69466a74defd8d Str2: ffffffffffffffffffffffff99def836146bc9b1b4d22831 Str3: 01000000000000000000000 ... (truncated)
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:52:14Z

-------- Score ----------------
Scores		Rules
.......		...............
20		network_tcp_listen
50		network_tcp_socket
50		network_dns
5		win_mutex
10		win_files_operation
10		Str_Win32_Winsock2_Library
1		ft_exe
50		ConventionEngine_Keyword_Reverse
50		ConventionEngine_Keyword_Shell
50		ConventionEngine_Keyword_Proxy
50		ConventionEngine_Keyword_Client
50		ConventionEngine_Term_Desktop
50		ConventionEngine_Term_Users
1		math_entropy_6
1		IsPE64
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
60		DebuggerException__SetConsoleCtrl_v1
30		Check_OutputDebugStringA_iat_v1
30		Check_OutputDebugStringA_iat
10		anti_dbg
10		browser_pass
1		Contains_PE_File
10		Big_Numbers1
10		Big_Numbers2
25		CRC32_poly_Constant
25		CRC32_table
25		BLOWFISH_Constants
20		MD5_Constants
15		RIPEMD160_Constants
20		SHA1_Constants
20		SHA512_Constants
20		SHA2_BLAKE2_IVs
15		WHIRLPOOL_Constants
15		DES_Long
15		RijnDael_AES_CHAR
5		BASE64_table
15		ecc_order

Score total: 904

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6cc148363200798a12091b97a17181a1                                                   |
| sha1                   | be0ad25b7b48347984908175404996531cfd74b7                                           |
| sha256                 | dbaf4a8c8431fd80cc5160dfdaca7adb301adc26ab7e3a48be9543edf539ea8d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FdJqcG3CpmZJtT8Flk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Execution Guardrails::Runs as Service [E1480.m07]                             |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | Socket Communication::Get Socket Status [C0001.012]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::Set Socket Config [C0001.001]                           |
| CRYPTOGRAPHY                | Crypto Library:: [C0059]                                                      |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
|                             | Cryptographic Hash::SHA224 [C0029.004]                                        |
|                             | Cryptographic Hash::SHA256 [C0029.003]                                        |
|                             | Decrypt Data::AES [C0031.001]                                                 |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encrypt Data::Blowfish [C0027.002]                                            |
|                             | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Checksum::Adler [C0032.005]                                                   |
|                             | Compression Library:: [C0060]                                                 |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| DISCOVERY                   | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+--------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                             | NAMESPACE                                            |
|--------------------------------------------------------+------------------------------------------------------|
| check for software breakpoints                         | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via GetTickCount (2 matches)      | anti-analysis/anti-debugging/debugger-detection      |
| receive data (4 matches)                               | communication                                        |
| send data (4 matches)                                  | communication                                        |
| check HTTP status code (3 matches)                     | communication/http/client                            |
| get socket information (3 matches)                     | communication/socket                                 |
| get socket status (3 matches)                          | communication/socket                                 |
| initialize Winsock library (3 matches)                 | communication/socket                                 |
| set socket configuration (8 matches)                   | communication/socket                                 |
| compute adler32 checksum                               | data-manipulation/checksum/adler32                   |
| encode data using Base64 (3 matches)                   | data-manipulation/encoding/base64                    |
| reference Base64 string                                | data-manipulation/encoding/base64                    |
| encode data using XOR (130 matches)                    | data-manipulation/encoding/xor                       |
| decrypt data using AES via x86 extensions (10 matches) | data-manipulation/encryption/aes                     |
| encrypt data using AES via x86 extensions (18 matches) | data-manipulation/encryption/aes                     |
| reference AES constants (4 matches)                    | data-manipulation/encryption/aes                     |
| encrypt data using blowfish                            | data-manipulation/encryption/blowfish                |
| encrypt data using DPAPI (2 matches)                   | data-manipulation/encryption/dpapi                   |
| encrypt data using RC4 PRGA (5 matches)                | data-manipulation/encryption/rc4                     |
| hash data with MD5 (3 matches)                         | data-manipulation/hashing/md5                        |
| hash data using murmur3 (2 matches)                    | data-manipulation/hashing/murmur                     |
| hash data using SHA1 (3 matches)                       | data-manipulation/hashing/sha1                       |
| hash data using SHA224 (2 matches)                     | data-manipulation/hashing/sha224                     |
| hash data using SHA256 (2 matches)                     | data-manipulation/hashing/sha256                     |
| authenticate HMAC (2 matches)                          | data-manipulation/hmac                               |
| contains PDB path                                      | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                     | executable/pe/section/rsrc                           |
| accept command line arguments                          | host-interaction/cli                                 |
| check if file exists                                   | host-interaction/file-system/exists                  |
| read file on Windows                                   | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                      | host-interaction/file-system/write                   |
| get memory capacity                                    | host-interaction/hardware/memory                     |
| print debug messages (5 matches)                       | host-interaction/log/debug/write-event               |
| access the Windows event log                           | host-interaction/log/winevt/access                   |
| check mutex and exit                                   | host-interaction/mutex                               |
| get local IPv4 addresses (3 matches)                   | host-interaction/network/address                     |
| resolve DNS                                            | host-interaction/network/dns/resolve                 |
| allocate thread local storage (2 matches)              | host-interaction/process                             |
| get thread local storage value (29 matches)            | host-interaction/process                             |
| set thread local storage value (23 matches)            | host-interaction/process                             |
| terminate process                                      | host-interaction/process/terminate                   |
| run as service                                         | host-interaction/service                             |
| create thread (3 matches)                              | host-interaction/thread/create                       |
| terminate thread                                       | host-interaction/thread/terminate                    |
| link many functions at runtime                         | linking/runtime-linking                              |
| linked against OpenSSL                                 | linking/static/openssl                               |
| linked against ZLIB                                    | linking/static/zlib                                  |
| enumerate PE sections (20 matches)                     | load-code/pe                                         |
| parse PE exports (5 matches)                           | load-code/pe                                         |
| parse PE header (85 matches)                           | load-code/pe                                         |
+--------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::File and Directory Discovery [T1083;1]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
3		- Discovery::System Network Configuration Discovery [T1016;3]

Score total: 47.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_tcp_listen', '20'), ('network_tcp_socket', '50'), ('network_dns', '50'), ('win_mutex', '5'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('ConventionEngine_Keyword_Reverse', '50'), ('ConventionEngine_Keyword_Shell', '50'), ('ConventionEngine_Keyword_Proxy', '50'), ('ConventionEngine_Keyword_Client', '50'), ('ConventionEngine_Term_Desktop', '50'), ('ConventionEngine_Term_Users', '50'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('Check_OutputDebugStringA_iat_v1', '30'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('browser_pass', '10'), ('Contains_PE_File', '1'), ('Big_Numbers1', '10'), ('Big_Numbers2', '10'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25'), ('BLOWFISH_Constants', '25'), ('MD5_Constants', '20'), ('RIPEMD160_Constants', '15'), ('SHA1_Constants', '20'), ('SHA512_Constants', '20'), ('SHA2_BLAKE2_IVs', '20'), ('WHIRLPOOL_Constants', '15'), ('DES_Long', '15'), ('RijnDael_AES_CHAR', '15'), ('BASE64_table', '5'), ('ecc_order', '15')]
-------------- LOKI_Score ------------
['904']
-------------- CAPA_Score ------------
['47.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
15275.184059458681
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FnkNkDBbSSHiMXuY9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a9c55bb87a7c5c3c923c4fa12940e719                                                   |
| sha1                   | d971656c6c605a6e2130ab83a38420e655428f94                                           |
| sha256                 | 57d8d248a8741176348b5d12dcf29f34c8f48ede0ca13c30d12e5ba0384056d7                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FnkNkDBbSSHiMXuY9.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| PERSISTENCE            | Event Triggered Execution:: \[T1546]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Set Registry Key [C0036.001]                                        |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| persist via GinaDLL registry key                     | persistence/registry/ginadll                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Persistence::Event Triggered Execution [T1546;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 8.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FnkNkDBbSSHiMXuY9.exe: Win.Trojan.Agent-595082 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.08:1)
Time: 25.064 sec (0 m 25 s)
Start Date: 2022:01:28 13:56:21
End Date:   2022:01:28 13:56:46

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:56:21Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FnkNkDBbSSHiMXuY9.exe SCORE: 83 TYPE: EXE SIZE: 53248 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fc7a6479670> 
MD5: a9c55bb87a7c5c3c923c4fa12940e719 
SHA1: d971656c6c605a6e2130ab83a38420e655428f94 
SHA256: 57d8d248a8741176348b5d12dcf29f34c8f48ede0ca13c30d12e5ba0384056d7 CREATED: Fri Jan 28 13:56:21 2022 MODIFIED: Fri Jan 28 13:56:21 2022 ACCESSED: Fri Jan 28 13:56:46 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey Str3: RegSetValueExA
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: CreateFileA
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_4 SUBSCORE: 1 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_11: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:56:46Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
1		ft_exe
1		math_entropy_4
1		IsPE32
1		IsConsole
1		HasRichSignature
35		Embedded_PE
2		PE_File
5		SEH_Save
5		SEH_Init
1		Contains_PE_File

Score total: 83

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Persistence::Event Triggered Execution [T1546;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_4', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasRichSignature', '1'), ('Embedded_PE', '35'), ('PE_File', '2'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['83']
-------------- CAPA_Score ------------
['8.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1485.0586465150789
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FhExoc4mrVJHXO2qg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FhExoc4mrVJHXO2qg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.24 MB
Data read: 0.23 MB (ratio 1.03:1)
Time: 25.083 sec (0 m 25 s)
Start Date: 2022:01:28 13:56:47
End Date:   2022:01:28 13:57:12

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x90 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf7 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 12: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 12: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8f in position 12: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:56:47Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FhExoc4mrVJHXO2qg.exe SCORE: 389 TYPE: EXE SIZE: 244224 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7faf224a2670> 
MD5: 1e609dffd12a59ea5d5c9b3055939b1f 
SHA1: 0a6cd87f09ae5961fce6ca9c1c2aeda8a99447fb 
SHA256: 57771f6312b091fb5450112864e56413ae2a2a2874289e8245eb3a0d286577e9 CREATED: Fri Jan 28 13:56:47 2022 MODIFIED: Fri Jan 28 13:56:47 2022 ACCESSED: Fri Jan 28 13:57:13 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: win_rdat_auto SUBSCORE: 45 
DESCRIPTION: Detects win.rdat. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 48984885c0751e483bfb Str2: 4885c0751e483bfb731383c8ff Str3: 48ffc34038341a75f74883791810488b7910 Str4: 669048ffc34038341a75f748837918 ... (truncated)
REASON_5: Yara Rule MATCH: ConventionEngine_Term_Documents SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344532d3ad0ab66582a428f2eb2a659aaccc303000000433a5c55736572735c4361726c6f732044616e6765725c446f63756d656e74735c56697375616c2053747 ... (truncated)
REASON_6: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344532d3ad0ab66582a428f2eb2a659aaccc303000000433a5c55736572735c4361726c6f732044616e6765725c446f63756d656e74735c56697375616c2053747 ... (truncated)
REASON_7: Yara Rule MATCH: ConventionEngine_Term_VisualStudio SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344532d3ad0ab66582a428f2eb2a659aaccc303000000433a5c55736572735c4361726c6f732044616e6765725c446f63756d656e74735c56697375616c2053747 ... (truncated)
REASON_8: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA
REASON_10: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_17: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_18: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_19: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:57:13Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
10		win_files_operation
1		ft_exe
45		win_rdat_auto
50		ConventionEngine_Term_Documents
50		ConventionEngine_Term_Users
50		ConventionEngine_Term_VisualStudio
1		math_entropy_6
15		dll_injection_thread
1		IsPE64
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
45		Inject_Thread
10		anti_dbg
1		Contains_PE_File

Score total: 389

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 1e609dffd12a59ea5d5c9b3055939b1f                                                   |
| sha1                   | 0a6cd87f09ae5961fce6ca9c1c2aeda8a99447fb                                           |
| sha256                 | 57771f6312b091fb5450112864e56413ae2a2a2874289e8245eb3a0d286577e9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FhExoc4mrVJHXO2qg.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| CREDENTIAL ACCESS      | Credentials from Password Stores::Password Managers \[T1555.005]\                  |
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Software Discovery:: \[T1518]\                                                     |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| steal KeePass passwords using KeeFarce               | collection/password-manager                          |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| set environment variable                             | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| write file on Windows                                | host-interaction/file-system/write                   |
| inject thread (2 matches)                            | host-interaction/process/inject                      |
| enumerate processes                                  | host-interaction/process/list                        |
| enumerate process modules                            | host-interaction/process/modules/list                |
| terminate process via fastfail                       | host-interaction/process/terminate                   |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (9 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
8		- Credential Access::Credentials from Password Stores::Password Managers [T1555.005;8]
2		- Discovery::Process Discovery [T1057;2]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]
4		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;4]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2		- Discovery::Software Discovery [T1518;2]

Score total: 25.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Credential Access::Credentials from Password Stores::Password Managers [T1555.005;8]', '8'), ('- Discovery::Process Discovery [T1057;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]', '4'), ('- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Discovery::Software Discovery [T1518;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('win_files_operation', '10'), ('ft_exe', '1'), ('win_rdat_auto', '45'), ('ConventionEngine_Term_Documents', '50'), ('ConventionEngine_Term_Users', '50'), ('ConventionEngine_Term_VisualStudio', '50'), ('math_entropy_6', '1'), ('dll_injection_thread', '15'), ('IsPE64', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Inject_Thread', '45'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['389']
-------------- CAPA_Score ------------
['25.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6664.05009741595
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FOCB02JySnmFS4JQl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | bf3700789059bda100668d870aa7da4f                                                   |
| sha1                   | be3b9f386af5437f5a8948d6d11e9c21eb71b6b5                                           |
| sha256                 | 9f3db7047a20988b5790f6aafe0f06c3201ce8c7419915ff5c1c6647c27b64ad                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FOCB02JySnmFS4JQl.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| link function at runtime on Windows (3 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FOCB02JySnmFS4JQl.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.282 sec (0 m 24 s)
Start Date: 2022:01:28 13:57:14
End Date:   2022:01:28 13:57:38

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:57:14Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:57:38Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
79.81049259875519
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FIKN2O3UOAqHXoht.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b40fcca78adbc528f5ac0dac3df3a959                                                   |
| sha1                   | 1859e6b054d245f863973d0844a23348a2593a31                                           |
| sha256                 | 1953c9e88e24fd6594170a1f62da21b27847595e067ef9dba7e07543d0e3a510                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FIKN2O3UOAqHXoht.exe                          |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FIKN2O3UOAqHXoht.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.10 MB
Data read: 0.10 MB (ratio 1.00:1)
Time: 25.005 sec (0 m 25 s)
Start Date: 2022:01:28 13:57:39
End Date:   2022:01:28 13:58:04

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:57:39Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:58:04Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
79.81049259875519
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FAtvZO1W5UtThccWud.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 07f7846bbcda782e5639292ad93907eb                                                   |
| sha1                   | 19929c80e9191bf101da7f8f164984f49c6df8d4                                           |
| sha256                 | a52c3792d8cef6019ce67203220dc191e207c6ddbdfa51ac385d9493ffe2a83a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FAtvZO1W5UtThccWud.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Automated Collection:: \[T1119]\                                                    |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Indicator Removal from Tools T1027.005             |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
|                        | System Information Discovery:: \[T1082]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-STATIC ANALYSIS        | Disassembler Evasion::Argument Obfuscation [B0012.001]                        |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key::RC4 KSA [C0028.002]                                           |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| contain obfuscated stackstrings                       | anti-analysis/obfuscation/string/stackstring         |
| parse credit card information                         | collection/credit-card                               |
| check HTTP status code                                | communication/http/client                            |
| encode data using Base64 (2 matches)                  | data-manipulation/encoding/base64                    |
| reference Base64 string                               | data-manipulation/encoding/base64                    |
| encrypt data using RC4 KSA                            | data-manipulation/encryption/rc4                     |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| get common file path (2 matches)                      | host-interaction/file-system                         |
| read file on Windows                                  | host-interaction/file-system/read                    |
| write file on Windows                                 | host-interaction/file-system/write                   |
| get disk information                                  | host-interaction/hardware/storage                    |
| get hostname                                          | host-interaction/os/hostname                         |
| create a process with modified I/O handles and window | host-interaction/process/create                      |
| create process on Windows                             | host-interaction/process/create                      |
| parse PE exports                                      | load-code/pe                                         |
| parse PE header                                       | load-code/pe                                         |
| write file to startup folder                          | persistence/startup-folder                           |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
5.5		- Collection::Automated Collection [T1119;5.5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 34.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FAtvZO1W5UtThccWud.exe: Win.Trojan.Datper-6736003-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.178 sec (0 m 24 s)
Start Date: 2022:01:28 13:58:05
End Date:   2022:01:28 13:58:29

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Datper-6736003-0

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:58:05Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:58:30Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Collection::Automated Collection [T1119;5.5]', '5.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Datper-6736003-0', '45')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['34.0']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
1244.9056223967946
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FSc4Mi2Gx0lAWA5cBg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FSc4Mi2Gx0lAWA5cBg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.28 MB
Data read: 0.27 MB (ratio 1.06:1)
Time: 25.220 sec (0 m 25 s)
Start Date: 2022:01:28 13:58:30
End Date:   2022:01:28 13:58:55

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:58:30Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FSc4Mi2Gx0lAWA5cBg.exe SCORE: 276 TYPE: EXE SIZE: 280064 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f6029ebf670> 
MD5: 605a2773eb23be4393f1a6938dfb34af 
SHA1: dd7b39389aec906d3355ccc2becb57f0fc876587 
SHA256: f9057ba9c9f2e6cc22c0c25d3d834f8cd80ac9a749e0609c2b91f79d62d0ad51 CREATED: Fri Jan 28 13:58:30 2022 MODIFIED: Fri Jan 28 13:58:30 2022 ACCESSED: Fri Jan 28 13:58:56 2022 
REASON_1: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetOpenUrl Str5: InternetReadFile Str6: InternetWriteFile
REASON_2: Yara Rule MATCH: network_ftp SUBSCORE: 60 
DESCRIPTION: Communications over FTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: FtpGetCurrentDirectory Str3: FtpGetFile Str4: FtpPutFile Str5: FtpSetCurrentDirectory Str6: FtpOpenFile Str7: FtpDe ... (truncated)
REASON_3: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetAsyncKeyState Str3: GetKeyState
REASON_4: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_5: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_6: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: DeleteFileA Str5: FindFirstFileA Str6: FindClose
REASON_7: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_8: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_9: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 33333333333333333333
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:58:56Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_http
60		network_ftp
80		keylogger
5		win_mutex
20		win_registry
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
1		ft_exe
1		math_entropy_6
1		IsPE64
1		IsDLL
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
10		anti_dbg
1		Contains_PE_File
10		Big_Numbers0

Score total: 276

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 605a2773eb23be4393f1a6938dfb34af                                                   |
| sha1                   | dd7b39389aec906d3355ccc2becb57f0fc876587                                           |
| sha256                 | f9057ba9c9f2e6cc22c0c25d3d834f8cd80ac9a749e0609c2b91f79d62d0ad51                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FSc4Mi2Gx0lAWA5cBg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Open URL [C0002.004]                                      |
|                             | HTTP Communication::Send Data [C0002.005]                                     |
| CRYPTOGRAPHY                | Encrypt Data:: [C0027]                                                        |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| OPERATING SYSTEM            | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location                            | collection                                           |
| log keystrokes via polling (3 matches)               | collection/keylog                                    |
| receive data                                         | communication                                        |
| send data                                            | communication                                        |
| parse URL                                            | communication/http                                   |
| connect to URL                                       | communication/http/client                            |
| create HTTP request                                  | communication/http/client                            |
| encrypt data using DPAPI (2 matches)                 | data-manipulation/encryption/dpapi                   |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| get file system object information (2 matches)       | host-interaction/file-system                         |
| check if file exists (2 matches)                     | host-interaction/file-system/exists                  |
| get graphical window text (3 matches)                | host-interaction/gui/window/get-text                 |
| create process on Windows                            | host-interaction/process/create                      |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (6 matches)        | host-interaction/registry                            |
| parse PE header (7 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Location Discovery [T1614;3]
1		- Discovery::File and Directory Discovery [T1083;1]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]

Score total: 32.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_http', '45'), ('network_ftp', '60'), ('keylogger', '80'), ('win_mutex', '5'), ('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1'), ('Big_Numbers0', '10')]
-------------- LOKI_Score ------------
['276']
-------------- CAPA_Score ------------
['32.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5022.765463557558
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fw83113g4VWOYEb4Yg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a5d66324daaee5672b913aa461d4bd3a                                                   |
| sha1                   | 856263bb665825de8c47ca649f33868df9eb79df                                           |
| sha256                 | 0e9d5b57db6d9d75bfa5837b62bd8402688433a998bf3d6ee9430898a7686025                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fw83113g4VWOYEb4Yg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Process Doppelgänging \[T1055.013]\                             |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get file size                                        | host-interaction/file-system/meta                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| use process Doppelgänging                            | host-interaction/process/inject                      |
| terminate process                                    | host-interaction/process/terminate                   |
| link many functions at runtime                       | linking/runtime-linking                              |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Defense Evasion::Process Injection::Process Doppelgänging [T1055.013;4]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 9.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fw83113g4VWOYEb4Yg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.18 MB
Data read: 0.17 MB (ratio 1.05:1)
Time: 25.223 sec (0 m 25 s)
Start Date: 2022:01:28 13:59:00
End Date:   2022:01:28 13:59:26

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:59:01Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fw83113g4VWOYEb4Yg.exe SCORE: 178 TYPE: EXE SIZE: 180736 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7ffa28cda670> 
MD5: a5d66324daaee5672b913aa461d4bd3a 
SHA1: 856263bb665825de8c47ca649f33868df9eb79df 
SHA256: 0e9d5b57db6d9d75bfa5837b62bd8402688433a998bf3d6ee9430898a7686025 CREATED: Fri Jan 28 13:59:00 2022 MODIFIED: Fri Jan 28 13:59:00 2022 ACCESSED: Fri Jan 28 13:59:26 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_7: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_9: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_10: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_11: Yara Rule MATCH: Process_Doppelganging SUBSCORE: 35 
DESCRIPTION: Detect Process Doppelganging REF: https://www.blackhat.com/docs/eu-17/materials/eu-17-Liberman-Lost-In-Transaction-Process-Doppelganging.pdf AUTHOR: McAfee ATR - Thomas Roccia - @fr0gger_ 
MATCHES: Str1: CreateTransaction Str2: CreateFileTransacted Str3: WriteFile Str4: RollbackTransaction Str5: CreateProcess Str6: CreateProcessParamet ... (truncated)
REASON_12: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_13: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:59:27Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
1		ft_exe
1		math_entropy_6
1		IsPE64
1		IsConsole
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
35		Process_Doppelganging
60		Debugger_Check__QueryInfo
10		anti_dbg
1		Contains_PE_File

Score total: 178

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Defense Evasion::Process Injection::Process Doppelgänging [T1055.013;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsConsole', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Process_Doppelganging', '35'), ('Debugger_Check__QueryInfo', '60'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['178']
-------------- CAPA_Score ------------
['9.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3000.683490927981
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F8ITg2hQWrrgIyArc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ba0422ccb92c557e2d54a826242cdd08                                                   |
| sha1                   | b77b2f349b076821b4f0daf5374fe5b2b8e40a91                                           |
| sha256                 | b31a65a8740c6ac91ccf81bc7e0e0f04e205ad453cfc35ceac60d1e6b51f9549                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F8ITg2hQWrrgIyArc.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F8ITg2hQWrrgIyArc.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.13 MB
Data read: 0.12 MB (ratio 1.06:1)
Time: 24.771 sec (0 m 24 s)
Start Date: 2022:01:28 13:59:27
End Date:   2022:01:28 13:59:52

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:59:27Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-F8ITg2hQWrrgIyArc.exe SCORE: 79 TYPE: EXE SIZE: 132096 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f35cb2d3670> 
MD5: ba0422ccb92c557e2d54a826242cdd08 
SHA1: b77b2f349b076821b4f0daf5374fe5b2b8e40a91 
SHA256: b31a65a8740c6ac91ccf81bc7e0e0f04e205ad453cfc35ceac60d1e6b51f9549 CREATED: Fri Jan 28 13:59:27 2022 MODIFIED: Fri Jan 28 13:59:27 2022 ACCESSED: Fri Jan 28 13:59:52 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetConnect
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T12:59:53Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
10		Str_Win32_Internet_API
1		ft_exe
1		math_entropy_6
1		IsPE64
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
1		Contains_PE_File

Score total: 79

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('Str_Win32_Internet_API', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['79']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1331.8761146430347
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F2WCf31D9brmBEIyEg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3d547b8c756973b61a634db99aca74d8                                                   |
| sha1                   | b7d9c8fd14e8419c6f1b5d62d8dfafe8ed12be06                                           |
| sha256                 | f0aeee2d6851b6d1b616e85ccb24ea4045c1d00880c39be644b4899f9cac398c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F2WCf31D9brmBEIyEg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery :: \[T1016]\                                |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| get domain controller name                           | host-interaction/network/domain                      |
| get hostname                                         | host-interaction/os/hostname                         |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (3 matches)        | host-interaction/registry                            |
| set registry value (3 matches)                       | host-interaction/registry/create                     |
| delete registry key (2 matches)                      | host-interaction/registry/delete                     |
| delete registry value                                | host-interaction/registry/delete                     |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]
3		- Discovery::System Network Configuration Discovery [T1016;3]

Score total: 12.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F2WCf31D9brmBEIyEg.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 24.215 sec (0 m 24 s)
Start Date: 2022:01:28 13:59:53
End Date:   2022:01:28 14:00:17

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T12:59:53Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:00:18Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['12.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
249.40778937110997
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FFJqNO3rNIfmHeoewd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9a86c3da2f39f3c6b1a4291f6940f6ea                                                   |
| sha1                   | 42e18468193e656b0e782be8023947a7e4c941d1                                           |
| sha256                 | 2235f03245ab289919a5c0b2272bf2f3a6a6a1e091944be1dfce79831678a71d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FFJqNO3rNIfmHeoewd.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FFJqNO3rNIfmHeoewd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 23.940 sec (0 m 23 s)
Start Date: 2022:01:28 14:00:18
End Date:   2022:01:28 14:00:42

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:00:18Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:00:43Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
39.905246299377595
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F6lfEa1x7ZVM6jZFt7.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 0a0882b8da225406cc838991b5f67d11                                                   |
| sha1                   | ef62537d97d436b6e7c03190ef35e9dbb4ef997d                                           |
| sha256                 | aa2316ff30647295efac2c884b30b6e83a8515c2d2ff1df3c5d6091b404c73a9                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F6lfEa1x7ZVM6jZFt7.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Network Share Discovery:: \[T1135]\                                                |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | Windows Management Instrumentation:: \[T1047]\                                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings targeting VirtualBox       | anti-analysis/anti-vm/vm-detection                   |
| receive data                                         | communication                                        |
| send data (2 matches)                                | communication                                        |
| reference Google Public DNS server                   | communication/dns                                    |
| connect network resource                             | communication/http                                   |
| parse URL                                            | communication/http                                   |
| check HTTP status code (2 matches)                   | communication/http/client                            |
| encode data using XOR (18 matches)                   | data-manipulation/encoding/xor                       |
| encrypt data using Curve25519 (2 matches)            | data-manipulation/encryption/elliptic-curve          |
| encrypt data using Salsa20 or ChaCha                 | data-manipulation/encryption/salsa20                 |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| get file size                                        | host-interaction/file-system/meta                    |
| move file                                            | host-interaction/file-system/move                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| enumerate disk volumes (2 matches)                   | host-interaction/hardware/storage                    |
| get disk information (3 matches)                     | host-interaction/hardware/storage                    |
| enumerate network shares                             | host-interaction/network                             |
| get hostname (2 matches)                             | host-interaction/os/hostname                         |
| get system information on Windows                    | host-interaction/os/info                             |
| get session user name (2 matches)                    | host-interaction/session                             |
| create thread                                        | host-interaction/thread/create                       |
| connect to WMI namespace via WbemLocator             | host-interaction/wmi                                 |
| link function at runtime on Windows (5 matches)      | linking/runtime-linking                              |
| enumerate PE sections (2 matches)                    | load-code/pe                                         |
| parse PE exports (4 matches)                         | load-code/pe                                         |
| parse PE header (8 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
4.5		- Execution::Windows Management Instrumentation [T1047;4.5]
3		- Discovery::Account Discovery [T1087;3]
2		- Execution::Shared Modules [T1129;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 36.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F6lfEa1x7ZVM6jZFt7.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.17 MB
Data read: 0.16 MB (ratio 1.05:1)
Time: 25.428 sec (0 m 25 s)
Start Date: 2022:01:28 14:00:43
End Date:   2022:01:28 14:01:08

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:00:43Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F6lfEa1x7ZVM6jZFt7.exe SCORE: 274 TYPE: EXE SIZE: 173056 
FIRST_BYTES: 4d5a98000300000004000000ffff0000b8000000 / <filter object at 0x7f925ba81670> 
MD5: 0a0882b8da225406cc838991b5f67d11 
SHA1: ef62537d97d436b6e7c03190ef35e9dbb4ef997d 
SHA256: aa2316ff30647295efac2c884b30b6e83a8515c2d2ff1df3c5d6091b404c73a9 CREATED: Fri Jan 28 14:00:43 2022 MODIFIED: Fri Jan 28 14:00:43 2022 ACCESSED: Fri Jan 28 14:01:08 2022 
REASON_1: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: HttpOpenRequest Str6: HttpSendRequest
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: FindClose
REASON_3: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_4: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_5: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: SUSP_XORed_URL_in_EXE SUBSCORE: 50 
DESCRIPTION: Detects an XORed URL in an executable REF: https://twitter.com/stvemillertime/status/1237035794973560834 AUTHOR: Florian Roth 
MATCHES: Str1: yeea+>> Str2: yeeab+>>
REASON_8: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: vbox
REASON_14: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_15: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: IsDebuggerPresent
REASON_17: Yara Rule MATCH: RansomSampleChimeraB SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: YOUR_FILES_ARE_ENCRYPTED.HTML
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: Chacha_128_constant SUBSCORE: 15 
DESCRIPTION: Look for 128-bit key Chacha stream cipher constant REF: https://www.ecrypt.eu.org/stream/salsa20pf.html AUTHOR: spelissier 
MATCHES: Str1: expand 16-byte k
REASON_20: Yara Rule MATCH: Chacha_256_constant SUBSCORE: 15 
DESCRIPTION: Look for 256-bit key Chacha stream cipher constant REF: https://tools.ietf.org/html/rfc8439#page-8 AUTHOR: spelissier 
MATCHES: Str1: expand 32-byte k Str2: expand 3 Str3: 2-byte k
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:01:09Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_http
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
1		ft_exe
50		SUSP_XORed_URL_in_EXE
1		math_entropy_6
1		IsPE32
2		IsWindowsGUI
1		HasDebugData
2		PE_File
10		VBox_Detection
5		SEH_Save
5		SEH_Init
10		anti_dbg
70		RansomSampleChimeraB
1		Contains_PE_File
15		Chacha_128_constant
15		Chacha_256_constant

Score total: 274

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Windows Management Instrumentation [T1047;4.5]', '4.5'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_http', '45'), ('win_files_operation', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '1'), ('SUSP_XORed_URL_in_EXE', '50'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('PE_File', '2'), ('VBox_Detection', '10'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('RansomSampleChimeraB', '70'), ('Contains_PE_File', '1'), ('Chacha_128_constant', '15'), ('Chacha_256_constant', '15')]
-------------- LOKI_Score ------------
['274']
-------------- CAPA_Score ------------
['36.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5070.878092307092
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FjMmaOwHCpf5FawJh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FjMmaOwHCpf5FawJh.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 1.03 MB
Data read: 0.97 MB (ratio 1.06:1)
Time: 25.407 sec (0 m 25 s)
Start Date: 2022:01:28 14:01:09
End Date:   2022:01:28 14:01:34

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:01:09Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FjMmaOwHCpf5FawJh.exe SCORE: 167 TYPE: EXE SIZE: 1015944 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa0a4c0c670> 
MD5: 7a32d32f1e6d327f9adab871ba83aef3 
SHA1: 3f9a3bc046fad113fcc5a809ab98dce495cecaa5 
SHA256: 2bb06d7f050031f587eb3041952ba5312deeb234ecfe658136bf17a7450db2fc CREATED: Fri Jan 28 14:01:09 2022 MODIFIED: Fri Jan 28 14:01:09 2022 ACCESSED: Fri Jan 28 14:01:35 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_17: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 0ef37e9732bb247e3978f5e17dd65686 Str2: c7c7d9542f7252f4362267a060bbc20d Str3: d70dd71faf241293299ef257245aa4bc Str4: fdaeaf418c9d7e82 ... (truncated)
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:01:36Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		misc_pe_signature
1		ft_exe
20		research_pe_signed_outside_timestamp
1		math_entropy_6
1		IsPE64
1		IsDLL
1		IsConsole
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
60		Debugger_Check__QueryInfo
1		Contains_PE_File
10		Big_Numbers1

Score total: 167

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 7a32d32f1e6d327f9adab871ba83aef3                                                   |
| sha1                   | 3f9a3bc046fad113fcc5a809ab98dce495cecaa5                                           |
| sha256                 | 2bb06d7f050031f587eb3041952ba5312deeb234ecfe658136bf17a7450db2fc                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FjMmaOwHCpf5FawJh.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (3 matches)           | host-interaction/process/terminate                   |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (18 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('Debugger_Check__QueryInfo', '60'), ('Contains_PE_File', '1'), ('Big_Numbers1', '10')]
-------------- LOKI_Score ------------
['167']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2726.5821240088144
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FTunRh30TFAFh0AQQ4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FTunRh30TFAFh0AQQ4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.30 MB
Data read: 0.29 MB (ratio 1.05:1)
Time: 25.250 sec (0 m 25 s)
Start Date: 2022:01:28 14:03:14
End Date:   2022:01:28 14:03:39

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:03:14Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FTunRh30TFAFh0AQQ4.exe SCORE: 92 TYPE: EXE SIZE: 304712 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fee1513c670> 
MD5: 3188cdc07256812f554e31432ef6b8c6 
SHA1: 13929ad3e0ab7c77cf9d7e6ef955df3a795d4c78 
SHA256: 4d7b19afa6159fc77c593115143da7c47ee09e7f0fd4da58eb7b371c75be4748 CREATED: Fri Jan 28 14:03:14 2022 MODIFIED: Fri Jan 28 14:03:14 2022 ACCESSED: Fri Jan 28 14:03:40 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:03:41Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		misc_pe_signature
1		ft_exe
20		research_pe_signed_outside_timestamp
1		math_entropy_6
1		IsPE64
2		IsWindowsGUI
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
1		Contains_PE_File

Score total: 92

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3188cdc07256812f554e31432ef6b8c6                                                   |
| sha1                   | 13929ad3e0ab7c77cf9d7e6ef955df3a795d4c78                                           |
| sha256                 | 4d7b19afa6159fc77c593115143da7c47ee09e7f0fd4da58eb7b371c75be4748                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FTunRh30TFAFh0AQQ4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for PEB BeingDebugged flag (2 matches)         | anti-analysis/anti-debugging/debugger-detection      |
| listen for remote procedure calls                    | communication/rpc/server                             |
| encrypt or decrypt data via BCrypt (4 matches)       | data-manipulation/encryption                         |
| hash data via BCrypt (3 matches)                     | data-manipulation/hashing                            |
| generate random numbers via WinAPI (2 matches)       | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get system information on Windows                    | host-interaction/os/info                             |
| terminate process via fastfail (21 matches)          | host-interaction/process/terminate                   |
| get kernel32 base address (3 matches)                | linking/runtime-linking                              |
| access PE header                                     | load-code/pe                                         |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 15.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['92']
-------------- CAPA_Score ------------
['15.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1767.3673958844006
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FMy4vL3PVzC9TGBa5e.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2b8bec5bcb1777eaa155d832f7afc797                                                   |
| sha1                   | 356d60df7a64367ca059d8e1fae02a9d4160e9da                                           |
| sha256                 | 782a48821d88060adf0f7ef3e8759fee3ddad49e942daad18c5af8ae0e9eb51e                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FMy4vL3PVzC9TGBa5e.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
| PERSISTENCE            | Scheduled Task/Job::Scheduled Task \[T1053.005]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | Socket Communication::Connect Socket [C0001.004]                              |
|                             | Socket Communication::Create TCP Socket [C0001.011]                           |
|                             | Socket Communication::Create UDP Socket [C0001.010]                           |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::TCP Client [C0001.008]                                  |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Encryption Key::RC4 KSA [C0028.002]                                           |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| receive data (2 matches)                             | communication                                        |
| send data                                            | communication                                        |
| creates tcp or udp socket (4 matches)                | communication/socket                                 |
| create UDP socket                                    | communication/socket/udp/send                        |
| act as TCP client (3 matches)                        | communication/tcp/client                             |
| decode data using Base64 via WinAPI (7 matches)      | data-manipulation/encoding/base64                    |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| create new key via CryptAcquireContext               | data-manipulation/encryption                         |
| decrypt data via SSPI                                | data-manipulation/encryption                         |
| encrypt data via SSPI                                | data-manipulation/encryption                         |
| get client handle via SChannel                       | data-manipulation/encryption                         |
| encrypt data using RC4 KSA (2 matches)               | data-manipulation/encryption/rc4                     |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable                           | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| create directory                                     | host-interaction/file-system/create                  |
| delete directory                                     | host-interaction/file-system/delete                  |
| delete file                                          | host-interaction/file-system/delete                  |
| write file on Windows                                | host-interaction/file-system/write                   |
| enumerate gui resources                              | host-interaction/gui                                 |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| hide graphical window                                | host-interaction/gui/window/hide                     |
| get disk information                                 | host-interaction/hardware/storage                    |
| check mutex                                          | host-interaction/mutex                               |
| create mutex                                         | host-interaction/mutex                               |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| get session user name (2 matches)                    | host-interaction/session                             |
| create thread (2 matches)                            | host-interaction/thread/create                       |
| access PEB ldr_data (2 matches)                      | linking/runtime-linking                              |
| parse PE exports                                     | load-code/pe                                         |
| schedule task via ITaskScheduler                     | persistence/scheduled-tasks                          |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Owner/User Discovery [T1033;3]
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::File and Directory Discovery [T1083;1]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
3		- Discovery::Account Discovery [T1087;3]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
5		- Persistence/Scheduled Task/Job/Scheduled Task [T1053.005;5]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
3		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
1		- Discovery::System Information Discovery [T1082;1]
3		- Discovery::System Network Configuration Discovery [T1016;3]

Score total: 48.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FMy4vL3PVzC9TGBa5e.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.03 MB
Data read: 0.03 MB (ratio 1.00:1)
Time: 24.380 sec (0 m 24 s)
Start Date: 2022:01:28 14:03:50
End Date:   2022:01:28 14:04:14

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf4 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 0-1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:03:50Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FMy4vL3PVzC9TGBa5e.exe SCORE: 319 TYPE: EXE SIZE: 31232 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f8047386670> 
MD5: 2b8bec5bcb1777eaa155d832f7afc797 
SHA1: 356d60df7a64367ca059d8e1fae02a9d4160e9da 
SHA256: 782a48821d88060adf0f7ef3e8759fee3ddad49e942daad18c5af8ae0e9eb51e CREATED: Fri Jan 28 14:03:50 2022 MODIFIED: Fri Jan 28 14:03:50 2022 ACCESSED: Fri Jan 28 14:04:15 2022 
REASON_1: Yara Rule MATCH: network_tcp_socket SUBSCORE: 50 
DESCRIPTION: Communications over RAW socket REF: - AUTHOR: x0r 
MATCHES: Str1: ws2_32.dll Str2: wsock32.dll Str3: socket Str4: send Str5: connect Str6: WSAStartup Str7: closesocket Str8: WSACleanup
REASON_2: Yara Rule MATCH: network_dns SUBSCORE: 50 
DESCRIPTION: Communications use DNS REF: - AUTHOR: x0r 
MATCHES: Str1: ws2_32.dll Str2: dnsapi.dll Str3: wsock32.dll Str4: getaddrinfo Str5: DnsQuery
REASON_3: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: OpenProcessToken
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: WriteFile Str3: SetFilePointer Str4: DeleteFileA Str5: CreateFileA Str6: CopyFile
REASON_6: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: ws2_32.dll Str2: wsock32.dll
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: win_systembc_auto SUBSCORE: 45 
DESCRIPTION: Detects win.systembc. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: ff75fce830030000ff75fce8620200005e5f Str2: 4f8bc75e5f Str3: 8b85f4feffffeb038b46185e5f5bc9 Str4: 8b450cab8b4514ab Str5: 74f4368a94290 ... (truncated)
REASON_9: Yara Rule MATCH: MiniTor SUBSCORE: 50 
DESCRIPTION: Identifies MiniTor implementation as seen in SystemBC and Parallax RAT. REF: https://news.sophos.com/en-us/2020/12/16/systembc/ AUTHOR: @bartblaze 
MATCHES: Str1: 558bec81c4f0fdffff5157568d4df42bcc518d44241050e8472500006a0f8d8500feffff50680c834000e8ad2400008d850ffeffff506a14ff7510e8b42800008d85f ... (truncated)
REASON_10: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645d305c645d401c645d500c645 Str2: c645d401c645d500c645d601c645 Str3: c645d500c645d601c645d700c645 Str4: c645d601c645d700c645d800c645 ... (truncated)
REASON_12: Yara Rule MATCH: winsocks SUBSCORE: 5 
DESCRIPTION: Imports Winsock Library REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Antivirus_strings SUBSCORE: 50 
DESCRIPTION: Contains references to security software REF: - AUTHOR: Jerome Athias 
MATCHES: Str1: guard.exe
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:04:15Z

-------- Score ----------------
Scores		Rules
.......		...............
50		network_tcp_socket
50		network_dns
5		win_mutex
10		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
1		ft_exe
45		win_systembc_auto
50		MiniTor
1		math_entropy_5
5		obfuscation_singlebyte_mov
5		winsocks
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
2		PE_File
50		Antivirus_strings
1		Contains_PE_File
20		Advapi_Hash_API

Score total: 319

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Persistence/Scheduled Task/Job/Scheduled Task [T1053.005;5]', '5'), ('- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]', '4'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_tcp_socket', '50'), ('network_dns', '50'), ('win_mutex', '5'), ('win_token', '10'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('win_systembc_auto', '45'), ('MiniTor', '50'), ('math_entropy_5', '1'), ('obfuscation_singlebyte_mov', '5'), ('winsocks', '5'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Antivirus_strings', '50'), ('Contains_PE_File', '1'), ('Advapi_Hash_API', '20')]
-------------- LOKI_Score ------------
['319']
-------------- CAPA_Score ------------
['48.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6013.535195136014
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FMfm7C4SPDkt1qglpe.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b94af4a4d4af6eac81fc135abda1c40c                                                   |
| sha1                   | d6356b2c6f8d29f8626062b5aefb13b7fc744d54                                           |
| sha256                 | 6ac06dfa543dca43327d55a61d0aaed25f3c90cce791e0555e3e306d47107859                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FMfm7C4SPDkt1qglpe.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Indicator Removal on Host::File Deletion \[T1070.004]\                             |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                 |
|                        | Modify Registry:: \[T1112]\                                                        |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery:: \[T1016]\                                 |
| EXECUTION              | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | DNS Communication::Resolve [C0011.001]                                        |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | Socket Communication::Connect Socket [C0001.004]                              |
|                             | Socket Communication::Create TCP Socket [C0001.011]                           |
|                             | Socket Communication::Initialize Winsock Library [C0001.009]                  |
|                             | Socket Communication::Receive Data [C0001.006]                                |
|                             | Socket Communication::Send Data [C0001.007]                                   |
|                             | Socket Communication::TCP Client [C0001.008]                                  |
| DEFENSE EVASION             | Self Deletion::COMSPEC Environment Variable [F0007.001]                       |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| self delete                                          | anti-analysis/anti-forensic/self-deletion            |
| timestomp file                                       | anti-analysis/anti-forensic/timestomp                |
| read and send data from client to server             | c2/file-transfer                                     |
| receive and write data from server to client         | c2/file-transfer                                     |
| creates tcp or udp socket                            | communication/socket                                 |
| initialize Winsock library                           | communication/socket                                 |
| act as TCP client                                    | communication/tcp/client                             |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| resolve DNS                                          | host-interaction/network/dns/resolve                 |
| create process on Windows                            | host-interaction/process/create                      |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| modify service                                       | host-interaction/service/modify                      |
| persist via Windows service                          | persistence/service                                  |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Execution::System Services::Service Execution [T1569.002;3]
1		- Discovery::File and Directory Discovery [T1083;1]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
8.5		- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Network Configuration Discovery [T1016;3]

Score total: 52.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FMfm7C4SPDkt1qglpe.exe: Win.Dropper.Ulise-9937584-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 24.772 sec (0 m 24 s)
Start Date: 2022:01:28 14:04:15
End Date:   2022:01:28 14:04:40

-------- Score ----------------
Scores		Rules
.......		...............
30		Win.Dropper.Ulise-9937584-0

Score total: 30.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 0: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:04:15Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FMfm7C4SPDkt1qglpe.exe SCORE: 78 TYPE: EXE SIZE: 61440 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f59792b2670> 
MD5: b94af4a4d4af6eac81fc135abda1c40c 
SHA1: d6356b2c6f8d29f8626062b5aefb13b7fc744d54 
SHA256: 6ac06dfa543dca43327d55a61d0aaed25f3c90cce791e0555e3e306d47107859 CREATED: Fri Jan 28 14:04:15 2022 MODIFIED: Fri Jan 28 14:04:15 2022 ACCESSED: Fri Jan 28 14:04:41 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegSetValueExA
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: kernel32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: DeleteFileA Str7: CreateFileA Str8: CopyFil ... (truncated)
REASON_3: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_11: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_12: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: VC6_Random SUBSCORE: 15 
DESCRIPTION: Look for Random function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: a180c1400069c0fd43030005c39e2600a380c14000c1f81025ff7f0000c3
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:04:41Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
10		Str_Win32_Winsock2_Library
1		ft_exe
1		math_entropy_5
1		IsPE32
1		IsConsole
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
5		SEH_Save
5		SEH_Init
1		Contains_PE_File
15		VC6_Random

Score total: 78

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]', '8.5'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]', '8.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3')]
---------------- ClamAV_Rules --------------
[('Win.Dropper.Ulise-9937584-0', '30')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Contains_PE_File', '1'), ('VC6_Random', '15')]
-------------- LOKI_Score ------------
['78']
-------------- CAPA_Score ------------
['52.0']
-------------- CLAMAV_Score ------------
['30.0']
-------------- SCORE FINAL ------------
2651.4307174417363
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FMZq2l4Y0nrg4xVuCe.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FMZq2l4Y0nrg4xVuCe.exe: Win.Malware.Beaugrit-9835568-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 24.266 sec (0 m 24 s)
Start Date: 2022:01:28 14:04:41
End Date:   2022:01:28 14:05:05

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Beaugrit-9835568-0

Score total: 50.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:04:41Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FMZq2l4Y0nrg4xVuCe.exe SCORE: 226 TYPE: EXE SIZE: 53346 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4751ca3670> 
MD5: 9324d1a8ae37a36ae560c37448c9705a 
SHA1: 042eb46fbd8480f85a860266907cab24954d57e1 
SHA256: a3d7bfbdd9e9f72fb9201a8e7f05f524007ed3ac2172c51a49bd361cb39aaf0f CREATED: Fri Jan 28 14:04:41 2022 MODIFIED: Fri Jan 28 14:04:41 2022 ACCESSED: Fri Jan 28 14:05:06 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: CreateFileA Str7: CopyFile
REASON_5: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_6: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_7: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetOpen
REASON_8: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645f072c645f175c645f26ec645 Str2: c645f633c645f732c645f82ec645 Str3: c645f732c645f82ec645f965c645 Str4: c645f82ec645f965c645fa78c645 ... (truncated)
REASON_11: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_14: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_18: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_19: Yara Rule MATCH: LimaAlfa SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: Novetta Threat Research & Interdiction Group - trig@novetta.com 
MATCHES: Str1: 33c0668b028be881e500f0ffff81fd00300000750d8b6c241825ff0f000003c701
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:05:06Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
10		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
1		ft_exe
1		math_entropy_5
5		obfuscation_singlebyte_mov
1		IsPE32
2		IsWindowsGUI
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
5		SEH_Init
60		LimaAlfa
1		Contains_PE_File

Score total: 226

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Beaugrit-9835568-0', '50')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '10'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('obfuscation_singlebyte_mov', '5'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('SEH_Init', '5'), ('LimaAlfa', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['226']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['50.0']
-------------- SCORE FINAL ------------
4211.3213208592
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FBiqOV3uF5V8LZXdHi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | dafbfa941f1d5af65c296a2b22d0ec7a                                                   |
| sha1                   | eaad1642d87dc72247930f93d7800f5e4c12e82c                                           |
| sha256                 | 5319c6b57e4dbf9cf23362bce0835a5deae25ff1036ea2766033333db6295f97                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FBiqOV3uF5V8LZXdHi.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FBiqOV3uF5V8LZXdHi.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.25 MB
Data read: 0.24 MB (ratio 1.03:1)
Time: 25.076 sec (0 m 25 s)
Start Date: 2022:01:28 14:05:06
End Date:   2022:01:28 14:05:31

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:05:07Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:05:32Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
79.81049259875519
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FLeyLi2czosbrwIyYl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FLeyLi2czosbrwIyYl.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.30 MB
Data read: 0.28 MB (ratio 1.06:1)
Time: 25.026 sec (0 m 25 s)
Start Date: 2022:01:28 14:05:32
End Date:   2022:01:28 14:05:57

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:05:33Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FLeyLi2czosbrwIyYl.exe SCORE: 181 TYPE: EXE SIZE: 297472 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7ff09050c670> 
MD5: fd5ea005e9ac54c8692ef8d8dbcc8a0c 
SHA1: 084e7e6db9b1047ff1171bc29696ae4a00459197 
SHA256: d40375ca08c682192bd6f57dcc43f056eb75ce61afb9172776253589be21194c CREATED: Fri Jan 28 14:05:32 2022 MODIFIED: Fri Jan 28 14:05:32 2022 ACCESSED: Fri Jan 28 14:05:58 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_2: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:05:58Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
80		keylogger
20		win_registry
1		ft_exe
1		math_entropy_6
1		IsPE64
1		IsDLL
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
1		Contains_PE_File

Score total: 181

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | fd5ea005e9ac54c8692ef8d8dbcc8a0c                                                   |
| sha1                   | 084e7e6db9b1047ff1171bc29696ae4a00459197                                           |
| sha256                 | d40375ca08c682192bd6f57dcc43f056eb75ce61afb9172776253589be21194c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FLeyLi2czosbrwIyYl.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location                            | collection                                           |
| log keystrokes via polling                           | collection/keylog                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (5 matches)  | executable/resource                                  |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| get file system object information (2 matches)       | host-interaction/file-system                         |
| delete file (5 matches)                              | host-interaction/file-system/delete                  |
| get file size (4 matches)                            | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| query or enumerate registry value                    | host-interaction/registry                            |
| set registry value                                   | host-interaction/registry/create                     |
| create thread                                        | host-interaction/thread/create                       |
| resume thread                                        | host-interaction/thread/resume                       |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Location Discovery [T1614;3]
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]

Score total: 27.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('screenshot', '65'), ('keylogger', '80'), ('win_registry', '20'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['181']
-------------- CAPA_Score ------------
['27.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3417.353814971057
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FygJrX2jOmc4mD2mz9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 8b21545a9a6b5fa8894bb8ec4d06de5b                                                   |
| sha1                   | 3feb6f204ad4a1a8653f66e73dc35c9555f49b88                                           |
| sha256                 | 6e9d3fc3e4c502592e48a42aaa498180eaa11a2b3dbb2e5aede88a2e74ad8f43                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FygJrX2jOmc4mD2mz9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FygJrX2jOmc4mD2mz9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 24.130 sec (0 m 24 s)
Start Date: 2022:01:28 14:06:03
End Date:   2022:01:28 14:06:27

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa5 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:06:03Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FygJrX2jOmc4mD2mz9.exe SCORE: 118 TYPE: EXE SIZE: 64248 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fabfbe78670> 
MD5: 8b21545a9a6b5fa8894bb8ec4d06de5b 
SHA1: 3feb6f204ad4a1a8653f66e73dc35c9555f49b88 
SHA256: 6e9d3fc3e4c502592e48a42aaa498180eaa11a2b3dbb2e5aede88a2e74ad8f43 CREATED: Fri Jan 28 14:06:03 2022 MODIFIED: Fri Jan 28 14:06:03 2022 ACCESSED: Fri Jan 28 14:06:28 2022 
REASON_1: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: ConventionEngine_Keyword_Install SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453a5fa96a1a66ab8489e4408a7632f3eda01000000453a5c5744462d494d4339302d4a4f42315c77696e31305f6275696c647465616d5f4d6f6465726e2e536 ... (truncated)
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 2 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:06:28Z

-------- Score ----------------
Scores		Rules
.......		...............
1		misc_pe_signature
1		ft_exe
50		ConventionEngine_Keyword_Install
1		math_entropy_5
1		IsPE64
2		IsWindowsGUI
1		HasOverlay
1		HasDebugData
2		ImportTableIsBad
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
1		Contains_PE_File

Score total: 118

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('misc_pe_signature', '1'), ('ft_exe', '1'), ('ConventionEngine_Keyword_Install', '50'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('ImportTableIsBad', '2'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['118']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1910.0792134034912
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F2yB5L1RAzr1kIPWw.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 61908f4d70ce6f16173e76aa42a8c25a                                                   |
| sha1                   | fd47522692c262de30da8d1f682dd014281d9317                                           |
| sha256                 | d7ff81ff775d4ab50d31ac1e962c8c4dea7ff9f280aa2b42ddd06760a5665002                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F2yB5L1RAzr1kIPWw.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::User Activity Based Checks \[T1497.002]\           |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection::Human User Check [B0009.012]                       |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for unmoving mouse cursor                      | anti-analysis/anti-vm/vm-detection                   |
| get geographical location                            | collection                                           |
| decompress data using aPLib                          | data-manipulation/compression                        |
| encode data using XOR (3 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| read file on Windows                                 | host-interaction/file-system/read                    |
| read file via mapping                                | host-interaction/file-system/read                    |
| check OS version                                     | host-interaction/os/version                          |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| terminate process                                    | host-interaction/process/terminate                   |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Location Discovery [T1614;3]
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
7.5		- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 23.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F2yB5L1RAzr1kIPWw.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 24.055 sec (0 m 24 s)
Start Date: 2022:01:28 14:06:28
End Date:   2022:01:28 14:06:52

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:06:28Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-F2yB5L1RAzr1kIPWw.exe SCORE: 60 TYPE: EXE SIZE: 45056 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7effa48f2670> 
MD5: 61908f4d70ce6f16173e76aa42a8c25a 
SHA1: fd47522692c262de30da8d1f682dd014281d9317 
SHA256: d7ff81ff775d4ab50d31ac1e962c8c4dea7ff9f280aa2b42ddd06760a5665002 CREATED: Fri Jan 28 14:06:28 2022 MODIFIED: Fri Jan 28 14:06:28 2022 ACCESSED: Fri Jan 28 14:06:52 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: SetFilePointer Str3: ReadFile Str4: CreateFileA
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_7 SUBSCORE: 1 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPacked SUBSCORE: 5 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_11: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:06:53Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
1		ft_exe
1		math_entropy_7
1		IsPE32
2		IsWindowsGUI
5		IsPacked
1		HasOverlay
1		HasRichSignature
2		PE_File
5		SEH_Save
5		SEH_Init
1		Contains_PE_File
25		CRC32_poly_Constant

Score total: 60

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]', '7.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_7', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('IsPacked', '5'), ('HasOverlay', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Contains_PE_File', '1'), ('CRC32_poly_Constant', '25')]
-------------- LOKI_Score ------------
['60']
-------------- CAPA_Score ------------
['23.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1419.8225594943547
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FfMGeJ2V1Rf8yyoxQ9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c56af5561e3f20bed435fb4355cffc29                                                   |
| sha1                   | 7e0e6900f4528e7dacb65ab1b1c107425d2a321b                                           |
| sha256                 | 70aaf2b367b97fa35d599a6db4d08875206ef18c99d8c8c5b5f25e4f5509931a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FfMGeJ2V1Rf8yyoxQ9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                          |
| CREDENTIAL ACCESS      | Credentials from Password Stores::Windows Credential Manager \[T1555.004]\          |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                         |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                         |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | Software Discovery:: \[T1518]\                                                      |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                               |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| acquire credentials from Windows Credential Manager  | collection                                           |
| encode data using XOR (9 matches)                    | data-manipulation/encoding/xor                       |
| authenticate HMAC (2 matches)                        | data-manipulation/hmac                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (4 matches)  | executable/resource                                  |
| open clipboard                                       | host-interaction/clipboard                           |
| replace clipboard data                               | host-interaction/clipboard                           |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| delete file (3 matches)                              | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| read .ini file (7 matches)                           | host-interaction/file-system/read                    |
| read file on Windows (2 matches)                     | host-interaction/file-system/read                    |
| read file via mapping                                | host-interaction/file-system/read                    |
| write file on Windows (4 matches)                    | host-interaction/file-system/write                   |
| enumerate gui resources                              | host-interaction/gui                                 |
| get graphical window text (2 matches)                | host-interaction/gui/window/get-text                 |
| hide graphical window                                | host-interaction/gui/window/hide                     |
| enumerate internet cache                             | host-interaction/internet/cache                      |
| read process memory                                  | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| enumerate processes                                  | host-interaction/process/list                        |
| acquire debug privileges                             | host-interaction/process/modify                      |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| delete registry value                                | host-interaction/registry/delete                     |
| link many functions at runtime (7 matches)           | linking/runtime-linking                              |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (4 matches)                          | load-code/pe                                         |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Collection::Clipboard Data [T1115;4]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Discovery::Software Discovery [T1518;2]
2		- Execution::Shared Modules [T1129;2]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
3		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
8		- Credential Access::Credentials from Password Stores::Windows Credential Manager [T1555.004;8]

Score total: 57.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FfMGeJ2V1Rf8yyoxQ9.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.09 MB
Data read: 0.09 MB (ratio 1.00:1)
Time: 25.401 sec (0 m 25 s)
Start Date: 2022:01:28 14:06:53
End Date:   2022:01:28 14:07:18

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:06:53Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FfMGeJ2V1Rf8yyoxQ9.exe SCORE: 254 TYPE: EXE SIZE: 101376 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fea672b1670> 
MD5: c56af5561e3f20bed435fb4355cffc29 
SHA1: 7e0e6900f4528e7dacb65ab1b1c107425d2a321b 
SHA256: 70aaf2b367b97fa35d599a6db4d08875206ef18c99d8c8c5b5f25e4f5509931a CREATED: Fri Jan 28 14:06:53 2022 MODIFIED: Fri Jan 28 14:06:53 2022 ACCESSED: Fri Jan 28 14:07:19 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: SeDebugPrivilege Str4: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: RegQueryValueExA Str4: RegOpenKeyExA Str5: RegCloseKey
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: AdjustTokenPrivileges Str4: OpenProcessToken Str5: LookupPrivilegeValueA
REASON_5: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: GetPrivateProfileIntA Str4: GetPrivateProfileStringA Str5: WritePrivateProfileStringA
REASON_6: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: DeleteFileA Str7: CreateFileA Str8: FindFir ... (truncated)
REASON_7: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_8: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645f401c645f500c645f600c645 Str2: c645f500c645f600c645f700c645 Str3: c645ec01c645f0d0c645f18cc645 Str4: c645f0d0c645f18cc645f29dc645 ... (truncated)
REASON_11: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_16: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext
REASON_19: Yara Rule MATCH: DES_sbox SUBSCORE: 15 
DESCRIPTION: DES [sbox] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:07:19Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
65		screenshot
20		win_registry
10		win_token
10		win_private_profile
10		win_files_operation
10		Str_Win32_Wininet_Library
1		ft_exe
1		math_entropy_6
5		obfuscation_singlebyte_mov
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
5		SEH_Init
1		Contains_PE_File
20		Advapi_Hash_API
15		DES_sbox

Score total: 254

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Collection::Clipboard Data [T1115;4]', '4'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Discovery::Software Discovery [T1518;2]', '2'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Credential Access::Credentials from Password Stores::Windows Credential Manager [T1555.004;8]', '8')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('screenshot', '65'), ('win_registry', '20'), ('win_token', '10'), ('win_private_profile', '10'), ('win_files_operation', '10'), ('Str_Win32_Wininet_Library', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('obfuscation_singlebyte_mov', '5'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('SEH_Init', '5'), ('Contains_PE_File', '1'), ('Advapi_Hash_API', '20'), ('DES_sbox', '15')]
-------------- LOKI_Score ------------
['254']
-------------- CAPA_Score ------------
['57.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5162.928228383489
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FdW3y13U39hnK0LoX9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e2bf42217a67e46433da8b6f4507219e                                                   |
| sha1                   | daf263702f11dc0430d30f9bf443e7885cf91fcb                                           |
| sha256                 | ae8a1c7eb64c42ea2a04f97523ebf0844c27029eb040d910048b680f884b9dce                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FdW3y13U39hnK0LoX9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Process Hollowing \[T1055.012]\                                 |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Resume Thread:: [C0054]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| get common file path                                 | host-interaction/file-system                         |
| get file size                                        | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| read process memory                                  | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| use process replacement                              | host-interaction/process/inject                      |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| enumerate PE sections                                | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
4		- Defense Evasion::Process Injection::Process Hollowing [T1055.012;4]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 9.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FdW3y13U39hnK0LoX9.exe: Win.Malware.Explorerhijack-9937586-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FdW3y13U39hnK0LoX9.exe: Win.Malware.Explorerhijack-9937587-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 24.703 sec (0 m 24 s)
Start Date: 2022:01:28 14:07:19
End Date:   2022:01:28 14:07:44

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.Explorerhijack-9937586-0
50		Win.Malware.Explorerhijack-9937587-0

Score total: 100.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:07:19Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FdW3y13U39hnK0LoX9.exe SCORE: 88 TYPE: EXE SIZE: 53248 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f586b3db670> 
MD5: e2bf42217a67e46433da8b6f4507219e 
SHA1: daf263702f11dc0430d30f9bf443e7885cf91fcb 
SHA256: ae8a1c7eb64c42ea2a04f97523ebf0844c27029eb040d910048b680f884b9dce CREATED: Fri Jan 28 14:07:19 2022 MODIFIED: Fri Jan 28 14:07:19 2022 ACCESSED: Fri Jan 28 14:07:44 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: CreateFileA
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_4 SUBSCORE: 1 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_7: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: ThreadControl__Context_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetThreadContext
REASON_9: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_10: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:07:45Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
1		ft_exe
1		math_entropy_4
1		IsPE32
1		IsConsole
1		HasRichSignature
2		PE_File
60		ThreadControl__Context_v1
5		SEH_Save
5		SEH_Init
1		Contains_PE_File

Score total: 88

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Process Injection::Process Hollowing [T1055.012;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('Win.Malware.Explorerhijack-9937586-0', '50'), ('Win.Malware.Explorerhijack-9937587-0', '50')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_4', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('ThreadControl__Context_v1', '60'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['88']
-------------- CAPA_Score ------------
['9.0']
-------------- CLAMAV_Score ------------
['100.0']
-------------- SCORE FINAL ------------
2833.2050295071467
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FtDAAu25VgAEd7tef1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FtDAAu25VgAEd7tef1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.36 MB
Data read: 0.34 MB (ratio 1.05:1)
Time: 25.791 sec (0 m 25 s)
Start Date: 2022:01:28 14:07:46
End Date:   2022:01:28 14:08:11

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 10: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc0 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf0 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd6 in position 0: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:07:46Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FtDAAu25VgAEd7tef1.exe SCORE: 263 TYPE: EXE SIZE: 363008 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f2c31fe2670> 
MD5: 0c605276ff21b5150365b7d1991f5904 
SHA1: 2d336978af261e07b1ecfaf65dc903b239e287a4 
SHA256: 720610b9067c8afe857819a098a44cab24e9da5cf6a086351d01b73714afd397 CREATED: Fri Jan 28 14:07:46 2022 MODIFIED: Fri Jan 28 14:07:46 2022 ACCESSED: Fri Jan 28 14:08:12 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: CreateFileA Str6: FindClose
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_10: Yara Rule MATCH: Process_Doppelganging SUBSCORE: 35 
DESCRIPTION: Detect Process Doppelganging REF: https://www.blackhat.com/docs/eu-17/materials/eu-17-Liberman-Lost-In-Transaction-Process-Doppelganging.pdf AUTHOR: McAfee ATR - Thomas Roccia - @fr0gger_ 
MATCHES: Str1: CreateTransaction Str2: CreateFileTransacted Str3: WriteFile Str4: RollbackTransaction
REASON_11: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_13: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_14: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_16: Yara Rule MATCH: MAL_Stashlog_Sep_2021_1 SUBSCORE: 70 
DESCRIPTION: Detect Stashlog malware REF: https://www.fireeye.com/blog/threat-research/2021/09/unknown-actor-using-clfs-log-files-for-stealth.html AUTHOR: Arkbird_SOLG 
MATCHES: Str1: 497E724A7BA2764BB4570B225601FB693A796873E7847DB943F7FE9E7281C91A443DF1F8519CBB25FC736CC65BF3DE67A82E704BEB698E17 Str2: 5083ec0c89e031 ... (truncated)
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: RIPEMD160_Constants SUBSCORE: 15 
DESCRIPTION: Look for RIPEMD-160 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3
REASON_19: Yara Rule MATCH: SHA1_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA1 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: f0e1d2c3 Str6: d6c162ca
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:08:12Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
1		ft_exe
1		math_entropy_6
1		IsPE32
1		IsConsole
1		HasDebugData
2		PE_File
5		Anti_Automated_Sandbox
35		Process_Doppelganging
30		Check_OutputDebugStringA_iat_v1
5		SEH_Save
5		SEH_Init
30		Check_OutputDebugStringA_iat
10		anti_dbg
70		MAL_Stashlog_Sep_2021_1
1		Contains_PE_File
15		RIPEMD160_Constants
20		SHA1_Constants

Score total: 263

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 0c605276ff21b5150365b7d1991f5904                                                   |
| sha1                   | 2d336978af261e07b1ecfaf65dc903b239e287a4                                           |
| sha256                 | 720610b9067c8afe857819a098a44cab24e9da5cf6a086351d01b73714afd397                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FtDAAu25VgAEd7tef1.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Cryptographic Hash::SHA1 [C0029.002]                                          |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
|                             | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| hash data using SHA1                                 | data-manipulation/hashing/sha1                       |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| set environment variable                             | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| read file via mapping (2 matches)                    | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| get disk size                                        | host-interaction/hardware/storage                    |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 7.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Process_Doppelganging', '35'), ('Check_OutputDebugStringA_iat_v1', '30'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Check_OutputDebugStringA_iat', '30'), ('anti_dbg', '10'), ('MAL_Stashlog_Sep_2021_1', '70'), ('Contains_PE_File', '1'), ('RIPEMD160_Constants', '15'), ('SHA1_Constants', '20')]
-------------- LOKI_Score ------------
['263']
-------------- CAPA_Score ------------
['7.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4307.937458220549
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FfxoQv431CnABj65q6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FfxoQv431CnABj65q6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.24 MB
Data read: 0.23 MB (ratio 1.03:1)
Time: 23.917 sec (0 m 23 s)
Start Date: 2022:01:28 14:09:26
End Date:   2022:01:28 14:09:50

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:09:27Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FfxoQv431CnABj65q6.exe SCORE: 89 TYPE: EXE SIZE: 249054 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f6ad3d49670> 
MD5: 068a76d4823419b376d418cf03215d5c 
SHA1: 4096855ff2c286c737ccf298ea048219cbe8e537 
SHA256: 39655d8f0d03173bd98de4d6f0c9bde51bc7ea0deed3a644ccd5d7732052e9c6 CREATED: Fri Jan 28 14:09:26 2022 MODIFIED: Fri Jan 28 14:09:26 2022 ACCESSED: Fri Jan 28 14:09:51 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 1 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPacked SUBSCORE: 5 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_7: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: rlpack SUBSCORE: 15 
DESCRIPTION: RLPack packed file REF: - AUTHOR: - 
MATCHES: Str1: MZ Str2: .packed Str3: .RLPack
REASON_9: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: .packed Str2: .RLPack
REASON_10: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:09:51Z

-------- Score ----------------
Scores		Rules
.......		...............
1		ft_exe
1		math_entropy_close_8
1		IsPE32
2		IsWindowsGUI
5		IsPacked
1		HasRichSignature
2		PE_File
15		rlpack
60		suspicious_packer_section
1		Contains_PE_File

Score total: 89

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '1'), ('math_entropy_close_8', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('IsPacked', '5'), ('HasRichSignature', '1'), ('PE_File', '2'), ('rlpack', '15'), ('suspicious_packer_section', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['89']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1410.5549412903908
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F1Swm51UxGBAu1TO5j.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F1Swm51UxGBAu1TO5j.exe: Win.Trojan.Agent-375080 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.04 MB (ratio 1.44:1)
Time: 24.691 sec (0 m 24 s)
Start Date: 2022:01:28 14:09:51
End Date:   2022:01:28 14:10:16

-------- Score ----------------
Scores		Rules
.......		...............
70		Win.Trojan.Agent-375080
75		Win.Trojan.Agent-375080
45		Win.Trojan.Agent-375080

Score total: 190.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:09:51Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F1Swm51UxGBAu1TO5j.exe SCORE: 204 TYPE: EXE SIZE: 36864 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f006da17670> 
MD5: 625ac05fd47adc3c63700c3b30de79ab 
SHA1: 9369d80106dd245938996e245340a3c6f17587fe 
SHA256: 0fa1498340fca6c562cfa389ad3e93395f44c72fd128d7ba08579a69aaf3b126 CREATED: Fri Jan 28 14:09:51 2022 MODIFIED: Fri Jan 28 14:09:51 2022 ACCESSED: Fri Jan 28 14:10:16 2022 
REASON_1: Yara Rule MATCH: network_dropper SUBSCORE: 65 
DESCRIPTION: File downloader/dropper REF: - AUTHOR: x0r 
MATCHES: Str1: urlmon.dll Str2: URLDownloadToFile
REASON_2: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: SeDebugPrivilege Str3: AdjustTokenPrivileges
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: CreateFileA
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_1 SUBSCORE: 1 
DESCRIPTION: Very low entropy - repeating 2 bytes REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:10:16Z

-------- Score ----------------
Scores		Rules
.......		...............
65		network_dropper
70		escalate_priv
10		win_token
10		win_files_operation
1		ft_exe
1		math_entropy_1
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
35		Embedded_PE
2		PE_File
5		SEH_Init
1		Contains_PE_File

Score total: 204

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Agent-375080', '70'), ('Win.Trojan.Agent-375080', '75'), ('Win.Trojan.Agent-375080', '45')]
-------------- LOKI_Rules ------------
[('network_dropper', '65'), ('escalate_priv', '70'), ('win_token', '10'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_1', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('Embedded_PE', '35'), ('PE_File', '2'), ('SEH_Init', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['204']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['190.0']
-------------- SCORE FINAL ------------
5625.140395029589
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fn5FWXGPUKCIr6IF7.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fn5FWXGPUKCIr6IF7.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.67 MB
Data read: 0.63 MB (ratio 1.06:1)
Time: 26.072 sec (0 m 26 s)
Start Date: 2022:01:28 14:10:17
End Date:   2022:01:28 14:10:43

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf2 in position 4: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:10:17Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Fn5FWXGPUKCIr6IF7.exe SCORE: 1399 TYPE: EXE SIZE: 665088 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7c42f2c670> 
MD5: 66602b5fab602cb4e6f754748d249542 
SHA1: 105232653edcf20ce539973401aa8015232c5cdf 
SHA256: c5144dd0a675e0c9d7f7a9cab034a680d99a8e8ae56e3588a1f3e0b2e8d917f3 CREATED: Fri Jan 28 14:10:17 2022 MODIFIED: Fri Jan 28 14:10:17 2022 ACCESSED: Fri Jan 28 14:10:43 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: FindClose
REASON_2: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645fc08c645fc09c645fc0ac645 Str2: c645fc09c645fc0ac645fc0bc645 Str3: c645fc0ac645fc0bc645fc0cc645
REASON_6: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: stager_reverse_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_12: Yara Rule MATCH: stager_bind_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_13: Yara Rule MATCH: win32_stage_boot_winsock_conn_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_14: Yara Rule MATCH: win32_stage_boot_bind_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_15: Yara Rule MATCH: win32_stage_boot_reverse_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_16: Yara Rule MATCH: win32_stage_boot_winsock_conn_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_17: Yara Rule MATCH: stager_reverse_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_18: Yara Rule MATCH: win32_stage_boot_bind_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_19: Yara Rule MATCH: win32_stage_boot_reverse_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_20: Yara Rule MATCH: win32_stage_boot_reverse_shell_revert_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_21: Yara Rule MATCH: win32_stage_winexec_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_22: Yara Rule MATCH: stager_bind_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_23: Yara Rule MATCH: win32_stage_boot_winsock_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_24: Yara Rule MATCH: win32_stage_boot_reverse_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_25: Yara Rule MATCH: win32_stage_api_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_26: Yara Rule MATCH: win32_stage_boot_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_27: Yara Rule MATCH: win32_stage_boot_reverse_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_28: Yara Rule MATCH: win32_stage_boot_reverse_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_29: Yara Rule MATCH: win32_stage_boot_bind_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_30: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_31: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_32: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_33: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_34: Yara Rule MATCH: RijnDael_AES_CHAR SUBSCORE: 15 
DESCRIPTION: RijnDael AES (check2) [char] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 637c777bf26b6fc53001672bfed7ab76ca82c97dfa5947f0add4a2af9ca472c0
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:10:43Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Winsock2_Library
1		ft_exe
1		math_entropy_6
5		obfuscation_singlebyte_mov
1		IsPE32
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
70		stager_reverse_tcp_nx_ldone_x86
70		stager_bind_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_conn_ldone_x86
70		win32_stage_boot_bind_read_ldone_x86
70		win32_stage_boot_reverse_read_ldone_x86
70		win32_stage_boot_winsock_conn_udp_ldone_x86
70		stager_reverse_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_bind_inlineegg_ldone_x86
70		win32_stage_boot_reverse_ldone_x86
70		win32_stage_boot_reverse_shell_revert_ldone_x86
70		win32_stage_winexec_ldone_x86
70		stager_bind_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_bind_ldone_x86
70		win32_stage_boot_reverse_shell_ldone_x86
70		win32_stage_api_ldone_x86
70		win32_stage_boot_bind_ldone_x86
70		win32_stage_boot_reverse_udp_ldone_x86
70		win32_stage_boot_reverse_inlineegg_ldone_x86
70		win32_stage_boot_bind_shell_ldone_x86
5		SEH_Save
5		SEH_Init
10		anti_dbg
1		Contains_PE_File
15		RijnDael_AES_CHAR

Score total: 1399

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 66602b5fab602cb4e6f754748d249542                                                   |
| sha1                   | 105232653edcf20ce539973401aa8015232c5cdf                                           |
| sha256                 | c5144dd0a675e0c9d7f7a9cab034a680d99a8e8ae56e3588a1f3e0b2e8d917f3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fn5FWXGPUKCIr6IF7.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| CRYPTOGRAPHY                | Crypto Library:: [C0059]                                                      |
|                             | Decrypt Data::AES [C0031.001]                                                 |
|                             | Encrypt Data::AES [C0027.001]                                                 |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| initialize Winsock library                            | communication/socket                                 |
| encode data using XOR (4 matches)                     | data-manipulation/encoding/xor                       |
| decrypt data using AES via x86 extensions (2 matches) | data-manipulation/encryption/aes                     |
| encrypt data using AES via x86 extensions             | data-manipulation/encryption/aes                     |
| contains PDB path                                     | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section         | executable/pe/section/tls                            |
| set environment variable                              | host-interaction/environment-variable                |
| allocate thread local storage                         | host-interaction/process                             |
| allocate RWX memory                                   | host-interaction/process/inject                      |
| linked against Crypto++                               | linking/static/cryptopp                              |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 15.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]', '4'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('obfuscation_singlebyte_mov', '5'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('stager_reverse_tcp_nx_ldone_x86', '70'), ('stager_bind_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_ldone_x86', '70'), ('win32_stage_boot_bind_read_ldone_x86', '70'), ('win32_stage_boot_reverse_read_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_udp_ldone_x86', '70'), ('stager_reverse_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_bind_inlineegg_ldone_x86', '70'), ('win32_stage_boot_reverse_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_revert_ldone_x86', '70'), ('win32_stage_winexec_ldone_x86', '70'), ('stager_bind_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_ldone_x86', '70'), ('win32_stage_api_ldone_x86', '70'), ('win32_stage_boot_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_udp_ldone_x86', '70'), ('win32_stage_boot_reverse_inlineegg_ldone_x86', '70'), ('win32_stage_boot_bind_shell_ldone_x86', '70'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1'), ('RijnDael_AES_CHAR', '15')]
-------------- LOKI_Score ------------
['1399']
-------------- CAPA_Score ------------
['15.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
22471.94510977631
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FNGRYt2Mw0f1ij78hf.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 766597058149125847962eecf0c6dac0                                                   |
| sha1                   | 3c75ac9f8ff661f133acb9dd1a8e210a9a0a3d0c                                           |
| sha256                 | 6b877d6bb0fb40835fd4494003b14377feeb8a304fa1a850f0067b4c8cadeefc                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FNGRYt2Mw0f1ij78hf.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                            |
| CREDENTIAL ACCESS      | Input Capture::GUI Input Capture \[T1056.002]\                                     |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| prompt user for credentials                          | collection/credentials                               |
| log keystrokes via polling (3 matches)               | collection/keylog                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (5 matches)  | executable/resource                                  |
| hide graphical window                                | host-interaction/gui/window/hide                     |
| create thread                                        | host-interaction/thread/create                       |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
3		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]

Score total: 19.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FNGRYt2Mw0f1ij78hf.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.11 MB
Data read: 0.11 MB (ratio 1.00:1)
Time: 24.797 sec (0 m 24 s)
Start Date: 2022:01:28 14:11:02
End Date:   2022:01:28 14:11:27

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:11:03Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FNGRYt2Mw0f1ij78hf.exe SCORE: 90 TYPE: EXE SIZE: 113152 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7ecb1a5670> 
MD5: 766597058149125847962eecf0c6dac0 
SHA1: 3c75ac9f8ff661f133acb9dd1a8e210a9a0a3d0c 
SHA256: 6b877d6bb0fb40835fd4494003b14377feeb8a304fa1a850f0067b4c8cadeefc CREATED: Fri Jan 28 14:11:02 2022 MODIFIED: Fri Jan 28 14:11:02 2022 ACCESSED: Fri Jan 28 14:11:28 2022 
REASON_1: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:11:28Z

-------- Score ----------------
Scores		Rules
.......		...............
80		keylogger
1		ft_exe
1		math_entropy_5
1		IsPE64
1		IsDLL
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
1		Contains_PE_File

Score total: 90

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('keylogger', '80'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['90']
-------------- CAPA_Score ------------
['19.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1815.4800246339337
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F0ajE01DIgjcSEMqAk.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 004091b8024936ff322c11cf370f2184                                                   |
| sha1                   | 8208fee26d92e661a8f65a721b272ae931bc7692                                           |
| sha256                 | 6210fa6ade115dd07409cfae21683b1772d6d3fdb6b438814cacbd3588dad9e3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F0ajE01DIgjcSEMqAk.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| query or enumerate registry value                    | host-interaction/registry                            |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 8.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F0ajE01DIgjcSEMqAk.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.070 sec (0 m 24 s)
Start Date: 2022:01:28 14:11:28
End Date:   2022:01:28 14:11:52

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:11:28Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] 
FILE: /tmp/.Loki_Scan/HTTP-F0ajE01DIgjcSEMqAk.exe SCORE: 44 TYPE: EXE SIZE: 22016 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f34a8e7e670> 
MD5: 004091b8024936ff322c11cf370f2184 
SHA1: 8208fee26d92e661a8f65a721b272ae931bc7692 
SHA256: 6210fa6ade115dd07409cfae21683b1772d6d3fdb6b438814cacbd3588dad9e3 CREATED: Fri Jan 28 14:11:28 2022 MODIFIED: Fri Jan 28 14:11:28 2022 ACCESSED: Fri Jan 28 14:11:53 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_2: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 0 warnings, 2 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:11:53Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		Str_Win32_Winsock2_Library
1		ft_exe
1		math_entropy_5
1		IsPE64
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
1		Contains_PE_File

Score total: 44

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['44']
-------------- CAPA_Score ------------
['8.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
866.9503014552446
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FcWeGa185imcc18mLg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a198216798ca38f280dc413f8c57f2c2                                                   |
| sha1                   | bd2dfda3d3abd9684f8608c4eb1007c26cb0e200                                           |
| sha256                 | 16a7d90a578215fb1796caf1c2ad99126bfd7022f49bd6b8051e925384910712                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FcWeGa185imcc18mLg.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (3 matches)                | collection                                           |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| write file on Windows                                | host-interaction/file-system/write                   |
| get ntdll base address                               | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Location Discovery [T1614;3]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 7.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FcWeGa185imcc18mLg.exe: Win.Countermeasure.LoaderWinGeneric-9804845-2 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FcWeGa185imcc18mLg.exe: Win.Malware.Agent-9870952-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.29 MB
Data read: 0.28 MB (ratio 1.06:1)
Time: 24.487 sec (0 m 24 s)
Start Date: 2022:01:28 14:11:53
End Date:   2022:01:28 14:12:18

-------- Score ----------------
Scores		Rules
.......		...............
60		Win.Countermeasure.LoaderWinGeneric-9804845-2
50		Win.Malware.Agent-9870952-0

Score total: 110.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 5: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:11:53Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FcWeGa185imcc18mLg.exe SCORE: 134 TYPE: EXE SIZE: 292864 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9e1a538670> 
MD5: a198216798ca38f280dc413f8c57f2c2 
SHA1: bd2dfda3d3abd9684f8608c4eb1007c26cb0e200 
SHA256: 16a7d90a578215fb1796caf1c2ad99126bfd7022f49bd6b8051e925384910712 CREATED: Fri Jan 28 14:11:53 2022 MODIFIED: Fri Jan 28 14:11:53 2022 ACCESSED: Fri Jan 28 14:12:18 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: Trojan_Win_Generic_v101 SUBSCORE: 50 
DESCRIPTION: not set REF: - AUTHOR: FireEye 
MATCHES: Str1: 2a00000041b817000000ba0204000089c1ff15 Str2: 817c243802040000757a48837c244017757248837c24482a75 Str3: ff15328c0400ffd32d5802000029f03 ... (truncated)
REASON_3: Yara Rule MATCH: math_entropy_7 SUBSCORE: 1 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: Trojan_Win_Generic_101 SUBSCORE: 70 
DESCRIPTION: Detects FireEye Windows trojan REF: https://www.fireeye.com/blog/products-and-services/2020/12/fireeye-shares-details-of-recent-cyber-attack-actions-to-protect-community.html AUTHOR: FireEye 
MATCHES: Str1: 2a00000041b817000000ba0204000089c1ff15 Str2: 817c243802040000757a48837c244017757248837c24482a75 Str3: ff15328c0400ffd32d5802000029f03 ... (truncated)
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPacked SUBSCORE: 5 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:12:18Z

-------- Score ----------------
Scores		Rules
.......		...............
1		ft_exe
50		Trojan_Win_Generic_v101
1		math_entropy_7
70		Trojan_Win_Generic_101
1		IsPE64
2		IsWindowsGUI
5		IsPacked
1		HasOverlay
2		PE_File
1		Contains_PE_File

Score total: 134

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('Win.Countermeasure.LoaderWinGeneric-9804845-2', '60'), ('Win.Malware.Agent-9870952-0', '50')]
-------------- LOKI_Rules ------------
[('ft_exe', '1'), ('Trojan_Win_Generic_v101', '50'), ('math_entropy_7', '1'), ('Trojan_Win_Generic_101', '70'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('IsPacked', '5'), ('HasOverlay', '1'), ('PE_File', '2'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['134']
-------------- CAPA_Score ------------
['7.0']
-------------- CLAMAV_Score ------------
['110.0']
-------------- SCORE FINAL ------------
3648.243192919297
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Ff0xtKMsgYApRksTg.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3808f21e56dede99bc914d90aeabe47a                                                   |
| sha1                   | 93cc73149d4bb34830a2cb2a3047e9267b9e3080                                           |
| sha256                 | 4a5ac3c6f8383cc33c795804ba5f7f5553c029bbb4a6d28f1e4d8fb5107902c1                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Ff0xtKMsgYApRksTg.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                            |
|                        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Network Share Discovery:: \[T1135]\                                                |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Network Configuration Discovery :: \[T1016]\                                |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
|                        | Windows Management Instrumentation:: \[T1047]\                                     |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Debugger Detection::Timing/Delay Check QueryPerformanceCounter [B0001.033]    |
| CRYPTOGRAPHY                | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encryption Key:: [C0028]                                                      |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Analysis Tool Discovery::Process Detection [B0013.001]                        |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Console:: [C0033]                                                             |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference analysis tools strings                     | anti-analysis                                        |
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via QueryPerformanceCounter     | anti-analysis/anti-debugging/debugger-detection      |
| connect network resource                             | communication/http                                   |
| encode data using XOR (9 matches)                    | data-manipulation/encoding/xor                       |
| encrypt or decrypt via WinCrypt                      | data-manipulation/encryption                         |
| reference public RSA key                             | data-manipulation/encryption/rsa                     |
| encrypt data using Salsa20 or ChaCha (2 matches)     | data-manipulation/encryption/salsa20                 |
| accept command line arguments (3 matches)            | host-interaction/cli                                 |
| manipulate console (2 matches)                       | host-interaction/console                             |
| interact with driver via control codes               | host-interaction/driver                              |
| get common file path                                 | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| delete file                                          | host-interaction/file-system/delete                  |
| enumerate files recursively                          | host-interaction/file-system/files/list              |
| get file size                                        | host-interaction/file-system/meta                    |
| set file attributes                                  | host-interaction/file-system/meta                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (5 matches)                    | host-interaction/file-system/write                   |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| get disk information (3 matches)                     | host-interaction/hardware/storage                    |
| enumerate network shares (2 matches)                 | host-interaction/network                             |
| enumerate domain computers via LDAP                  | host-interaction/network/domain                      |
| get domain controller name                           | host-interaction/network/domain                      |
| get hostname (2 matches)                             | host-interaction/os/hostname                         |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| allocate thread local storage                        | host-interaction/process                             |
| get thread local storage value                       | host-interaction/process                             |
| set thread local storage value                       | host-interaction/process                             |
| create process on Windows                            | host-interaction/process/create                      |
| acquire debug privileges                             | host-interaction/process/modify                      |
| modify access privileges                             | host-interaction/process/modify                      |
| terminate process (3 matches)                        | host-interaction/process/terminate                   |
| set registry value                                   | host-interaction/registry/create                     |
| query service status                                 | host-interaction/service                             |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| enumerate services                                   | host-interaction/service/list                        |
| start service                                        | host-interaction/service/start                       |
| stop service                                         | host-interaction/service/stop                        |
| get session user name                                | host-interaction/session                             |
| create thread (3 matches)                            | host-interaction/thread/create                       |
| terminate thread                                     | host-interaction/thread/terminate                    |
| connect to WMI namespace via WbemLocator             | host-interaction/wmi                                 |
| parse PE exports (2 matches)                         | load-code/pe                                         |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Execution::Command and Scripting Interpreter [T1059;4]
4.5		- Execution::Windows Management Instrumentation [T1047;4.5]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
3		- Discovery::Account Discovery [T1087;3]
1		- Discovery::System Information Discovery [T1082;1]
2		- Execution::Shared Modules [T1129;2]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
9		- Impact::Service Stop [T1489;9]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
4		- Defense Evasion::File and Directory Permissions Modification [T1222;4]
3		- Execution::System Services::Service Execution [T1569.002;3]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Network Configuration Discovery [T1016;3]

Score total: 71.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Ff0xtKMsgYApRksTg.exe: Win.Ransomware.MountLocker-9802291-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.06 MB
Data read: 0.06 MB (ratio 1.00:1)
Time: 24.334 sec (0 m 24 s)
Start Date: 2022:01:28 14:12:18
End Date:   2022:01:28 14:12:43

-------- Score ----------------
Scores		Rules
.......		...............
80		Win.Ransomware.MountLocker-9802291-0

Score total: 80.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 6: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb9 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf6 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd2 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 5: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:12:19Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-Ff0xtKMsgYApRksTg.exe SCORE: 694 TYPE: EXE SIZE: 68096 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fa0c4be8670> 
MD5: 3808f21e56dede99bc914d90aeabe47a 
SHA1: 93cc73149d4bb34830a2cb2a3047e9267b9e3080 
SHA256: 4a5ac3c6f8383cc33c795804ba5f7f5553c029bbb4a6d28f1e4d8fb5107902c1 CREATED: Fri Jan 28 14:12:18 2022 MODIFIED: Fri Jan 28 14:12:18 2022 ACCESSED: Fri Jan 28 14:12:43 2022 
REASON_1: Yara Rule MATCH: create_service SUBSCORE: 20 
DESCRIPTION: Create a windows service REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: CreateService Str3: ControlService Str4: StartService Str5: QueryServiceStatus
REASON_2: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: SeDebugPrivilege Str3: AdjustTokenPrivileges
REASON_3: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetDC
REASON_4: Yara Rule MATCH: spreading_share SUBSCORE: 70 
DESCRIPTION: Malware can spread east-west using share drive REF: - AUTHOR: x0r 
MATCHES: Str1: NETAPI32.dll Str2: NetShareEnum
REASON_5: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_6: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: win_mount_locker_auto SUBSCORE: 45 
DESCRIPTION: Detects win.mount_locker. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 4883f8ff74364883642420004c8d4c2468448bc7488bd3 Str2: ff156e3b00008bd885c0743b488b4d6f488d4567c744243000010000 Str3: ff15f95f00004c8d4 ... (truncated)
REASON_9: Yara Rule MATCH: math_entropy_4 SUBSCORE: 1 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_13: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_14: Yara Rule MATCH: Detect_Monitoring SUBSCORE: 50 
DESCRIPTION: Check for monitoring tools REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: procexp.exe Str2: procmon.exe
REASON_15: Yara Rule MATCH: anti_dbgtools_v1 SUBSCORE: 60 
DESCRIPTION: Checks for the presence of known debug tools REF: - AUTHOR: x0r 
MATCHES: Str1: procexp.exe Str2: procmon.exe
REASON_16: Yara Rule MATCH: anti_dbgtools SUBSCORE: 55 
DESCRIPTION: Checks for the presence of known debug tools REF: - AUTHOR: x0r 
MATCHES: Str1: procexp.exe Str2: procmon.exe
REASON_17: Yara Rule MATCH: RANSOM_mountlocker SUBSCORE: 60 
DESCRIPTION: Rule to detect Mount Locker ransomware REF: - AUTHOR: McAfee ATR Team 
MATCHES: Str1: cid=%CLIENT_ID
REASON_18: Yara Rule MATCH: RAN_MountLocker_May_2021_1 SUBSCORE: 75 
DESCRIPTION: Detect the Mountlocker ransomware REF: Internal Research AUTHOR: Arkbird_SOLG 
MATCHES: Str1: 48214d774c8d055040000048214d6f458bce488d4d7744897d6733d2c7442420000000f0ff15913b000085c00f840b020000488b4d77488d456f4889442428488d3de ... (truncated)
REASON_19: Yara Rule MATCH: dbgdetect_procs SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: procexp Str2: procmon
REASON_20: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_21: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 879538e20b82e80052dd5f7ef9ad5077
REASON_22: Yara Rule MATCH: Chacha_256_constant SUBSCORE: 15 
DESCRIPTION: Look for 256-bit key Chacha stream cipher constant REF: https://tools.ietf.org/html/rfc8439#page-8 AUTHOR: spelissier 
MATCHES: Str1: expand 32-byte k Str2: expand 3 Str3: 2-byte k
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:12:44Z

-------- Score ----------------
Scores		Rules
.......		...............
20		create_service
70		escalate_priv
65		screenshot
70		spreading_share
10		win_token
10		win_files_operation
1		ft_exe
45		win_mount_locker_auto
1		math_entropy_4
1		IsPE64
2		IsWindowsGUI
1		HasRichSignature
2		PE_File
50		Detect_Monitoring
60		anti_dbgtools_v1
55		anti_dbgtools
60		RANSOM_mountlocker
75		RAN_MountLocker_May_2021_1
70		dbgdetect_procs
1		Contains_PE_File
10		Big_Numbers1
15		Chacha_256_constant

Score total: 694

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Windows Management Instrumentation [T1047;4.5]', '4.5'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Impact::Service Stop [T1489;9]', '9'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Defense Evasion::File and Directory Permissions Modification [T1222;4]', '4'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3')]
---------------- ClamAV_Rules --------------
[('Win.Ransomware.MountLocker-9802291-0', '80')]
-------------- LOKI_Rules ------------
[('create_service', '20'), ('escalate_priv', '70'), ('screenshot', '65'), ('spreading_share', '70'), ('win_token', '10'), ('win_files_operation', '10'), ('ft_exe', '1'), ('win_mount_locker_auto', '45'), ('math_entropy_4', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Detect_Monitoring', '50'), ('anti_dbgtools_v1', '60'), ('anti_dbgtools', '55'), ('RANSOM_mountlocker', '60'), ('RAN_MountLocker_May_2021_1', '75'), ('dbgdetect_procs', '70'), ('Contains_PE_File', '1'), ('Big_Numbers1', '10'), ('Chacha_256_constant', '15')]
-------------- LOKI_Score ------------
['694']
-------------- CAPA_Score ------------
['71.5']
-------------- CLAMAV_Score ------------
['80.0']
-------------- SCORE FINAL ------------
13432.91164031821
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FAZxK7qhwuRnyBoSi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FAZxK7qhwuRnyBoSi.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.78 MB
Data read: 0.73 MB (ratio 1.06:1)
Time: 25.097 sec (0 m 25 s)
Start Date: 2022:01:28 14:12:44
End Date:   2022:01:28 14:13:09

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:12:44Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FAZxK7qhwuRnyBoSi.exe SCORE: 215 TYPE: EXE SIZE: 772608 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f816bee0670> 
MD5: e24b2506af9f97069b171dc87240b2f7 
SHA1: 5718a9bcae2706e6e5e5b9d322a0d3be0e1a3558 
SHA256: 18d51bd52b4fa76870407f7ee4a0b0bd0b86c0fbdd7f00322edc50d3d4ff15d2 CREATED: Fri Jan 28 14:12:44 2022 MODIFIED: Fri Jan 28 14:12:44 2022 ACCESSED: Fri Jan 28 14:13:09 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_15: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_16: Yara Rule MATCH: skip20_sqllang_hook SUBSCORE: 60 
DESCRIPTION: YARA rule to detect if a sqllang.dll version is targeted by skip-2.0. Each byte pattern corresponds to a function hooked by skip-2.0. If _0 or _1 match, it is probably targeted as it corresponds to the hook responsible for bypassing the authentication. REF: https://www.welivesecurity.com/ AUTHOR: Mathieu Tartare <mathieu.tartare@eset.com> 
MATCHES: Str1: 8bc1488b8c24300200004833cc
REASON_17: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:13:10Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
5		win_mutex
10		win_files_operation
1		ft_exe
1		math_entropy_6
1		IsPE64
1		IsDLL
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
10		anti_dbg
60		skip20_sqllang_hook
1		Contains_PE_File

Score total: 215

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e24b2506af9f97069b171dc87240b2f7                                                   |
| sha1                   | 5718a9bcae2706e6e5e5b9d322a0d3be0e1a3558                                           |
| sha256                 | 18d51bd52b4fa76870407f7ee4a0b0bd0b86c0fbdd7f00322edc50d3d4ff15d2                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FAZxK7qhwuRnyBoSi.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
|                        | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
| COMMUNICATION               | HTTP Communication::Read Header [C0002.014]                                   |
|                             | Interprocess Communication::Create Pipe [C0003.001]                           |
|                             | Interprocess Communication::Read Pipe [C0003.003]                             |
| CRYPTOGRAPHY                | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-debugging instructions (2 matches)      | anti-analysis/anti-debugging/debugger-detection      |
| get geographical location (4 matches)                | collection                                           |
| check HTTP status code (2 matches)                   | communication/http/client                            |
| create pipe                                          | communication/named-pipe/create                      |
| read pipe                                            | communication/named-pipe/read                        |
| encode data using XOR (36 matches)                   | data-manipulation/encoding/xor                       |
| hash data using murmur3 (2 matches)                  | data-manipulation/hashing/murmur                     |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (10 matches) | executable/resource                                  |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get file system object information                   | host-interaction/file-system                         |
| check if file exists (11 matches)                    | host-interaction/file-system/exists                  |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| get graphical window text (2 matches)                | host-interaction/gui/window/get-text                 |
| get disk information (3 matches)                     | host-interaction/hardware/storage                    |
| get disk size                                        | host-interaction/hardware/storage                    |
| get storage device properties (2 matches)            | host-interaction/hardware/storage                    |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| create mutex (2 matches)                             | host-interaction/mutex                               |
| get thread local storage value (2 matches)           | host-interaction/process                             |
| set thread local storage value (2 matches)           | host-interaction/process                             |
| create process on Windows (3 matches)                | host-interaction/process/create                      |
| terminate process via fastfail (14 matches)          | host-interaction/process/terminate                   |
| link many functions at runtime (2 matches)           | linking/runtime-linking                              |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Location Discovery [T1614;3]
3		- Execution::System Services::Service Execution [T1569.002;3]
1		- Discovery::File and Directory Discovery [T1083;1]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 36.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('screenshot', '65'), ('win_mutex', '5'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('anti_dbg', '10'), ('skip20_sqllang_hook', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['215']
-------------- CAPA_Score ------------
['36.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4125.81479718019
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FYgHfU3R6KYPwVprQb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 05db5eaffee4d667b4fde07041bbbef6                                                   |
| sha1                   | bc35edb25aceb0826c4e4f638f9fe19c1192cc84                                           |
| sha256                 | 71a4f9b800d81ff6632b9892a6a502c412c141341e46d697a8c004e2f460913b                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FYgHfU3R6KYPwVprQb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount (9 matches)    | anti-analysis/anti-debugging/debugger-detection      |
| obfuscated with callobfuscator                       | anti-analysis/obfuscation                            |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| write file on Windows                                | host-interaction/file-system/write                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 16.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FYgHfU3R6KYPwVprQb.exe: Win.Countermeasure.LoaderWinGeneric-9804845-2 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.29 MB
Data read: 0.28 MB (ratio 1.06:1)
Time: 24.235 sec (0 m 24 s)
Start Date: 2022:01:28 14:13:46
End Date:   2022:01:28 14:14:11

-------- Score ----------------
Scores		Rules
.......		...............
60		Win.Countermeasure.LoaderWinGeneric-9804845-2

Score total: 60.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:13:47Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:14:11Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('Win.Countermeasure.LoaderWinGeneric-9804845-2', '60')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['16.5']
-------------- CLAMAV_Score ------------
['60.0']
-------------- SCORE FINAL ------------
1084.5735290463656
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FKMchj4Xin4mEYUZt3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 4c220a9fd4d1aee3e5861fea1ab3573e                                                   |
| sha1                   | ba6a6627917900a5740110e589c8ea602c2ba341                                           |
| sha256                 | b95769a76e3148e35b76eae351f22c1ac609c6a4fbf5e0794deeeac13b55bd1d                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FKMchj4Xin4mEYUZt3.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| enumerate PE sections                                | load-code/pe                                         |
| inspect section memory permissions                   | load-code/pe                                         |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FKMchj4Xin4mEYUZt3.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.16 MB
Data read: 0.15 MB (ratio 1.05:1)
Time: 25.109 sec (0 m 25 s)
Start Date: 2022:01:28 14:14:12
End Date:   2022:01:28 14:14:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:14:12Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FKMchj4Xin4mEYUZt3.exe SCORE: 70 TYPE: EXE SIZE: 158208 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd65416a670> 
MD5: 4c220a9fd4d1aee3e5861fea1ab3573e 
SHA1: ba6a6627917900a5740110e589c8ea602c2ba341 
SHA256: b95769a76e3148e35b76eae351f22c1ac609c6a4fbf5e0794deeeac13b55bd1d CREATED: Fri Jan 28 14:14:12 2022 MODIFIED: Fri Jan 28 14:14:12 2022 ACCESSED: Fri Jan 28 14:14:37 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_10: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_11: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:14:38Z

-------- Score ----------------
Scores		Rules
.......		...............
1		ft_exe
1		math_entropy_5
1		IsPE64
1		IsDLL
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
1		Contains_PE_File

Score total: 70

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['70']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1189.2357273215346
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FphjFe4u56F40i83kb.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | a117edc0e74ab4770acf7f7e86e573f7                                                   |
| sha1                   | 5ceffb1a5e05e52aafcbc2d44e1e8445440706f3                                           |
| sha256                 | b5bc4fce58403ea554691db678e6c8c448310fe59990990f0e37cd4357567d37                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FphjFe4u56F40i83kb.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                             |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                       |
|                        | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Location Discovery:: \[T1614]\                                               |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| spoof parent PID                                     | anti-analysis/anti-forensic                          |
| get geographical location                            | collection                                           |
| log keystrokes via polling                           | collection/keylog                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| query environment variable (5 matches)               | host-interaction/environment-variable                |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists (2 matches)                     | host-interaction/file-system/exists                  |
| get file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| find graphical window (2 matches)                    | host-interaction/gui/window/find                     |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| check mutex (7 matches)                              | host-interaction/mutex                               |
| create mutex                                         | host-interaction/mutex                               |
| get system information on Windows                    | host-interaction/os/info                             |
| read process memory                                  | host-interaction/process                             |
| create process on Windows (4 matches)                | host-interaction/process/create                      |
| enumerate process modules                            | host-interaction/process/modules/list                |
| terminate process via fastfail (5 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (12 matches)       | host-interaction/registry                            |
| delete registry key (3 matches)                      | host-interaction/registry/delete                     |
| delete registry value                                | host-interaction/registry/delete                     |
| get session user name                                | host-interaction/session                             |
| get token membership                                 | host-interaction/session                             |
| link function at runtime on Windows (3 matches)      | linking/runtime-linking                              |
| parse PE header (8 matches)                          | load-code/pe                                         |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
3		- Discovery::System Location Discovery [T1614;3]
1		- Discovery::File and Directory Discovery [T1083;1]
3		- Discovery::System Owner/User Discovery [T1033;3]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
3		- Discovery::Account Discovery [T1087;3]
2		- Discovery::Application Window Discovery [T1010;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]

Score total: 40.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FphjFe4u56F40i83kb.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.12 MB
Data read: 0.12 MB (ratio 1.00:1)
Time: 24.934 sec (0 m 24 s)
Start Date: 2022:01:28 14:14:38
End Date:   2022:01:28 14:15:03

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:14:38Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FphjFe4u56F40i83kb.exe SCORE: 140 TYPE: EXE SIZE: 126464 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f43e38d4670> 
MD5: a117edc0e74ab4770acf7f7e86e573f7 
SHA1: 5ceffb1a5e05e52aafcbc2d44e1e8445440706f3 
SHA256: b5bc4fce58403ea554691db678e6c8c448310fe59990990f0e37cd4357567d37 CREATED: Fri Jan 28 14:14:38 2022 MODIFIED: Fri Jan 28 14:14:38 2022 ACCESSED: Fri Jan 28 14:15:03 2022 
REASON_1: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:15:03Z

-------- Score ----------------
Scores		Rules
.......		...............
80		keylogger
5		win_mutex
20		win_registry
10		win_token
1		ft_exe
1		math_entropy_6
1		IsPE64
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
10		anti_dbg
1		Contains_PE_File

Score total: 140

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('keylogger', '80'), ('win_mutex', '5'), ('win_registry', '20'), ('win_token', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['140']
-------------- CAPA_Score ------------
['40.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3026.931707007955
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F3UW1F2En2fMBOfOS2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F3UW1F2En2fMBOfOS2.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.48 MB
Data read: 0.46 MB (ratio 1.05:1)
Time: 25.404 sec (0 m 25 s)
Start Date: 2022:01:28 14:15:04
End Date:   2022:01:28 14:15:29

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:15:04Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F3UW1F2En2fMBOfOS2.exe SCORE: 177 TYPE: EXE SIZE: 486736 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9c226f5670> 
MD5: 4b944d93d5c75ef05f64ccb9d877d9f5 
SHA1: f343691790795f06b22a1f6995c53124fb70f8f2 
SHA256: 5cbb22f583517b32f8bdca9e5d8083761c8a414588b8506adf5c5761a528dfbe CREATED: Fri Jan 28 14:15:04 2022 MODIFIED: Fri Jan 28 14:15:04 2022 ACCESSED: Fri Jan 28 14:15:30 2022 
REASON_1: Yara Rule MATCH: network_dropper SUBSCORE: 65 
DESCRIPTION: File downloader/dropper REF: - AUTHOR: x0r 
MATCHES: Str1: urlmon.dll Str2: URLDownloadToFile
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_4: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DESCRIPTION\System Str2: identifier
REASON_16: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DESCRIPTION\System Str2: identifier
REASON_17: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_18: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:15:30Z

-------- Score ----------------
Scores		Rules
.......		...............
65		network_dropper
5		win_mutex
10		Str_Win32_Http_API
1		misc_pe_signature
1		ft_exe
20		research_pe_signed_outside_timestamp
1		math_entropy_6
1		IsPE64
1		IsDLL
1		IsConsole
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
1		Contains_PE_File
5		BASE64_table

Score total: 177

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 4b944d93d5c75ef05f64ccb9d877d9f5                                                   |
| sha1                   | f343691790795f06b22a1f6995c53124fb70f8f2                                           |
| sha256                 | 5cbb22f583517b32f8bdca9e5d8083761c8a414588b8506adf5c5761a528dfbe                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F3UW1F2En2fMBOfOS2.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Download URL [C0002.006]                                  |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | HTTP Communication::Set Header [C0002.013]                                    |
|                             | HTTP Communication::WinHTTP [C0002.008]                                       |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::FNV [C0030.005]                                       |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| receive data                                         | communication                                        |
| initialize WinHTTP library                           | communication/http                                   |
| read HTTP header (2 matches)                         | communication/http                                   |
| set HTTP header (2 matches)                          | communication/http                                   |
| check HTTP status code                               | communication/http/client                            |
| prepare HTTP request                                 | communication/http/client                            |
| receive HTTP response (3 matches)                    | communication/http/client                            |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| encode data using XOR (14 matches)                   | data-manipulation/encoding/xor                       |
| hash data using fnv (14 matches)                     | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| linked against CPP regex library                     | linking/static/cppregex                              |
| enumerate PE sections (2 matches)                    | load-code/pe                                         |
| parse PE header (11 matches)                         | load-code/pe                                         |
| persist via Run registry key (2 matches)             | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
1		- Discovery::File and Directory Discovery [T1083;1]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]

Score total: 24.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('network_dropper', '65'), ('win_mutex', '5'), ('Str_Win32_Http_API', '10'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('Contains_PE_File', '1'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['177']
-------------- CAPA_Score ------------
['24.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
3294.1002178235462
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FpHgeR3jE4gmWBABSa.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ffeae4a391a1d5203bd04b4161557227                                                   |
| sha1                   | 7c7013dd8def75c94828b40ffa139b6d89ec4683                                           |
| sha256                 | 81fc45c95bdb421257645b4ff91a6afc82201d3ffe570c059994d79ff1484f90                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FpHgeR3jE4gmWBABSa.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                          |
|                        | Input Capture::Keylogging \[T1056.001]\                                             |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                             |
|                        | Hide Artifacts::Hidden Window \[T1564.003]\                                         |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | System Information Discovery:: \[T1082]\                                            |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
|                        | Resource Hijacking:: \[T1496]\                                                      |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Send Data [C0002.005]                                     |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Encryption Key::Import Public Key [C0028.001]                                 |
|                             | Generate Pseudo-random Sequence::Mersenne Twister [C0021.005]                 |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+--------------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                                   | NAMESPACE                                            |
|--------------------------------------------------------------+------------------------------------------------------|
| inspect load icon resource                                   | anti-analysis                                        |
| log keystrokes via polling (3 matches)                       | collection/keylog                                    |
| receive data                                                 | communication                                        |
| send data (2 matches)                                        | communication                                        |
| connect to HTTP server                                       | communication/http/client                            |
| create HTTP request                                          | communication/http/client                            |
| encode data using XOR (15 matches)                           | data-manipulation/encoding/xor                       |
| create new key via CryptAcquireContext (3 matches)           | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt (4 matches)                  | data-manipulation/encryption                         |
| import public key                                            | data-manipulation/encryption                         |
| encrypt data using AES via WinAPI (2 matches)                | data-manipulation/encryption/aes                     |
| reference public RSA key                                     | data-manipulation/encryption/rsa                     |
| hash data via WinCrypt                                       | data-manipulation/hashing                            |
| hash data using SHA1                                         | data-manipulation/hashing/sha1                       |
| hash data using SHA1 via WinCrypt                            | data-manipulation/hashing/sha1                       |
| generate random numbers using a Mersenne Twister (3 matches) | data-manipulation/prng/mersenne                      |
| contain a resource (.rsrc) section                           | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (3 matches)          | executable/resource                                  |
| accept command line arguments (2 matches)                    | host-interaction/cli                                 |
| replace clipboard data                                       | host-interaction/clipboard                           |
| query environment variable (2 matches)                       | host-interaction/environment-variable                |
| get common file path (3 matches)                             | host-interaction/file-system                         |
| get file system object information                           | host-interaction/file-system                         |
| copy file                                                    | host-interaction/file-system/copy                    |
| delete file (5 matches)                                      | host-interaction/file-system/delete                  |
| check if file exists                                         | host-interaction/file-system/exists                  |
| enumerate files recursively                                  | host-interaction/file-system/files/list              |
| get file attributes                                          | host-interaction/file-system/meta                    |
| get file size (2 matches)                                    | host-interaction/file-system/meta                    |
| set file attributes (9 matches)                              | host-interaction/file-system/meta                    |
| move file                                                    | host-interaction/file-system/move                    |
| read file on Windows (2 matches)                             | host-interaction/file-system/read                    |
| write file on Windows (5 matches)                            | host-interaction/file-system/write                   |
| get graphical window text (2 matches)                        | host-interaction/gui/window/get-text                 |
| hide graphical window (6 matches)                            | host-interaction/gui/window/hide                     |
| get disk information (2 matches)                             | host-interaction/hardware/storage                    |
| get disk size (2 matches)                                    | host-interaction/hardware/storage                    |
| check mutex and exit                                         | host-interaction/mutex                               |
| get hostname                                                 | host-interaction/os/hostname                         |
| get system information on Windows                            | host-interaction/os/info                             |
| check OS version                                             | host-interaction/os/version                          |
| create process on Windows (5 matches)                        | host-interaction/process/create                      |
| terminate process                                            | host-interaction/process/terminate                   |
| query or enumerate registry key                              | host-interaction/registry                            |
| query or enumerate registry value (8 matches)                | host-interaction/registry                            |
| delete registry key                                          | host-interaction/registry/delete                     |
| delete registry value (2 matches)                            | host-interaction/registry/delete                     |
| create thread                                                | host-interaction/thread/create                       |
| resume thread                                                | host-interaction/thread/resume                       |
| mine cryptocurrency                                          | impact/cryptocurrency                                |
| link function at runtime on Windows (7 matches)              | linking/runtime-linking                              |
| parse PE exports                                             | load-code/pe                                         |
| parse PE header (7 matches)                                  | load-code/pe                                         |
| persist via Run registry key (3 matches)                     | persistence/registry/run                             |
+--------------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
8		- Impact::Resource Hijacking [T1496;8]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
4		- Collection::Clipboard Data [T1115;4]
2		- Discovery::Application Window Discovery [T1010;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
3		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
4		- Defense Evasion::File and Directory Permissions Modification [T1222;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]

Score total: 68.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FpHgeR3jE4gmWBABSa.exe: Win.Trojan.Cryptolocker-2 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.34 MB
Data read: 0.33 MB (ratio 1.04:1)
Time: 32.826 sec (0 m 32 s)
Start Date: 2022:01:28 14:15:54
End Date:   2022:01:28 14:16:27

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Cryptolocker-2

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xeb in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 3: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa1 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:15:54Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FpHgeR3jE4gmWBABSa.exe SCORE: 534 TYPE: EXE SIZE: 348160 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7efcef791670> 
MD5: ffeae4a391a1d5203bd04b4161557227 
SHA1: 7c7013dd8def75c94828b40ffa139b6d89ec4683 
SHA256: 81fc45c95bdb421257645b4ff91a6afc82201d3ffe570c059994d79ff1484f90 CREATED: Fri Jan 28 14:15:54 2022 MODIFIED: Fri Jan 28 14:15:54 2022 ACCESSED: Fri Jan 28 14:16:27 2022 
REASON_1: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: InternetWriteFile Str6: HttpOpenRequest Str7: HttpS ... (truncated)
REASON_2: Yara Rule MATCH: network_dga SUBSCORE: 45 
DESCRIPTION: Communication using dga REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: WININET.dll Str3: CRYPT32.dll Str4: SystemTimeToFileTime Str5: GetSystemTime Str6: CryptCreateHash Str7: CryptAcqu ... (truncated)
REASON_3: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_4: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_5: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_6: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_7: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_8: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_9: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_10: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_11: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: win_cryptolocker_auto SUBSCORE: 45 
DESCRIPTION: Detects win.cryptolocker. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 8b47048d140833c93bc273168d9b00000000 Str2: 8bf1578b46088d3c85040000008b460485ff751e Str3: 8bec8b45085356578bf98b5704 Str4: eb096a006a ... (truncated)
REASON_13: Yara Rule MATCH: math_entropy_close_8 SUBSCORE: 1 
DESCRIPTION: Very high entropy - random stream, packed data or encryption REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_16: Yara Rule MATCH: IsPacked SUBSCORE: 5 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_17: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_18: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_20: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_21: Yara Rule MATCH: Win32_Ransomware_CryptoLocker SUBSCORE: 60 
DESCRIPTION: Yara rule that detects CryptoLocker ransomware. REF: - AUTHOR: ReversingLabs 
MATCHES: Str1: 558bec83ec4053568bc1578945f4e82dfdffff84c00f84620100008b5d0832c00f57c08845fb660f1345c4eb038d490084c074086a00ff15a82141006a006a00ff75c ... (truncated)
REASON_22: Yara Rule MATCH: ransomware_windows_cryptolocker SUBSCORE: 85 
DESCRIPTION: The CryptoLocker malware propagated via infected email attachments, and via an existing botnet; when activated, the malware encrypts files stored on local and mounted network drives REF: https://www.secureworks.com/research/cryptolocker-ransomware AUTHOR: @fusionrace 
MATCHES: Str1: bb to select the method of payment and the currency. Str2: Where can I purchase a MoneyPak? Str3: Ukash is electronic cash and e-comm ... (truncated)
REASON_23: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_24: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: CryptCreateHash Str4: CryptHashData Str5: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:16:27Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_http
45		network_dga
65		screenshot
80		keylogger
5		win_mutex
20		win_registry
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
1		ft_exe
45		win_cryptolocker_auto
1		math_entropy_close_8
1		IsPE32
2		IsWindowsGUI
5		IsPacked
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
5		SEH_Init
60		Win32_Ransomware_CryptoLocker
85		ransomware_windows_cryptolocker
1		Contains_PE_File
20		Advapi_Hash_API

Score total: 534

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Impact::Resource Hijacking [T1496;8]', '8'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Collection::Clipboard Data [T1115;4]', '4'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]', '3'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::File and Directory Permissions Modification [T1222;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Cryptolocker-2', '45')]
-------------- LOKI_Rules ------------
[('network_http', '45'), ('network_dga', '45'), ('screenshot', '65'), ('keylogger', '80'), ('win_mutex', '5'), ('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '1'), ('win_cryptolocker_auto', '45'), ('math_entropy_close_8', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('IsPacked', '5'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('SEH_Init', '5'), ('Win32_Ransomware_CryptoLocker', '60'), ('ransomware_windows_cryptolocker', '85'), ('Contains_PE_File', '1'), ('Advapi_Hash_API', '20')]
-------------- LOKI_Score ------------
['534']
-------------- CAPA_Score ------------
['68.0']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
10386.62445722856
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FdU7pGmxIDhTlRiC1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ba947eb07d8c823949316a97364d060f                                                   |
| sha1                   | fc28eb7c35d2652df0ea88366489bdc5d1b1c3f6                                           |
| sha256                 | 547c396ad518ed087962182c01608c53d08ad61fcfaf63390cddea1d175b1a33                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FdU7pGmxIDhTlRiC1.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                            |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Execution Guardrails::Runs as Service [E1480.m07]                             |
| COMMUNICATION               | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Set Header [C0002.013]                                    |
|                             | HTTP Communication::WinHTTP [C0002.008]                                       |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DEFENSE EVASION             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| initialize WinHTTP library                           | communication/http                                   |
| set HTTP header                                      | communication/http                                   |
| prepare HTTP request                                 | communication/http/client                            |
| receive HTTP response                                | communication/http/client                            |
| create new key via CryptAcquireContext (3 matches)   | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt                      | data-manipulation/encryption                         |
| encrypt data using AES via WinAPI                    | data-manipulation/encryption/aes                     |
| hash data via WinCrypt                               | data-manipulation/hashing                            |
| hash data with MD5                                   | data-manipulation/hashing/md5                        |
| hash data using SHA1                                 | data-manipulation/hashing/sha1                       |
| hash data using SHA1 via WinCrypt                    | data-manipulation/hashing/sha1                       |
| generate random numbers via WinAPI (2 matches)       | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes               | host-interaction/driver                              |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| create directory (2 matches)                         | host-interaction/file-system/create                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| read file on Windows (2 matches)                     | host-interaction/file-system/read                    |
| write file on Windows (2 matches)                    | host-interaction/file-system/write                   |
| create process on Windows                            | host-interaction/process/create                      |
| terminate process                                    | host-interaction/process/terminate                   |
| query or enumerate registry value (2 matches)        | host-interaction/registry                            |
| query service status                                 | host-interaction/service                             |
| run as service                                       | host-interaction/service                             |
| start service (2 matches)                            | host-interaction/service/start                       |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Execution::System Services::Service Execution [T1569.002;3]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 26.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FdU7pGmxIDhTlRiC1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 27.678 sec (0 m 27 s)
Start Date: 2022:01:28 14:16:27
End Date:   2022:01:28 14:16:55

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xfe in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:16:28Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FdU7pGmxIDhTlRiC1.exe SCORE: 97 TYPE: EXE SIZE: 38120 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f61fb602670> 
MD5: ba947eb07d8c823949316a97364d060f 
SHA1: fc28eb7c35d2652df0ea88366489bdc5d1b1c3f6 
SHA256: 547c396ad518ed087962182c01608c53d08ad61fcfaf63390cddea1d175b1a33 CREATED: Fri Jan 28 14:16:27 2022 MODIFIED: Fri Jan 28 14:16:27 2022 ACCESSED: Fri Jan 28 14:16:56 2022 
REASON_1: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegCloseKey
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: FindClose
REASON_3: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_4: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
REASON_16: Yara Rule MATCH: MD5_Constants SUBSCORE: 20 
DESCRIPTION: Look for MD5 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: #Eg Str2: 89abcdef Str3: fedcba98 Str4: vT2 Str5: 78a46ad7
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:16:56Z

-------- Score ----------------
Scores		Rules
.......		...............
20		win_registry
10		win_files_operation
10		Str_Win32_Http_API
1		misc_pe_signature
1		ft_exe
1		math_entropy_6
1		IsPE64
2		IsWindowsGUI
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
1		Contains_PE_File
20		Advapi_Hash_API
20		MD5_Constants

Score total: 97

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Http_API', '10'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Contains_PE_File', '1'), ('Advapi_Hash_API', '20'), ('MD5_Constants', '20')]
-------------- LOKI_Score ------------
['97']
-------------- CAPA_Score ------------
['26.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2056.1145985791886
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FAQ7Bp1JfBkXKQfwf8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 64f5611cc62e65748d140e6f288ce1ea                                                   |
| sha1                   | d337d3576ae4b7495f1d58926868af8bf296cf87                                           |
| sha256                 | ec1dc1a2ee200da0c787328df4fb91a2b978fd09ca1f83f3e55994c0f9ba1d11                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FAQ7Bp1JfBkXKQfwf8.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| accept command line arguments                        | host-interaction/cli                                 |
| check mutex and exit                                 | host-interaction/mutex                               |
| access PE header                                     | load-code/pe                                         |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 8.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FAQ7Bp1JfBkXKQfwf8.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.01 MB
Data read: 0.01 MB (ratio 1.00:1)
Time: 25.103 sec (0 m 25 s)
Start Date: 2022:01:28 14:16:56
End Date:   2022:01:28 14:17:21

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:16:56Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:17:22Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['8.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
159.62098519751038
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FQHw4a3BJD2oAia8v8.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 9db13dadd1f105cdb739a3243a1463cf                                                   |
| sha1                   | a24eb7199732b56cedf040a594d3dff8eabfd285                                           |
| sha256                 | cfdd7cc431d1ed6ca72b43292daad839066425661b5a7fe30a680ae6735cfd3a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FQHw4a3BJD2oAia8v8.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable                           | host-interaction/environment-variable                |
| get common file path                                 | host-interaction/file-system                         |
| get hostname                                         | host-interaction/os/hostname                         |
| create process on Windows (2 matches)                | host-interaction/process/create                      |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FQHw4a3BJD2oAia8v8.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.873 sec (0 m 24 s)
Start Date: 2022:01:28 14:17:22
End Date:   2022:01:28 14:17:47

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:17:22Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:17:48Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['10.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
199.526231496888
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FEr2gY3EESuuKYZ9O.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 690a9f472f6aafba0e90bedab91366c2                                                   |
| sha1                   | 8f4e4a8634d704fd98d6df491149cdb472ba30ab                                           |
| sha256                 | 44b1c84811495b426ec69a15888d5824a894421df052cc378fd6ada5c32a112f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FEr2gY3EESuuKYZ9O.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (5 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions               | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 10.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FEr2gY3EESuuKYZ9O.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.579 sec (0 m 24 s)
Start Date: 2022:01:28 14:17:48
End Date:   2022:01:28 14:18:12

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:17:48Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:18:14Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['10.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
199.526231496888
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FDCABLJjhh8Pv5fte.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6db032025bd266e5a3a52259f57f9247                                                   |
| sha1                   | 700463b333e6f007018d80048921187987840b5b                                           |
| sha256                 | 71d8a301c01f61d1bb69784d823a8040fa43cf3f063325b68e97b47cc3e3814c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FDCABLJjhh8Pv5fte.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FDCABLJjhh8Pv5fte.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 24.480 sec (0 m 24 s)
Start Date: 2022:01:28 14:18:15
End Date:   2022:01:28 14:18:39

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:18:15Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FDCABLJjhh8Pv5fte.exe SCORE: 70 TYPE: EXE SIZE: 40960 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4b543b8670> 
MD5: 6db032025bd266e5a3a52259f57f9247 
SHA1: 700463b333e6f007018d80048921187987840b5b 
SHA256: 71d8a301c01f61d1bb69784d823a8040fa43cf3f063325b68e97b47cc3e3814c CREATED: Fri Jan 28 14:18:15 2022 MODIFIED: Fri Jan 28 14:18:15 2022 ACCESSED: Fri Jan 28 14:18:40 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:18:40Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		ft_exe
1		math_entropy_5
1		IsPE64
1		IsDLL
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
1		Contains_PE_File

Score total: 70

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['70']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1149.3304810221568
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FmBFmd19GXI4T8aSA2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FmBFmd19GXI4T8aSA2.exe: Win.Exploit.CVE_2017_0213-6306933-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 24.483 sec (0 m 24 s)
Start Date: 2022:01:28 14:18:41
End Date:   2022:01:28 14:19:05

-------- Score ----------------
Scores		Rules
.......		...............
25		Win.Exploit.CVE_2017_0213-6306933-0

Score total: 25.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x98 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x91 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcf in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa5 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xae in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe6 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x85 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf3 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xf5 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8c in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xab in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcd in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:18:41Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FmBFmd19GXI4T8aSA2.exe SCORE: 265 TYPE: EXE SIZE: 55808 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f890ace6670> 
MD5: 1195d0d18be9362fb8dd9e1738404c9d 
SHA1: ef02cc3dbdff915c9149aef86911b4e780b89ae6 
SHA256: dd79b2abc21e766fe3076038482ded43e5069a1af9e0ad29e06dce387bfae900 CREATED: Fri Jan 28 14:18:41 2022 MODIFIED: Fri Jan 28 14:18:41 2022 ACCESSED: Fri Jan 28 14:19:06 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: DuplicateTokenEx Str3: AdjustTokenPrivileges Str4: OpenProcessToken
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_13: Yara Rule MATCH: Ran_Mem_RagnarLocker_Nov_2020_1 SUBSCORE: 75 
DESCRIPTION: Detect memory artefacts of the Ragnarlocker ransomware (Nov 2020) REF: Internal Research AUTHOR: Arkbird_SOLG 
MATCHES: Str1: \.\PHYSICALDRIVE%d Str2: bootfont.bin Str3: bootsect.bak Str4: bootmgr.efi Str5: Internet Explorer Str6:   </trustInfo> Str7: Tor br ... (truncated)
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Crypt32_CryptBinaryToString_API SUBSCORE: 25 
DESCRIPTION: Looks for crypt32 CryptBinaryToStringA function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: CRYPT32.dll Str2: CryptBinaryToStringA
REASON_16: Yara Rule MATCH: SHA512_Constants SUBSCORE: 20 
DESCRIPTION: Look for SHA384/SHA512 constants REF: - AUTHOR: phoul (@phoul) 
MATCHES: Str1: 982f8a42 Str2: 91443771 Str3: cffbc0b5 Str4: a5dbb5e9 Str5: 22ae28d7
REASON_17: Yara Rule MATCH: SHA2_BLAKE2_IVs SUBSCORE: 20 
DESCRIPTION: Look for SHA2/BLAKE2/Argon2 IVs REF: - AUTHOR: spelissier 
MATCHES: Str1: 67e6096a Str2: 85ae67bb Str3: 72f36e3c Str4: 3af54fa5 Str5: RQ Str6: 8c68059b Str7: abd9831f Str8: 19cde05b
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:19:06Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
10		win_token
10		win_files_operation
1		ft_exe
1		math_entropy_6
1		IsPE32
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
75		Ran_Mem_RagnarLocker_Nov_2020_1
1		Contains_PE_File
25		Crypt32_CryptBinaryToString_API
20		SHA512_Constants
20		SHA2_BLAKE2_IVs

Score total: 265

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Exploit.CVE_2017_0213-6306933-0', '25')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '10'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Ran_Mem_RagnarLocker_Nov_2020_1', '75'), ('Contains_PE_File', '1'), ('Crypt32_CryptBinaryToString_API', '25'), ('SHA512_Constants', '20'), ('SHA2_BLAKE2_IVs', '20')]
-------------- LOKI_Score ------------
['265']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['25.0']
-------------- SCORE FINAL ------------
4514.698312970492
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FauHdt3ywZXlsWjjl6.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 37f9f0d495cebf0359d06cf96e85a51f                                                   |
| sha1                   | b4e674db12ab0c2d39260dab1a7779d9947a4908                                           |
| sha256                 | 8958aec70d263062a01f77a71e2787275470340d0d39cce267b800ef09dd1538                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FauHdt3ywZXlsWjjl6.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
|                             | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)  | executable/resource                                  |
| query environment variable (2 matches)               | host-interaction/environment-variable                |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| create directory                                     | host-interaction/file-system/create                  |
| delete directory                                     | host-interaction/file-system/delete                  |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| read .ini file                                       | host-interaction/file-system/read                    |
| find graphical window                                | host-interaction/gui/window/find                     |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| access the Windows event log                         | host-interaction/log/winevt/access                   |
| check mutex and exit                                 | host-interaction/mutex                               |
| create process on Windows                            | host-interaction/process/create                      |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry value (6 matches)        | host-interaction/registry                            |
| set registry value (6 matches)                       | host-interaction/registry/create                     |
| delete registry key                                  | host-interaction/registry/delete                     |
| delete registry value (2 matches)                    | host-interaction/registry/delete                     |
| query service status                                 | host-interaction/service                             |
| modify service                                       | host-interaction/service/modify                      |
| start service                                        | host-interaction/service/start                       |
| stop service                                         | host-interaction/service/stop                        |
| link function at runtime on Windows (4 matches)      | linking/runtime-linking                              |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Discovery::Application Window Discovery [T1010;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
9		- Impact::Service Stop [T1489;9]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
3		- Execution::System Services::Service Execution [T1569.002;3]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 35.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FauHdt3ywZXlsWjjl6.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.21 MB
Data read: 0.20 MB (ratio 1.04:1)
Time: 25.507 sec (0 m 25 s)
Start Date: 2022:01:28 14:19:06
End Date:   2022:01:28 14:19:32

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:19:06Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] 
FILE: /tmp/.Loki_Scan/HTTP-FauHdt3ywZXlsWjjl6.exe SCORE: 51 TYPE: EXE SIZE: 210944 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fb0699e9670> 
MD5: 37f9f0d495cebf0359d06cf96e85a51f 
SHA1: b4e674db12ab0c2d39260dab1a7779d9947a4908 
SHA256: 8958aec70d263062a01f77a71e2787275470340d0d39cce267b800ef09dd1538 CREATED: Fri Jan 28 14:19:06 2022 MODIFIED: Fri Jan 28 14:19:06 2022 ACCESSED: Fri Jan 28 14:19:32 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_12: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: IsDebuggerPresent Str4: OutputDebugString
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 0 warnings, 2 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:19:32Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
20		win_registry
1		ft_exe
1		math_entropy_5
1		IsPE64
1		IsDLL
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
10		anti_dbg
1		Contains_PE_File

Score total: 51

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Impact::Service Stop [T1489;9]', '9'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('win_registry', '20'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['51']
-------------- CAPA_Score ------------
['35.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1516.6136499691202
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FkhkMp1L6N8qmoWHJa.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e88b0d6398970e74de1de457b971003f                                                   |
| sha1                   | 861185d8d7100db4acc6f1f18e67cb360e7d109c                                           |
| sha256                 | 0c3031f630adc6cdd7b877fa1c2982909cde01dff612db5dd7df58cc778dd919                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FkhkMp1L6N8qmoWHJa.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::OutputDebugString [B0001.016]                             |
|                             | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
| PROCESS                     | Create Thread:: [C0038]                                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for OutputDebugString error                    | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB BeingDebugged flag                     | anti-analysis/anti-debugging/debugger-detection      |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| find graphical window                                | host-interaction/gui/window/find                     |
| print debug messages                                 | host-interaction/log/debug/write-event               |
| create thread                                        | host-interaction/thread/create                       |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 10.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FkhkMp1L6N8qmoWHJa.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 24.348 sec (0 m 24 s)
Start Date: 2022:01:28 14:19:33
End Date:   2022:01:28 14:19:57

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:19:33Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FkhkMp1L6N8qmoWHJa.exe SCORE: 148 TYPE: EXE SIZE: 45056 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f91e5c3d670> 
MD5: e88b0d6398970e74de1de457b971003f 
SHA1: 861185d8d7100db4acc6f1f18e67cb360e7d109c 
SHA256: 0c3031f630adc6cdd7b877fa1c2982909cde01dff612db5dd7df58cc778dd919 CREATED: Fri Jan 28 14:19:33 2022 MODIFIED: Fri Jan 28 14:19:33 2022 ACCESSED: Fri Jan 28 14:19:57 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_4 SUBSCORE: 1 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_7: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: Check_OutputDebugStringA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: Check_FindWindowA_iat_v1 SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: OLLYDBG
REASON_10: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_11: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_12: Yara Rule MATCH: Check_OutputDebugStringA_iat SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: Check_FindWindowA_iat SUBSCORE: 20 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: OLLYDBG
REASON_14: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: OutputDebugString
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:19:58Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
1		ft_exe
1		math_entropy_4
1		IsPE32
1		IsConsole
1		HasRichSignature
2		PE_File
30		Check_OutputDebugStringA_iat_v1
30		Check_FindWindowA_iat_v1
5		SEH_Save
5		SEH_Init
30		Check_OutputDebugStringA_iat
20		Check_FindWindowA_iat
10		anti_dbg
1		Contains_PE_File

Score total: 148

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_4', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Check_OutputDebugStringA_iat_v1', '30'), ('Check_FindWindowA_iat_v1', '30'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('Check_OutputDebugStringA_iat', '30'), ('Check_FindWindowA_iat', '20'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['148']
-------------- CAPA_Score ------------
['10.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2555.14446791418
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F6LBDswqovknu0nGj.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | f3edff85de5fd002692d54a04bcb1c09                                                   |
| sha1                   | 4c844c5b0ee7cb230c9c28290d079143e00cb216                                           |
| sha256                 | caf29650446db3842e1c1e8e5e1bafadaf90fc82c5c37b9e2c75a089b7476131                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F6LBDswqovknu0nGj.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Delete Directory:: [C0048]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| interact with driver via control codes (4 matches)   | host-interaction/driver                              |
| delete directory                                     | host-interaction/file-system/delete                  |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
3		- Execution::System Services::Service Execution [T1569.002;3]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 16.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F6LBDswqovknu0nGj.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.708 sec (0 m 24 s)
Start Date: 2022:01:28 14:19:58
End Date:   2022:01:28 14:20:22

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:19:58Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:20:23Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['16.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
319.24197039502076
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FrXZgMJ9L1p6DdZ44.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FrXZgMJ9L1p6DdZ44.exe: Win.Malware.EccentricBandwagon-9748740-0 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.17 MB
Data read: 0.16 MB (ratio 1.05:1)
Time: 25.852 sec (0 m 25 s)
Start Date: 2022:01:28 14:20:23
End Date:   2022:01:28 14:20:49

-------- Score ----------------
Scores		Rules
.......		...............
50		Win.Malware.EccentricBandwagon-9748740-0

Score total: 50.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:20:23Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FrXZgMJ9L1p6DdZ44.exe SCORE: 280 TYPE: EXE SIZE: 175104 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7ff4aaace670> 
MD5: 34404a3fb9804977c6ab86cb991fb130 
SHA1: b345e6fae155bfaf79c67b38cf488bb17d5be56d 
SHA256: c6930e298bba86c01d0fe2c8262c46b4fce97c6c5037a193904cfc634246fbec CREATED: Fri Jan 28 14:20:23 2022 MODIFIED: Fri Jan 28 14:20:23 2022 ACCESSED: Fri Jan 28 14:20:49 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: BitBlt Str4: GetDC
REASON_2: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetAsyncKeyState Str3: GetKeyState Str4: MapVirtualKey
REASON_3: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: DeleteFileA Str6: FindFirstFileA Str7: FindClose
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: win_pslogger_auto SUBSCORE: 45 
DESCRIPTION: Detects win.pslogger. REF: - AUTHOR: Felix Bilstein - yara-signator at cocacoding dot com 
MATCHES: Str1: 8d7608660fd60f8d7f088b048d04ed4100ffe0 Str2: 899de4feffffe8788500008d95e8feffffe81d210000538d55e88d8de8feffff Str3: 81e6fdff000083ce0 ... (truncated)
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_13: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_14: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_15: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_17: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:20:49Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
80		keylogger
10		win_files_operation
1		ft_exe
45		win_pslogger_auto
1		math_entropy_6
1		IsPE32
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
5		SEH_Save
5		SEH_Init
10		anti_dbg
1		Contains_PE_File
25		CRC32_poly_Constant
25		CRC32_table

Score total: 280

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 34404a3fb9804977c6ab86cb991fb130                                                   |
| sha1                   | b345e6fae155bfaf79c67b38cf488bb17d5be56d                                           |
| sha256                 | c6930e298bba86c01d0fe2c8262c46b4fce97c6c5037a193904cfc634246fbec                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FrXZgMJ9L1p6DdZ44.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                         |
|                        | Input Capture::Keylogging \[T1056.001]\                                            |
|                        | Screen Capture:: \[T1113]\                                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
|                             | Screen Capture::WinAPI [E1113.m01]                                            |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Encryption Key::RC4 KSA [C0028.002]                                           |
|                             | Generate Pseudo-random Sequence:: [C0021]                                     |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Compression Library:: [C0060]                                                 |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+----------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                               | NAMESPACE                                            |
|----------------------------------------------------------+------------------------------------------------------|
| log keystrokes                                           | collection/keylog                                    |
| log keystrokes via polling                               | collection/keylog                                    |
| capture screenshot                                       | collection/screenshot                                |
| encode data using XOR (5 matches)                        | data-manipulation/encoding/xor                       |
| encrypt data using RC4 KSA                               | data-manipulation/encryption/rc4                     |
| encrypt data using RC4 PRGA (2 matches)                  | data-manipulation/encryption/rc4                     |
| generate random numbers using the Delphi LCG (3 matches) | data-manipulation/prng/lcg                           |
| contain a resource (.rsrc) section                       | executable/pe/section/rsrc                           |
| read clipboard data                                      | host-interaction/clipboard                           |
| set environment variable                                 | host-interaction/environment-variable                |
| get common file path                                     | host-interaction/file-system                         |
| create directory                                         | host-interaction/file-system/create                  |
| delete directory (2 matches)                             | host-interaction/file-system/delete                  |
| delete file (2 matches)                                  | host-interaction/file-system/delete                  |
| check if file exists                                     | host-interaction/file-system/exists                  |
| enumerate files via kernel32 functions                   | host-interaction/file-system/files/list              |
| read file on Windows                                     | host-interaction/file-system/read                    |
| write file on Windows (5 matches)                        | host-interaction/file-system/write                   |
| get graphical window text                                | host-interaction/gui/window/get-text                 |
| get session user name                                    | host-interaction/session                             |
| create thread                                            | host-interaction/thread/create                       |
| terminate thread                                         | host-interaction/thread/terminate                    |
| linked against XZip                                      | linking/static/xzip                                  |
| enumerate PE sections (2 matches)                        | load-code/pe                                         |
| parse PE header (2 matches)                              | load-code/pe                                         |
+----------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Collection::Clipboard Data [T1115;4]
3		- Discovery::Account Discovery [T1087;3]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
4		- Collection::Screen Capture [T1113;4]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6		- Collection::Input Capture::Keylogging [T1056.001;6]

Score total: 39.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Collection::Clipboard Data [T1115;4]', '4'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Collection::Screen Capture [T1113;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6')]
---------------- ClamAV_Rules --------------
[('Win.Malware.EccentricBandwagon-9748740-0', '50')]
-------------- LOKI_Rules ------------
[('screenshot', '65'), ('keylogger', '80'), ('win_files_operation', '10'), ('ft_exe', '1'), ('win_pslogger_auto', '45'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25')]
-------------- LOKI_Score ------------
['280']
-------------- CAPA_Score ------------
['39.0']
-------------- CLAMAV_Score ------------
['50.0']
-------------- SCORE FINAL ------------
5845.315947626064
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FLbzqsoOZ71HtOqL4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FLbzqsoOZ71HtOqL4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.19 MB
Data read: 0.18 MB (ratio 1.04:1)
Time: 25.370 sec (0 m 25 s)
Start Date: 2022:01:28 14:20:51
End Date:   2022:01:28 14:21:16

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5a968a83780406c060335be361e0ea99                                                   |
| sha1                   | c7ec1d45372f648657ed041b6c1c410e41117489                                           |
| sha256                 | f41032bfb7ef0b2a228c46b30b40b28e9cbd7dc19879b1996e1d71f2a5782eec                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FLbzqsoOZ71HtOqL4.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (2 matches)                | collection                                           |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| check OS version (2 matches)                         | host-interaction/os/version                          |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Location Discovery [T1614;3]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 8.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:20:51Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:21:17Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['8.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
159.62098519751038
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FmTTyzrHnsFzk6Gzc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xdb in position 2: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xd0 in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:21:18Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FmTTyzrHnsFzk6Gzc.exe SCORE: 449 TYPE: EXE SIZE: 2874880 
FIRST_BYTES: 4d5a50000200000004000f00ffff0000b8000000 / <filter object at 0x7f97482da670> 
MD5: 648fc498110b11b4313a47a776e6ba40 
SHA1: 3a182e146f3549715e760b34722411eb2dad6578 
SHA256: b483b6f21601752ff800ba52092e358050e4b370117503a9309787fd57935926 CREATED: Fri Jan 28 14:21:18 2022 MODIFIED: Fri Jan 28 14:21:18 2022 ACCESSED: Fri Jan 28 14:21:43 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: gdi32.dll Str2: user32.dll Str3: BitBlt Str4: GetDC
REASON_2: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: GetKeyState Str3: MapVirtualKey
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: advapi32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.DLL Str2: kernel32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: FindClose
REASON_5: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: wininet.dll
REASON_6: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_7: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: misc_no_dosmode_header SUBSCORE: 10 
DESCRIPTION: Detect on absence of 'DOS Mode' heaader between MZ and PE boundries REF: - AUTHOR: Jason Batchelor
REASON_9: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645e000c645e100c645e2ffc645 Str2: c645f000c645f100c645f2ffc645 Str3: c645db00c645da00c645d900c645
REASON_11: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: borland_delphi SUBSCORE: 1 
DESCRIPTION: Borland Delphi 2.0 - 7.0 / 2005 - 2007 REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 538bd833c0a330ec66006a00e8dbf9ffffa328c66700a128c66700a340ec660033c0a344ec660033c0a3 Str2: 538bd833c0a330ec66006a00e8dbf9ffffa328c667 ... (truncated)
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: IDENTIFIER
REASON_17: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: IDENTIFIER
REASON_18: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: IDENTIFIER
REASON_19: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_20: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: user32.dll Str2: UnhookWindowsHookEx Str3: CallNextHookEx
REASON_21: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_22: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_23: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.DLL Str2: kernel32.dll Str3: IsDebuggerPresent Str4: OutputDebugString
REASON_24: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_25: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_26: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
REASON_27: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
REASON_28: Yara Rule MATCH: Delphi_Random SUBSCORE: 15 
DESCRIPTION: Look for Random function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 5331db699308e066000584080842899308e06600f7e289d05bc3
REASON_29: Yara Rule MATCH: Delphi_FormShow SUBSCORE: 15 
DESCRIPTION: Look for Form.Show function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 538bd8b2018bc3e8c0acffff8bc3e8bdb9f5ff5bc3
REASON_30: Yara Rule MATCH: Delphi_CompareCall SUBSCORE: 15 
DESCRIPTION: Look for Compare string function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 39d0743085d074228b48fc3b4afc752401c901c801caf7d9538b1c013b1c11750783c10478f331c05bc3
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:21:47Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
80		keylogger
20		win_registry
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Http_API
1		ft_exe
10		misc_no_dosmode_header
1		math_entropy_6
5		obfuscation_singlebyte_mov
15		dll_injection_hook
1		IsPE32
2		IsWindowsGUI
1		borland_delphi
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
35		Win_Hook_v12
5		SEH_Save
5		SEH_Init
10		anti_dbg
1		Contains_PE_File
25		CRC32_poly_Constant
25		CRC32_table
5		BASE64_table
15		Delphi_Random
15		Delphi_FormShow
15		Delphi_CompareCall

Score total: 449

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FmTTyzrHnsFzk6Gzc.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 2.91 MB
Data read: 2.74 MB (ratio 1.06:1)
Time: 31.180 sec (0 m 31 s)
Start Date: 2022:01:28 14:21:18
End Date:   2022:01:28 14:21:49

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 648fc498110b11b4313a47a776e6ba40                                                   |
| sha1                   | 3a182e146f3549715e760b34722411eb2dad6578                                           |
| sha256                 | b483b6f21601752ff800ba52092e358050e4b370117503a9309787fd57935926                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FmTTyzrHnsFzk6Gzc.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                          |
|                        | Input Capture::Keylogging \[T1056.001]\                                             |
|                        | Screen Capture:: \[T1113]\                                                          |
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | Hide Artifacts::Hidden Window \[T1564.003]\                                         |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                         |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                       |
|                        | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Location Discovery:: \[T1614]\                                               |
|                        | System Network Configuration Discovery::Internet Connection Discovery \[T1016.001]\ |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Virtual Machine Detection:: [B0009]                                           |
|                             | Virtual Machine Detection::Instruction Testing [B0009.029]                    |
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
|                             | Screen Capture::WinAPI [E1113.m01]                                            |
| COMMAND AND CONTROL         | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Read Header [C0002.014]                                   |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | HTTP Communication::Set Header [C0002.013]                                    |
|                             | HTTP Communication::WinHTTP [C0002.008]                                       |
|                             | Interprocess Communication::Create Pipe [C0003.001]                           |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence:: [C0021]                                     |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
|                             | Compression Library:: [C0060]                                                 |
|                             | Encode Data::Base64 [C0026.001]                                               |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Key [C0036.002]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Resume Thread:: [C0054]                                                       |
|                             | Set Thread Local Storage Value:: [C0041]                                      |
|                             | Suspend Thread:: [C0055]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| inspect load icon resource                            | anti-analysis                                        |
| check for software breakpoints (2 matches)            | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via GetTickCount (3 matches)     | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-VM instructions (2 matches)              | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Xen               | anti-analysis/anti-vm/vm-detection                   |
| get geographical location (5 matches)                 | collection                                           |
| log keystrokes                                        | collection/keylog                                    |
| log keystrokes via polling (9 matches)                | collection/keylog                                    |
| capture screenshot                                    | collection/screenshot                                |
| send data                                             | communication                                        |
| initialize WinHTTP library                            | communication/http                                   |
| read HTTP header                                      | communication/http                                   |
| set HTTP header (3 matches)                           | communication/http                                   |
| receive HTTP response (2 matches)                     | communication/http/client                            |
| create pipe                                           | communication/named-pipe/create                      |
| compiled with Borland Delphi                          | compiler/delphi                                      |
| reference Base64 string                               | data-manipulation/encoding/base64                    |
| encode data using XOR (13 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA (4 matches)               | data-manipulation/encryption/rc4                     |
| generate random numbers using the Delphi LCG          | data-manipulation/prng/lcg                           |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section         | executable/pe/section/tls                            |
| extract resource via kernel32 functions (4 matches)   | executable/resource                                  |
| accept command line arguments (2 matches)             | host-interaction/cli                                 |
| read clipboard data                                   | host-interaction/clipboard                           |
| replace clipboard data                                | host-interaction/clipboard                           |
| query environment variable                            | host-interaction/environment-variable                |
| create directory                                      | host-interaction/file-system/create                  |
| delete directory                                      | host-interaction/file-system/delete                  |
| delete file                                           | host-interaction/file-system/delete                  |
| check if file exists (2 matches)                      | host-interaction/file-system/exists                  |
| get file attributes (2 matches)                       | host-interaction/file-system/meta                    |
| get file size                                         | host-interaction/file-system/meta                    |
| get file version info (2 matches)                     | host-interaction/file-system/meta                    |
| read file on Windows (2 matches)                      | host-interaction/file-system/read                    |
| write file on Windows (4 matches)                     | host-interaction/file-system/write                   |
| enumerate gui resources (3 matches)                   | host-interaction/gui                                 |
| set application hook (4 matches)                      | host-interaction/gui                                 |
| set global application hook                           | host-interaction/gui                                 |
| find graphical window (2 matches)                     | host-interaction/gui/window/find                     |
| get graphical window text (2 matches)                 | host-interaction/gui/window/get-text                 |
| hide graphical window (15 matches)                    | host-interaction/gui/window/hide                     |
| get number of processors                              | host-interaction/hardware/cpu                        |
| get keyboard layout (5 matches)                       | host-interaction/hardware/keyboard/layout            |
| get disk size                                         | host-interaction/hardware/storage                    |
| check Internet connectivity via WinINet               | host-interaction/network/connectivity                |
| get hostname                                          | host-interaction/os/hostname                         |
| get system information on Windows                     | host-interaction/os/info                             |
| check OS version (3 matches)                          | host-interaction/os/version                          |
| get thread local storage value                        | host-interaction/process                             |
| set thread local storage value                        | host-interaction/process                             |
| create a process with modified I/O handles and window | host-interaction/process/create                      |
| create process on Windows                             | host-interaction/process/create                      |
| allocate RWX memory                                   | host-interaction/process/inject                      |
| query or enumerate registry key (3 matches)           | host-interaction/registry                            |
| query or enumerate registry value (6 matches)         | host-interaction/registry                            |
| set registry value                                    | host-interaction/registry/create                     |
| delete registry key                                   | host-interaction/registry/delete                     |
| delete registry value                                 | host-interaction/registry/delete                     |
| get session user name                                 | host-interaction/session                             |
| create thread (2 matches)                             | host-interaction/thread/create                       |
| resume thread (2 matches)                             | host-interaction/thread/resume                       |
| suspend thread                                        | host-interaction/thread/suspend                      |
| access PEB ldr_data (3 matches)                       | linking/runtime-linking                              |
| link function at runtime on Windows (4 matches)       | linking/runtime-linking                              |
| linked against ZLIB                                   | linking/static/zlib                                  |
| enumerate PE sections (5 matches)                     | load-code/pe                                         |
| parse PE header (13 matches)                          | load-code/pe                                         |
| persist via Run registry key                          | persistence/registry/run                             |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Location Discovery [T1614;3]
4		- Execution::Command and Scripting Interpreter [T1059;4]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
3		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
2		- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Collection::Clipboard Data [T1115;4]
3		- Discovery::Account Discovery [T1087;3]
2		- Discovery::Application Window Discovery [T1010;2]
4		- Collection::Screen Capture [T1113;4]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
1		- Discovery::Query Registry [T1012;1]

Score total: 86.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]', '3'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Discovery::System Network Configuration Discovery::Internet Connection Discovery [T1016.001;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Collection::Clipboard Data [T1115;4]', '4'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Collection::Screen Capture [T1113;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('screenshot', '65'), ('keylogger', '80'), ('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '1'), ('misc_no_dosmode_header', '10'), ('math_entropy_6', '1'), ('obfuscation_singlebyte_mov', '5'), ('dll_injection_hook', '15'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('borland_delphi', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('Win_Hook_v12', '35'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25'), ('BASE64_table', '5'), ('Delphi_Random', '15'), ('Delphi_FormShow', '15'), ('Delphi_CompareCall', '15')]
-------------- LOKI_Score ------------
['449']
-------------- CAPA_Score ------------
['86.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
8832.096025023635
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F4nllg2nexY6MhT79b.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F4nllg2nexY6MhT79b.exe: Win.Trojan.Agent-375080 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.05 MB
Data read: 0.04 MB (ratio 1.44:1)
Time: 25.522 sec (0 m 25 s)
Start Date: 2022:01:28 14:24:51
End Date:   2022:01:28 14:25:17

-------- Score ----------------
Scores		Rules
.......		...............
70		Win.Trojan.Agent-375080
75		Win.Trojan.Agent-375080
45		Win.Trojan.Agent-375080

Score total: 190.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:24:51Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F4nllg2nexY6MhT79b.exe SCORE: 204 TYPE: EXE SIZE: 36864 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fdd57b2d670> 
MD5: 56bed8249e7c2982a90e54e1e55391a2 
SHA1: 92c1802eeec9c5a15af83961e53c07b04476bd4a 
SHA256: e2aed4398e0178670d9678961ca89a0f15a3eac20f396bdf29de8ac66cb853fa CREATED: Fri Jan 28 14:24:51 2022 MODIFIED: Fri Jan 28 14:24:51 2022 ACCESSED: Fri Jan 28 14:25:17 2022 
REASON_1: Yara Rule MATCH: network_dropper SUBSCORE: 65 
DESCRIPTION: File downloader/dropper REF: - AUTHOR: x0r 
MATCHES: Str1: urlmon.dll Str2: URLDownloadToFile
REASON_2: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: SeDebugPrivilege Str3: AdjustTokenPrivileges
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: CreateFileA
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_1 SUBSCORE: 1 
DESCRIPTION: Very low entropy - repeating 2 bytes REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_13: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:25:17Z

-------- Score ----------------
Scores		Rules
.......		...............
65		network_dropper
70		escalate_priv
10		win_token
10		win_files_operation
1		ft_exe
1		math_entropy_1
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
35		Embedded_PE
2		PE_File
5		SEH_Init
1		Contains_PE_File

Score total: 204

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Agent-375080', '70'), ('Win.Trojan.Agent-375080', '75'), ('Win.Trojan.Agent-375080', '45')]
-------------- LOKI_Rules ------------
[('network_dropper', '65'), ('escalate_priv', '70'), ('win_token', '10'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_1', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('Embedded_PE', '35'), ('PE_File', '2'), ('SEH_Init', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['204']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['190.0']
-------------- SCORE FINAL ------------
5625.140395029589
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FyHLit3vuemhvZ65gl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 773290480d5445f11d3dc1b800728966                                                   |
| sha1                   | e70318439993e073dc298d45a9c8eaa8cee79e4d                                           |
| sha256                 | 7b8c44c6eba0246f755f1700cc71d39ce756f23b5358957b7fe55b7ac6c30dce                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FyHLit3vuemhvZ65gl.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Virtualization/Sandbox Evasion:: \[T1497]\                                          |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                         |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                       |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | Software Discovery:: \[T1518]\                                                      |
|                        | System Network Configuration Discovery:: \[T1016]\                                  |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | Shared Modules:: \[T1129]\                                                          |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
|                             | Virtual Machine Detection::Product Key/ID Testing [B0007.005]                 |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for microsoft office emulation                 | anti-analysis/anti-vm/vm-detection                   |
| check for sandbox username                           | anti-analysis/anti-vm/vm-detection                   |
| check for windows sandbox via device                 | anti-analysis/anti-vm/vm-detection                   |
| check for windows sandbox via dns suffix             | anti-analysis/anti-vm/vm-detection                   |
| check for windows sandbox via genuine state          | anti-analysis/anti-vm/vm-detection                   |
| check for windows sandbox via process name           | anti-analysis/anti-vm/vm-detection                   |
| check for windows sandbox via registry               | anti-analysis/anti-vm/vm-detection                   |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get common file path                                 | host-interaction/file-system                         |
| get local IPv4 addresses                             | host-interaction/network/address                     |
| query or enumerate registry value                    | host-interaction/registry                            |
| get session user name                                | host-interaction/session                             |
| parse PE header (7 matches)                          | load-code/pe                                         |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
3		- Discovery::Account Discovery [T1087;3]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::Query Registry [T1012;1]
7		- Defense Evasion::Virtualization/Sandbox Evasion [T1497;7]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2		- Discovery::Software Discovery [T1518;2]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Network Configuration Discovery [T1016;3]

Score total: 39.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FyHLit3vuemhvZ65gl.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.13 MB
Data read: 0.12 MB (ratio 1.03:1)
Time: 25.144 sec (0 m 25 s)
Start Date: 2022:01:28 14:25:17
End Date:   2022:01:28 14:25:43

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x80 in position 7: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:25:18Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FyHLit3vuemhvZ65gl.exe SCORE: 79 TYPE: EXE SIZE: 131072 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f16180f7670> 
MD5: 773290480d5445f11d3dc1b800728966 
SHA1: e70318439993e073dc298d45a9c8eaa8cee79e4d 
SHA256: 7b8c44c6eba0246f755f1700cc71d39ce756f23b5358957b7fe55b7ac6c30dce CREATED: Fri Jan 28 14:25:17 2022 MODIFIED: Fri Jan 28 14:25:17 2022 ACCESSED: Fri Jan 28 14:25:43 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: FindClose
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453594b1e80d4c8644d8d6a0b933385ff6203000000433a5c55736572735c50435c736f757263655c7265706f735c57696e646f77732053616e64626f7820446 ... (truncated)
REASON_4: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:25:43Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
1		ft_exe
50		ConventionEngine_Term_Users
1		math_entropy_6
1		IsPE64
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
10		anti_dbg
1		Contains_PE_File

Score total: 79

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Virtualization/Sandbox Evasion [T1497;7]', '7'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Discovery::Software Discovery [T1518;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Network Configuration Discovery [T1016;3]', '3')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '1'), ('ConventionEngine_Term_Users', '50'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['79']
-------------- CAPA_Score ------------
['39.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2030.2179248821426
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F33OeU1Ad6MhYA1cG4.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 695500833b489cbcbfecd08b1faf81c5                                                   |
| sha1                   | 6d4b085c151f3849630516795077166028c14e27                                           |
| sha256                 | 2a8993f81a3a8e23829fe6f13dfaf32840633b2d1aec73a7c2ac7acf15acee72                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F33OeU1Ad6MhYA1cG4.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
| DATA                        | Non-Cryptographic Hash::FNV [C0030.005]                                       |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-debugging instructions                  | anti-analysis/anti-debugging/debugger-detection      |
| hash data using fnv                                  | data-manipulation/hashing/fnv                        |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| query environment variable                           | host-interaction/environment-variable                |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 11.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F33OeU1Ad6MhYA1cG4.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.23 MB
Data read: 0.22 MB (ratio 1.04:1)
Time: 25.999 sec (0 m 25 s)
Start Date: 2022:01:28 14:25:44
End Date:   2022:01:28 14:26:10

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc7 in position 1: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:25:44Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F33OeU1Ad6MhYA1cG4.exe SCORE: 250 TYPE: EXE SIZE: 235520 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f8cac91f670> 
MD5: 695500833b489cbcbfecd08b1faf81c5 
SHA1: 6d4b085c151f3849630516795077166028c14e27 
SHA256: 2a8993f81a3a8e23829fe6f13dfaf32840633b2d1aec73a7c2ac7acf15acee72 CREATED: Fri Jan 28 14:25:44 2022 MODIFIED: Fri Jan 28 14:25:44 2022 ACCESSED: Fri Jan 28 14:26:10 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier Str3: identifier
REASON_10: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier Str3: identifier
REASON_11: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier Str2: Identifier Str3: identifier
REASON_12: Yara Rule MATCH: VM_Detect_VirtualPC_XEN_Wine_v1 SUBSCORE: 60 
DESCRIPTION: Xen detection, VirtualPC, Red Pill, Wine and other REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: 45c70001
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: 45c70001
REASON_15: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: 45c70001
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:26:11Z

-------- Score ----------------
Scores		Rules
.......		...............
1		ft_exe
1		math_entropy_5
1		IsPE64
1		IsDLL
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
60		VM_Detect_VirtualPC_XEN_Wine_v1
5		Anti_Automated_Sandbox
60		vmdetect_2
60		vmdetect
1		Contains_PE_File

Score total: 250

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('VM_Detect_VirtualPC_XEN_Wine_v1', '60'), ('Anti_Automated_Sandbox', '5'), ('vmdetect_2', '60'), ('vmdetect', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['250']
-------------- CAPA_Score ------------
['11.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4191.688147374204
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FVJs5tvDN8R4GHC87.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FVJs5tvDN8R4GHC87.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.32 MB
Data read: 0.30 MB (ratio 1.05:1)
Time: 25.812 sec (0 m 25 s)
Start Date: 2022:01:28 14:26:11
End Date:   2022:01:28 14:26:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:26:11Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FVJs5tvDN8R4GHC87.exe SCORE: 131 TYPE: EXE SIZE: 316928 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fd59f73b670> 
MD5: 93aeb0de230121bad93f8cb76254faef 
SHA1: 925c9e08d60cc7607b466a57a85161c5b166924b 
SHA256: 2b3453d38387189a5b837ed8a4db7014514e5408d4b287403dadf08e4700ff58 CREATED: Fri Jan 28 14:26:11 2022 MODIFIED: Fri Jan 28 14:26:11 2022 ACCESSED: Fri Jan 28 14:26:38 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_11: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_12: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier Str2: Identifier
REASON_13: Yara Rule MATCH: skip20_sqllang_hook SUBSCORE: 60 
DESCRIPTION: YARA rule to detect if a sqllang.dll version is targeted by skip-2.0. Each byte pattern corresponds to a function hooked by skip-2.0. If _0 or _1 match, it is probably targeted as it corresponds to the hook responsible for bypassing the authentication. REF: https://www.welivesecurity.com/ AUTHOR: Mathieu Tartare <mathieu.tartare@eset.com> 
MATCHES: Str1: 8bc1488b8c24300200004833cc
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:26:38Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		ft_exe
1		math_entropy_6
1		IsPE64
1		IsDLL
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
60		skip20_sqllang_hook
1		Contains_PE_File

Score total: 131

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 93aeb0de230121bad93f8cb76254faef                                                   |
| sha1                   | 925c9e08d60cc7607b466a57a85161c5b166924b                                           |
| sha256                 | 2b3453d38387189a5b837ed8a4db7014514e5408d4b287403dadf08e4700ff58                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FVJs5tvDN8R4GHC87.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| PROCESS                     | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| enumerate PE sections (2 matches)                    | load-code/pe                                         |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 10.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('skip20_sqllang_hook', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['131']
-------------- CAPA_Score ------------
['10.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
2285.7126251957907
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F6fnY5GCJYrIzv3C3.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 7e17f0f35d50f49407841372f24fbd38                                                   |
| sha1                   | 921ad55a3f593239b906163cf1bb8001194822f3                                           |
| sha256                 | 934c3445fe9d1a3d4cca4d3ec09c9191d8f9067e13e58fa0b288cb520cd40785                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F6fnY5GCJYrIzv3C3.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Automated Collection:: \[T1119]\                                                   |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Check String:: [C0019]                                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| parse credit card information                        | collection/credit-card                               |
| encrypt data using RC4 PRGA (5 matches)              | data-manipulation/encryption/rc4                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| allocate thread local storage                        | host-interaction/process                             |
| terminate process                                    | host-interaction/process/terminate                   |
| link many functions at runtime                       | linking/runtime-linking                              |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
2		- Execution::Shared Modules [T1129;2]
5.5		- Collection::Automated Collection [T1119;5.5]

Score total: 13.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F6fnY5GCJYrIzv3C3.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.18 MB
Data read: 0.17 MB (ratio 1.05:1)
Time: 25.127 sec (0 m 25 s)
Start Date: 2022:01:28 14:26:57
End Date:   2022:01:28 14:27:22

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:26:57Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] 
FILE: /tmp/.Loki_Scan/HTTP-F6fnY5GCJYrIzv3C3.exe SCORE: 44 TYPE: EXE SIZE: 183296 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f2d3630f670> 
MD5: 7e17f0f35d50f49407841372f24fbd38 
SHA1: 921ad55a3f593239b906163cf1bb8001194822f3 
SHA256: 934c3445fe9d1a3d4cca4d3ec09c9191d8f9067e13e58fa0b288cb520cd40785 CREATED: Fri Jan 28 14:26:57 2022 MODIFIED: Fri Jan 28 14:26:57 2022 ACCESSED: Fri Jan 28 14:27:23 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.DLL Str2: kernel32.dll Str3: KERNEL32.dll Str4: WriteFile Str5: SetFilePointer Str6: CreateFileA
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645d0ccc645d1ccc645d2ccc645 Str2: c645d1ccc645d2ccc645d3ccc645 Str3: c645d2ccc645d3ccc645d4ccc645 Str4: c645d3ccc645d4ccc645d5ccc645 ... (truncated)
REASON_5: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_10: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_11: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.DLL Str2: kernel32.dll Str3: KERNEL32.dll Str4: IsDebuggerPresent
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 0 warnings, 2 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:27:23Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
1		ft_exe
1		math_entropy_6
5		obfuscation_singlebyte_mov
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
2		PE_File
5		SEH_Save
5		SEH_Init
10		anti_dbg
1		Contains_PE_File

Score total: 44

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Collection::Automated Collection [T1119;5.5]', '5.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('obfuscation_singlebyte_mov', '5'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('PE_File', '2'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['44']
-------------- CAPA_Score ------------
['13.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
966.7134172036886
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FEh26x34GlqAPqGXA5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 433d943ce267eaa3485137e0d21a7348                                                   |
| sha1                   | 0ffbae84afadf220cd379bc823f0ba7e95e50ea5                                           |
| sha256                 | 3c4de3f013d4611bbdb14ea17207e4d93eb406e14e639b1d87ce217c96747cf2                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FEh26x34GlqAPqGXA5.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 2.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FEh26x34GlqAPqGXA5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.07 MB
Data read: 0.07 MB (ratio 1.00:1)
Time: 24.785 sec (0 m 24 s)
Start Date: 2022:01:28 14:27:24
End Date:   2022:01:28 14:27:48

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:27:24Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FEh26x34GlqAPqGXA5.exe SCORE: 65 TYPE: EXE SIZE: 70144 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fc41612a670> 
MD5: 433d943ce267eaa3485137e0d21a7348 
SHA1: 0ffbae84afadf220cd379bc823f0ba7e95e50ea5 
SHA256: 3c4de3f013d4611bbdb14ea17207e4d93eb406e14e639b1d87ce217c96747cf2 CREATED: Fri Jan 28 14:27:24 2022 MODIFIED: Fri Jan 28 14:27:24 2022 ACCESSED: Fri Jan 28 14:27:49 2022 
REASON_1: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_2: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_3: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_6: Yara Rule MATCH: ImportTableIsBad SUBSCORE: 2 
DESCRIPTION: ImportTable Check REF: - AUTHOR: _pusher_ & mrexodia
REASON_7: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_9: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_10: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:27:49Z

-------- Score ----------------
Scores		Rules
.......		...............
1		ft_exe
1		math_entropy_5
1		IsPE64
1		IsConsole
1		HasDebugData
2		ImportTableIsBad
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
1		Contains_PE_File

Score total: 65

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('ImportTableIsBad', '2'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['65']
-------------- CAPA_Score ------------
['2.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1070.0858213991012
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FsBxqY35sVx489xzRd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FsBxqY35sVx489xzRd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.62 MB
Data read: 0.59 MB (ratio 1.05:1)
Time: 26.115 sec (0 m 26 s)
Start Date: 2022:01:28 14:27:49
End Date:   2022:01:28 14:28:15

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8a in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x96 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb7 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xe8 in position 0: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:27:49Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FsBxqY35sVx489xzRd.exe SCORE: 340 TYPE: EXE SIZE: 623104 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f291ec70670> 
MD5: 6b25f1e754ef486bbb28a66d46bababe 
SHA1: a010d69bd8eec8e207578723b1052e8e018eeec5 
SHA256: 38749e9c35921ab2fb0b8a80f8e13f89521c58c4d65d18dc4109c816c210e0fe CREATED: Fri Jan 28 14:27:49 2022 MODIFIED: Fri Jan 28 14:27:49 2022 ACCESSED: Fri Jan 28 14:28:15 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_3: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken Str4: LookupPrivilegeValueA
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: Kernel32.DLL Str2: kernel32.dll Str3: KERNEL32.dll Str4: WriteFile Str5: SetFilePointer Str6: ReadFile Str7: DeleteFileA Str8: Create ... (truncated)
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: Havex SUBSCORE: 85 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 07e8b6b0ffff59895dfce897ffffff8945e08d45e450e840ffffff593bc374 Str2: 8a46038847038a46028847028a46018847018b45085e5fc9c3 Str3: e8234f0 ... (truncated)
REASON_7: Yara Rule MATCH: math_entropy_7 SUBSCORE: 1 
DESCRIPTION: High entropy - probably random stream, packed data or encryption REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c645d0ccc645d1ccc645d2ccc645 Str2: c645d1ccc645d2ccc645d3ccc645 Str3: c645d2ccc645d3ccc645d4ccc645 Str4: c645d3ccc645d4ccc645d5ccc645 ... (truncated)
REASON_9: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsPacked SUBSCORE: 5 
DESCRIPTION: Entropy Check REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_17: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_18: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: Kernel32.DLL Str2: kernel32.dll Str3: KERNEL32.dll Str4: IsDebuggerPresent
REASON_19: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_20: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: BBBBBBBBBBBBBBBBBBBB
REASON_21: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
REASON_22: Yara Rule MATCH: CRC32_table SUBSCORE: 25 
DESCRIPTION: Look for CRC32 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 00000000963007772c610eeeba51099919c46d07
REASON_23: Yara Rule MATCH: CRC32b_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32b [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: b71dc104
REASON_24: Yara Rule MATCH: VC8_Random SUBSCORE: 15 
DESCRIPTION: Look for Random function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: e80f4100008b481469c9fd43030081c1c39e26008948148bc1c1e81025ff7f0000c3
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:28:16Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
20		win_registry
10		win_token
10		win_files_operation
1		ft_exe
85		Havex
1		math_entropy_7
5		obfuscation_singlebyte_mov
1		IsPE32
2		IsWindowsGUI
5		IsPacked
1		HasOverlay
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
5		SEH_Save
5		SEH_Init
10		anti_dbg
1		Contains_PE_File
10		Big_Numbers0
25		CRC32_poly_Constant
25		CRC32_table
25		CRC32b_poly_Constant
15		VC8_Random

Score total: 340

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 6b25f1e754ef486bbb28a66d46bababe                                                   |
| sha1                   | a010d69bd8eec8e207578723b1052e8e018eeec5                                           |
| sha256                 | 38749e9c35921ab2fb0b8a80f8e13f89521c58c4d65d18dc4109c816c210e0fe                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FsBxqY35sVx489xzRd.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | System Shutdown/Reboot:: \[T1529]\                                                 |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | Interprocess Communication::Create Pipe [C0003.001]                           |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete Directory:: [C0048]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Read File:: [C0051]                                                           |
|                             | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
|                             | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Allocate Thread Local Storage:: [C0040]                                       |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+-------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                            | NAMESPACE                                            |
|-------------------------------------------------------+------------------------------------------------------|
| create pipe                                           | communication/named-pipe/create                      |
| compiled with exe4j                                   | compiler/exe4j                                       |
| encode data using XOR (3 matches)                     | data-manipulation/encoding/xor                       |
| debug build                                           | executable/pe/debug                                  |
| contain a resource (.rsrc) section                    | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (2 matches)   | executable/resource                                  |
| accept command line arguments (2 matches)             | host-interaction/cli                                 |
| query environment variable (12 matches)               | host-interaction/environment-variable                |
| set environment variable (4 matches)                  | host-interaction/environment-variable                |
| get common file path (6 matches)                      | host-interaction/file-system                         |
| create directory (4 matches)                          | host-interaction/file-system/create                  |
| delete directory (4 matches)                          | host-interaction/file-system/delete                  |
| delete file (3 matches)                               | host-interaction/file-system/delete                  |
| check if file exists                                  | host-interaction/file-system/exists                  |
| enumerate files recursively                           | host-interaction/file-system/files/list              |
| read file on Windows (8 matches)                      | host-interaction/file-system/read                    |
| write file on Windows (3 matches)                     | host-interaction/file-system/write                   |
| enumerate gui resources                               | host-interaction/gui                                 |
| shutdown system                                       | host-interaction/os                                  |
| check OS version (3 matches)                          | host-interaction/os/version                          |
| allocate thread local storage                         | host-interaction/process                             |
| create a process with modified I/O handles and window | host-interaction/process/create                      |
| create process on Windows (4 matches)                 | host-interaction/process/create                      |
| modify access privileges                              | host-interaction/process/modify                      |
| terminate process (4 matches)                         | host-interaction/process/terminate                   |
| query or enumerate registry key (2 matches)           | host-interaction/registry                            |
| query or enumerate registry value (5 matches)         | host-interaction/registry                            |
| set registry value (2 matches)                        | host-interaction/registry/create                     |
| create thread                                         | host-interaction/thread/create                       |
| link many functions at runtime (2 matches)            | linking/runtime-linking                              |
+-------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
1		- Discovery::File and Directory Discovery [T1083;1]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
2		- Discovery::Application Window Discovery [T1010;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Execution::Shared Modules [T1129;2]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
9		- Impact::System Shutdown/Reboot [T1529;9]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 46.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Impact::System Shutdown/Reboot [T1529;9]', '9'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('win_registry', '20'), ('win_token', '10'), ('win_files_operation', '10'), ('ft_exe', '1'), ('Havex', '85'), ('math_entropy_7', '1'), ('obfuscation_singlebyte_mov', '5'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('IsPacked', '5'), ('HasOverlay', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1'), ('Big_Numbers0', '10'), ('CRC32_poly_Constant', '25'), ('CRC32_table', '25'), ('CRC32b_poly_Constant', '25'), ('VC8_Random', '15')]
-------------- LOKI_Score ------------
['340']
-------------- CAPA_Score ------------
['46.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6316.433830828315
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FDIfd53pnbBkIPLQc1.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | edc83f2d9e0f3906eeff6c5056ebeca6                                                   |
| sha1                   | 3c3bd1889d01ee717b15af7100bf1897beabda49                                           |
| sha256                 | d036bcd15fb7054aa1951bd72c776e3ba089c3e6ab5020a850a1b52ed0ed2f08                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FDIfd53pnbBkIPLQc1.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location (3 matches)                | collection                                           |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| check OS version                                     | host-interaction/os/version                          |
| parse PE header (4 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Location Discovery [T1614;3]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 8.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FDIfd53pnbBkIPLQc1.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 24.454 sec (0 m 24 s)
Start Date: 2022:01:28 14:28:24
End Date:   2022:01:28 14:28:48

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:28:24Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-FDIfd53pnbBkIPLQc1.exe SCORE: 79 TYPE: EXE SIZE: 49664 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f245337a670> 
MD5: edc83f2d9e0f3906eeff6c5056ebeca6 
SHA1: 3c3bd1889d01ee717b15af7100bf1897beabda49 
SHA256: d036bcd15fb7054aa1951bd72c776e3ba089c3e6ab5020a850a1b52ed0ed2f08 CREATED: Fri Jan 28 14:28:24 2022 MODIFIED: Fri Jan 28 14:28:24 2022 ACCESSED: Fri Jan 28 14:28:49 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_10: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_11: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:28:49Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		ft_exe
1		math_entropy_5
1		IsPE64
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
60		DebuggerException__SetConsoleCtrl_v1
1		Contains_PE_File

Score total: 79

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE64', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['79']
-------------- CAPA_Score ------------
['8.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1411.68660724179
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FQpt3y4xTCHxaXdL3c.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FQpt3y4xTCHxaXdL3c.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.19 MB
Data read: 0.18 MB (ratio 1.04:1)
Time: 25.740 sec (0 m 25 s)
Start Date: 2022:01:28 14:28:49
End Date:   2022:01:28 14:29:15

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:28:49Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:29:16Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 914530f2fcb9110f4dcb2b1e027e5ae2                                                   |
| sha1                   | 970f592957e9466de3b0c76d6520a2e8e2a45c72                                           |
| sha256                 | cd4aa8eb12f2013a19ac68d3858d0c103588096a6b81b0fd6e252bdbf5f09c85                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FQpt3y4xTCHxaXdL3c.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| terminate process via fastfail (10 matches)          | host-interaction/process/terminate                   |
| create thread (4 matches)                            | host-interaction/thread/create                       |
| parse PE header (6 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
79.81049259875519
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FNratCUleztq7sPC5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 2d3edc218a90f03089cc01715a9f047f                                                   |
| sha1                   | 52c402ab80daf46fe997151819442d8ac97932f6                                           |
| sha256                 | e606530456555bfa92c98365539b16d20bf678fae1ce180d9574a0ea48cc8a9f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FNratCUleztq7sPC5.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Application Layer Protocol::Web Protocols \[T1071.001]\                             |
|                        | Non-Application Layer Protocol:: \[T1095]\                                          |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                             |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                         |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                    |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                            |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | Software Discovery:: \[T1518]\                                                      |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | System Services::Service Execution \[T1569.002]\                                    |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
|                        | Service Stop:: \[T1489]\                                                            |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
|                        | Create or Modify System Process::Windows Service \[T1543.003]\                      |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
| COMMAND AND CONTROL         | C2 Communication::Receive Data [B0030.002]                                    |
|                             | C2 Communication::Send Data [B0030.001]                                       |
| COMMUNICATION               | HTTP Communication::Connect to Server [C0002.009]                             |
|                             | HTTP Communication::Create Request [C0002.012]                                |
|                             | HTTP Communication::Get Response [C0002.017]                                  |
|                             | HTTP Communication::Send Request [C0002.003]                                  |
|                             | Interprocess Communication::Connect Pipe [C0003.002]                          |
|                             | Interprocess Communication::Create Pipe [C0003.001]                           |
|                             | Interprocess Communication::Read Pipe [C0003.003]                             |
|                             | Interprocess Communication::Write Pipe [C0003.004]                            |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Checksum::CRC32 [C0032.001]                                                   |
|                             | Checksum::Luhn [C0032.002]                                                    |
|                             | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| receive data                                         | communication                                        |
| send data                                            | communication                                        |
| create pipe                                          | communication/named-pipe/create                      |
| read pipe (2 matches)                                | communication/named-pipe/read                        |
| write pipe (3 matches)                               | communication/named-pipe/write                       |
| hash data with CRC32                                 | data-manipulation/checksum/crc32                     |
| validate payment card number using luhn algorithm    | data-manipulation/checksum/luhn                      |
| encode data using XOR (3 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA                          | data-manipulation/encryption/rc4                     |
| contain an embedded PE file                          | executable/subfile/pe                                |
| get common file path                                 | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| create directory                                     | host-interaction/file-system/create                  |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| set file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| read file on Windows (2 matches)                     | host-interaction/file-system/read                    |
| write file on Windows (3 matches)                    | host-interaction/file-system/write                   |
| get disk information                                 | host-interaction/hardware/storage                    |
| check mutex                                          | host-interaction/mutex                               |
| create mutex                                         | host-interaction/mutex                               |
| get hostname                                         | host-interaction/os/hostname                         |
| read process memory                                  | host-interaction/process                             |
| create process on Windows (2 matches)                | host-interaction/process/create                      |
| inject thread                                        | host-interaction/process/inject                      |
| enumerate processes (4 matches)                      | host-interaction/process/list                        |
| terminate process (2 matches)                        | host-interaction/process/terminate                   |
| query or enumerate registry value                    | host-interaction/registry                            |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| start service                                        | host-interaction/service/start                       |
| stop service                                         | host-interaction/service/stop                        |
| get token membership                                 | host-interaction/session                             |
| terminate thread                                     | host-interaction/thread/terminate                    |
| spawn thread to RWX shellcode                        | load-code/shellcode                                  |
| persist via Run registry key                         | persistence/registry/run                             |
| write file to startup folder                         | persistence/startup-folder                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
9		- Impact::Service Stop [T1489;9]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::File and Directory Permissions Modification [T1222;4]
3		- Execution::System Services::Service Execution [T1569.002;3]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]
2		- Discovery::Software Discovery [T1518;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
1		- Discovery::Query Registry [T1012;1]

Score total: 74.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FNratCUleztq7sPC5.exe: Win.Trojan.ProPOS-1 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.04 MB
Data read: 0.04 MB (ratio 1.00:1)
Time: 24.666 sec (0 m 24 s)
Start Date: 2022:01:28 14:29:25
End Date:   2022:01:28 14:29:50

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.ProPOS-1

Score total: 45.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xde in position 5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:29:25Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FNratCUleztq7sPC5.exe SCORE: 529 TYPE: EXE SIZE: 42496 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f4a5baf8670> 
MD5: 2d3edc218a90f03089cc01715a9f047f 
SHA1: 52c402ab80daf46fe997151819442d8ac97932f6 
SHA256: e606530456555bfa92c98365539b16d20bf678fae1ce180d9574a0ea48cc8a9f CREATED: Fri Jan 28 14:29:25 2022 MODIFIED: Fri Jan 28 14:29:25 2022 ACCESSED: Fri Jan 28 14:29:50 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_2: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: HttpOpenRequest Str6: HttpSendRequest
REASON_3: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_4: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: DeleteFileA Str5: CreateFileA Str6: SetFileAttributesA Str7: CopyFile
REASON_6: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_7: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_8: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpQueryInfo Str3: HttpOpenRequest
REASON_9: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: ConventionEngine_Anomaly_NulledOut SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 525344536ade19bb8007d04f92147832a36de67f0b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 ... (truncated)
REASON_11: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_16: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_18: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_19: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_20: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_21: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: SOFTWARE\Microsoft\Windows\CurrentVersion Str2: Software\Microsoft\Windows\CurrentVersion Str3: RegQueryValue
REASON_22: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread Str5: CreateThread
REASON_23: Yara Rule MATCH: Antivirus_strings SUBSCORE: 50 
DESCRIPTION: Contains references to security software REF: - AUTHOR: Jerome Athias 
MATCHES: Str1: firewall.exe
REASON_24: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_25: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_26: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_27: Yara Rule MATCH: easterjackpos SUBSCORE: 60 
DESCRIPTION: Identify JackPOS REF: - AUTHOR: Brian Wallace @botnet_hunter 
MATCHES: Str1: updateinterval= Str2: cardinterval= Str3: {[!17!]}{[!18!]}
REASON_28: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_29: Yara Rule MATCH: CRC32_poly_Constant SUBSCORE: 25 
DESCRIPTION: Look for CRC32 [poly] REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 2083b8ed
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:29:51Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
45		network_http
5		win_mutex
20		win_registry
10		win_files_operation
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
1		ft_exe
50		ConventionEngine_Anomaly_NulledOut
1		math_entropy_6
15		dll_injection_thread
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
35		Embedded_PE
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
45		Inject_Thread
50		Antivirus_strings
5		SEH_Save
5		SEH_Init
10		anti_dbg
60		easterjackpos
1		Contains_PE_File
25		CRC32_poly_Constant

Score total: 529

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Impact::Service Stop [T1489;9]', '9'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::File and Directory Permissions Modification [T1222;4]', '4'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]', '4'), ('- Discovery::Software Discovery [T1518;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Command and Control::Application Layer Protocol::Web Protocols [T1071.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.ProPOS-1', '45')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('network_http', '45'), ('win_mutex', '5'), ('win_registry', '20'), ('win_files_operation', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '1'), ('ConventionEngine_Anomaly_NulledOut', '50'), ('math_entropy_6', '1'), ('dll_injection_thread', '15'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('Embedded_PE', '35'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('Inject_Thread', '45'), ('Antivirus_strings', '50'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('easterjackpos', '60'), ('Contains_PE_File', '1'), ('CRC32_poly_Constant', '25')]
-------------- LOKI_Score ------------
['529']
-------------- CAPA_Score ------------
['74.5']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
10437.071848078482
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FX7iiJ2lTKd16d0Tte.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ae3f3dc3ed900f2a582bad86a764508c                                                   |
| sha1                   | 1e44ee63bdb2cf3a6e48b521844204218a001344                                           |
| sha256                 | 1a1876c5eed2b8cd9e14ebff3f4eeb7e21552a4c6aab4bf392a55f8df3612dab                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FX7iiJ2lTKd16d0Tte.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 4.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FX7iiJ2lTKd16d0Tte.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.477 sec (0 m 24 s)
Start Date: 2022:01:28 14:29:51
End Date:   2022:01:28 14:30:15

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:29:51Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:30:16Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['4.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
79.81049259875519
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F9CR8qE6Gz1fzut5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /usr/local/bin/capa, line 11, in <module>
    load_entry_point('flare-capa==3.1.0', 'console_scripts', 'capa')()
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/main.py, line 1035, in main
    print(capa.render.default.render(meta, rules, capabilities))
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/default.py, line 218, in render
    doc = capa.render.result_document.convert_capabilities_to_result_document(meta, rules, capabilities)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 319, in convert_capabilities_to_result_document
    rule_meta = convert_meta_to_result_document(rule.meta)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in convert_meta_to_result_document
    meta[att
sh: 18: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 223, in <listcomp>
    meta[att: not found
sh: 32: ck] = [parse_canonical_attack(attack) for attack in attacks]
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/result_document.py, line 236, in parse_canonical_attack
    parts, id = capa.render.utils.parse_parts_id(attack)
  File /usr/local/lib/python3.8/dist-packages/flare_capa-3.1.0-py3.8.egg/capa/render/utils.py, line 34, in parse_parts_id
    parts = s.split(::)
AttributeError: 'dict' object has no attribute 'split'

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0: not found

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F9CR8qE6Gz1fzut5.exe: Win.Trojan.Agent-899040 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.392 sec (0 m 24 s)
Start Date: 2022:01:28 14:30:16
End Date:   2022:01:28 14:30:40

-------- Score ----------------
Scores		Rules
.......		...............
70		Win.Trojan.Agent-899040
75		Win.Trojan.Agent-899040
45		Win.Trojan.Agent-899040

Score total: 190.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:30:16Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F9CR8qE6Gz1fzut5.exe SCORE: 149 TYPE: EXE SIZE: 22016 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f02b46f0670> 
MD5: c335a9d41185a32ad918c5389ee54235 
SHA1: c14680366c5148cde9043a29ef8f13392159bc28 
SHA256: 77003a5710a7c95df61ea015b6e4c204daee7f54cbf69e95f3fdbdda69e05403 CREATED: Fri Jan 28 14:30:16 2022 MODIFIED: Fri Jan 28 14:30:16 2022 ACCESSED: Fri Jan 28 14:30:41 2022 
REASON_1: Yara Rule MATCH: network_http SUBSCORE: 45 
DESCRIPTION: Communications over HTTP REF: - AUTHOR: x0r 
MATCHES: Str1: WININET.dll Str2: InternetConnect Str3: InternetOpen Str4: InternetReadFile Str5: InternetWriteFile Str6: HttpOpenRequest Str7: HttpS ... (truncated)
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA Str6: RegCreateKeyA
REASON_4: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_5: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: ReadFile Str4: DeleteFileA Str5: CopyFile
REASON_6: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_7: Yara Rule MATCH: Str_Win32_Wininet_Library SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WININET.dll
REASON_8: Yara Rule MATCH: Str_Win32_Internet_API SUBSCORE: 10 
DESCRIPTION: Match Windows Inet API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: InternetCloseHandle Str2: InternetReadFile Str3: InternetConnect Str4: InternetOpen
REASON_9: Yara Rule MATCH: Str_Win32_Http_API SUBSCORE: 10 
DESCRIPTION: Match Windows Http API call REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: HttpSendRequest Str2: HttpOpenRequest
REASON_10: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_13: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_14: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_15: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_16: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Software\Microsoft\Windows\CurrentVersion Str2: RegQueryValue
REASON_17: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64892500000000
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:30:41Z

-------- Score ----------------
Scores		Rules
.......		...............
45		network_http
5		win_mutex
20		win_registry
10		win_token
10		win_files_operation
10		Str_Win32_Winsock2_Library
10		Str_Win32_Wininet_Library
10		Str_Win32_Internet_API
10		Str_Win32_Http_API
1		ft_exe
1		math_entropy_5
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
5		SEH_Init
1		Contains_PE_File

Score total: 149

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Agent-899040', '70'), ('Win.Trojan.Agent-899040', '75'), ('Win.Trojan.Agent-899040', '45')]
-------------- LOKI_Rules ------------
[('network_http', '45'), ('win_mutex', '5'), ('win_registry', '20'), ('win_token', '10'), ('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('Str_Win32_Wininet_Library', '10'), ('Str_Win32_Internet_API', '10'), ('Str_Win32_Http_API', '10'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('SEH_Init', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['149']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['190.0']
-------------- SCORE FINAL ------------
4753.449139175977
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FlE7apTe3G9JqpQI5.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 18ec5becfa3991fb654e105bafbd5a4b                                                   |
| sha1                   | 1f3f79edbb6607b9640dd6a99856ee858af9cb55                                           |
| sha256                 | bf023ff344efe2db0e0a963869368f0ef352764666bc368ad61b7a4c1d9f5975                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FlE7apTe3G9JqpQI5.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Get File Attributes:: [C0049]                                                 |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| copy file                                            | host-interaction/file-system/copy                    |
| check if file exists                                 | host-interaction/file-system/exists                  |
| get file attributes                                  | host-interaction/file-system/meta                    |
| read file via mapping                                | host-interaction/file-system/read                    |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Discovery::File and Directory Discovery [T1083;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]

Score total: 9.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FlE7apTe3G9JqpQI5.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 24.517 sec (0 m 24 s)
Start Date: 2022:01:28 14:30:41
End Date:   2022:01:28 14:31:06

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:30:41Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:31:06Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['9.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
179.57360834719918
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FAqHOW1COLduJW9Pj9.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 1ef610b1f9646063f96ad880aad9569d                                                   |
| sha1                   | bb1ca3681747a48d82d2a95d573ee82adff2b0bd                                           |
| sha256                 | 563653399b82cd443f120eceff836ea3678d4cf11d9b351bb737573c2d856299                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FAqHOW1COLduJW9Pj9.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                          |
|                        | Service Stop:: \[T1489]\                                                           |
| PERSISTENCE            | Create or Modify System Process::Windows Service \[T1543.003]\                     |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Virtual Machine Detection:: [B0009]                                           |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| EXECUTION                   | Install Additional Program:: [B0023]                                          |
| FILE SYSTEM                 | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| reference anti-VM strings targeting VirtualBox       | anti-analysis/anti-vm/vm-detection                   |
| encode data using XOR (3 matches)                    | data-manipulation/encoding/xor                       |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| contain an embedded PE file                          | executable/subfile/pe                                |
| interact with driver via control codes               | host-interaction/driver                              |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| delete file                                          | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files via ntdll functions                  | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| check mutex and exit                                 | host-interaction/mutex                               |
| get system information on Windows                    | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| terminate process                                    | host-interaction/process/terminate                   |
| create or open registry key                          | host-interaction/registry                            |
| query service status                                 | host-interaction/service                             |
| create service                                       | host-interaction/service/create                      |
| delete service                                       | host-interaction/service/delete                      |
| start service                                        | host-interaction/service/start                       |
| stop service (2 matches)                             | host-interaction/service/stop                        |
| get ntdll base address (2 matches)                   | linking/runtime-linking                              |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| access PE header (2 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
9		- Impact::Service Stop [T1489;9]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
3		- Execution::System Services::Service Execution [T1569.002;3]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]

Score total: 51.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FAqHOW1COLduJW9Pj9.exe: Win.Trojan.ZeroCleare-7511225-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FAqHOW1COLduJW9Pj9.exe: Win.Trojan.ZeroCleare-7511333-0 FOUND
/var/log/Out_Zeek/extract_files/HTTP-FAqHOW1COLduJW9Pj9.exe: Win.Trojan.ZeroCleare-7580180-2 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.14 MB
Data read: 0.14 MB (ratio 1.06:1)
Time: 24.534 sec (0 m 24 s)
Start Date: 2022:01:28 14:31:06
End Date:   2022:01:28 14:31:31

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.ZeroCleare-7511225-0
45		Win.Trojan.ZeroCleare-7511333-0
45		Win.Trojan.ZeroCleare-7580180-2

Score total: 135.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 0: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x87 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x87 in position 4: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x81 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:31:07Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FAqHOW1COLduJW9Pj9.exe SCORE: 374 TYPE: EXE SIZE: 146944 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f7aca9e1670> 
MD5: 1ef610b1f9646063f96ad880aad9569d 
SHA1: bb1ca3681747a48d82d2a95d573ee82adff2b0bd 
SHA256: 563653399b82cd443f120eceff836ea3678d4cf11d9b351bb737573c2d856299 CREATED: Fri Jan 28 14:31:06 2022 MODIFIED: Fri Jan 28 14:31:06 2022 ACCESSED: Fri Jan 28 14:31:31 2022 
REASON_1: Yara Rule MATCH: create_service SUBSCORE: 20 
DESCRIPTION: Create a windows service REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: CreateService Str3: ControlService Str4: StartService Str5: QueryServiceStatus
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: Intezer_Iranian_Wipers SUBSCORE: 90 
DESCRIPTION: Shamoon, ZeroCleare and Dustman REF: https://analyze.intezer.com AUTHOR: Intezer Labs
REASON_6: Yara Rule MATCH: SUSP_XORed_URL_in_EXE SUBSCORE: 50 
DESCRIPTION: Detects an XORed URL in an executable REF: https://twitter.com/stvemillertime/status/1237035794973560834 AUTHOR: Florian Roth 
MATCHES: Str1: c2dededa908585
REASON_7: Yara Rule MATCH: ConventionEngine_Term_Desktop SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445387df26eb529a5949bb381fa6a09edbd90c000000433a5c55736572735c53445c4465736b746f705c54444c5c536f757263655c4675727574616b615c6f757 ... (truncated)
REASON_8: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 5253445387df26eb529a5949bb381fa6a09edbd90c000000433a5c55736572735c53445c4465736b746f705c54444c5c536f757263655c4675727574616b615c6f757 ... (truncated)
REASON_9: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_11: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_12: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_13: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_14: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_15: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: VBox Str2: VirtualBox
REASON_16: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent
REASON_17: Yara Rule MATCH: MAL_ME_RawDisk_Agent_Jan20_2 SUBSCORE: 60 
DESCRIPTION: Detects suspicious malware using ElRawDisk REF: https://twitter.com/jfslowik/status/1212501454549741568?s=09 AUTHOR: Florian Roth 
MATCHES: Str1: The Magic Word! Str2: Software\Oracle\VirtualBox Str3: \.\%s Str4: 4981c6ffffff7f4c89b42498
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:31:31Z

-------- Score ----------------
Scores		Rules
.......		...............
20		create_service
5		win_mutex
20		win_registry
1		ft_exe
90		Intezer_Iranian_Wipers
50		SUSP_XORed_URL_in_EXE
50		ConventionEngine_Term_Desktop
50		ConventionEngine_Term_Users
1		math_entropy_6
1		IsPE64
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
10		VBox_Detection
10		anti_dbg
60		MAL_ME_RawDisk_Agent_Jan20_2
1		Contains_PE_File

Score total: 374

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Impact::Service Stop [T1489;9]', '9'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.ZeroCleare-7511225-0', '45'), ('Win.Trojan.ZeroCleare-7511333-0', '45'), ('Win.Trojan.ZeroCleare-7580180-2', '45')]
-------------- LOKI_Rules ------------
[('create_service', '20'), ('win_mutex', '5'), ('win_registry', '20'), ('ft_exe', '1'), ('Intezer_Iranian_Wipers', '90'), ('SUSP_XORed_URL_in_EXE', '50'), ('ConventionEngine_Term_Desktop', '50'), ('ConventionEngine_Term_Users', '50'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('VBox_Detection', '10'), ('anti_dbg', '10'), ('MAL_ME_RawDisk_Agent_Jan20_2', '60'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['374']
-------------- CAPA_Score ------------
['51.5']
-------------- CLAMAV_Score ------------
['135.0']
-------------- SCORE FINAL ------------
8654.609937935664
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FkAQDr4bhtjQXvFG0d.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e5369ac309f1be6d77afeeb3edab0ed8                                                   |
| sha1                   | b7afd3c57b074109bf576b77b33d641fd8e87871                                           |
| sha256                 | 478383fb588665c254d416b7c50a124f82291124b002d9bad9fd758a59fd728f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FkAQDr4bhtjQXvFG0d.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Clipboard Data:: \[T1115]\                                                          |
| DEFENSE EVASION        | File and Directory Permissions Modification:: \[T1222]\                             |
|                        | Hide Artifacts::Hidden Window \[T1564.003]\                                         |
|                        | Indicator Removal on Host:: \[T1070]\                                               |
|                        | Indicator Removal on Host::Clear Windows Event Logs \[T1070.001]\                   |
|                        | Indicator Removal on Host::File Deletion \[T1070.004]\                              |
|                        | Indicator Removal on Host::Timestomp \[T1070.006]\                                  |
|                        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information:: \[T1027]\                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
|                        | Subvert Trust Controls::Mark-of-the-Web Bypass \[T1553.005]\                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                         |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Network Share Discovery:: \[T1135]\                                                 |
|                        | Process Discovery:: \[T1057]\                                                       |
|                        | Software Discovery:: \[T1518]\                                                      |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Owner/User Discovery:: \[T1033]\                                             |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
|                        | Inhibit System Recovery:: \[T1490]\                                                 |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
|                             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
|                             | File and Directory Discovery::Log File [E1083.m01]                            |
| FILE SYSTEM                 | Copy File:: [C0045]                                                           |
|                             | Delete File:: [C0047]                                                         |
|                             | Get File Attributes:: [C0049]                                                 |
|                             | Read File:: [C0051]                                                           |
|                             | Set File Attributes:: [C0050]                                                 |
|                             | Writes File:: [C0052]                                                         |
| IMPACT                      | Clipboard Modification:: [E1510]                                              |
|                             | Disk Content Wipe::Delete Shadow Drive [F0014.001]                            |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Check Mutex:: [C0043]                                                         |
|                             | Create Mutex:: [C0042]                                                        |
|                             | Create Process:: [C0017]                                                      |
|                             | Create Process::Create Suspended Process [C0017.003]                          |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| execute anti-debugging instructions                  | anti-analysis/anti-debugging/debugger-detection      |
| impersonate file version information                 | anti-analysis/anti-forensic                          |
| clear the Windows event log (2 matches)              | anti-analysis/anti-forensic/clear-logs               |
| timestomp file (3 matches)                           | anti-analysis/anti-forensic/timestomp                |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| create new key via CryptAcquireContext               | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt                      | data-manipulation/encryption                         |
| encrypt data using AES via WinAPI                    | data-manipulation/encryption/aes                     |
| hash data via WinCrypt                               | data-manipulation/hashing                            |
| initialize hashing via WinCrypt                      | data-manipulation/hashing                            |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions              | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| replace clipboard data                               | host-interaction/clipboard                           |
| query environment variable (6 matches)               | host-interaction/environment-variable                |
| bypass Mark of the Web                               | host-interaction/file-system                         |
| copy file                                            | host-interaction/file-system/copy                    |
| delete file (4 matches)                              | host-interaction/file-system/delete                  |
| check if file exists                                 | host-interaction/file-system/exists                  |
| enumerate files recursively (2 matches)              | host-interaction/file-system/files/list              |
| get file attributes                                  | host-interaction/file-system/meta                    |
| get file size (2 matches)                            | host-interaction/file-system/meta                    |
| set file attributes (3 matches)                      | host-interaction/file-system/meta                    |
| move file (2 matches)                                | host-interaction/file-system/move                    |
| read file on Windows                                 | host-interaction/file-system/read                    |
| write file on Windows (3 matches)                    | host-interaction/file-system/write                   |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| hide graphical window (2 matches)                    | host-interaction/gui/window/hide                     |
| get number of processors                             | host-interaction/hardware/cpu                        |
| get disk information (2 matches)                     | host-interaction/hardware/storage                    |
| access the Windows event log (2 matches)             | host-interaction/log/winevt/access                   |
| check mutex and exit                                 | host-interaction/mutex                               |
| enumerate network shares                             | host-interaction/network                             |
| create process on Windows (3 matches)                | host-interaction/process/create                      |
| create process suspended (3 matches)                 | host-interaction/process/create                      |
| enumerate processes                                  | host-interaction/process/list                        |
| terminate process (3 matches)                        | host-interaction/process/terminate                   |
| delete registry value                                | host-interaction/registry/delete                     |
| get session information                              | host-interaction/session                             |
| create thread (3 matches)                            | host-interaction/thread/create                       |
| terminate thread                                     | host-interaction/thread/terminate                    |
| delete volume shadow copies                          | impact/inhibit-system-recovery                       |
| link function at runtime on Windows                  | linking/runtime-linking                              |
| persist via Run registry key (2 matches)             | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
3		- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]
8.5		- Defense Evasion::Indicator Removal on Host [T1070;8.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
8.5		- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]
8.5		- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]
8		- Impact::Inhibit System Recovery [T1490;8]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::File and Directory Permissions Modification [T1222;4]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
4		- Collection::Clipboard Data [T1115;4]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Discovery::Software Discovery [T1518;2]
8.5		- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]
5		- Defense Evasion::Subvert Trust Controls::Mark-of-the-Web Bypass [T1553.005;5]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
1		- Discovery::System Information Discovery [T1082;1]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]

Score total: 102.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FkAQDr4bhtjQXvFG0d.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.303 sec (0 m 24 s)
Start Date: 2022:01:28 14:31:32
End Date:   2022:01:28 14:31:56

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x83 in position 0: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8d in position 2: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:31:32Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FkAQDr4bhtjQXvFG0d.exe SCORE: 304 TYPE: EXE SIZE: 18432 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7fe10907e670> 
MD5: e5369ac309f1be6d77afeeb3edab0ed8 
SHA1: b7afd3c57b074109bf576b77b33d641fd8e87871 
SHA256: 478383fb588665c254d416b7c50a124f82291124b002d9bad9fd758a59fd728f CREATED: Fri Jan 28 14:31:32 2022 MODIFIED: Fri Jan 28 14:31:32 2022 ACCESSED: Fri Jan 28 14:31:57 2022 
REASON_1: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_4: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: FindClose Str6: CopyFile
REASON_5: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_6: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_10: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_12: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_13: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Identifier
REASON_14: Yara Rule MATCH: Win32_Ransomware_Kangaroo SUBSCORE: 60 
DESCRIPTION: Yara rule that detects Kangaroo ransomware. REF: - AUTHOR: ReversingLabs 
MATCHES: Str1: 83ec3053558b6c243c565733ff57576a03576a0768000000c033db55895c2440897c2434897c2430ff15003140008bf083feff0f84f60100008d442428508d4c24345 ... (truncated)
REASON_15: Yara Rule MATCH: Destructive_Ransomware_Gen1 SUBSCORE: 60 
DESCRIPTION: Detects destructive malware REF: http://blog.talosintelligence.com/2018/02/olympic-destroyer.html AUTHOR: Florian Roth 
MATCHES: Str1: delete shadows /all /quiet
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:31:57Z

-------- Score ----------------
Scores		Rules
.......		...............
65		screenshot
5		win_mutex
20		win_registry
10		win_files_operation
1		ft_exe
1		math_entropy_5
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
60		Win32_Ransomware_Kangaroo
60		Destructive_Ransomware_Gen1
1		Contains_PE_File
20		Advapi_Hash_API

Score total: 304

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Defense Evasion::Hide Artifacts::Hidden Window [T1564.003;3]', '3'), ('- Defense Evasion::Indicator Removal on Host [T1070;8.5]', '8.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Defense Evasion::Indicator Removal on Host::Clear Windows Event Logs [T1070.001;8.5]', '8.5'), ('- Defense Evasion::Indicator Removal on Host::Timestomp [T1070.006;8.5]', '8.5'), ('- Impact::Inhibit System Recovery [T1490;8]', '8'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::File and Directory Permissions Modification [T1222;4]', '4'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Collection::Clipboard Data [T1115;4]', '4'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Discovery::Software Discovery [T1518;2]', '2'), ('- Defense Evasion::Indicator Removal on Host::File Deletion [T1070.004;8.5]', '8.5'), ('- Defense Evasion::Subvert Trust Controls::Mark-of-the-Web Bypass [T1553.005;5]', '5'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('screenshot', '65'), ('win_mutex', '5'), ('win_registry', '20'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_5', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Win32_Ransomware_Kangaroo', '60'), ('Destructive_Ransomware_Gen1', '60'), ('Contains_PE_File', '1'), ('Advapi_Hash_API', '20')]
-------------- LOKI_Score ------------
['304']
-------------- CAPA_Score ------------
['102.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
6853.242866350042
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FlzfJ53LgAg4FERfr2.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FlzfJ53LgAg4FERfr2.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.48 MB
Data read: 0.46 MB (ratio 1.05:1)
Time: 26.686 sec (0 m 26 s)
Start Date: 2022:01:28 14:31:57
End Date:   2022:01:28 14:32:24

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc2 in position 4: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:31:57Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FlzfJ53LgAg4FERfr2.exe SCORE: 1488 TYPE: EXE SIZE: 485888 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7ff1f2924670> 
MD5: 321338196a46b600ea330fc5d98d0699 
SHA1: 4383ae835ced10ee49f88fe5a965d70679d4a8bc 
SHA256: 66e51558f8bf9a329f2e9a2feb4592a4a30fd9124e171a8e2f17ba00fb902b0f CREATED: Fri Jan 28 14:31:57 2022 MODIFIED: Fri Jan 28 14:31:57 2022 ACCESSED: Fri Jan 28 14:32:23 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: FindClose
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_7: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_8: Yara Rule MATCH: stager_reverse_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_9: Yara Rule MATCH: stager_bind_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_10: Yara Rule MATCH: win32_stage_boot_winsock_conn_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_11: Yara Rule MATCH: win32_stage_boot_bind_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_12: Yara Rule MATCH: win32_stage_boot_reverse_read_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_13: Yara Rule MATCH: win32_stage_boot_winsock_conn_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_14: Yara Rule MATCH: stager_reverse_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_15: Yara Rule MATCH: win32_stage_boot_bind_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_16: Yara Rule MATCH: win32_stage_boot_reverse_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_17: Yara Rule MATCH: win32_stage_boot_reverse_shell_revert_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_18: Yara Rule MATCH: win32_stage_winexec_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_19: Yara Rule MATCH: stager_bind_ipv6_tcp_nx_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_20: Yara Rule MATCH: win32_stage_boot_winsock_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_21: Yara Rule MATCH: win32_stage_boot_reverse_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_22: Yara Rule MATCH: win32_stage_api_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_23: Yara Rule MATCH: win32_stage_boot_bind_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_24: Yara Rule MATCH: win32_stage_boot_reverse_udp_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_25: Yara Rule MATCH: win32_stage_boot_reverse_inlineegg_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_26: Yara Rule MATCH: win32_stage_boot_bind_shell_ldone_x86 SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: 5f5e5d5bc20800
REASON_27: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_28: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_29: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_30: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: dbghelp.dll
REASON_31: Yara Rule MATCH: antisb_threatExpert SUBSCORE: 60 
DESCRIPTION: Anti-Sandbox checks for ThreatExpert REF: - AUTHOR: x0r 
MATCHES: Str1: dbghelp.dll
REASON_32: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_33: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_34: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: IsDebuggerPresent
REASON_35: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:32:24Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
1		ft_exe
1		math_entropy_6
1		IsPE32
1		IsConsole
1		HasDebugData
2		PE_File
70		stager_reverse_tcp_nx_ldone_x86
70		stager_bind_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_conn_ldone_x86
70		win32_stage_boot_bind_read_ldone_x86
70		win32_stage_boot_reverse_read_ldone_x86
70		win32_stage_boot_winsock_conn_udp_ldone_x86
70		stager_reverse_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_bind_inlineegg_ldone_x86
70		win32_stage_boot_reverse_ldone_x86
70		win32_stage_boot_reverse_shell_revert_ldone_x86
70		win32_stage_winexec_ldone_x86
70		stager_bind_ipv6_tcp_nx_ldone_x86
70		win32_stage_boot_winsock_bind_ldone_x86
70		win32_stage_boot_reverse_shell_ldone_x86
70		win32_stage_api_ldone_x86
70		win32_stage_boot_bind_ldone_x86
70		win32_stage_boot_reverse_udp_ldone_x86
70		win32_stage_boot_reverse_inlineegg_ldone_x86
70		win32_stage_boot_bind_shell_ldone_x86
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
60		antisb_threatExpert
5		SEH_Save
5		SEH_Init
10		anti_dbg
1		Contains_PE_File

Score total: 1488

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 321338196a46b600ea330fc5d98d0699                                                   |
| sha1                   | 4383ae835ced10ee49f88fe5a965d70679d4a8bc                                           |
| sha256                 | 66e51558f8bf9a329f2e9a2feb4592a4a30fd9124e171a8e2f17ba00fb902b0f                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FlzfJ53LgAg4FERfr2.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection::Timing/Delay Check QueryPerformanceCounter [B0001.033]    |
| CRYPTOGRAPHY                | Encrypt Data::RC4 [C0027.009]                                                 |
|                             | Generate Pseudo-random Sequence::RC4 PRGA [C0021.004]                         |
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
|                             | Non-Cryptographic Hash::MurmurHash [C0030.001]                                |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| PROCESS                     | Resume Thread:: [C0054]                                                       |
|                             | Suspend Thread:: [C0055]                                                      |
|                             | Terminate Thread:: [C0039]                                                    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| check for time delay via QueryPerformanceCounter     | anti-analysis/anti-debugging/debugger-detection      |
| compiled with dmd                                    | compiler/d                                           |
| encode data using XOR (3 matches)                    | data-manipulation/encoding/xor                       |
| encrypt data using RC4 PRGA (2 matches)              | data-manipulation/encryption/rc4                     |
| hash data using murmur3 (3 matches)                  | data-manipulation/hashing/murmur                     |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| query environment variable                           | host-interaction/environment-variable                |
| write file on Windows (3 matches)                    | host-interaction/file-system/write                   |
| get memory capacity (2 matches)                      | host-interaction/hardware/memory                     |
| get system information on Windows (2 matches)        | host-interaction/os/info                             |
| check OS version                                     | host-interaction/os/version                          |
| resume thread (3 matches)                            | host-interaction/thread/resume                       |
| suspend thread                                       | host-interaction/thread/suspend                      |
| terminate thread                                     | host-interaction/thread/terminate                    |
| access PEB ldr_data (3 matches)                      | linking/runtime-linking                              |
| link many functions at runtime                       | linking/runtime-linking                              |
| parse PE exports (9 matches)                         | load-code/pe                                         |
| parse PE header (32 matches)                         | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 21.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('PE_File', '2'), ('stager_reverse_tcp_nx_ldone_x86', '70'), ('stager_bind_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_ldone_x86', '70'), ('win32_stage_boot_bind_read_ldone_x86', '70'), ('win32_stage_boot_reverse_read_ldone_x86', '70'), ('win32_stage_boot_winsock_conn_udp_ldone_x86', '70'), ('stager_reverse_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_bind_inlineegg_ldone_x86', '70'), ('win32_stage_boot_reverse_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_revert_ldone_x86', '70'), ('win32_stage_winexec_ldone_x86', '70'), ('stager_bind_ipv6_tcp_nx_ldone_x86', '70'), ('win32_stage_boot_winsock_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_shell_ldone_x86', '70'), ('win32_stage_api_ldone_x86', '70'), ('win32_stage_boot_bind_ldone_x86', '70'), ('win32_stage_boot_reverse_udp_ldone_x86', '70'), ('win32_stage_boot_reverse_inlineegg_ldone_x86', '70'), ('win32_stage_boot_bind_shell_ldone_x86', '70'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('antisb_threatExpert', '60'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['1488']
-------------- CAPA_Score ------------
['21.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
24012.192101539673
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F3dsdF13AYX1J1bOjh.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 39009536cafe30c6ef2501fe46c9df5e                                                   |
| sha1                   | 6ff7b4d30f31186de899665c704a105227704b72                                           |
| sha256                 | 93d2604f7fdf7f014ac5bef63ab177b6107f3cfc26da6cbd9a7ab50c96564a04                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F3dsdF13AYX1J1bOjh.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+-------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                    |
|------------------------+-------------------------------------------------------------------------------------|
| COLLECTION             | Input Capture::Keylogging \[T1056.001]\                                             |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                         |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                     |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                            |
|                        | File and Directory Discovery:: \[T1083]\                                            |
|                        | Query Registry:: \[T1012]\                                                          |
|                        | System Information Discovery:: \[T1082]\                                            |
|                        | System Service Discovery:: \[T1007]\                                                |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                       |
|                        | Shared Modules:: \[T1129]\                                                          |
|                        | System Services::Service Execution \[T1569.002]\                                    |
| IMPACT                 | Data Manipulation::Stored Data Manipulation \[T5665.001]\                           |
| PERSISTENCE            | Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder \[T1547.001]\ |
|                        | Create or Modify System Process::Windows Service \[T1543.003]\                      |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                               |
+------------------------+-------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COLLECTION                  | Keylogging::Polling [F0002.002]                                               |
| DISCOVERY                   | Application Window Discovery::Window Text [E1010.m01]                         |
| FILE SYSTEM                 | Create Directory:: [C0046]                                                    |
|                             | Delete File:: [C0047]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Delete Registry Value [C0036.007]                                   |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Key [C0036.005]                                      |
|                             | Registry::Query Registry Value [C0036.006]                                    |
|                             | Registry::Set Registry Key [C0036.001]                                        |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| log keystrokes via polling                           | collection/keylog                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| extract resource via kernel32 functions (5 matches)  | executable/resource                                  |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable (5 matches)               | host-interaction/environment-variable                |
| create directory                                     | host-interaction/file-system/create                  |
| delete file (3 matches)                              | host-interaction/file-system/delete                  |
| get file version info                                | host-interaction/file-system/meta                    |
| find graphical window                                | host-interaction/gui/window/find                     |
| get graphical window text                            | host-interaction/gui/window/get-text                 |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| get disk information                                 | host-interaction/hardware/storage                    |
| get system information on Windows                    | host-interaction/os/info                             |
| create process on Windows                            | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| modify access privileges                             | host-interaction/process/modify                      |
| query or enumerate registry key                      | host-interaction/registry                            |
| query or enumerate registry value (4 matches)        | host-interaction/registry                            |
| set registry value (4 matches)                       | host-interaction/registry/create                     |
| delete registry value                                | host-interaction/registry/delete                     |
| enumerate services                                   | host-interaction/service/list                        |
| modify service                                       | host-interaction/service/modify                      |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
| persist via Run registry key                         | persistence/registry/run                             |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
4		- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]
1		- Discovery::File and Directory Discovery [T1083;1]
2		- Discovery::Application Window Discovery [T1010;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Execution::Shared Modules [T1129;2]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
8		- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]
1		- Discovery::Query Registry [T1012;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]
3		- Execution::System Services::Service Execution [T1569.002;3]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]

Score total: 45.5

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F3dsdF13AYX1J1bOjh.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.20 MB
Data read: 0.19 MB (ratio 1.04:1)
Time: 25.097 sec (0 m 25 s)
Start Date: 2022:01:28 14:33:07
End Date:   2022:01:28 14:33:32

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:33:07Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F3dsdF13AYX1J1bOjh.exe SCORE: 260 TYPE: EXE SIZE: 197632 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f57034fa670> 
MD5: 39009536cafe30c6ef2501fe46c9df5e 
SHA1: 6ff7b4d30f31186de899665c704a105227704b72 
SHA256: 93d2604f7fdf7f014ac5bef63ab177b6107f3cfc26da6cbd9a7ab50c96564a04 CREATED: Fri Jan 28 14:33:07 2022 MODIFIED: Fri Jan 28 14:33:07 2022 ACCESSED: Fri Jan 28 14:33:33 2022 
REASON_1: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_2: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: GDI32.dll Str2: USER32.dll Str3: GetDC
REASON_3: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetKeyState
REASON_4: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegCloseKey
REASON_5: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken
REASON_6: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_7: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_14: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:33:33Z

-------- Score ----------------
Scores		Rules
.......		...............
70		escalate_priv
65		screenshot
80		keylogger
20		win_registry
10		win_token
1		ft_exe
1		math_entropy_6
1		IsPE64
2		IsWindowsGUI
1		HasDebugData
1		HasRichSignature
2		PE_File
5		Anti_Automated_Sandbox
1		Contains_PE_File

Score total: 260

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001;4]', '4'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Impact::Data Manipulation::Stored Data Manipulation [T5665.001;8]', '8'), ('- Discovery::Query Registry [T1012;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Persistence::Create or Modify System Process::Windows Service [T1543.003;4]', '4'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('escalate_priv', '70'), ('screenshot', '65'), ('keylogger', '80'), ('win_registry', '20'), ('win_token', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsWindowsGUI', '2'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Anti_Automated_Sandbox', '5'), ('Contains_PE_File', '1')]
-------------- LOKI_Score ------------
['260']
-------------- CAPA_Score ------------
['45.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
5028.566653709735
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-F1MP3l3ndglPErpxpl.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-F1MP3l3ndglPErpxpl.exe: Win.Exploit.CVE_2019_1219-7151042-2 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.52 MB
Data read: 0.50 MB (ratio 1.06:1)
Time: 25.605 sec (0 m 25 s)
Start Date: 2022:01:28 14:33:33
End Date:   2022:01:28 14:33:59

-------- Score ----------------
Scores		Rules
.......		...............
25		Win.Exploit.CVE_2019_1219-7151042-2

Score total: 25.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 3cb21ae76ff3da4b7e02d77ff76e82be                                                   |
| sha1                   | 7156270661549f75c253f169fe8988690f6fc700                                           |
| sha256                 | c2c49f2592f78b7a70fd984dbbb25f7251dd1c851caa884f39ff1c8075f0b228                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-F1MP3l3ndglPErpxpl.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COLLECTION             | Data from Information Repositories:: \[T1213]\                                     |
|                        | Input Capture::Keylogging \[T1056.001]\                                            |
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Modify Registry:: \[T1112]\                                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Asynchronous Procedure Call \[T1055.004]\                       |
|                        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
|                        | Process Injection::Thread Execution Hijacking \[T1055.003]\                        |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
|                        | Virtualization/Sandbox Evasion::Time Based Evasion \[T1497.003]\                   |
|                        | Virtualization/Sandbox Evasion::User Activity Based Checks \[T1497.002]\           |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | Process Discovery:: \[T1057]\                                                      |
|                        | Query Registry:: \[T1012]\                                                         |
|                        | Software Discovery:: \[T1518]\                                                     |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Service Discovery:: \[T1007]\                                               |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
|                        | System Services::Service Execution \[T1569.002]\                                   |
|                        | Windows Management Instrumentation:: \[T1047]\                                     |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Debugger Detection:: [B0001]                                                  |
|                             | Debugger Detection::Anti-debugging Instructions [B0001.034]                   |
|                             | Debugger Detection::CheckRemoteDebuggerPresent [B0001.002]                    |
|                             | Debugger Detection::Memory Write Watching [B0001.010]                         |
|                             | Debugger Detection::OutputDebugString [B0001.016]                             |
|                             | Debugger Detection::Process Environment Block BeingDebugged [B0001.035]       |
|                             | Debugger Detection::Process Environment Block NtGlobalFlag [B0001.036]        |
|                             | Debugger Detection::SetHandleInformation [B0001.024]                          |
|                             | Debugger Detection::Software Breakpoints [B0001.025]                          |
|                             | Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]               |
|                             | Debugger Detection::WudfIsAnyDebuggerPresent [B0001.031]                      |
|                             | Emulator Detection:: [B0004]                                                  |
|                             | Virtual Machine Detection:: [B0009]                                           |
|                             | Virtual Machine Detection::Human User Check [B0009.012]                       |
| COLLECTION                  | Keylogging::Application Hook [F0002.001]                                      |
| COMMUNICATION               | ICMP Communication::Echo Request [C0014.002]                                  |
| DISCOVERY                   | Analysis Tool Discovery::Process Detection [B0013.001]                        |
| FILE SYSTEM                 | Get File Attributes:: [C0049]                                                 |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| OPERATING SYSTEM            | Registry::Create Registry Key [C0036.004]                                     |
|                             | Registry::Open Registry Key [C0036.003]                                       |
|                             | Registry::Query Registry Value [C0036.006]                                    |
| PROCESS                     | Create Mutex:: [C0042]                                                        |
|                             | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference analysis tools strings                     | anti-analysis                                        |
| check for OutputDebugString error                    | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB BeingDebugged flag                     | anti-analysis/anti-debugging/debugger-detection      |
| check for PEB NtGlobalFlag flag                      | anti-analysis/anti-debugging/debugger-detection      |
| check for debugger via API                           | anti-analysis/anti-debugging/debugger-detection      |
| check for protected handle exception                 | anti-analysis/anti-debugging/debugger-detection      |
| check for software breakpoints                       | anti-analysis/anti-debugging/debugger-detection      |
| check for time delay via GetTickCount                | anti-analysis/anti-debugging/debugger-detection      |
| check for trap flag exception                        | anti-analysis/anti-debugging/debugger-detection      |
| check for unexpected memory writes (3 matches)       | anti-analysis/anti-debugging/debugger-detection      |
| check process job object                             | anti-analysis/anti-debugging/debugger-detection      |
| execute anti-debugging instructions (2 matches)      | anti-analysis/anti-debugging/debugger-detection      |
| check if process is running under wine (2 matches)   | anti-analysis/anti-emulation/wine                    |
| check for unmoving mouse cursor                      | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Parallels        | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Qemu             | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VMWare           | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VirtualBox       | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting VirtualPC        | anti-analysis/anti-vm/vm-detection                   |
| reference anti-VM strings targeting Xen              | anti-analysis/anti-vm/vm-detection                   |
| reference WMI statements (30 matches)                | collection/database/wmi                              |
| log keystrokes via application hook                  | collection/keylog                                    |
| get MAC address on Windows                           | collection/network                                   |
| send ICMP echo request                               | communication/icmp                                   |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| interact with driver via control codes               | host-interaction/driver                              |
| query environment variable (4 matches)               | host-interaction/environment-variable                |
| get Program Files directory (2 matches)              | host-interaction/file-system                         |
| get common file path (5 matches)                     | host-interaction/file-system                         |
| read raw disk data                                   | host-interaction/file-system                         |
| check if file exists (2 matches)                     | host-interaction/file-system/exists                  |
| get file attributes (2 matches)                      | host-interaction/file-system/meta                    |
| set console window title                             | host-interaction/gui/console                         |
| find graphical window                                | host-interaction/gui/window/find                     |
| get number of processor cores                        | host-interaction/hardware/cpu                        |
| get number of processors                             | host-interaction/hardware/cpu                        |
| get memory capacity                                  | host-interaction/hardware/memory                     |
| enumerate disk properties                            | host-interaction/hardware/storage                    |
| get disk information (2 matches)                     | host-interaction/hardware/storage                    |
| get disk size (2 matches)                            | host-interaction/hardware/storage                    |
| print debug messages (6 matches)                     | host-interaction/log/debug/write-event               |
| create mutex                                         | host-interaction/mutex                               |
| get system information on Windows (4 matches)        | host-interaction/os/info                             |
| get process heap flags (2 matches)                   | host-interaction/process                             |
| get process heap force flags (2 matches)             | host-interaction/process                             |
| read process memory (2 matches)                      | host-interaction/process                             |
| allocate RWX memory (2 matches)                      | host-interaction/process/inject                      |
| inject APC                                           | host-interaction/process/inject                      |
| inject dll                                           | host-interaction/process/inject                      |
| inject thread                                        | host-interaction/process/inject                      |
| enumerate processes                                  | host-interaction/process/list                        |
| get Explorer PID                                     | host-interaction/process/list                        |
| acquire debug privileges                             | host-interaction/process/modify                      |
| modify access privileges                             | host-interaction/process/modify                      |
| enumerate process modules (2 matches)                | host-interaction/process/modules/list                |
| terminate process                                    | host-interaction/process/terminate                   |
| terminate process via fastfail (3 matches)           | host-interaction/process/terminate                   |
| query or enumerate registry value                    | host-interaction/registry                            |
| enumerate services                                   | host-interaction/service/list                        |
| enumerate threads (2 matches)                        | host-interaction/thread/list                         |
| connect to WMI namespace via WbemLocator             | host-interaction/wmi                                 |
| get kernel32 base address                            | linking/runtime-linking                              |
| link function at runtime on Windows (7 matches)      | linking/runtime-linking                              |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Discovery::Process Discovery [T1057;2]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
4		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;4]
2		- Execution::Shared Modules [T1129;2]
5		- Collection::Data from Information Repositories [T1213;5]
8.5		- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
6		- Collection::Input Capture::Keylogging [T1056.001;6]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
4		- Defense Evasion::Process Injection::Asynchronous Procedure Call [T1055.004;4]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
3		- Execution::System Services::Service Execution [T1569.002;3]
2.5		- Defense Evasion::Modify Registry [T1112;2.5]
1		- Discovery::File and Directory Discovery [T1083;1]
4.5		- Execution::Windows Management Instrumentation [T1047;4.5]
4		- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Discovery::Software Discovery [T1518;2]
1		- Discovery::System Information Discovery [T1082;1]
7.5		- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]
1		- Discovery::Query Registry [T1012;1]

Score total: 78.5

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x84 in position 7: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc6 in position 0: invalid continuation byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:33:33Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-F1MP3l3ndglPErpxpl.exe SCORE: 2369 TYPE: EXE SIZE: 520704 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f22b21e7670> 
MD5: 3cb21ae76ff3da4b7e02d77ff76e82be 
SHA1: 7156270661549f75c253f169fe8988690f6fc700 
SHA256: c2c49f2592f78b7a70fd984dbbb25f7251dd1c851caa884f39ff1c8075f0b228 CREATED: Fri Jan 28 14:33:33 2022 MODIFIED: Fri Jan 28 14:33:33 2022 ACCESSED: Fri Jan 28 14:33:59 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: NtWriteVirtualMemory Str4: WriteProcessMemory Str5: CreateRemoteThread Str6: CreateThread
REASON_2: Yara Rule MATCH: escalate_priv SUBSCORE: 70 
DESCRIPTION: Escalade priviledges REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges
REASON_3: Yara Rule MATCH: screenshot SUBSCORE: 65 
DESCRIPTION: Take screenshot REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetDC
REASON_4: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: GetAsyncKeyState Str3: GetKeyState Str4: MapVirtualKey Str5: GetKeyboardType
REASON_5: Yara Rule MATCH: migrate_apc SUBSCORE: 45 
DESCRIPTION: APC queue tasks migration REF: - AUTHOR: x0r 
MATCHES: Str1: OpenThread Str2: QueueUserAPC
REASON_6: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_7: Yara Rule MATCH: win_registry SUBSCORE: 20 
DESCRIPTION: Affect system registries REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: RegQueryValueExA Str3: RegOpenKeyExA Str4: RegCloseKey Str5: RegSetValueExA
REASON_8: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: AdjustTokenPrivileges Str3: OpenProcessToken
REASON_9: Yara Rule MATCH: win_private_profile SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: GetPrivateProfileIntA Str4: GetPrivateProfileStringA Str5: WritePrivateProfileStringA
REASON_10: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: WriteFile Str4: SetFilePointer Str5: ReadFile Str6: DeleteFileA Str7: CreateFileA Str8: FindFir ... (truncated)
REASON_11: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: ConventionEngine_Term_Desktop SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453da876d845c1fc549894fa23eb2fb0e2301000000433a5c55736572735c737072696e675c4465736b746f705c616c2d6b68617365722d6d61737465725c783 ... (truncated)
REASON_13: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453da876d845c1fc549894fa23eb2fb0e2301000000433a5c55736572735c737072696e675c4465736b746f705c616c2d6b68617365722d6d61737465725c783 ... (truncated)
REASON_14: Yara Rule MATCH: math_entropy_5 SUBSCORE: 1 
DESCRIPTION: Medium entropy - like binary data REF: - AUTHOR: -
REASON_15: Yara Rule MATCH: obfuscation_singlebyte_mov SUBSCORE: 5 
DESCRIPTION: Detects strings obfuscated by single-byte mov ex: mov [ebp+String+1], A REF: - AUTHOR: Andreas Schuster 
MATCHES: Str1: c6450400c6450500c6450600c645
REASON_16: Yara Rule MATCH: self_inject SUBSCORE: 15 
DESCRIPTION: Self Injecting code - like code packers REF: - AUTHOR: - 
MATCHES: Str1: VirtualAlloc Str2: VirtualProtect Str3: CreateProcessInternal
REASON_17: Yara Rule MATCH: dll_injection_thread SUBSCORE: 15 
DESCRIPTION: Injection using kernel32.dll:VirtualAllocEx REF: - AUTHOR: - 
MATCHES: Str1: LoadLibraryA Str2: NtCreateThreadEx
REASON_18: Yara Rule MATCH: dll_injection_hook SUBSCORE: 15 
DESCRIPTION: Injection using User32.dll:VirtualAllocEx REF: - AUTHOR: -
REASON_19: Yara Rule MATCH: possible_includes_base64_packed_functions SUBSCORE: 25 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: atOb Str2: This Str3: prog Str4: rogr Str5: ogra Str6: gram Str7: cann Str8: anno Str9: nnot Str10: mode Str11: Rich Str12: ichO Str1 ... (truncated)
REASON_20: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_21: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_22: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_23: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_24: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_25: Yara Rule MATCH: virtualbox_detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\ACPI\DSDT\VBOX__ Str2: \.\VBoxMiniRdrDN Str3: vboxhook.dll Str4: SOFTWARE\Oracle\VirtualBox Guest Additions Str5: HARDWARE\ ... (truncated)
REASON_26: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\Description\System Str2: SystemBiosVersion Str3: QEMU Str4: qemu Str5: qemu Str6: QEMU Str7: HARDWARE\DEVICEMAP\Scsi\Scsi Po ... (truncated)
REASON_27: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\Description\System Str2: SystemBiosVersion Str3: VideoBiosVersion Str4: VBox Str5: VBOX Str6: vbox Str7: VBox Str8: vbox Str ... (truncated)
REASON_28: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DEVICEMAP\Scsi\Scsi Port 0\Scsi Bus 0\Target Id 0\Logical Unit Id 0 Str2: Identifier Str3: Identifier Str4: VMWare Str5: vmw ... (truncated)
REASON_29: Yara Rule MATCH: VM_Detect_VirtualPC_XEN_Wine_v1 SUBSCORE: 60 
DESCRIPTION: Xen detection, VirtualPC, Red Pill, Wine and other REF: - AUTHOR: Thomas Roccia - @fr0gger_ - Unprotect Project 
MATCHES: Str1: wine_get_unix_file_name
REASON_30: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_31: Yara Rule MATCH: Check_Dlls SUBSCORE: 30 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: sbiedll.dll Str2: dbghelp.dll Str3: api_log.dll Str4: dir_watch.dll Str5: pstorec.dll Str6: vmcheck.dll Str7: wpespy.dll
REASON_32: Yara Rule MATCH: Check_VBox_DeviceMap SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DEVICEMAP\Scsi\Scsi Port 0\Scsi Bus 0\Target Id 0\Logical Unit Id 0 Str2: Identifier Str3: Identifier Str4: VBox Str5: VBOX  ... (truncated)
REASON_33: Yara Rule MATCH: Check_VBox_VideoDrivers SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\Description\System Str2: VideoBiosVersion Str3: VirtualBox Str4: VIRTUALBOX Str5: virtualbox Str6: VirtualBox
REASON_34: Yara Rule MATCH: Check_VmTools SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: SOFTWARE\VMware, Inc.\VMware Tools
REASON_35: Yara Rule MATCH: vmdetect_2 SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: VMware Str2: VMWARE
REASON_36: Yara Rule MATCH: WMI_VM_Detect_v1 SUBSCORE: 50 
DESCRIPTION: Detection of Virtual Appliances through the use of WMI for use of evasion. REF: - AUTHOR: Joe Giron 
MATCHES: Str1: SELECT * FROM Win32_VideoController Str2: Parallel
REASON_37: Yara Rule MATCH: AtomTable_Inject SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: GlobalAddAtom Str2: GlobalGetAtomName Str3: QueueUserAPC
REASON_38: Yara Rule MATCH: DLL_inject SUBSCORE: 40 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: LoadLibraryA Str4: CreateFileA Str5: WriteProcessMemory Str6: HeapAlloc Str7: GetProcAddress S ... (truncated)
REASON_39: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: NtWriteVirtualMemory Str4: WriteProcessMemory Str5: CreateRemoteThread Str6: CreateThread
REASON_40: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: UnhookWindowsHookEx Str3: SetWindowsHookExA Str4: CallNextHookEx
REASON_41: Yara Rule MATCH: Process_Doppelganging SUBSCORE: 35 
DESCRIPTION: Detect Process Doppelganging REF: https://www.blackhat.com/docs/eu-17/materials/eu-17-Liberman-Lost-In-Transaction-Process-Doppelganging.pdf AUTHOR: McAfee ATR - Thomas Roccia - @fr0gger_ 
MATCHES: Str1: CreateTransaction Str2: CreateFileTransacted Str3: WriteFile Str4: RollbackTransaction Str5: CreateProcess Str6: CreateProcessParamet ... (truncated)
REASON_42: Yara Rule MATCH: Atom_Bombing SUBSCORE: 40 
DESCRIPTION: Detect AtomBombing Injection REF: https://blog.ensilo.com/atombombing-brand-new-code-injection-for-windows AUTHOR: McAfee ATR - Thomas Roccia - @fr0gger_  
MATCHES: Str1: GlobalAddAtom Str2: GlobalGetAtomName Str3: QueueUserAPC Str4: NtQueueApcThread Str5: NtSetContextThread
REASON_43: Yara Rule MATCH: APC_Inject SUBSCORE: 40 
DESCRIPTION: Detect APC Injection REF: - AUTHOR: McAfee ATR - Thomas Roccia - @fr0gger_  
MATCHES: Str1: NtQueueApcThread Str2: NtResumeThread Str3: NtTestAlert Str4: QueueUserAPC
REASON_44: Yara Rule MATCH: Debugger_Check__GlobalFlags SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: NtGlobalFlags
REASON_45: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_46: Yara Rule MATCH: Debugger_Check__RemoteAPI SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: CheckRemoteDebuggerPresent
REASON_47: Yara Rule MATCH: Debugger_Hiding__Thread SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetInformationThread
REASON_48: Yara Rule MATCH: DebuggerHiding__Active_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: DebugActiveProcess
REASON_49: Yara Rule MATCH: DebuggerException__ConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: GenerateConsoleCtrlEvent
REASON_50: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_51: Yara Rule MATCH: ThreadControl__Context_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetThreadContext
REASON_52: Yara Rule MATCH: SEH__vectored_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: AddVectoredExceptionHandler Str2: RemoveVectoredExceptionHandler
REASON_53: Yara Rule MATCH: Check_Debugger_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_54: Yara Rule MATCH: Check_Qemu_Description SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\Description\System Str2: SystemBiosVersion Str3: QEMU Str4: qemu Str5: qemu Str6: QEMU
REASON_55: Yara Rule MATCH: Check_Qemu_DeviceMap SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: HARDWARE\DEVICEMAP\Scsi\Scsi Port 0\Scsi Bus 0\Target Id 0\Logical Unit Id 0 Str2: Identifier Str3: Identifier Str4: QEMU Str5: qemu  ... (truncated)
REASON_56: Yara Rule MATCH: vmdetect SUBSCORE: 60 
DESCRIPTION: Possibly employs anti-virtualization techniques REF: - AUTHOR: nex 
MATCHES: Str1: VMware Str2: VMWARE
REASON_57: Yara Rule MATCH: WMI_VM_Detect SUBSCORE: 50 
DESCRIPTION: Detection of Virtual Appliances through the use of WMI for use of evasion. REF: - AUTHOR: Joe Giron 
MATCHES: Str1: SELECT * FROM Win32_VideoController Str2: Parallel
REASON_58: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: kernel32.dll Str2: KERNEL32.dll Str3: CheckRemoteDebuggerPresent Str4: IsDebuggerPresent Str5: OutputDebugString Str6: ContinueDebugE ... (truncated)
REASON_59: Yara Rule MATCH: vmdetect_misc SUBSCORE: 50 
DESCRIPTION: Following Rule is referenced from AlienVault's Yara rule repository.This rule contains additional processes and driver names. REF: - AUTHOR: @abhinavbom 
MATCHES: Str1: VBoxService Str2: vboxservice Str3: VBoxTray Str4: vboxtray Str5: SOFTWARE\Oracle\VirtualBox Guest Additions Str6: wine_get_unix_file ... (truncated)
REASON_60: Yara Rule MATCH: VMdetectMisc SUBSCORE: 25 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: VBoxService Str2: vboxservice Str3: VBoxTray Str4: vboxtray Str5: SOFTWARE\Oracle\VirtualBox Guest Additions Str6: wine_get_unix_file ... (truncated)
REASON_61: Yara Rule MATCH: SandboxDetectMisc SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: sbiedll Str2: joeboxserver Str3: joeboxcontrol
REASON_62: Yara Rule MATCH: avdetect_procs SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: filemon.exe Str2: procmon.exe Str3: Wireshark.exe
REASON_63: Yara Rule MATCH: dbgdetect_procs SUBSCORE: 70 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: Wireshark Str2: filemon Str3: procexp Str4: procmon Str5: regmon Str6: ImmunityDebugger Str7: ollydbg Str8: PETools
REASON_64: Yara Rule MATCH: TrojanDownloaderCbeplaySample SUBSCORE: 60 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: pstorec.dll Str2: VIRTUALBOX Str3: VideoBiosVersion Str4: QEMU Str5: QEMU Str6: VMWARE Str7: VMWARE Str8: VBOX Str9: VBOX Str10: VIRT ... (truncated)
REASON_65: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_66: Yara Rule MATCH: MD5_API SUBSCORE: 25 
DESCRIPTION: Looks for MD5 API REF: - AUTHOR: _pusher_ 
MATCHES: Str1: advapi32.dll Str2: ADVAPI32.dll Str3: MD5Init Str4: MD5Update Str5: MD5Final
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:34:21Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
70		escalate_priv
65		screenshot
80		keylogger
45		migrate_apc
5		win_mutex
20		win_registry
10		win_token
10		win_private_profile
10		win_files_operation
1		ft_exe
50		ConventionEngine_Term_Desktop
50		ConventionEngine_Term_Users
1		math_entropy_5
5		obfuscation_singlebyte_mov
15		self_inject
15		dll_injection_thread
15		dll_injection_hook
25		possible_includes_base64_packed_functions
1		IsPE64
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
10		virtualbox_detection
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
60		VM_Detect_VirtualPC_XEN_Wine_v1
5		Anti_Automated_Sandbox
30		Check_Dlls
60		Check_VBox_DeviceMap
60		Check_VBox_VideoDrivers
60		Check_VmTools
60		vmdetect_2
50		WMI_VM_Detect_v1
35		AtomTable_Inject
40		DLL_inject
45		Inject_Thread
35		Win_Hook_v12
35		Process_Doppelganging
40		Atom_Bombing
40		APC_Inject
60		Debugger_Check__GlobalFlags
60		Debugger_Check__QueryInfo
60		Debugger_Check__RemoteAPI
60		Debugger_Hiding__Thread
60		DebuggerHiding__Active_v1
60		DebuggerException__ConsoleCtrl_v1
60		DebuggerException__SetConsoleCtrl_v1
60		ThreadControl__Context_v1
60		SEH__vectored_v1
60		Check_Debugger_v1
5		Check_Qemu_Description
5		Check_Qemu_DeviceMap
60		vmdetect
50		WMI_VM_Detect
10		anti_dbg
50		vmdetect_misc
25		VMdetectMisc
70		SandboxDetectMisc
70		avdetect_procs
70		dbgdetect_procs
60		TrojanDownloaderCbeplaySample
1		Contains_PE_File
25		MD5_API

Score total: 2369

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::Process Discovery [T1057;2]', '2'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Collection::Data from Information Repositories [T1213;5]', '5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::Time Based Evasion [T1497.003;8.5]', '8.5'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Collection::Input Capture::Keylogging [T1056.001;6]', '6'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Defense Evasion::Process Injection::Asynchronous Procedure Call [T1055.004;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Execution::System Services::Service Execution [T1569.002;3]', '3'), ('- Defense Evasion::Modify Registry [T1112;2.5]', '2.5'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Execution::Windows Management Instrumentation [T1047;4.5]', '4.5'), ('- Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003;4]', '4'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Discovery::Software Discovery [T1518;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Defense Evasion::Virtualization/Sandbox Evasion::User Activity Based Checks [T1497.002;7.5]', '7.5'), ('- Discovery::Query Registry [T1012;1]', '1')]
---------------- ClamAV_Rules --------------
[('Win.Exploit.CVE_2019_1219-7151042-2', '25')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('escalate_priv', '70'), ('screenshot', '65'), ('keylogger', '80'), ('migrate_apc', '45'), ('win_mutex', '5'), ('win_registry', '20'), ('win_token', '10'), ('win_private_profile', '10'), ('win_files_operation', '10'), ('ft_exe', '1'), ('ConventionEngine_Term_Desktop', '50'), ('ConventionEngine_Term_Users', '50'), ('math_entropy_5', '1'), ('obfuscation_singlebyte_mov', '5'), ('self_inject', '15'), ('dll_injection_thread', '15'), ('dll_injection_hook', '15'), ('possible_includes_base64_packed_functions', '25'), ('IsPE64', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('virtualbox_detection', '10'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('VM_Detect_VirtualPC_XEN_Wine_v1', '60'), ('Anti_Automated_Sandbox', '5'), ('Check_Dlls', '30'), ('Check_VBox_DeviceMap', '60'), ('Check_VBox_VideoDrivers', '60'), ('Check_VmTools', '60'), ('vmdetect_2', '60'), ('WMI_VM_Detect_v1', '50'), ('AtomTable_Inject', '35'), ('DLL_inject', '40'), ('Inject_Thread', '45'), ('Win_Hook_v12', '35'), ('Process_Doppelganging', '35'), ('Atom_Bombing', '40'), ('APC_Inject', '40'), ('Debugger_Check__GlobalFlags', '60'), ('Debugger_Check__QueryInfo', '60'), ('Debugger_Check__RemoteAPI', '60'), ('Debugger_Hiding__Thread', '60'), ('DebuggerHiding__Active_v1', '60'), ('DebuggerException__ConsoleCtrl_v1', '60'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('ThreadControl__Context_v1', '60'), ('SEH__vectored_v1', '60'), ('Check_Debugger_v1', '60'), ('Check_Qemu_Description', '5'), ('Check_Qemu_DeviceMap', '5'), ('vmdetect', '60'), ('WMI_VM_Detect', '50'), ('anti_dbg', '10'), ('vmdetect_misc', '50'), ('VMdetectMisc', '25'), ('SandboxDetectMisc', '70'), ('avdetect_procs', '70'), ('dbgdetect_procs', '70'), ('TrojanDownloaderCbeplaySample', '60'), ('Contains_PE_File', '1'), ('MD5_API', '25')]
-------------- LOKI_Score ------------
['2369']
-------------- CAPA_Score ------------
['78.5']
-------------- CLAMAV_Score ------------
['25.0']
-------------- SCORE FINAL ------------
39427.13199960288
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FdYTUa14g2Kxcdjqm.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | c62801f2fd980d444ec12455f83cf536                                                   |
| sha1                   | 82f508b9caaf23f766935d03d43c28c787ae1b2b                                           |
| sha256                 | 5b63cdaa6b386340186d48fca6687b51d666f4457c1d1228c4915bdd2917a315                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FdYTUa14g2Kxcdjqm.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+


+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| get disk information                                 | host-interaction/hardware/storage                    |
| parse PE header (2 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
1		- Discovery::System Information Discovery [T1082;1]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 5.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FdYTUa14g2Kxcdjqm.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.02 MB
Data read: 0.02 MB (ratio 1.00:1)
Time: 24.209 sec (0 m 24 s)
Start Date: 2022:01:28 14:34:21
End Date:   2022:01:28 14:34:46

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:34:22Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:34:46Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::System Information Discovery [T1082;1]', '1'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['5.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
99.763115748444
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FzRoLEuDocTRDx4Le.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Loki
==================================================================
------- Erreur -------
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 4-5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 4-5: invalid continuation byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa3 in position 1: invalid start byte
Traceback (most recent call last):
  File /etc/Loki/lib/helpers.py, line 188, in removeNonAscii
    filtered_string = filter(lambda x: x in printable, s.decode('utf-8'))
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x89 in position 1: invalid start byte

-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:34:47Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FzRoLEuDocTRDx4Le.exe SCORE: 234 TYPE: EXE SIZE: 315904 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f18d100e670> 
MD5: e4c33ac3638eef68311f8ac0d72483c7 
SHA1: f78bc256038330de1b23be28e93206d9b64d03ef 
SHA256: 033f4cb193b78f18f70c36e53ab46b21b81449c59e9fe302e1778a6898a5479a CREATED: Fri Jan 28 14:34:47 2022 MODIFIED: Fri Jan 28 14:34:47 2022 ACCESSED: Fri Jan 28 14:35:13 2022 
REASON_1: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: WriteFile Str3: SetFilePointer Str4: ReadFile Str5: CreateFileA Str6: FindClose
REASON_2: Yara Rule MATCH: Str_Win32_Winsock2_Library SUBSCORE: 10 
DESCRIPTION: Match Winsock 2 API library declaration REF: https://github.com/dfirnotes/rules AUTHOR: @adricnet 
MATCHES: Str1: WS2_32.dll
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: ConventionEngine_Term_Users SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453e9937259b583cf48a17705ed53425f9301000000433a5c55736572735c757365725c736f757263655c7265706f735c61737369676e6d656e74325c4465627 ... (truncated)
REASON_5: Yara Rule MATCH: ConventionEngine_Term_Users_User SUBSCORE: 50 
DESCRIPTION: Searching for PE files with PDB path keywords, terms or anomalies. REF: - AUTHOR: @stvemillertime 
MATCHES: Str1: 52534453e9937259b583cf48a17705ed53425f9301000000433a5c55736572735c757365725c736f757263655c7265706f735c61737369676e6d656e74325c4465627 ... (truncated)
REASON_6: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: DebuggerException__SetConsoleCtrl_v1 SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: SetConsoleCtrlHandler
REASON_13: Yara Rule MATCH: SEH_Save SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64ff3500000000
REASON_14: Yara Rule MATCH: SEH_Init SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: Malware Utkonos 
MATCHES: Str1: 64a300000000 Str2: 64892500000000
REASON_15: Yara Rule MATCH: anti_dbg SUBSCORE: 10 
DESCRIPTION: Checks if being debugged REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: IsDebuggerPresent Str3: OutputDebugString
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: Crypt32_CryptBinaryToString_API SUBSCORE: 25 
DESCRIPTION: Looks for crypt32 CryptBinaryToStringA function REF: - AUTHOR: _pusher_ 
MATCHES: Str1: CRYPT32.dll Str2: CryptBinaryToStringA
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:35:13Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_files_operation
10		Str_Win32_Winsock2_Library
1		ft_exe
50		ConventionEngine_Term_Users
50		ConventionEngine_Term_Users_User
1		math_entropy_6
1		IsPE32
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
60		DebuggerException__SetConsoleCtrl_v1
5		SEH_Save
5		SEH_Init
10		anti_dbg
1		Contains_PE_File
25		Crypt32_CryptBinaryToString_API

Score total: 234

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FzRoLEuDocTRDx4Le.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.32 MB
Data read: 0.30 MB (ratio 1.05:1)
Time: 27.309 sec (0 m 27 s)
Start Date: 2022:01:28 14:34:47
End Date:   2022:01:28 14:35:14

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | e4c33ac3638eef68311f8ac0d72483c7                                                   |
| sha1                   | f78bc256038330de1b23be28e93206d9b64d03ef                                           |
| sha256                 | 033f4cb193b78f18f70c36e53ab46b21b81449c59e9fe302e1778a6898a5479a                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FzRoLEuDocTRDx4Le.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| COMMAND AND CONTROL    | Non-Application Layer Protocol:: \[T1095]\                                         |
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Process Injection::Dynamic-link Library Injection \[T1055.001]\                    |
| DISCOVERY              | Account Discovery:: \[T1087]\                                                      |
|                        | File and Directory Discovery:: \[T1083]\                                           |
|                        | System Information Discovery:: \[T1082]\                                           |
|                        | System Owner/User Discovery:: \[T1033]\                                            |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| COMMUNICATION               | Socket Communication::Initialize Winsock Library [C0001.009]                  |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| OPERATING SYSTEM            | Environment Variable::Set Variable [C0034.001]                                |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| initialize Winsock library                           | communication/socket                                 |
| encode data using Base64 via WinAPI                  | data-manipulation/encoding/base64                    |
| contains PDB path                                    | executable/pe/pdb                                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| set environment variable (2 matches)                 | host-interaction/environment-variable                |
| get common file path (2 matches)                     | host-interaction/file-system                         |
| read file via mapping                                | host-interaction/file-system/read                    |
| write file on Windows                                | host-interaction/file-system/write                   |
| print debug messages (2 matches)                     | host-interaction/log/debug/write-event               |
| get hostname                                         | host-interaction/os/hostname                         |
| get session user name                                | host-interaction/session                             |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| inject DLL reflectively                              | load-code/pe                                         |
| inspect section memory permissions                   | load-code/pe                                         |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header                                      | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Owner/User Discovery [T1033;3]
1		- Discovery::File and Directory Discovery [T1083;1]
5		- Command and Control::Non-Application Layer Protocol [T1095;5]
3		- Discovery::Account Discovery [T1087;3]
4		- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;4]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 25.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Owner/User Discovery [T1033;3]', '3'), ('- Discovery::File and Directory Discovery [T1083;1]', '1'), ('- Command and Control::Non-Application Layer Protocol [T1095;5]', '5'), ('- Discovery::Account Discovery [T1087;3]', '3'), ('- Defense Evasion::Process Injection::Dynamic-link Library Injection [T1055.001;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_files_operation', '10'), ('Str_Win32_Winsock2_Library', '10'), ('ft_exe', '1'), ('ConventionEngine_Term_Users', '50'), ('ConventionEngine_Term_Users_User', '50'), ('math_entropy_6', '1'), ('IsPE32', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('DebuggerException__SetConsoleCtrl_v1', '60'), ('SEH_Save', '5'), ('SEH_Init', '5'), ('anti_dbg', '10'), ('Contains_PE_File', '1'), ('Crypt32_CryptBinaryToString_API', '25')]
-------------- LOKI_Score ------------
['234']
-------------- CAPA_Score ------------
['25.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4207.465649101225
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-Fbtj3Y3vjq128HgyHc.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-Fbtj3Y3vjq128HgyHc.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.23 MB
Data read: 0.23 MB (ratio 1.03:1)
Time: 26.119 sec (0 m 26 s)
Start Date: 2022:01:28 14:35:33
End Date:   2022:01:28 14:36:00

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:35:34Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[WARNING] 
FILE: /tmp/.Loki_Scan/HTTP-Fbtj3Y3vjq128HgyHc.exe SCORE: 97 TYPE: EXE SIZE: 239416 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f599e562670> 
MD5: 05aeb5e395b205d60ae010c5105b71f9 
SHA1: b2ae6398c50353baf9de5b1c16a74f79437f9310 
SHA256: 29649c628aa857904fa83bf577ef4f70527fa73bb4fa4c1539f6dc8ddfb896aa CREATED: Fri Jan 28 14:35:33 2022 MODIFIED: Fri Jan 28 14:35:33 2022 ACCESSED: Fri Jan 28 14:36:00 2022 
REASON_1: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_2: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: research_pe_signed_outside_timestamp SUBSCORE: 20 
DESCRIPTION: PE linker timestamp is outside the Authenticode validity period REF: - AUTHOR: David Cannings 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_9: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_11: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_12: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_16: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_17: Yara Rule MATCH: BASE64_table SUBSCORE: 5 
DESCRIPTION: Look for Base64 table REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/
[NOTICE] Results: 0 alerts, 1 warnings, 1 notices
[RESULT] Suspicious objects detected!
[RESULT] Loki recommends a deeper analysis of the suspicious objects.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:36:00Z

-------- Score ----------------
Scores		Rules
.......		...............
5		win_mutex
1		misc_pe_signature
1		ft_exe
20		research_pe_signed_outside_timestamp
1		math_entropy_6
1		IsPE64
1		IsDLL
1		IsConsole
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
1		Contains_PE_File
5		BASE64_table

Score total: 97

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 05aeb5e395b205d60ae010c5105b71f9                                                   |
| sha1                   | b2ae6398c50353baf9de5b1c16a74f79437f9310                                           |
| sha256                 | 29649c628aa857904fa83bf577ef4f70527fa73bb4fa4c1539f6dc8ddfb896aa                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-Fbtj3Y3vjq128HgyHc.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | Application Window Discovery:: \[T1010]\                                           |
|                        | System Location Discovery:: \[T1614]\                                              |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Check String:: [C0019]                                                        |
|                             | Encode Data::Base64 [C0026.001]                                               |
| PROCESS                     | Create Thread:: [C0038]                                                       |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| get geographical location                            | collection                                           |
| reference Base64 string                              | data-manipulation/encoding/base64                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| enumerate gui resources                              | host-interaction/gui                                 |
| terminate process via fastfail (6 matches)           | host-interaction/process/terminate                   |
| create thread (2 matches)                            | host-interaction/thread/create                       |
| parse PE header (3 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
3		- Discovery::System Location Discovery [T1614;3]
2		- Execution::Shared Modules [T1129;2]
2		- Discovery::Application Window Discovery [T1010;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]

Score total: 13.0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Discovery::System Location Discovery [T1614;3]', '3'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Discovery::Application Window Discovery [T1010;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_mutex', '5'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('research_pe_signed_outside_timestamp', '20'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Contains_PE_File', '1'), ('BASE64_table', '5')]
-------------- LOKI_Score ------------
['97']
-------------- CAPA_Score ------------
['13.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
1796.730497633234
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FPPNmBaAJfgvyTE3a.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FPPNmBaAJfgvyTE3a.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.28 MB
Data read: 0.27 MB (ratio 1.06:1)
Time: 25.410 sec (0 m 25 s)
Start Date: 2022:01:28 14:36:10
End Date:   2022:01:28 14:36:36

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:36:11Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FPPNmBaAJfgvyTE3a.exe SCORE: 241 TYPE: EXE SIZE: 282488 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f9b4a213670> 
MD5: b1116e05a2aeda8e95f89e74c1525a6c 
SHA1: 7685045ccd89e21943330c049a84e6f0184104be 
SHA256: 1cdf9d33b2c92a212c8a297802178127f354131d6d05641b6fdb6c52aff5fde3 CREATED: Fri Jan 28 14:36:10 2022 MODIFIED: Fri Jan 28 14:36:10 2022 ACCESSED: Fri Jan 28 14:36:36 2022 
REASON_1: Yara Rule MATCH: inject_thread SUBSCORE: 50 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread
REASON_2: Yara Rule MATCH: win_mutex SUBSCORE: 5 
DESCRIPTION: Create or check mutex REF: - AUTHOR: x0r 
MATCHES: Str1: CreateMutex
REASON_3: Yara Rule MATCH: misc_pe_signature SUBSCORE: 1 
DESCRIPTION: Triggers if an authenticode signature is present within a PE file (if the PE is signed for example) REF: - AUTHOR: Jason Batchelor
REASON_4: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_5: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_8: Yara Rule MATCH: HasOverlay SUBSCORE: 1 
DESCRIPTION: Overlay Check REF: - AUTHOR: _pusher_
REASON_9: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_10: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_11: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_12: Yara Rule MATCH: Qemu_Detection SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_13: Yara Rule MATCH: VBox_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_14: Yara Rule MATCH: VMWare_Detection SUBSCORE: 10 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: identifier
REASON_15: Yara Rule MATCH: Anti_Automated_Sandbox SUBSCORE: 5 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: RegQueryValue
REASON_16: Yara Rule MATCH: Inject_Thread SUBSCORE: 45 
DESCRIPTION: Code injection with CreateRemoteThread in a remote process REF: - AUTHOR: x0r modified by @fr0gger_ 
MATCHES: Str1: OpenProcess Str2: VirtualAllocEx Str3: WriteProcessMemory Str4: CreateRemoteThread
REASON_17: Yara Rule MATCH: Debugger_Check__QueryInfo SUBSCORE: 60 
DESCRIPTION: not set REF: https://github.com/naxonez/yaraRules/blob/master/AntiDebugging.yara AUTHOR: - 
MATCHES: Str1: QueryInformationProcess
REASON_18: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_19: Yara Rule MATCH: Big_Numbers1 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 32:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 340b71789a9b7dc52cae1c90b8a71a90
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:36:37Z

-------- Score ----------------
Scores		Rules
.......		...............
50		inject_thread
5		win_mutex
1		misc_pe_signature
1		ft_exe
1		math_entropy_6
1		IsPE64
1		IsConsole
1		HasOverlay
1		HasDebugData
1		HasRichSignature
2		PE_File
35		Qemu_Detection
10		VBox_Detection
10		VMWare_Detection
5		Anti_Automated_Sandbox
45		Inject_Thread
60		Debugger_Check__QueryInfo
1		Contains_PE_File
10		Big_Numbers1

Score total: 241

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | b1116e05a2aeda8e95f89e74c1525a6c                                                   |
| sha1                   | 7685045ccd89e21943330c049a84e6f0184104be                                           |
| sha256                 | 1cdf9d33b2c92a212c8a297802178127f354131d6d05641b6fdb6c52aff5fde3                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FPPNmBaAJfgvyTE3a.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Deobfuscate/Decode Files or Information:: \[T1140]\                                |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
|                        | Virtualization/Sandbox Evasion::System Checks \[T1497.001]\                        |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Shared Modules:: \[T1129]\                                                         |
| PRIVILEGE ESCALATION   | Access Token Manipulation:: \[T1134]\                                              |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| ANTI-BEHAVIORAL ANALYSIS    | Virtual Machine Detection:: [B0009]                                           |
| FILE SYSTEM                 | Read File:: [C0051]                                                           |
| PROCESS                     | Resume Thread:: [C0054]                                                       |
|                             | Suspend Thread:: [C0055]                                                      |
|                             | Terminate Process:: [C0018]                                                   |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| reference anti-VM strings                            | anti-analysis/anti-vm/vm-detection                   |
| decode data using Base64 via WinAPI                  | data-manipulation/encoding/base64                    |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
| read file on Windows                                 | host-interaction/file-system/read                    |
| check OS version                                     | host-interaction/os/version                          |
| acquire debug privileges                             | host-interaction/process/modify                      |
| terminate process via fastfail (2 matches)           | host-interaction/process/terminate                   |
| resume thread                                        | host-interaction/thread/resume                       |
| suspend thread                                       | host-interaction/thread/suspend                      |
| parse PE header (5 matches)                          | load-code/pe                                         |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
2		- Execution::Shared Modules [T1129;2]
5		- Privilege Escalation::Access Token Manipulation [T1134;5]
4		- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
6.5		- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 20.5

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Shared Modules [T1129;2]', '2'), ('- Privilege Escalation::Access Token Manipulation [T1134;5]', '5'), ('- Defense Evasion::Deobfuscate/Decode Files or Information [T1140;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001;6.5]', '6.5'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('inject_thread', '50'), ('win_mutex', '5'), ('misc_pe_signature', '1'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsConsole', '1'), ('HasOverlay', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Qemu_Detection', '35'), ('VBox_Detection', '10'), ('VMWare_Detection', '10'), ('Anti_Automated_Sandbox', '5'), ('Inject_Thread', '45'), ('Debugger_Check__QueryInfo', '60'), ('Contains_PE_File', '1'), ('Big_Numbers1', '10')]
-------------- LOKI_Score ------------
['241']
-------------- CAPA_Score ------------
['20.5']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
4228.621368399903
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FkDPtt2RLhN6KZExpi.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
------- Erreur -------
WARNING:capa:--------------------------------------------------------------------------------
WARNING:capa: This sample appears to be packed.
WARNING:capa: 
WARNING:capa: Packed samples have often been obfuscated to hide their logic.
WARNING:capa: capa cannot handle obfuscation well. This means the results may be misleading or incomplete.
WARNING:capa: If possible, you should try to unpack this input file before analyzing it with capa.
WARNING:capa: 
WARNING:capa: Identified via rule: (internal) packer file limitation
WARNING:capa: 
WARNING:capa: Use -v or -vv if you really want to see the capabilities identified by capa.
WARNING:capa:--------------------------------------------------------------------------------

-------  Out   -------

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FkDPtt2RLhN6KZExpi.exe: Win.Trojan.Buzus-9327 FOUND

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 1
Data scanned: 0.57 MB
Data read: 0.41 MB (ratio 1.39:1)
Time: 25.609 sec (0 m 25 s)
Start Date: 2022:01:28 14:36:45
End Date:   2022:01:28 14:37:11

-------- Score ----------------
Scores		Rules
.......		...............
45		Win.Trojan.Buzus-9327

Score total: 45.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:36:45Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[ALERT] 
FILE: /tmp/.Loki_Scan/HTTP-FkDPtt2RLhN6KZExpi.exe SCORE: 239 TYPE: EXE SIZE: 429568 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f511ea85670> 
MD5: db9fe790b4e18abf55df31aa0b81e558 
SHA1: 97f2462c4462364babbc82ad49b7bd65e8647474 
SHA256: d7dbe8d8a68c26bf5d00adb957a4dbf5bd6415a81b50a823a4b872a6d2f494cf CREATED: Fri Jan 28 14:36:45 2022 MODIFIED: Fri Jan 28 14:36:45 2022 ACCESSED: Fri Jan 28 14:37:11 2022 
REASON_1: Yara Rule MATCH: keylogger SUBSCORE: 80 
DESCRIPTION: Run a keylogger REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: USER32.DLL Str3: GetAsyncKeyState
REASON_2: Yara Rule MATCH: win_files_operation SUBSCORE: 10 
DESCRIPTION: Affect private profile REF: - AUTHOR: x0r 
MATCHES: Str1: KERNEL32.dll Str2: KERNEL32.DLL Str3: WriteFile Str4: DeleteFileA Str5: CreateFileA
REASON_3: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_4: Yara Rule MATCH: math_entropy_4 SUBSCORE: 1 
DESCRIPTION: Low entropy - like plaintext or HTML or sparse data REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsPE32 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsWindowsGUI SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_8: Yara Rule MATCH: Embedded_PE SUBSCORE: 35 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Win_Hook_v12 SUBSCORE: 35 
DESCRIPTION: Affect hook table REF: - AUTHOR: x0r 
MATCHES: Str1: USER32.dll Str2: USER32.DLL Str3: SetWindowsHookExA Str4: CallNextHookEx
REASON_11: Yara Rule MATCH: suspicious_packer_section SUBSCORE: 60 
DESCRIPTION: The packer/protector section names/keywords REF: http://www.hexacorn.com/blog/2012/10/14/random-stats-from-1-2m-samples-pe-section-names/ AUTHOR: @j0sm1 
MATCHES: Str1: pebundle
REASON_12: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_13: Yara Rule MATCH: Big_Numbers0 SUBSCORE: 10 
DESCRIPTION: Looks for big numbers 20:sized REF: - AUTHOR: _pusher_ 
MATCHES: Str1: 88888888888888888888
[NOTICE] Results: 1 alerts, 0 warnings, 1 notices
[RESULT] Indicators detected!
[RESULT] Loki recommends checking the elements on virustotal.com or Google and triage with a professional tool like THOR https://nextron-systems.com/thor in corporate networks.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:37:11Z

-------- Score ----------------
Scores		Rules
.......		...............
80		keylogger
10		win_files_operation
1		ft_exe
1		math_entropy_4
1		IsPE32
2		IsWindowsGUI
1		HasRichSignature
35		Embedded_PE
2		PE_File
35		Win_Hook_v12
60		suspicious_packer_section
1		Contains_PE_File
10		Big_Numbers0

Score total: 239

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('No Match', '0')]
---------------- ClamAV_Rules --------------
[('Win.Trojan.Buzus-9327', '45')]
-------------- LOKI_Rules ------------
[('keylogger', '80'), ('win_files_operation', '10'), ('ft_exe', '1'), ('math_entropy_4', '1'), ('IsPE32', '1'), ('IsWindowsGUI', '2'), ('HasRichSignature', '1'), ('Embedded_PE', '35'), ('PE_File', '2'), ('Win_Hook_v12', '35'), ('suspicious_packer_section', '60'), ('Contains_PE_File', '1'), ('Big_Numbers0', '10')]
-------------- LOKI_Score ------------
['239']
-------------- CAPA_Score ------------
['0']
-------------- CLAMAV_Score ------------
['45.0']
-------------- SCORE FINAL ------------
4354.411165289436
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FElDiU32hM1K9MMdSe.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | ad82b246ddc7b8a49936670ec1ecbec8                                                   |
| sha1                   | e7be001f09b210ad402f76a7f7d336477440d762                                           |
| sha256                 | f405ef44de0fa7c79c20a4843fe0f76eebf64e34d32ebb29aa98d998acf89036                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | amd64                                                                              |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FElDiU32hM1K9MMdSe.exe                        |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| CRYPTOGRAPHY                | Cryptographic Hash:: [C0029]                                                  |
|                             | Cryptographic Hash::SHA1 [C0029.002]                                          |
|                             | Decrypt Data:: [C0031]                                                        |
|                             | Encrypt Data:: [C0027]                                                        |
|                             | Encrypt Data::3DES [C0027.004]                                                |
|                             | Encrypt Data::AES [C0027.001]                                                 |
|                             | Encryption Key:: [C0028]                                                      |
|                             | Generate Pseudo-random Sequence::Use API [C0021.003]                          |
| DEFENSE EVASION             | Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]    |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| create new key via CryptAcquireContext               | data-manipulation/encryption                         |
| encrypt or decrypt via WinCrypt (3 matches)          | data-manipulation/encryption                         |
| encrypt data using AES via WinAPI (2 matches)        | data-manipulation/encryption/aes                     |
| encrypt data using DES via WinAPI                    | data-manipulation/encryption/des                     |
| hash data via WinCrypt (2 matches)                   | data-manipulation/hashing                            |
| hash data using SHA1                                 | data-manipulation/hashing/sha1                       |
| hash data using SHA1 via WinCrypt                    | data-manipulation/hashing/sha1                       |
| generate random numbers via WinAPI                   | data-manipulation/prng                               |
| contain a resource (.rsrc) section                   | executable/pe/section/rsrc                           |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]

Score total: 6.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FElDiU32hM1K9MMdSe.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.11 MB
Data read: 0.11 MB (ratio 1.00:1)
Time: 25.963 sec (0 m 25 s)
Start Date: 2022:01:28 14:37:11
End Date:   2022:01:28 14:37:37

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:37:11Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] 
FILE: /tmp/.Loki_Scan/HTTP-FElDiU32hM1K9MMdSe.exe SCORE: 40 TYPE: EXE SIZE: 111616 
FIRST_BYTES: 4d5a90000300000004000000ffff0000b8000000 / <filter object at 0x7f35bce7f670> 
MD5: ad82b246ddc7b8a49936670ec1ecbec8 
SHA1: e7be001f09b210ad402f76a7f7d336477440d762 
SHA256: f405ef44de0fa7c79c20a4843fe0f76eebf64e34d32ebb29aa98d998acf89036 CREATED: Fri Jan 28 14:37:11 2022 MODIFIED: Fri Jan 28 14:37:11 2022 ACCESSED: Fri Jan 28 14:37:38 2022 
REASON_1: Yara Rule MATCH: win_token SUBSCORE: 10 
DESCRIPTION: Affect system token REF: - AUTHOR: x0r 
MATCHES: Str1: ADVAPI32.dll Str2: OpenProcessToken
REASON_2: Yara Rule MATCH: ft_exe SUBSCORE: 1 
DESCRIPTION: Simple signature to trigger on PE files. REF: - AUTHOR: Jason Batchelor 
MATCHES: Str1: MZ
REASON_3: Yara Rule MATCH: math_entropy_6 SUBSCORE: 1 
DESCRIPTION: High entropy - like binary code or base64 encoded random stream REF: - AUTHOR: -
REASON_4: Yara Rule MATCH: IsPE64 SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_5: Yara Rule MATCH: IsDLL SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_6: Yara Rule MATCH: IsConsole SUBSCORE: 1 
DESCRIPTION: not set REF: - AUTHOR: -
REASON_7: Yara Rule MATCH: HasDebugData SUBSCORE: 1 
DESCRIPTION: DebugData Check REF: - AUTHOR: _pusher_
REASON_8: Yara Rule MATCH: HasRichSignature SUBSCORE: 1 
DESCRIPTION: Rich Signature Check REF: - AUTHOR: _pusher_ 
MATCHES: Str1: Rich
REASON_9: Yara Rule MATCH: PE_File SUBSCORE: 2 
DESCRIPTION: not set REF: - AUTHOR: - 
MATCHES: Str1: MZ
REASON_10: Yara Rule MATCH: Contains_PE_File SUBSCORE: 1 
DESCRIPTION: Detect a PE file inside a byte sequence REF: - AUTHOR: Didier Stevens (https://DidierStevens.com) 
MATCHES: Str1: MZ
REASON_11: Yara Rule MATCH: Advapi_Hash_API SUBSCORE: 20 
DESCRIPTION: Looks for advapi API functions REF: - AUTHOR: _pusher_ 
MATCHES: Str1: ADVAPI32.dll Str2: CryptCreateHash Str3: CryptHashData Str4: CryptAcquireContext
[NOTICE] Results: 0 alerts, 0 warnings, 2 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:37:39Z

-------- Score ----------------
Scores		Rules
.......		...............
10		win_token
1		ft_exe
1		math_entropy_6
1		IsPE64
1		IsDLL
1		IsConsole
1		HasDebugData
1		HasRichSignature
2		PE_File
1		Contains_PE_File
20		Advapi_Hash_API

Score total: 40

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('win_token', '10'), ('ft_exe', '1'), ('math_entropy_6', '1'), ('IsPE64', '1'), ('IsDLL', '1'), ('IsConsole', '1'), ('HasDebugData', '1'), ('HasRichSignature', '1'), ('PE_File', '2'), ('Contains_PE_File', '1'), ('Advapi_Hash_API', '20')]
-------------- LOKI_Score ------------
['40']
-------------- CAPA_Score ------------
['6.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
753.6730158825782
============================================



==================================================================
PATH=[/var/log/Out_Zeek/extract_files] FILENAME=[HTTP-FjbnAngq5R9bdtvgd.exe] EVENT_TYPES=['IN_CREATE']
==================================================================

==================================================================
Scan Capa
==================================================================
-------  Out   -------
+------------------------+------------------------------------------------------------------------------------+
| md5                    | 5b3968b47eb16a1cb88525e3b565eab1                                                   |
| sha1                   | 43f2c73e08b589d6885bd248b056fe4ac99a590b                                           |
| sha256                 | 5f70c76b6771b7c56bc5da34e424eb9a090cedeb807c795795a88c415a2e772c                   |
| os                     | windows                                                                            |
| format                 | pe                                                                                 |
| arch                   | i386                                                                               |
| path                   | /var/log/Out_Zeek/extract_files/HTTP-FjbnAngq5R9bdtvgd.exe                         |
+------------------------+------------------------------------------------------------------------------------+

+------------------------+------------------------------------------------------------------------------------+
| ATT&CK Tactic          | ATT&CK Technique                                                                   |
|------------------------+------------------------------------------------------------------------------------|
| DEFENSE EVASION        | Obfuscated Files or Information:: \[T1027]\                                        |
|                        | Obfuscated Files or Information::Software Packing \[T1027.002]\                    |
| DISCOVERY              | System Information Discovery:: \[T1082]\                                           |
| EXECUTION              | Command and Scripting Interpreter:: \[T1059]\                                      |
|                        | Shared Modules:: \[T1129]\                                                         |
+------------------------+------------------------------------------------------------------------------------+

+-----------------------------+-------------------------------------------------------------------------------+
| MBC Objective               | MBC Behavior                                                                  |
|-----------------------------+-------------------------------------------------------------------------------|
| DATA                        | Encode Data::XOR [C0026.002]                                                  |
| DEFENSE EVASION             | Obfuscated Files or Information::Encoding-Standard Algorithm [E1027.m02]      |
| FILE SYSTEM                 | Writes File:: [C0052]                                                         |
| MEMORY                      | Allocate Memory:: [C0007]                                                     |
| PROCESS                     | Create Process:: [C0017]                                                      |
+-----------------------------+-------------------------------------------------------------------------------+

+------------------------------------------------------+------------------------------------------------------+
| CAPABILITY                                           | NAMESPACE                                            |
|------------------------------------------------------+------------------------------------------------------|
| compiled with MinGW for Windows                      | compiler/mingw                                       |
| encode data using XOR                                | data-manipulation/encoding/xor                       |
| contain a thread local storage (.tls) section        | executable/pe/section/tls                            |
| accept command line arguments                        | host-interaction/cli                                 |
| query environment variable                           | host-interaction/environment-variable                |
| write file on Windows                                | host-interaction/file-system/write                   |
| get thread local storage value                       | host-interaction/process                             |
| execute command                                      | host-interaction/process/create                      |
| allocate RWX memory                                  | host-interaction/process/inject                      |
| link function at runtime on Windows (2 matches)      | linking/runtime-linking                              |
| enumerate PE sections                                | load-code/pe                                         |
| parse PE exports                                     | load-code/pe                                         |
| parse PE header (4 matches)                          | load-code/pe                                         |
| load NCR ATM library                                 | targeting/automated-teller-machine/ncr               |
| reference NCR ATM library routines                   | targeting/automated-teller-machine/ncr               |
+------------------------------------------------------+------------------------------------------------------+


-------- Score ----------------
Scores		Rules
.......		...............
4		- Execution::Command and Scripting Interpreter [T1059;4]
2		- Execution::Shared Modules [T1129;2]
2		- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]
4		- Defense Evasion::Obfuscated Files or Information [T1027;4]
1		- Discovery::System Information Discovery [T1082;1]

Score total: 13.0

==================================================================
Scan ClamAV
==================================================================
-------  Out   -------
/var/log/Out_Zeek/extract_files/HTTP-FjbnAngq5R9bdtvgd.exe: OK

----------- SCAN SUMMARY -----------
Known viruses: 8780984
Engine version: 0.103.5
Scanned directories: 0
Scanned files: 1
Infected files: 0
Data scanned: 0.05 MB
Data read: 0.05 MB (ratio 1.00:1)
Time: 24.637 sec (0 m 24 s)
Start Date: 2022:01:28 14:37:39
End Date:   2022:01:28 14:38:03

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0.0

==================================================================
Scan Loki
==================================================================
-------  Out   -------

                                                                               
      __   ____  __ ______  
     / /  / __ \/ //_/  _/  
    / /__/ /_/ / ,< _/ /    
   /____/\____/_/|_/___/    
   YARA and IOC Scanner     
  
   by Florian Roth, GNU General Public License
   version 0.44.2 (Python 3 release)
  
   DISCLAIMER - USE AT YOUR OWN RISK

                                                                               

[NOTICE] Starting Loki Scan VERSION: 0.44.2 SYSTEM: yanis-virtual-machine TIME: 20220128T13:37:39Z PLATFORM:     PROC: x86_64 ARCH: 64bit 
[INFO] File Name Characteristics initialized with 3183 regex patterns
[INFO] C2 server indicators initialized with 16747 elements
[INFO] Malicious MD5 Hashes initialized with 19269 hashes
[INFO] Malicious SHA1 Hashes initialized with 7204 hashes
[INFO] Malicious SHA256 Hashes initialized with 189748 hashes
[INFO] False Positive Hashes initialized with 30 hashes
[INFO] Processing YARA rules folder /etc/Loki/signature-base/yara
[INFO] Initializing all YARA rules at once (composed string of all rule files)
[INFO] Initialized 3856 Yara rules
[INFO] Current user is root - very good
[INFO] Scanning Path /tmp/.Loki_Scan/ ...  
-[NOTICE] Results: 0 alerts, 0 warnings, 1 notices
[RESULT] SYSTEM SEEMS TO BE CLEAN.
[INFO] Please report false positives via https://github.com/Neo23x0/signature-base
[NOTICE] Finished LOKI Scan SYSTEM: yanis-virtual-machine TIME: 20220128T13:38:04Z

-------- Score ----------------
Scores		Rules
.......		...............
0		No Match

Score total: 0

============ Résultat des scans ============
---------------- CAPA_Rules ----------------
[('- Execution::Command and Scripting Interpreter [T1059;4]', '4'), ('- Execution::Shared Modules [T1129;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information::Software Packing [T1027.002;2]', '2'), ('- Defense Evasion::Obfuscated Files or Information [T1027;4]', '4'), ('- Discovery::System Information Discovery [T1082;1]', '1')]
---------------- ClamAV_Rules --------------
[('No Match', '0')]
-------------- LOKI_Rules ------------
[('No Match', '0')]
-------------- LOKI_Score ------------
['0']
-------------- CAPA_Score ------------
['13.0']
-------------- CLAMAV_Score ------------
['0']
-------------- SCORE FINAL ------------
259.38410094595434
============================================

